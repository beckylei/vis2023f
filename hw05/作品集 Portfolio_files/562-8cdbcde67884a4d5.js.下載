"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[562],{41796:function(e,t,n){n.d(t,{E:function(){return CloudFileAuthForm}});var r=n(85893),a=n(5146),l=n(90580);let CloudFileAuthForm=e=>{let{provider:t,children:n,alreadyAuthenticated:s,redirectToPicker:o=!1,onAuth:i}=e;return(0,r.jsxs)("form",{onSubmit:e=>{e.target.token.value=(0,a.FN)(),null==i||i(t,s)},action:"".concat("https://api.observablehq.com","/user/token/authorize"),method:"post",children:[(0,r.jsx)("input",{type:"hidden",name:"token",value:""}),(0,r.jsx)("input",{type:"hidden",name:"path",value:"".concat(location.pathname).concat(o?"?cloudFileProvider=".concat(t):"")}),(0,r.jsx)("input",{type:"hidden",name:"scopes",value:l.c[t].scopes.join(" ")}),(0,r.jsx)("input",{type:"hidden",name:"provider",value:t}),n]})}},63067:function(e,t,n){n.d(t,{h:function(){return CommentsLocked}});var r=n(85893),a=n(67294),l=n(42751),s=n(53141),o=n(40687),i=n(66002),c=n(76284),d=n(17596),u=n(4293),p=n(17616),m=n(43697);let CommentsLocked=e=>{let{commentingLock:t}=e,{admin_locked:n,admin_lock_reason:h,user_lock_actor:f,time:v}=t,x=v||void 0,g=(0,d.K)(x),b=x&&(0,u.LN)(x,g),y=(0,c.d)((0,a.useCallback)(()=>(0,r.jsx)(m.u,{label:(0,r.jsxs)("div",{className:"truncate w5 pa2 f6 dark-gray",children:[n?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{suppressHydrationWarning:!0,children:["By"," ",(0,r.jsx)("a",{href:i.Eo.support,rel:"noopener noreferrer",target:"_blank",className:"no-underline dark-gray hover-blue",children:"Observable Support"}),b&&(0,r.jsxs)(r.Fragment,{children:[" on ",b]})]}),(0,r.jsx)("div",{className:"mt2 f7 fw5 ws-normal dark-gray lh-copy",children:h})]}):f&&(0,r.jsxs)("div",{className:"flex truncate items-center",suppressHydrationWarning:!0,children:["By",(0,r.jsx)(l.q,{user:f,size:14,alt:"@".concat(f.login),className:"mh1"}),(0,p.RX)(f),b&&(0,r.jsxs)(r.Fragment,{children:[" on ",b]})]}),(0,r.jsxs)("div",{className:"mt2 f7 fw5 ws-normal dark-gray lh-copy",children:["While comments are locked, only editors may comment."," ",(0,r.jsxs)("a",{href:"/@observablehq/comments",target:"_blank",rel:"noreferrer",className:"inline-flex no-underline blue items-center",children:["Learn more",(0,r.jsx)(s.Z,{})]})]})]}),children:(0,r.jsx)("span",{children:"Comments locked"})}),[n,h,f,b]));return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.Z,{className:"mr1 moon-gray"}),y]})}},86893:function(e,t,n){n.d(t,{J:function(){return FileDetails}});var r=n(85893),a=n(47095),l=n(78460),fileIconFor=e=>{let{mimeType:t}=e;if(!t)return(0,r.jsx)(AttachmentIconOther,{className:"flex-shrink-0"});let[n,a]=t.split("/"),l={className:"flex-shrink-0",title:t};switch(n){case"audio":return(0,r.jsx)(AttachmentIconSound,{...l});case"video":return(0,r.jsx)(AttachmentIconVideo,{...l});case"image":return"svg+xml"===a?(0,r.jsx)(AttachmentIconSvg,{...l}):(0,r.jsx)(AttachmentIconImage,{...l});case"text":return"csv"===a||"tab-separated-values"===a?(0,r.jsx)(AttachmentIconData,{...l}):(0,r.jsx)(AttachmentIconText,{...l});case"application":switch(a){case"pdf":return(0,r.jsx)(AttachmentIconPdf,{...l});case"geo+json":return(0,r.jsx)(AttachmentIconGeojson,{...l});case"xml":case"json":case"x-sqlite3":return(0,r.jsx)(AttachmentIconData,{...l})}}return(0,r.jsx)(AttachmentIconOther,{...l})};function AttachmentIconData(e){return(0,r.jsxs)("svg",{width:"24",height:"27",viewBox:"0 0 28 32",fill:"white",...e,children:[(0,r.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2 26.5C2 28.433 3.567 30 5.5 30H22.5C24.433 30 26 28.433 26 26.5V10.5H19.5C18.3954 10.5 17.5 9.60457 17.5 8.5V2H5.5C3.567 2 2 3.567 2 5.5V26.5Z",fill:"#EFEFEF"}),(0,r.jsx)("path",{d:"M26 10.5L17.5 2V8.5C17.5 9.60457 18.3954 10.5 19.5 10.5H26Z",fill:"#E2E2E2"}),(0,r.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M10.1111 14C9.49746 14 9 14.4975 9 15.1111V17.3333C9 17.947 9.49746 18.4444 10.1111 18.4444H12.3333C12.947 18.4444 13.4444 17.947 13.4444 17.3333V15.1111C13.4444 14.4975 12.947 14 12.3333 14H10.1111ZM15.6667 14C15.053 14 14.5556 14.4975 14.5556 15.1111V17.3333C14.5556 17.947 15.053 18.4444 15.6667 18.4444H17.8889C18.5025 18.4444 19 17.947 19 17.3333V15.1111C19 14.4975 18.5025 14 17.8889 14H15.6667ZM9 20.6667C9 20.053 9.49746 19.5556 10.1111 19.5556H12.3333C12.947 19.5556 13.4444 20.053 13.4444 20.6667V22.8889C13.4444 23.5025 12.947 24 12.3333 24H10.1111C9.49746 24 9 23.5025 9 22.8889V20.6667ZM15.6667 19.5556C15.053 19.5556 14.5556 20.053 14.5556 20.6667V22.8889C14.5556 23.5025 15.053 24 15.6667 24H17.8889C18.5025 24 19 23.5025 19 22.8889V20.6667C19 20.053 18.5025 19.5556 17.8889 19.5556H15.6667Z",fill:"#C4C4C4"})]})}function AttachmentIconOther(e){return(0,r.jsxs)("svg",{width:"24",height:"27",viewBox:"0 0 28 32",fill:"none",...e,children:[(0,r.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2 26.5C2 28.433 3.567 30 5.5 30H22.5C24.433 30 26 28.433 26 26.5V10.5H19.5C18.3954 10.5 17.5 9.60457 17.5 8.5V2H5.5C3.567 2 2 3.567 2 5.5V26.5Z",fill:"#F2F2F2"}),(0,r.jsx)("path",{d:"M26 10.5L17.5 2V8.5C17.5 9.60457 18.3954 10.5 19.5 10.5H26Z",fill:"#E4E4E4"}),(0,r.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M13.4462 14.0293C12.5637 13.0792 11.0428 13.1363 10.2339 14.1499C9.5666 14.9861 9.6264 16.1884 10.3734 16.9543L16.6159 23.3543C16.8831 23.6284 17.3237 23.6284 17.591 23.3543C17.8491 23.0898 17.8491 22.6677 17.591 22.4032L11.979 16.6495L13.1244 15.5323L18.7364 21.286C19.6006 22.172 19.6006 23.5855 18.7364 24.4715C17.8412 25.3893 16.3657 25.3893 15.4705 24.4715L9.22803 18.0714C7.91758 16.7279 7.81268 14.6188 8.98334 13.1519C10.4023 11.3738 13.0703 11.2737 14.6185 12.9404L20.5861 19.3646L19.4139 20.4535L13.4462 14.0293Z",fill:"#C4C4C4"})]})}function AttachmentIconPdf(e){return(0,r.jsxs)("svg",{width:"24",height:"27",viewBox:"0 0 28 32",fill:"white",...e,children:[(0,r.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2 26.5C2 28.433 3.567 30 5.5 30H22.5C24.433 30 26 28.433 26 26.5V10.5H19.5C18.3954 10.5 17.5 9.60457 17.5 8.5V2H5.5C3.567 2 2 3.567 2 5.5V26.5Z",fill:"#EFEFEF"}),(0,r.jsx)("path",{d:"M26 10.5L17.5 2V8.5C17.5 9.60457 18.3954 10.5 19.5 10.5H26Z",fill:"#E2E2E2"}),(0,r.jsx)("rect",{x:"7",y:"20",width:"4",height:"4",stroke:"#C4C4C4",strokeWidth:"2"}),(0,r.jsx)("circle",{cx:"12.5",cy:"13.5",r:"2.5",stroke:"#C4C4C4",strokeWidth:"2"}),(0,r.jsx)("path",{d:"M15.4689 21.25L18.5 16L21.5311 21.25H15.4689Z",stroke:"#C4C4C4",strokeWidth:"2"})]})}function AttachmentIconSound(e){return(0,r.jsxs)("svg",{width:"24",height:"27",viewBox:"0 0 28 32",fill:"white",...e,children:[(0,r.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2 26.5C2 28.433 3.567 30 5.5 30H22.5C24.433 30 26 28.433 26 26.5V10.5H19.5C18.3954 10.5 17.5 9.60457 17.5 8.5V2H5.5C3.567 2 2 3.567 2 5.5V26.5Z",fill:"#EFEFEF"}),(0,r.jsx)("path",{d:"M26 10.5L17.5 2V8.5C17.5 9.60457 18.3954 10.5 19.5 10.5H26Z",fill:"#E2E2E2"}),(0,r.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M17.0761 20.0534V14.2508L11.9239 15.8358V23.5082C11.9736 23.6655 12 23.8303 12 24C12 25.1046 10.8807 26 9.5 26C8.11929 26 7 25.1046 7 24C7 22.8954 8.11929 22 9.5 22C9.69829 22 9.89118 22.0185 10.0761 22.0534V15.8358C10.0761 15.0246 10.6052 14.3083 11.3806 14.0698L17.4893 12.1905C18.2021 11.9712 18.9239 12.5043 18.9239 13.2502V21.5082C18.9736 21.6655 19 21.8303 19 22C19 23.1046 17.8807 24 16.5 24C15.1193 24 14 23.1046 14 22C14 20.8954 15.1193 20 16.5 20C16.6983 20 16.8912 20.0185 17.0761 20.0534Z",fill:"#C4C4C4"})]})}function AttachmentIconText(e){return(0,r.jsxs)("svg",{width:"24",height:"27",viewBox:"0 0 28 32",fill:"white",...e,children:[(0,r.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2 26.5C2 28.433 3.567 30 5.5 30H22.5C24.433 30 26 28.433 26 26.5V10.5H19.5C18.3954 10.5 17.5 9.60457 17.5 8.5V2H5.5C3.567 2 2 3.567 2 5.5V26.5Z",fill:"#EFEFEF"}),(0,r.jsx)("path",{d:"M26 10.5L17.5 2V8.5C17.5 9.60457 18.3954 10.5 19.5 10.5H26Z",fill:"#E2E2E2"}),(0,r.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7 15C7 14.4477 7.44772 14 8 14H20C20.5523 14 21 14.4477 21 15C21 15.5523 20.5523 16 20 16H8C7.44772 16 7 15.5523 7 15ZM7 19C7 18.4477 7.44772 18 8 18H20C20.5523 18 21 18.4477 21 19C21 19.5523 20.5523 20 20 20H8C7.44772 20 7 19.5523 7 19ZM8 22C7.44772 22 7 22.4477 7 23C7 23.5523 7.44772 24 8 24H15C15.5523 24 16 23.5523 16 23C16 22.4477 15.5523 22 15 22H8Z",fill:"#C4C4C4"})]})}function AttachmentIconImage(e){return(0,r.jsxs)("svg",{width:"24",height:"27",viewBox:"0 0 28 32",fill:"white",...e,children:[(0,r.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2 26.5C2 28.433 3.567 30 5.5 30H22.5C24.433 30 26 28.433 26 26.5V10.5H19.5C18.3954 10.5 17.5 9.60457 17.5 8.5V2H5.5C3.567 2 2 3.567 2 5.5V26.5Z",fill:"#EFEFEF"}),(0,r.jsx)("path",{d:"M26 10.5L17.5 2V8.5C17.5 9.60457 18.3954 10.5 19.5 10.5H26Z",fill:"#E2E2E2"}),(0,r.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M19.9143 17.8125C21.2432 17.8125 22.3205 16.7352 22.3205 15.4062C22.3205 14.0773 21.2432 13 19.9143 13C18.5853 13 17.508 14.0773 17.508 15.4062C17.508 16.7352 18.5853 17.8125 19.9143 17.8125ZM9.08063 16.0838C9.42048 15.5174 10.2414 15.5174 10.5812 16.0838L13.7013 21.284L15.0893 19.4333C15.4393 18.9667 16.1393 18.9667 16.4893 19.4333L18.8643 22.6C19.2969 23.1768 18.8853 24 18.1643 24H13.7855H13.4143H5.87635C5.19622 24 4.77612 23.258 5.12605 22.6748L9.08063 16.0838Z",fill:"#C4C4C4"})]})}function AttachmentIconSvg(e){return(0,r.jsxs)("svg",{width:"24",height:"27",viewBox:"0 0 28 32",fill:"white",...e,children:[(0,r.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2 26.5C2 28.433 3.567 30 5.5 30H22.5C24.433 30 26 28.433 26 26.5V10.5H19.5C18.3954 10.5 17.5 9.60457 17.5 8.5V2H5.5C3.567 2 2 3.567 2 5.5V26.5Z",fill:"#EFEFEF"}),(0,r.jsx)("path",{d:"M26 10.5L17.5 2V8.5C17.5 9.60457 18.3954 10.5 19.5 10.5H26Z",fill:"#E2E2E2"}),(0,r.jsx)("rect",{x:"7",y:"20",width:"4",height:"4",stroke:"#C4C4C4",strokeWidth:"2"}),(0,r.jsx)("circle",{cx:"12.5",cy:"13.5",r:"2.5",stroke:"#C4C4C4",strokeWidth:"2"}),(0,r.jsx)("path",{d:"M15.4689 21.25L18.5 16L21.5311 21.25H15.4689Z",stroke:"#C4C4C4",strokeWidth:"2"})]})}function AttachmentIconVideo(e){return(0,r.jsxs)("svg",{width:"24",height:"27",viewBox:"0 0 28 32",fill:"white",...e,children:[(0,r.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2 26.5C2 28.433 3.567 30 5.5 30H22.5C24.433 30 26 28.433 26 26.5V10.5H19.5C18.3954 10.5 17.5 9.60457 17.5 8.5V2H5.5C3.567 2 2 3.567 2 5.5V26.5Z",fill:"#EFEFEF"}),(0,r.jsx)("path",{d:"M26 10.5L17.5 2V8.5C17.5 9.60457 18.3954 10.5 19.5 10.5H26Z",fill:"#E2E2E2"}),(0,r.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M14.1061 25.2121C17.4783 25.2121 20.2121 22.4783 20.2121 19.1061C20.2121 15.7338 17.4783 13 14.1061 13C10.7338 13 8 15.7338 8 19.1061C8 22.4783 10.7338 25.2121 14.1061 25.2121ZM16.2945 19.8756C16.8288 19.5017 16.8288 18.7104 16.2945 18.3365L14.175 16.8528C13.5524 16.417 12.6969 16.8624 12.6969 17.6224V20.5897C12.6969 21.3497 13.5524 21.7951 14.175 21.3593L16.2945 19.8756Z",fill:"#C4C4C4"})]})}function AttachmentIconGeojson(e){return(0,r.jsxs)("svg",{width:"24",height:"27",viewBox:"0 0 28 32",fill:"white",...e,children:[(0,r.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2 26.5C2 28.433 3.567 30 5.5 30H22.5C24.433 30 26 28.433 26 26.5V10.5H19.5C18.3954 10.5 17.5 9.60457 17.5 8.5V2H5.5C3.567 2 2 3.567 2 5.5V26.5Z",fill:"#EFEFEF"}),(0,r.jsx)("path",{d:"M26 10.5L17.5 2V8.5C17.5 9.60457 18.3954 10.5 19.5 10.5H26Z",fill:"#E2E2E2"}),(0,r.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M14 13C11.2386 13 9 15.2501 9 18.0256C9 20.1019 10.0788 21.4751 11.0711 22.7383C11.4054 23.1638 11.7299 23.5768 12 24C12.515 24.8069 12.9234 25.4282 13.2332 25.8905C13.607 26.4482 14.393 26.4482 14.7668 25.8905C15.0766 25.4282 15.485 24.8069 16 24C16.2783 23.564 16.6142 23.1523 16.9591 22.7295C17.943 21.5235 19 20.228 19 18.0256C19 15.2501 16.7614 13 14 13ZM14 20C15.1046 20 16 19.1046 16 18C16 16.8954 15.1046 16 14 16C12.8954 16 12 16.8954 12 18C12 19.1046 12.8954 20 14 20Z",fill:"#C4C4C4"})]})}var s=n(14255),o=n(79998),i=n(29020);let FileDetails=e=>{var t;let{file:n,used:c,isPrivateInPublic:d=!1,isBucketUnavailable:u=!1,isBucketError:p=!1}=e;return d||u||p?(0,r.jsxs)("div",{className:"flex f7 items-center",children:[(0,r.jsxs)("div",{className:"relative flex-shrink-0",children:[(0,r.jsx)(fileIconFor,{mimeType:n.mimeType}),(0,r.jsx)("div",{className:"flex absolute bottom-0 br-100 bg-red justify-center items-center",style:{right:"-3px",width:14,height:14},children:(0,r.jsx)(l.Z,{className:"white","aria-label":"Private file",style:{width:14,height:14}})})]}),(0,r.jsxs)("div",{className:"ph2 overflow-x-hidden",children:[(0,r.jsx)("div",{className:"truncate pb1 fw6 dark-gray",title:n.name,children:n.name}),(0,r.jsx)("div",{className:"truncate gray lh-title",children:d?"Only available in private notebooks":u?"Private file storage unavailable":"Unable to access file"})]})]}):(0,r.jsxs)("div",{className:"flex f7 items-center",children:[(0,r.jsxs)("div",{className:"relative flex-shrink-0",children:[(null===(t=n.mimeType)||void 0===t?void 0:t.startsWith("image/"))&&"url"in n?(0,r.jsx)("img",{src:n.url,alt:n.name,className:"br2 ba bw1 b--light-silver",style:{width:20,height:24,objectFit:"cover"}}):(0,r.jsx)(fileIconFor,{mimeType:n.mimeType}),c&&(0,r.jsx)("div",{className:"flex absolute bottom-0 br-100 bg-blue justify-center items-center",style:{right:"-3px",width:14,height:14},children:(0,r.jsx)(a.Z,{className:"white","aria-label":"Private file",style:{width:14,height:14}})})]}),(0,r.jsxs)("div",{className:"ph2 overflow-x-hidden",children:["downloadUrl"in n?(0,r.jsx)("a",{className:"db truncate pb1 fw6 no-underline dark-gray hover-blue",href:n.downloadUrl,title:n.name,children:n.name}):(0,r.jsx)("div",{className:"truncate pb1 fw6 dark-gray",title:n.name,children:n.name}),(0,r.jsxs)("div",{className:"truncate gray lh-title",children:[(0,i.lL)(n)?(0,r.jsx)("span",{className:"f7 gray",children:"Local"}):c?(0,r.jsx)("span",{className:"f7 fw6 blue",children:"In use"}):(0,r.jsx)("span",{className:"f7 gray",children:"Unused"}),(0,r.jsx)("span",{className:"light-gray",children:" • "}),"size"in n?(0,r.jsxs)(r.Fragment,{children:[(0,o.BU)(n.size),(0,r.jsx)("span",{className:"light-gray",children:" • "})]}):null,(0,r.jsx)(s.q,{time:n.createTime})]})]})]})}},10067:function(e,t,n){var r=n(85893);t.Z=e=>(0,r.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd",...e,children:[(0,r.jsx)("path",{d:"M10.2929 8.29291L11.7071 9.70712L9.4142 12L11.7071 14.2929L10.2929 15.7071L6.58577 12L10.2929 8.29291Z"}),(0,r.jsx)("path",{d:"M8 11L14 11L14 13L8 13L8 11Z"}),(0,r.jsx)("path",{d:"M2 3C2 1.89543 2.89543 1 4 1H10L14 5V8H12V6H9V3H4V13H6V15H4C2.89543 15 2 14.1046 2 13V3Z"})]})},68301:function(e,t,n){var r=n(85893);t.Z=e=>(0,r.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",...e,children:[(0,r.jsx)("rect",{x:"9",y:"12",width:"2",height:"10",transform:"rotate(-180 9 12)",fill:"currentColor"}),(0,r.jsx)("path",{d:"M12 9L8 13L4 9",stroke:"currentColor",strokeWidth:"2",strokeLinejoin:"round"}),e.children]})},97721:function(e,t,n){var r=n(85893);t.Z=e=>(0,r.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",...e,children:[(0,r.jsx)("rect",{x:"7",y:"4",width:"2",height:"10",fill:"currentColor"}),(0,r.jsx)("path",{d:"M4 7L8 3L12 7",stroke:"currentColor",strokeWidth:"2",strokeLinejoin:"round"}),e.children]})},46579:function(e,t,n){var r=n(85893);t.Z=e=>(0,r.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...e,children:[(0,r.jsxs)("g",{clipPath:"url(#clip0_2412_6063)",children:[(0,r.jsx)("path",{d:"M8 11.1C9.65685 11.1 10.8 9.65685 10.8 8H10C8.89543 8 8 7.10457 8 6V5C6.34315 5 5 6.34315 5 8C5 9.65685 6.34315 11.1 8 11.1Z"}),(0,r.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2.19093 7.98979C2.46293 8.46514 3.04532 9.12944 3.94418 9.73177C5.02258 10.4544 6.4321 11 8.00001 11C9.56792 11 10.9774 10.4544 12.0558 9.73177C12.9547 9.12944 13.5371 8.46514 13.8091 7.98978C13.2086 6.84813 11.2592 5 8.00001 5C4.74085 5 2.79147 6.84813 2.19093 7.98979ZM0.151323 7.68377C0.794907 5.75302 3.59368 3 8.00001 3C12.4063 3 15.2051 5.75302 15.8487 7.68377L15.9541 8L15.8487 8.31623C15.5017 9.35714 14.4797 10.5151 13.1692 11.3932C11.8226 12.2956 10.0321 13 8.00001 13C5.96792 13 4.17744 12.2956 2.83083 11.3932C1.52032 10.5151 0.498294 9.35714 0.151323 8.31623L0.0459137 8L0.151323 7.68377Z"}),(0,r.jsx)("rect",{width:"19.578",height:"2",rx:"1",transform:"matrix(-0.707107 -0.707107 -0.707107 0.707107 15.658 14.8438)",fill:"white"}),(0,r.jsx)("rect",{width:"16.2193",height:"2",transform:"matrix(-0.707107 -0.707107 -0.707107 0.707107 15.3884 12.5742)"})]}),(0,r.jsx)("defs",{children:(0,r.jsx)("clipPath",{id:"clip0_2412_6063",children:(0,r.jsx)("rect",{width:"16",height:"16",fill:"white"})})})]})},33234:function(e,t,n){var r=n(85893);t.Z=e=>(0,r.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",stroke:"currentColor",...e,children:[(0,r.jsx)("circle",{cx:"4",cy:"3",r:"2",strokeWidth:"1.5"}),(0,r.jsx)("circle",{cx:"12",cy:"13",r:"2",strokeWidth:"1.5"}),(0,r.jsx)("path",{d:"M4 5V11C4 12.1046 4.89543 13 6 13H7",strokeWidth:"2"}),(0,r.jsx)("path",{d:"M12 11V5C12 3.89543 11.1046 3 10 3H9",strokeWidth:"2"})]})},69745:function(e,t,n){var r=n(85893);t.Z=e=>(0,r.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor",...e,children:[(0,r.jsx)("path",{d:"M8 11C9.65685 11 11 9.65685 11 8H10C8.89543 8 8 7.10457 8 6V5C6.34315 5 5 6.34315 5 8C5 9.65685 6.34315 11 8 11Z"}),(0,r.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2.19092 7.98979C2.46291 8.46514 3.0453 9.12944 3.94417 9.73177C5.02256 10.4544 6.43208 11 7.99999 11C9.5679 11 10.9774 10.4544 12.0558 9.73177C12.9547 9.12944 13.5371 8.46514 13.8091 7.98978C13.2085 6.84813 11.2592 5 7.99999 5C4.74083 5 2.79145 6.84813 2.19092 7.98979ZM0.151308 7.68377C0.794892 5.75302 3.59366 3 7.99999 3C12.4063 3 15.2051 5.75302 15.8487 7.68377L15.9541 8L15.8487 8.31623C15.5017 9.35714 14.4797 10.5151 13.1692 11.3932C11.8226 12.2956 10.0321 13 7.99999 13C5.9679 13 4.17742 12.2956 2.83082 11.3932C1.52031 10.5151 0.498278 9.35714 0.151308 8.31623L0.0458984 8L0.151308 7.68377Z"})]})},62825:function(e,t,n){var r=n(85893);t.Z=e=>(0,r.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",...e,children:[(0,r.jsx)("path",{d:"M11 15V15C11 14.4477 10.5523 14 10 14L6 14C5.44772 14 5 14.4477 5 15V15",stroke:"currentColor",strokeWidth:"2"}),(0,r.jsx)("path",{d:"M3 3L13 3",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),(0,r.jsx)("path",{d:"M11 8.25L13 3L15 8.25C15 9.2165 14.1046 10 13 10C11.8954 10 11 9.2165 11 8.25Z",stroke:"currentColor",strokeWidth:"2",strokeLinejoin:"round"}),(0,r.jsx)("path",{d:"M1 8.25L3 3L5 8.25C5 9.2165 4.10457 10 3 10C1.89543 10 1 9.2165 1 8.25Z",stroke:"currentColor",strokeWidth:"2",strokeLinejoin:"round"}),(0,r.jsx)("path",{d:"M8 3L8 14",stroke:"currentColor",strokeWidth:"2"})]})},82173:function(e,t,n){var r=n(85893);t.Z=e=>(0,r.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd",...e,children:[(0,r.jsx)("path",{d:"M3 1.75C2.30964 1.75 1.75 2.30964 1.75 3C1.75 3.69036 2.30964 4.25 3 4.25C3.69036 4.25 4.25 3.69036 4.25 3C4.25 2.30964 3.69036 1.75 3 1.75ZM0.25 3C0.25 1.48122 1.48122 0.25 3 0.25C4.51878 0.25 5.75 1.48122 5.75 3C5.75 4.51878 4.51878 5.75 3 5.75C1.48122 5.75 0.25 4.51878 0.25 3Z"}),(0,r.jsx)("path",{d:"M13 11.75C12.3096 11.75 11.75 12.3096 11.75 13C11.75 13.6904 12.3096 14.25 13 14.25C13.6904 14.25 14.25 13.6904 14.25 13C14.25 12.3096 13.6904 11.75 13 11.75ZM10.25 13C10.25 11.4812 11.4812 10.25 13 10.25C14.5188 10.25 15.75 11.4812 15.75 13C15.75 14.5188 14.5188 15.75 13 15.75C11.4812 15.75 10.25 14.5188 10.25 13Z"}),(0,r.jsx)("path",{d:"M10 12C9.44771 12 9 11.5523 9 11V5C9 3.34315 7.65685 2 6 2H5V4H6C6.55228 4 7 4.44772 7 5V11C7 12.6569 8.34315 14 10 14H11V12H10Z"})]})},26281:function(e,t,n){var r=n(85893);t.Z=e=>(0,r.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd",...e,children:[(0,r.jsx)("path",{d:"M8 14C11.3137 14 14 11.3137 14 8C14 4.68629 11.3137 2 8 2C4.68629 2 2 4.68629 2 8C2 11.3137 4.68629 14 8 14ZM8 16C12.4183 16 16 12.4183 16 8C16 3.58172 12.4183 0 8 0C3.58172 0 0 3.58172 0 8C0 12.4183 3.58172 16 8 16Z"}),(0,r.jsx)("path",{d:"M8.00002 5C7.23823 5 6.75235 5.42428 6.33207 6.0547L4.66797 4.9453C5.24769 4.07572 6.26181 3 8.00002 3C8.85764 3 9.74527 3.22801 10.4006 3.82095C11.0961 4.45014 11.3871 5.36121 11.24 6.39142C11.0654 7.61316 10.1329 8.20968 9.62788 8.53274C9.61312 8.54219 9.59872 8.5514 9.58471 8.56038C9.28352 8.75365 9.13447 8.85248 9.03752 8.95193C9.01576 8.97425 9.00487 8.98888 9.00006 8.9961C9.00004 8.99719 9.00002 8.99848 9.00002 9V10H7.00002V9C7.00002 8.36831 7.27443 7.89539 7.60537 7.55588C7.87516 7.27912 8.21507 7.06207 8.45012 6.91197C8.46899 6.89992 8.48719 6.8883 8.50461 6.87712C9.08301 6.50598 9.22542 6.35112 9.26007 6.10858C9.32718 5.63879 9.19239 5.42486 9.05886 5.30405C8.88525 5.14699 8.54074 5 8.00002 5Z"}),(0,r.jsx)("circle",{cx:"8",cy:"12",r:"1.25"})]})},38716:function(e,t,n){var r=n(85893);t.Z=e=>(0,r.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",stroke:"currentColor",strokeWidth:"2",...e,children:[(0,r.jsx)("rect",{x:"2",y:"2",width:"4",height:"12",rx:"1"}),(0,r.jsx)("rect",{x:"10",y:"2",width:"4",height:"12",rx:"1"})]})},91:function(e,t,n){n.d(t,{E:function(){return ReplaceAll}});var r=n(85893);let ReplaceAll=e=>(0,r.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",stroke:"currentColor",...e,children:[(0,r.jsx)("path",{d:"M8 9L8 3C8 2.44772 8.44772 2 9 2L11 2",strokeWidth:"2"}),(0,r.jsx)("path",{d:"M5 6L8 9L11 6",strokeWidth:"2"}),(0,r.jsx)("circle",{cx:"8",cy:"14",r:"0.5"}),(0,r.jsx)("circle",{cx:"5",cy:"14",r:"0.5"}),(0,r.jsx)("circle",{cx:"11",cy:"14",r:"0.5"})]})},75919:function(e,t,n){n.d(t,{x:function(){return ReplaceOne}});var r=n(85893);let ReplaceOne=e=>(0,r.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",stroke:"currentColor",...e,children:[(0,r.jsx)("path",{d:"M8 9L8 3C8 2.44772 8.44772 2 9 2L11 2",strokeWidth:"2"}),(0,r.jsx)("path",{d:"M5 6L8 9L11 6",strokeWidth:"2"}),(0,r.jsx)("circle",{cx:"8",cy:"14",r:"0.5"})]})},69583:function(e,t,n){var r=n(85893);t.Z=e=>(0,r.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",...e,children:[(0,r.jsx)("path",{d:"M6 9.5L3 6L6 2.5",stroke:"currentColor",strokeWidth:"2"}),(0,r.jsx)("path",{d:"M4 6C5.91616 6 7.69217 6 9.49994 6C11.4329 6 13 7.567 13 9.5V9.5C13 11.433 11.433 13 9.5 13H9",stroke:"currentColor",strokeWidth:"2"})]})},8122:function(e,t,n){var r=n(85893),a=n(94184),l=n.n(a),s=n(81649);t.Z=e=>{let{className:t,...n}=e;return(0,r.jsx)(s.Z,{className:l()("rotate-180",t),...n})}},81649:function(e,t,n){var r=n(85893);t.Z=e=>(0,r.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",...e,children:[(0,r.jsx)("path",{xmlns:"http://www.w3.org/2000/svg",d:"M7.8 2.26667L5.6 5.2C5.22229 5.70361 4.62951 6 4 6V13L5.36656 13.6833C5.78313 13.8916 6.24247 14 6.7082 14H12.2192C12.6781 14 13.0781 13.6877 13.1894 13.2425L14.6894 7.24254C14.8472 6.61139 14.3698 6 13.7192 6H12H9V2.66667C9 2.29848 8.70152 2 8.33333 2C8.1235 2 7.9259 2.0988 7.8 2.26667Z",stroke:"currentColor",strokeWidth:"2"}),(0,r.jsx)("path",{xmlns:"http://www.w3.org/2000/svg",d:"M0 6C0 5.44772 0.447715 5 1 5H2V14H1C0.447715 14 0 13.5523 0 13V6Z",fill:"currentColor",stroke:"none",strokeWidth:"2"})]})},65057:function(e,t,n){var r=n(85893);t.Z=e=>(0,r.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",stroke:"currentColor",strokeWidth:"2",...e,children:[(0,r.jsx)("rect",{x:"3",y:"7",width:"10",height:"7",rx:"0.5"}),(0,r.jsx)("path",{d:"M5 7.5V5C5 1.36704 9.9495 1.03365 10.8577 4"})]})},80159:function(e,t,n){n.d(t,{e:function(){return KeyboardShortcut}});var r=n(85893),a=n(5379),l=n.n(a),s=n(94184),o=n.n(s),i=n(88182);let KeyboardShortcut=e=>{let{shortcut:t}=e;return(0,r.jsx)("span",{title:(0,i._)(t),className:"f7",children:t.split("-").map((e,t)=>(0,r.jsxs)("span",{suppressHydrationWarning:!0,className:"jsx-7e2b8cbab695f8d1 "+(o()("dib",t>0?"ml1":"","Drag"===e||"Click"===e?"":"tc br2 ph1 key-shadow")||""),children:[("Drag"===e||"Click"===e)&&"+ ",(0,i.Z)(e),(0,r.jsx)(l(),{id:"7e2b8cbab695f8d1",children:"span.jsx-7e2b8cbab695f8d1{min-width:6px}.key-shadow.jsx-7e2b8cbab695f8d1{-webkit-box-shadow:0 0 0 1px#dedede,1px 1px 0 1px var(--silver);-moz-box-shadow:0 0 0 1px#dedede,1px 1px 0 1px var(--silver);box-shadow:0 0 0 1px#dedede,1px 1px 0 1px var(--silver)}"})]},t))})}},17101:function(e,t,n){n.d(t,{N:function(){return Node}});var r=n(85893),a=n(94184),l=n.n(a),s=n(67294),o=n(63067),i=n(51337),c=n(91929),d=n(95381),u=n(14318),caretUp=e=>(0,r.jsx)("svg",{width:"8",height:"16",viewBox:"0 0 8 16",fill:"none",...e,children:(0,r.jsx)("path",{d:"M1 9.5L4 7L7 9.5",stroke:"currentColor",strokeWidth:"1.8"})});let ToggleResolvedComments=e=>{let{numResolved:t,numUnresolved:n,expanded:a,onToggle:s}=e;return(0,r.jsx)("div",{className:l()("flex nl2 nr2",n?"bb":"","b--light-gray"),children:(0,r.jsxs)("button",{type:"button",onClick:s,className:"inline-flex w-100 pa2 f6 mid-gray bg-transparent i pointer bn",children:[a?(0,r.jsx)(caretUp,{className:"mr2"}):(0,r.jsx)(u.Z,{className:"mr2"}),t>1?"".concat(t," resolved comments"):"1 resolved comment"]})})};var p=n(26713),m=n(7595),h=n(90271),f=n(63302),v=n(32980),x=n(29020),g=n(60147);function DisplayComments(e,t){return e.map((n,a)=>"updateInitiated"===n.status?(0,r.jsx)(d.S,{nodeId:n.node_id,comment:n,isUpdatingComment:!0,dispatch:t,first:0===a},"remote-".concat(n.id)):(0,r.jsx)(c.s,{dispatch:t,comment:n,first:0===a,repeated:a>0&&e[a].user.id===e[a-1].user.id},(0,x.tO)(n)?"local-".concat(n.nonce):"remote-".concat(n.id)))}var b=(0,g.$j)((e,t)=>{let{notebook:n,currentUser:r}=e;return{resolvedComments:(0,f.o7)(n,t.nodeId),unresolvedComments:(0,f.HS)(n,t.nodeId),notebook:n,currentUser:r}},e=>({dispatch:e}))(e=>{let{nodeId:t,notebook:n,currentUser:a,resolvedComments:s,unresolvedComments:c,dispatch:u}=e;if(!n.openComments.has(t)||!(0,m.H7)(n))return null;let f=(0,v.f$)(n)&&c.length>0,g=n.composingComments.has(t),b=n.expandedResolvedComments.has(t);return(0,r.jsx)("div",{className:"relative pea sans-serif f6 lh-f6 dark-gray",style:{paddingTop:"0.75rem"},children:(0,r.jsxs)("div",{className:"bg-washed-yellow",style:{maxWidth:640+2*h.Mv,marginLeft:-h.Mv,marginRight:-h.Mv,paddingLeft:h.Mv,paddingRight:h.Mv},children:[b&&DisplayComments(s,u),s.length>0&&(0,r.jsx)(ToggleResolvedComments,{numResolved:s.length,numUnresolved:c.length,expanded:b,onToggle:function(){u({type:"toggleResolvedComments",nodeId:t,trigger:"click",source:"commentBox"})}}),DisplayComments(c,u),g?(0,r.jsx)(d.S,{nodeId:t,dispatch:u,first:c.length+s.length===0}):(0,r.jsxs)("div",{className:l()("flex","justify-".concat(f?"between":"end"),"bg-washed-yellow pb2"),children:[f&&(0,r.jsx)(p.sn,{onClick:function(){u({type:"resolveComments",nodeId:t,trigger:"click",source:"commentBox"})},disabled:!c.every(e=>(0,m.Lj)(e)),text:"Resolve",className:"mr2"}),(0,x.fC)(n)&&!(0,v.RF)(n)?(0,r.jsx)("div",{className:"inline-flex ph2 nr2 pt1 pb3 f6 dark-gray items-center",children:(0,r.jsx)(o.h,{commentingLock:n.commentingLock})}):(0,r.jsx)(p.sn,{icon:i.ZP,text:"Comment",onClick:function(){(0,v.RF)(n)?u({type:"commentComposeOpen",nodeId:t,trigger:"click",source:"commentBox"}):a||u({type:"showModal",modal:"login",modalProps:{loginReason:"comment"},trigger:"click",source:"comment"})}})]})]})})}),y=n(84372),j=n(62420),w=n(27554),components_jumpToError=e=>{let{id:t,dispatch:n}=e;return(0,r.jsx)("button",{title:"Jump to error",onClick:()=>n({type:"focusError",id:t}),className:"absolute pv1 ph2 bg-near-white red f7 fw5 bn br3 pointer pea",style:{top:-28,right:-14},children:"Jump to error"})},k=n(83749),C=n(5379),N=n.n(C),indeterminate=e=>(0,r.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",...e,children:[(0,r.jsx)("rect",{x:"5",y:"7",width:"6",height:"2",rx:"1",fill:"currentColor"}),(0,r.jsx)("rect",{x:"3",y:"3",width:"10",height:"10",rx:"1",stroke:"currentColor",strokeWidth:"2"})]}),S=n(1316),L=n(65057),M=n(40591),R=n(41312),D=n(49751),_=n(4870),Z=n(42786);let E=(0,g.$j)(e=>{let{notebook:t}=e;return{notebook:t}},e=>({dispatch:e}))(e=>{let{id:t,notebook:n,dispatch:a}=e,o=(0,M.DY)(n.model,t),i=(0,R.Qc)(o),c=i.body.source.value,d=(0,D.uF)(n),u=(0,D.uF)(n,{ignoreResolutions:!0}),p=(0,s.useMemo)(()=>{if(!d||!u)return;let{directImports:e}=(0,D.$r)(d),t=(0,D.ng)(u.specifiers,e,n.model.resolutions);return t.get(c)},[c,d,u,n.model.resolutions]);if(!p)return null;let m=(0,D.xT)(null==d?void 0:d.specifiers[c]),h=_.Z.parse(c);return h&&(0,Z.qU)(o)?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("button",{title:"".concat(p.updatesAvailable?"Updates available. ":"").concat("locked"===p.lockStatus?"This import and all of its dependencies are locked.":"unlocked"===p.lockStatus?"This import and all of its dependencies are unlocked, so the latest version will always be imported.":"Not all of this import's dependencies are locked."," Click to open the Dependencies pane and manage versions."),onClick:()=>{a({type:"showNotebookDependencyDetails",updatesAvailable:p.updatesAvailable,status:p.lockStatus,specifier:c})},className:N().dynamic([["216e23a914626b64",[m?"color: var(--white)":"",p.updatesAvailable?"background-color: var(--observable-focus-light-blue)":"",m?"background-color: var(--red)":"",m?"color: var(--white)":"",m?"background-color: var(--red);":""]]])+" "+(l()(p.updatesAvailable?"has-updates ":"","lock-status absolute hover-mid-gray pv1 ph2 bg-near-white f7 fw5 bn gray br4 pointer flex items-center align-center pea")||""),children:"locked"===p.lockStatus?(0,r.jsx)(S.Z,{}):"unlocked"===p.lockStatus?(0,r.jsx)(L.Z,{}):(0,r.jsx)(indeterminate,{})}),(0,r.jsx)(N(),{id:"216e23a914626b64",dynamic:[m?"color: var(--white)":"",p.updatesAvailable?"background-color: var(--observable-focus-light-blue)":"",m?"background-color: var(--red)":"",m?"color: var(--white)":"",m?"background-color: var(--red);":""],children:".lock-status.__jsx-style-dynamic-selector{padding-left:10px;padding-right:10px;top:-28px;right:-14px;color:var(--observable-focus-dark-blue);".concat(m?"color: var(--white)":"",";").concat(p.updatesAvailable?"background-color: var(--observable-focus-light-blue)":"",";").concat(m?"background-color: var(--red)":"",";}.lock-status.__jsx-style-dynamic-selector:hover{color:var(--mid-gray);").concat(m?"color: var(--white)":"",';}.has-updates.__jsx-style-dynamic-selector::after{content:"";position:absolute;top:0;right:0;width:7px;height:7px;background-color:var(--observable-focus-dark-blue);').concat(m?"background-color: var(--red);":"",";-webkit-border-radius:3.5px;-moz-border-radius:3.5px;border-radius:3.5px}")})]}):null});var T=n(49847),F=n(54687),V=n(20736),I=n(4530),H=n(56770),A=n(68404),P=n(44911),O=n(50809);let Node=e=>{var t,n,a;let{node:o,editorState:i,assistFocused:c,focused:d,selected:u,selectionFocused:m,editorOpen:f,workerHeight:C,editors:N,hovered:S,hasPrevious:L,hasNext:D,rowId:_=0,editorComponent:Z,nodeInserterProps:B}=e,U=(0,g.I0)(),z=(0,s.useRef)(null),W=(0,s.useRef)(null),q=(0,s.useRef)(null),G=(0,s.useRef)(null),{id:Y}=o,K=(0,R.u2)(o),{canEditDashboard:X,chartSpec:$,displayMode:J,isDragging:Q,docAllowsLayout:ee,canDeleteNode:et,nextId:en,nodeNotebook:er,suggestions:ea,present:el,user:es}=(0,g.v9)(e=>{var t,n,r,a;let{currentUser:l,notebook:s}=e;return{user:l,nodeNotebook:s,canEditDashboard:(0,v.ng)(l,s)&&!s.present,chartSpec:null===(t=s.workerStatus.get(Y))||void 0===t?void 0:t.chartSpec,displayMode:null===(r=s.workerStatus.get(Y))||void 0===r?void 0:null===(n=r.display)||void 0===n?void 0:n.mode,isDragging:(s.dragId||0===s.dragId)&&s.dragId>-1,docAllowsLayout:(0,x.XT)(s),canDeleteNode:s.model.nodes.length>1,nextId:(0,M.o4)(s.model,Y),suggestions:null===(a=s.workerStatus.get(Y))||void 0===a?void 0:a.suggestions,present:s.present}}),eo=(0,V.GS)(V.ro),ei=ee&&(!eo||!el),ec=ei?_:Y,ed=O.bd.flatMap(e=>{let{items:t}=e;return t.filter(e=>{var t;return null===(t=e.filter)||void 0===t?void 0:t.call(e,{allowFileAttachments:!1,allowPrivateData:!1,allowSchedules:!1,suggestions:ea||[],previousMode:o.mode})})}),[eu,ep]=(0,s.useState)(!1),{jumpToError:em}=i.field(F.ei).find(e=>{let{jumpToError:t}=e;return t})||{},[eh,ef]=(0,s.useState)({filter:void 0,sort:void 0}),[ev,ex]=(0,s.useState)(!1);(0,s.useEffect)(()=>{let e=(0,A.jn)(W.current,ec,"editor",U),t=(0,A.jn)(q.current,ec,"comments",U),n=(0,A.jn)(G.current,ec,"display",U);return()=>{e.disconnect(),t.disconnect(),n.disconnect()}},[ec,U]),(0,s.useEffect)(()=>{m&&(0,H.zT)(z.current)},[m]);let eg=(0,V.GS)(V.ro),eb=f&&d;return(0,r.jsxs)("div",{ref:z,className:l()("relative node pen",S||d?"node-hover":""),"data-node-id":Y,"data-section":(null===(n=o.display)||void 0===n?void 0:null===(t=n.presentation)||void 0===t?void 0:t.hidden)?"hidden":"present",id:"nodeName"!==K&&K||void 0,style:{marginTop:h.KI,marginBottom:h.KI,paddingTop:C},children:[(0,r.jsxs)("div",{onMouseEnter:()=>U({type:"hover",id:Y}),children:[u||m?(0,r.jsx)("div",{className:"absolute br2 z-1",style:{top:1,left:-13,right:-13,bottom:1,boxShadow:u&&m?"0px 0px 0px 2px var(--lightest-blue), 0px 0px 0px 4px var(--faint-blue)":u?"0px 0px 0px 2px var(--washed-blue)":"0px 0px 0px 2px var(--lightest-blue)"}}):null,(0,r.jsx)("div",{ref:G,children:(0,P.kk)(o)&&"table"===J&&(0,r.jsx)(T.V,{node:o,operations:eh,setOperations:ef,setColumnsFlash:ex})}),(0,r.jsxs)("div",{ref:W,className:"relative",children:[em?(0,r.jsx)(components_jumpToError,{dispatch:U,id:Y}):(null===(a=(0,R.Qc)(o).body)||void 0===a?void 0:a.type)==="ImportDeclaration"?(0,r.jsx)(E,{id:Y}):null,ei&&X&&(0,P.kk)(o)&&(0,r.jsx)("div",{style:{height:"".concat(h.dL,"px")}}),ei&&f&&(0,r.jsx)("div",{style:{height:3}}),f&&(0,r.jsx)(Z,{node:o,editorState:i,focused:d,assistFocused:c,hovered:S,selected:u||m,editors:N,hasPrevious:L,hasNext:D,operations:eh,setOperations:ef,columnsFlash:ev,setColumnsFlash:ex,rowId:_,allowsLayout:ei}),!ei&&eb&&!Q&&(0,r.jsxs)("div",{className:"relative pea flex items-center justify-end mt1",style:{right:-14},children:[!eu&&(0,r.jsxs)(r.Fragment,{children:[ed.map((e,t)=>{let{action:n,icon:a,label:l}=e;return(0,r.jsx)(p.hA,{className:"bg-observable-focus-lightest-blue hover-bg-observable-focus-light-blue mid-gray mr1",icon:null!=a?a:y.Z,text:eg?"":l,onClick:()=>{(0,I.MR)((0,I.ym)({type:"notebook:view:nodeSuggestionSelectedEvent",data:{suggestion:l},eventVersion:1,notebook:er,currentUser:es})),null==n||n(U,{chartSpec:$,filter:"",nextId:en,previousId:Y,previousNode:o,trigger:"click"})},title:l},t)}),(0,r.jsx)(p.hA,{icon:j.Z,title:eg?"":"Duplicate cell",className:"bg-observable-focus-lightest-blue hover-bg-observable-focus-light-blue mid-gray mr1 ml2",onClick:e=>{U({type:"duplicate",id:Y,before:e.shiftKey})}})]}),(0,r.jsx)(p.hA,{icon:w.Z,title:eg?"":et?eu?"Click again to confirm deletion":"Delete cell":"Delete cell (Cannot delete the only cell)",className:"bg-observable-focus-lightest-blue hover-bg-observable-focus-light-blue mid-gray",destructive:eu,disabled:!et,onBlur:()=>ep(!1),onClick:e=>{eu?(U({type:"remove",focusAfter:e.shiftKey,focusBefore:!e.shiftKey,id:Y}),ep(!1)):ep(!0)},text:eu?"Delete?":""})]})]}),!ei&&eb&&!Q&&B&&(0,r.jsx)(k.Z,{...B}),(0,r.jsx)("div",{ref:q,children:!ei&&(0,r.jsx)(b,{nodeId:Y})})]}),!eb&&!el&&B&&(0,r.jsx)(k.Z,{...B})]})}},68227:function(e,t,n){n.d(t,{P:function(){return _}});var r=n(85893),a=n(46350),l=n(94184),s=n.n(l),o=n(67294),i=n(96265),c=n(13961),d=n(56564),u=n(26713),p=n(68301),m=n(97721),h=n(15100),f=n(46579),v=n(69745),x=n(62420),g=n(31881),b=n(91696),y=n(27554),j=n(28857),w=n(10245),k=n(57636),C=n(12037),N=n(7595),S=n(88182),L=n(80400),M=n(44911),R=n(29020),D=n(60147);let _=2500,Z=(0,o.memo)(function(e){var t;let{node:n,hasPrevious:l,hasNext:i,editorFocused:c,editorKey:d,editorMode:Z,editorReadonly:E,editorSettings:T,editors:F,dirty:V,dispatch:I}=e,{id:H,data:A,pinned:P}=n,O=(null==A?void 0:null===(t=A.display)||void 0===t?void 0:t.mode)==="none",{canAttach:B,canDeleteNode:U,firstNodeId:z,allowsLayout:W,isDragging:q,documentType:G}=(0,D.v9)(e=>{var t;let{notebook:n,currentUser:r}=e;return{canAttach:(0,N.j5)(r,n),canDeleteNode:n.model.nodes.length>1,firstNodeId:null===(t=n.model.nodes[0])||void 0===t?void 0:t.id,allowsLayout:(0,R.XT)(n),isDragging:(n.dragId||0===n.dragId)&&n.dragId>-1,documentType:n.type}}),Y="dashboard"!==G,[K,X]=(0,o.useState)(null),$=(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(u.hA,{icon:V?b.s:b.Z,title:"Run cell ".concat((0,S.Z)("Shift-Enter")),className:V?"blue":"",onClick:()=>{F.applyCommand(d,(0,w.z)("click","nodeToolbar"))}}),(0,r.jsx)(u.hA,{icon:g.Z,title:"".concat(P?"Unpin":"Pin"," cell ").concat((0,S.Z)("Mod-.")),className:P?"blue ml2":"ml2",joinRight:Y,onClick:()=>I({type:"togglePin",id:H})}),Y&&(0,r.jsx)(u.hA,{icon:O?f.Z:v.Z,title:"".concat(O?"Show":"Hide"," output ").concat((0,S.Z)("Mod-,")),className:"ml2",joinLeft:!0,onClick:()=>I({type:"toggleDisplay",id:H})}),(0,r.jsx)(u.hA,{icon:h.Z,title:"Select cell ".concat((0,S.Z)("Escape-X")),suppressHydrationWarning:!0,className:"ml2",onClick:()=>I({type:"selectionPromote"})}),(0,r.jsx)(u.hA,{icon:m.Z,title:"Move cell up ".concat((0,S.Z)("Ctrl-Shift-Up")),suppressHydrationWarning:!0,className:"ml2",disabled:!l,joinRight:!0,onClick:()=>I({type:"moveUp",id:H})}),(0,r.jsx)(u.hA,{icon:p.Z,title:"Move cell down ".concat((0,S.Z)("Ctrl-Shift-Down")),suppressHydrationWarning:!0,className:"ml2",disabled:!i,joinLeft:!0,onClick:()=>I({type:"moveDown",id:H})}),(0,r.jsx)(u.hA,{icon:x.Z,title:"Duplicate cell ".concat((0,S.Z)("Shift-Alt-Mod-Down")),suppressHydrationWarning:!0,className:"ml2",onClick:e=>{I({type:"duplicate",id:H,before:e.shiftKey})}}),(0,r.jsx)(u.hA,{icon:y.Z,title:U?"Double-click to delete cell ".concat((0,S.Z)("Alt-Backspace")):"Delete cell (Cannot delete the only cell)",suppressHydrationWarning:!0,className:"ml2",destructive:!!K,disabled:!U,text:K?"Delete?":"",onClick:e=>{K?(I({type:"remove",focusAfter:e.shiftKey,focusBefore:!e.shiftKey&&H!==z,id:H}),window.clearTimeout(K),X(null)):X(window.setTimeout(()=>X(null),_))}}),c&&M.qz[Z].toolbar.length?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"ml2 mv1 bl bw1 br2",style:{borderColor:"var(--observable-focus-light-blue)"}}),M.qz[Z].toolbar.filter(e=>!e.requiresAttachments||B).map(e=>(0,r.jsx)(u.hA,{"data-cy":e.name,icon:e.icon,title:e.title,joinLeft:e.joinLeft,joinRight:e.joinRight,suppressHydrationWarning:!0,className:"ml2",onClick:()=>{"attach"!==e.name||T.fileUploadsOn?e.onClick(d,F,H,I):T.loginToUpload&&I({type:"showModal",modal:"login",modalProps:{loginReason:"files"},trigger:"click",source:"nodeEditorToolbarAttachButton"})}},e.name))]}):null,(0,r.jsx)("div",{className:"flex flex-grow-1"}),(0,r.jsx)(u.hA,{icon:j.Z,title:"Blur cell ".concat((0,S.Z)("Escape")),suppressHydrationWarning:!0,transparent:!0,onMouseDown:e=>{e.stopPropagation()},onClick:()=>{I({type:"blur",id:H})}})]});return(0,L.t)()?(0,r.jsx)("div",{className:"pt1 pb2 near-black",style:{marginLeft:-14,marginRight:-14,minWidth:"calc(100% + 28px)",borderBottomRightRadius:"0.25rem",borderTopRightRadius:0,backgroundColor:"var(--observable-focus-lightest-blue)"},onMouseDown:e=>{e.preventDefault()},children:(0,r.jsx)("div",{className:"ph2 w-100 flex relative no-wrap overflow-y-hidden overflow-x-auto",children:$})}):(0,r.jsx)(a.h,{children:(0,r.jsx)("div",{className:s()("fixed left-0 right-0 bottom-0 pv2 z-1 bg-white b--silver bt near-black dn-print",q&&"pen"),onMouseDown:e=>{e.preventDefault(),F.refocus()},children:(0,r.jsx)(C.Z,{className:s()(!W&&"w-100"),children:(0,r.jsxs)("div",{className:"flex relative",style:{marginLeft:W?"calc(-5% - 10px)":-14,marginRight:-14},children:[(0,r.jsx)("div",{className:s()(!W&&"absolute","h-100 flex items-center pr2"),style:{font:"var(--monospace-font)",right:W?"":"100%"},onMouseDown:e=>{e.stopPropagation()},children:(0,r.jsx)(k.Q,{node:n,source:"nodeToolbar",dispatch:I,disabled:E,style:{textAlign:"right",width:"calc(max((100vw - var(--max-width-8))/2, 0px))"}})}),$]})})})})});t.Z=e=>{let{node:t,dirty:n,hasPrevious:a,hasNext:l,editorFocused:s,editorState:o,editors:u,dispatch:p}=e,m=o.field(c.C);return(0,r.jsx)(Z,{node:t,hasPrevious:a,hasNext:l,editorFocused:s,editorKey:o.field(i.A),editorMode:m,editorSettings:o.field(d.i),editors:u,dirty:n,dispatch:p,editorReadonly:o.readOnly})}},57636:function(e,t,n){n.d(t,{Q:function(){return u}});var r=n(85893),a=n(67294),l=n(24067),s=n(91),o=n(75919),i=n(17267),c=n(88182),d=n(41312);let u=a.forwardRef(function(e,t){let{node:n,dispatch:u,disabled:p,autoWidth:m=!1,className:h,style:f,source:v,onSubmit:x=()=>{},onFocus:g}=e,{id:b}=n,y=(0,d.u2)(n)||"",[j,w]=(0,a.useState)(y),[k,C]=(0,a.useState)(!1),N=j!==y,S=!k&&""!==j&&N,L="cell ".concat(n.id);function maybeRename(e){return(!j||!!(0,d.r1)(j))&&(u({type:"setName",name:j,id:b,source:v,replaceReferences:e}),!0)}return(0,a.useEffect)(()=>w(y),[y]),(0,r.jsxs)("div",{className:"relative flex items-stretch",children:[(0,r.jsx)(l.Z,{value:j,"data-cy":"cell-name-input-".concat(v),spellCheck:"false",autoCorrect:"off",autoCapitalize:"none",disabled:p,className:h,style:{paddingRight:N?20:8,color:!j||(0,d.r1)(j)?void 0:"var(--red)",font:"var(--monospace-font)",textOverflow:"ellipsis",maxWidth:200,minWidth:75,width:m?"calc(".concat(N?16:0,"px + (").concat((j||L).length," * 8.5px) + (2 * var(--spacing-small)))"):(null==f?void 0:f.minWidth)||75,...f},minimal:!0,maxLength:65536,placeholder:L,large:!1,onChange:e=>w(e.target.value.replace(/\s/g,"")),onBlur:async()=>{if(await Promise.resolve(),!maybeRename(!1))return w(y)},onKeyDown:e=>{if(C(!!e.altKey),("Enter"===e.key||("s"===e.key||"\xdf"===e.key)&&e[i.Ao]&&!e.shiftKey)&&maybeRename(!e.altKey)){if(e.preventDefault(),e.shiftKey||"s"===e.key||"\xdf"===e.key)return e.stopPropagation();x()}},onKeyUp:e=>{e.altKey||C(!1)},onFocus:g,ref:t}),N?(0,r.jsx)("button",{title:"Rename cell and replace references ".concat((0,c.Z)("Enter"),"\nRename cell ").concat((0,c.Z)("Alt-Enter")),suppressHydrationWarning:!0,className:"absolute top-0 right-0 h-100 bg-transparent bn ph1 blue hover-dark-blue flex items-center pointer squishy",onMouseDown:()=>u({type:"setName",name:j,id:b,source:"nodeToolbar",replaceReferences:S}),children:S?(0,r.jsx)(s.E,{}):(0,r.jsx)(o.x,{})}):null]})})},98616:function(e,t,n){n.d(t,{Z:function(){return nodeSelectionToolbar}});var r=n(85893),a=n(46350),l=n(94184),s=n.n(l),o=n(67294),i=n(26713),c=n(68301),d=n(97721),u=n(15100),p=n(46579),m=n(69745),h=n(62420),f=n(31881),v=n(91696);let Selected=e=>(0,r.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",...e,children:[(0,r.jsx)("mask",{id:"path-1-inside-1_528:41919",fill:"white",children:(0,r.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M5 1C2.79086 1 1 2.79086 1 5V11C1 13.2091 2.79086 15 5 15H11C13.2091 15 15 13.2091 15 11V5C15 2.79086 13.2091 1 11 1H5ZM11.868 6.94597L12.5639 6.22791L11.1278 4.83596L10.4318 5.55403L7.149 8.94108L5.67569 7.67824L4.91644 7.02745L3.61485 8.54597L4.37411 9.19676L6.56161 11.0718L7.2758 11.6839L7.93047 11.0085L11.868 6.94597Z"})}),(0,r.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M5 1C2.79086 1 1 2.79086 1 5V11C1 13.2091 2.79086 15 5 15H11C13.2091 15 15 13.2091 15 11V5C15 2.79086 13.2091 1 11 1H5ZM11.868 6.94597L12.5639 6.22791L11.1278 4.83596L10.4318 5.55403L7.149 8.94108L5.67569 7.67824L4.91644 7.02745L3.61485 8.54597L4.37411 9.19676L6.56161 11.0718L7.2758 11.6839L7.93047 11.0085L11.868 6.94597Z",fill:"currentColor"}),(0,r.jsx)("path",{d:"M12.5639 6.22791L14.0001 7.61985L15.392 6.18372L13.9559 4.79177L12.5639 6.22791ZM11.868 6.94597L10.4318 5.55403L10.4318 5.55403L11.868 6.94597ZM11.1278 4.83596L12.5198 3.39982L11.0836 2.00788L9.69167 3.44401L11.1278 4.83596ZM10.4318 5.55403L11.868 6.94597L11.868 6.94597L10.4318 5.55403ZM7.149 8.94108L5.84742 10.4596L7.2758 11.6839L8.58514 10.333L7.149 8.94108ZM5.67569 7.67824L6.97728 6.15973L6.97728 6.15973L5.67569 7.67824ZM4.91644 7.02745L6.21802 5.50894L4.69951 4.20736L3.39792 5.72587L4.91644 7.02745ZM3.61485 8.54597L2.09634 7.24438L0.794758 8.7629L2.31327 10.0645L3.61485 8.54597ZM4.37411 9.19676L5.67569 7.67824L5.67569 7.67824L4.37411 9.19676ZM6.56161 11.0718L5.26003 12.5903L5.26003 12.5903L6.56161 11.0718ZM7.2758 11.6839L5.97422 13.2024L7.40261 14.4268L8.71194 13.0759L7.2758 11.6839ZM7.93047 11.0085L9.3666 12.4004L9.3666 12.4004L7.93047 11.0085ZM3 5C3 3.89543 3.89543 3 5 3V-1C1.68629 -1 -1 1.68629 -1 5H3ZM3 11V5H-1V11H3ZM5 13C3.89543 13 3 12.1046 3 11H-1C-1 14.3137 1.68629 17 5 17V13ZM11 13H5V17H11V13ZM13 11C13 12.1046 12.1046 13 11 13V17C14.3137 17 17 14.3137 17 11H13ZM13 5V11H17V5H13ZM11 3C12.1046 3 13 3.89543 13 5H17C17 1.68629 14.3137 -1 11 -1V3ZM5 3H11V-1H5V3ZM11.1278 4.83596L10.4318 5.55403L13.3041 8.33792L14.0001 7.61985L11.1278 4.83596ZM9.73586 6.27209L11.172 7.66404L13.9559 4.79177L12.5198 3.39982L9.73586 6.27209ZM11.868 6.94597L12.5639 6.2279L9.69167 3.44401L8.9957 4.16208L11.868 6.94597ZM8.58514 10.333L11.868 6.94597L8.9957 4.16208L5.71286 7.54913L8.58514 10.333ZM4.37411 9.19676L5.84742 10.4596L8.45058 7.42257L6.97728 6.15973L4.37411 9.19676ZM3.61485 8.54597L4.37411 9.19676L6.97728 6.15973L6.21802 5.50894L3.61485 8.54597ZM5.13337 9.84755L6.43495 8.32904L3.39792 5.72587L2.09634 7.24438L5.13337 9.84755ZM5.67569 7.67824L4.91644 7.02745L2.31327 10.0645L3.07253 10.7153L5.67569 7.67824ZM7.86319 9.55324L5.67569 7.67824L3.07253 10.7153L5.26003 12.5903L7.86319 9.55324ZM8.57739 10.1654L7.86319 9.55324L5.26003 12.5903L5.97422 13.2024L8.57739 10.1654ZM6.49433 9.61653L5.83967 10.292L8.71194 13.0759L9.3666 12.4004L6.49433 9.61653ZM10.4318 5.55403L6.49433 9.61653L9.3666 12.4004L13.3041 8.33792L10.4318 5.55403Z",fill:"currentColor",mask:"url(#path-1-inside-1_528:41919)"})]});var x=n(27554),g=n(28857),b=n(68227),y=n(12037),j=n(40591),w=n(12307),k=n(88182),C=n(29020),N=n(60147),S=n(85478),L=n(42786),nodeSelectionToolbar=function(e){let{model:t,selection:n,selectionFocusId:l,dispatch:M}=e,R=(0,S.dZ)({selection:n,selectionFocusId:l}),D=(0,w.G)(R,e=>!(0,j.DY)(t,e).pinned),_=(0,w.G)(R,e=>(0,L.qU)((0,j.DY)(t,e))),Z=(0,w.G)(R,e=>{let n=(0,j.t$)(t,e);return null!==n&&!R.has(n)}),E=(0,w.G)(R,e=>{let n=(0,j.o4)(t,e);return null!==n&&!R.has(n)}),T=R.size<t.nodes.length,F=(0,N.v9)(e=>{let{notebook:t}=e;return(0,C.XT)(t)}),[V,I]=(0,o.useState)(null);return(0,r.jsx)(a.h,{children:(0,r.jsx)("div",{className:"fixed left-0 right-0 bottom-0 pv2 z-1 bg-white b--silver bt near-black",children:(0,r.jsx)(y.Z,{className:s()(!F&&"w-100"),children:(0,r.jsxs)("div",{className:"flex relative",style:{marginLeft:-14,marginRight:-14},children:[(0,r.jsxs)("div",{className:s()(F?"pt2":"absolute","h-100 nowrap flex items-center fw6 pr2"),style:{right:F?"":"100%"},children:[R.size.toLocaleString("en")," ",1===R.size?"cell":"cells"]}),(0,r.jsx)(i.hA,{icon:v.Z,title:"Run cells ".concat((0,k.Z)("Shift-Enter")),suppressHydrationWarning:!0,onClick:()=>M({type:"selectionRun"})}),(0,r.jsx)(i.hA,{icon:f.Z,title:"".concat(D?"Pin cells":"Unpin cells"," ").concat((0,k.Z)("P")),suppressHydrationWarning:!0,className:D?"ml2":"blue ml2",joinRight:!0,onClick:()=>M({type:"selectionPin"})}),(0,r.jsx)(i.hA,{icon:_?m.Z:p.Z,title:"".concat(_?"Hide":"Show"," output ").concat((0,k.Z)(",")),suppressHydrationWarning:!0,className:"ml2",joinLeft:!0,onClick:()=>M({type:"selectionHide"})}),(0,r.jsx)(i.hA,{icon:n.size?Selected:u.Z,title:null===l||n.size?"Clear selection ".concat((0,k.Z)("Escape")):"Toggle selection ".concat((0,k.Z)("X")),suppressHydrationWarning:!0,className:s()("ml2",n.size?"blue":""),onClick:()=>{null===l||n.size?M({type:"selectionBlur"}):M({type:"selectionToggle",id:l})}}),(0,r.jsx)(i.hA,{icon:d.Z,title:"Move cells up ".concat((0,k.Z)("Alt-Up")),suppressHydrationWarning:!0,className:"ml2",disabled:!Z,joinRight:!0,onClick:()=>M({type:"selectionMoveUp"})}),(0,r.jsx)(i.hA,{icon:c.Z,title:"Move cells down ".concat((0,k.Z)("Alt-Down")),suppressHydrationWarning:!0,className:"ml2",disabled:!E,joinLeft:!0,onClick:()=>M({type:"selectionMoveDown"})}),(0,r.jsx)(i.hA,{icon:h.Z,title:"Duplicate cells ".concat((0,k.Z)("Shift-Alt-Down")),suppressHydrationWarning:!0,className:"ml2",onClick:e=>M({type:"selectionDuplicate",before:e.shiftKey})}),(0,r.jsx)(i.hA,{icon:x.Z,title:T?"Delete cells ".concat((0,k.Z)("D")):"Delete cells (Cannot delete all cells)",suppressHydrationWarning:!0,className:"ml2",destructive:!!V,disabled:!T,text:V?"Delete?":"",onClick:()=>{V?(M({type:"selectionDelete"}),window.clearTimeout(V),I(null)):I(window.setTimeout(()=>I(null),b.P))}}),(0,r.jsx)("div",{className:"flex flex-grow-1"}),(0,r.jsx)(i.hA,{icon:g.Z,title:"Clear selection ".concat((0,k.Z)("Escape")),suppressHydrationWarning:!0,className:"ml2",transparent:!0,onClick:()=>M({type:"selectionClear"})})]})})})})}},556:function(e,t,n){n.d(t,{i:function(){return el}});var r=n(85893),a=n(94184),l=n.n(a),s=n(67294),o=n(5379),i=n.n(o),c=n(41269),d=n(27522),u=n(64063),p=n.n(u),m=n(10998),h=n(17);let DataTypeNumber=e=>(0,r.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",...e,children:[(0,r.jsx)("rect",{x:"3",y:"5",width:"10",height:"2",rx:"0.5",fill:"currentColor"}),(0,r.jsx)("path",{d:"M9 3.5C9 3.22386 9.22386 3 9.5 3H10.5C10.7761 3 11 3.22386 11 3.5V12.5C11 12.7761 10.7761 13 10.5 13H9.5C9.22386 13 9 12.7761 9 12.5V3.5Z",fill:"currentColor"}),(0,r.jsx)("path",{d:"M5 3.5C5 3.22386 5.22386 3 5.5 3H6.5C6.77614 3 7 3.22386 7 3.5V12.5C7 12.7761 6.77614 13 6.5 13H5.5C5.22386 13 5 12.7761 5 12.5V3.5Z",fill:"currentColor"}),(0,r.jsx)("rect",{x:"3",y:"9",width:"10",height:"2",rx:"0.5",fill:"currentColor"})]}),DataTypeOther=e=>(0,r.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",...e,children:[(0,r.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4 5C4 3.89543 4.89543 3 6 3H10C11.1046 3 12 3.89543 12 5V6.27924C12 7.1401 11.4491 7.90438 10.6325 8.17661L9 8.72076V10H7V8.72076C7 7.8599 7.55086 7.09562 8.36754 6.82339L10 6.27924V5H6V6H4V5Z",fill:"currentColor"}),(0,r.jsx)("rect",{x:"7",y:"11",width:"2",height:"2",rx:"0.5",fill:"currentColor"})]});var reduce=e=>(0,r.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",...e,children:(0,r.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4 4.70711C4 3.7643 4.7643 3 5.70711 3H10C11.1046 3 12 3.89543 12 5V6H10V5H6.41421L8 6.58579C8.78105 7.36683 8.78105 8.63316 8 9.41421L6.41421 11H10V10H12V11C12 12.1046 11.1046 13 10 13H5.70711C4.7643 13 4 12.2357 4 11.2929C4 10.8401 4.17986 10.4059 4.5 10.0858L6.58579 8L4.5 5.91421C4.17986 5.59407 4 5.15986 4 4.70711Z",fill:"currentColor"})}),f=n(28857),v=n(74364),x=n(6359),g=n(71256),b=n(32007),y=n(90271),j=n(44911),w=n(60147);let k={x:{name:"X",title:"Horizontal encoding"},y:{name:"Y",title:"Vertical encoding"},color:{name:"Color",title:"Color and series encoding"},size:{name:"Size",title:"Size encoding for dot marks"},fx:{name:"Facet X",title:"Horizontal facet encoding"},fy:{name:"Facet Y",title:"Vertical facet encoding"},mark:{name:"Mark",title:"Override for automatic mark selection"}},C=["#9d5bf3","#ff57f6","#ff77a7","#ffc850","#ffff53","#adff7f","#39ffc9","#2bffff","#65a7ff","#6e40aa","#c83dac","#ff5375","#ff8c38","#c9d33a","#79f659","#28ea8d","#1eb8d0","#4775de","#4d2d77","#8c2b78","#b33a52","#b36227","#8d9429","#55ac3e","#1ca463","#158192","#32529b","#000000","#666666","#cccccc","#ffffff"],N=["x","y","color","size"];function getGrouping(e){let{x:t,y:n,color:r,size:a}=e;if(t.reduce&&n.reduce);else if(t.reduce)return["y"];else if(n.reduce)return["x"];else if(r.reduce||a.reduce)return["x","y"];return[]}let Divider=()=>(0,r.jsx)("div",{className:"bb b--light-gray ma0 mb1"}),MaybeCheck=e=>{let{show:t}=e;return t?(0,r.jsx)(h.Z,{className:"mr1"}):(0,r.jsx)("div",{style:{width:12},className:"mr1"})},SelectorContents=e=>{let{value:t,specValue:n,options:a,label:l,allowNull:s}=e;return(0,r.jsxs)(v.uf,{style:{padding:"4px 0",margin:0},children:[(0,r.jsx)("div",{className:"gray f7 ph12 mb2 mt1",children:l}),(0,r.jsx)(Divider,{}),s&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(v.wt,{value:"__null",className:"flex items-center justify-between ph12",children:(0,r.jsxs)("span",{className:"flex items-center flex-auto",children:[(0,r.jsx)(MaybeCheck,{show:"__null"===t}),"—"]})},"__null"),(0,r.jsx)(Divider,{})]}),(0,r.jsx)(v.wt,{value:"__undefined",className:"flex items-center justify-between ph12",children:(0,r.jsxs)("span",{className:"flex items-center flex-auto justify-between",children:[(0,r.jsxs)("span",{className:"flex items-center",children:[(0,r.jsx)(MaybeCheck,{show:"__undefined"===t}),"Auto"]}),"__undefined"===t&&(0,r.jsx)("span",{className:"gray",children:n||"—"})]})},"__undefined"),(0,r.jsx)(Divider,{}),a.map(e=>(0,r.jsxs)(v.wt,{value:e,className:"flex items-center ph12",children:[(0,r.jsx)(MaybeCheck,{show:e===t}),(0,r.jsx)("span",{className:"truncate",children:e})]},"".concat(e)))]})},MarkSelector=e=>{let{options:t,onChange:n,value:a,chartSpec:s,focusedOrSelected:o}=e;a=null===a?"__null":void 0===a?"__undefined":a;let i=null==s?void 0:s.mark;return(0,r.jsxs)(v.vz,{onChange:n,value:a,className:l()("flex-auto bn br2 br--left chart-input","__undefined"===a?o?"bg-observable-focus-light-blue":"bg-light-silver":"bg-white"),style:{overflow:"visible"},children:[(0,r.jsxs)(v.Y4,{className:"flex items-center justify-between f6 fw5 br2 br--left",style:{margin:0},children:[(0,r.jsx)("div",{className:l()("flex items-stretch pl2","__undefined"===a?"mid-gray":""),children:"__undefined"===a?"Auto".concat(i?": ".concat(i):""):"__null"===a?"—":a}),(0,r.jsx)(v.r9,{className:"inline-flex items-center pr2",children:(0,r.jsx)(m.Z,{})})]}),(0,r.jsx)(v.jI,{style:{maxHeight:"400px",overflowY:"scroll"},children:(0,r.jsx)(SelectorContents,{value:a,specValue:i,options:t,label:"Mark",allowNull:!1})})]})},ReduceSelector=e=>{let{channel:t,options:n,onChange:a,value:s,chartSpec:o}=e;s=null===s?"__null":void 0===s?"__undefined":s;let i=o?o[t].reduce:void 0,c=o&&getGrouping(o).map(e=>o[e].value||e).join(" and "),d=c&&i?"count"===i?"Count by ".concat(c):"".concat(i[0].toUpperCase()+i.slice(1)," of ").concat(o[t].value||"–"," by ").concat(c):void 0;return(0,r.jsxs)(v.vz,{onChange:a,value:s,className:"bn br2 chart-input",style:{overflow:"visible",color:"inherit"},title:d,children:[(0,r.jsxs)(v.Y4,{className:l()("br2 flex items-center justify-between f7 fw5","__undefined"===s?"o-50":""),style:{margin:0},children:[(0,r.jsx)(reduce,{className:"mr1"}),("__undefined"!==s||i)&&(0,r.jsx)("div",{className:"flex items-stretch pr2 lh-solid",children:"__undefined"===s?i?"Auto: ".concat(i):"":"__null"===s?"—":s}),(0,r.jsx)(v.r9,{className:"inline-flex items-center pr2",children:(0,r.jsx)(m.Z,{})})]}),(0,r.jsx)(v.jI,{style:{maxHeight:"400px",overflowY:"scroll",minWidth:180},children:(0,r.jsx)(SelectorContents,{value:s,specValue:i,options:n,label:"Reducer",allowNull:!0})})]})},S={number:DataTypeNumber,integer:DataTypeNumber,bigint:DataTypeNumber,string:e=>(0,r.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",...e,children:[(0,r.jsx)("path",{d:"M13 4C13 3.44772 12.5523 3 12 3H10C9.44772 3 9 3.44772 9 4V7C9 7.55228 9.44772 8 10 8H13V4Z",fill:"currentColor"}),(0,r.jsx)("path",{d:"M7 4C7 3.44772 6.55228 3 6 3H4C3.44772 3 3 3.44772 3 4V7C3 7.55228 3.44772 8 4 8H7V4Z",fill:"currentColor"}),(0,r.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M5.00001 8H7.00001V9C7.00001 9.8692 6.85308 10.6012 6.37625 11.2687C5.94256 11.8759 5.28996 12.3419 4.55471 12.8321L3.44531 11.168C4.21007 10.6581 4.55747 10.3741 4.74878 10.1063C4.89694 9.89883 5.00001 9.63081 5.00001 9V8Z",fill:"currentColor"}),(0,r.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M11 8H13V9C13 9.8692 12.8531 10.6012 12.3762 11.2687C11.9426 11.8759 11.29 12.3419 10.5547 12.8321L9.44531 11.168C10.2101 10.6581 10.5575 10.3741 10.7488 10.1063C10.8969 9.89883 11 9.63081 11 9V8Z",fill:"currentColor"})]}),boolean:e=>(0,r.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",...e,children:[(0,r.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M11.1652 3.00672C11.1107 3.00227 11.0556 3 11 3H5C3.89543 3 3 3.89543 3 5V11C3 12.1046 3.89543 13 5 13H11C12.1046 13 13 12.1046 13 11V6.82873L11 8.82873V11H5L5 5H9.17188L11.1652 3.00672Z",fill:"currentColor"}),(0,r.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M13.7071 4.70711L8.00001 10.4142L5.29291 7.70711L6.70712 6.29289L8.00001 7.58579L12.2929 3.29289L13.7071 4.70711Z",fill:"currentColor"})]}),date:e=>(0,r.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",...e,children:[(0,r.jsx)("circle",{cx:"8",cy:"8",r:"5",stroke:"currentColor",strokeWidth:"2"}),(0,r.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7 3H9V7.58579L10.7071 9.29289L9.29289 10.7071L7 8.41421V3Z",fill:"currentColor"})]}),object:e=>(0,r.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",...e,children:[(0,r.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2.99997 4.5C2.99997 3.67157 3.67154 3 4.49997 3H6.99997V5H4.99997V5.76393C4.99997 6.07442 4.92768 6.38065 4.78883 6.65836L3.50018 8L4.78883 9.34164C4.92768 9.61935 4.99997 9.92558 4.99997 10.2361V11H6.99997V13H4.49997C3.67154 13 2.99997 12.3284 2.99997 11.5V10.2361L2.16145 8.55902C1.98549 8.20711 1.98549 7.79289 2.16145 7.44098L2.99997 5.76393V4.5Z",fill:"currentColor"}),(0,r.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M13 4.5C13 3.67157 12.3285 3 11.5 3H9.00003V5H11V5.76393C11 6.07442 11.0723 6.38065 11.2112 6.65836L12.4998 8L11.2112 9.34164C11.0723 9.61935 11 9.92558 11 10.2361V11H9.00003V13H11.5C12.3285 13 13 12.3284 13 11.5V10.2361L13.8386 8.55902C14.0145 8.20711 14.0145 7.79289 13.8386 7.44098L13 5.76393V4.5Z",fill:"currentColor"})]}),buffer:e=>(0,r.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",...e,children:[(0,r.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M6 5H5L5 11H6V5ZM5 3C3.89543 3 3 3.89543 3 5V11C3 12.1046 3.89543 13 5 13H6C7.10457 13 8 12.1046 8 11V5C8 3.89543 7.10457 3 6 3H5Z",fill:"currentColor"}),(0,r.jsx)("path",{d:"M10.374 3.08397C10.4562 3.02922 10.5527 3 10.6514 3H11.5C11.7761 3 12 3.22386 12 3.5V11H12.5C12.7761 11 13 11.2239 13 11.5V12.5C13 12.7761 12.7761 13 12.5 13H9.5C9.22386 13 9 12.7761 9 12.5V11.5C9 11.2239 9.22386 11 9.5 11H10V6H9.5C9.22386 6 9 5.77614 9 5.5V4.26759C9 4.10042 9.08355 3.9443 9.22265 3.85157L10.374 3.08397Z",fill:"currentColor"})]}),array:e=>(0,r.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",...e,children:[(0,r.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M3 5C3 3.89543 3.89543 3 5 3H7V5H5V11H7V13H5C3.89543 13 3 12.1046 3 11V5Z",fill:"currentColor"}),(0,r.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M11 5H9V3H11C12.1046 3 13 3.89543 13 5V11C13 12.1046 12.1046 13 11 13H9V11H11V5Z",fill:"currentColor"})]})},FieldSelectorContents=e=>{let{data:t,channel:n,value:a,dispatch:l,setIsExpanded:o}=e,i=(0,g.Nq)(t,l),{isExpanded:c}=(0,d.kR)();return(0,s.useEffect)(()=>o(c),[c,o]),(0,r.jsxs)(v.uf,{style:{padding:"4px 0",margin:0},children:[(0,r.jsx)("div",{className:"gray f7 ph12 mb2 mt1",children:"Field"}),(0,r.jsx)(Divider,{}),(0,r.jsx)(v.wt,{value:"__undefined",className:"flex items-center justify-between ph12",children:(0,r.jsxs)("span",{className:"flex items-center flex-auto",children:[(0,r.jsx)(MaybeCheck,{show:"undefined"===a.type}),"—"]})},"__undefined"),(0,r.jsx)(Divider,{}),i?[...i].map(e=>{var t;let[n,{type:l}]=e,s=null!==(t=S[l])&&void 0!==t?t:DataTypeOther;return(0,r.jsxs)(v.wt,{value:n,className:"flex items-center ph12",children:[(0,r.jsx)(MaybeCheck,{show:n===a.value}),(0,r.jsx)(s,{className:"moon-gray mr1 flex-shrink-0"}),(0,r.jsx)("span",{className:"truncate",children:n})]},"".concat(n))}):null,"color"===n?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"bb b--light-gray ma0 mb2"}),(0,r.jsx)("div",{className:"ph12 pt1 flex flex-wrap mb2",style:{gap:3.7},children:C.map(e=>(0,r.jsx)(v.wt,{className:"w1 h1 db ba br2 color-option",value:"__".concat(e),style:{margin:0,background:e,borderColor:"constant"===a.type&&a.value===e?"black":"rgba(0,0,0,0.3)"}},e))})]}):null]})},FieldSelector=e=>{var t;let{id:n,data:a,documentType:o,channel:i,value:c,dispatch:d,focused:u,selected:h}=e,[f,g]=(0,s.useState)("other"),[y,w]=(0,s.useState)(!1),k=(0,s.useRef)(null),C=(0,j.IS)(o).config;function page(e){var t;let r=(0,b.VQ)(a);if(!r)return;let l=new x.n4(r,"","chart"),s=null!==(t=c.value)&&void 0!==t?t:"";l.run(d).then(t=>{let r=Array.from(t.keys()),a=r.indexOf(s),l=-1;if(0===a&&"prev"===e||a===r.length-1&&"next"===e){d({type:"setChartConfig",id:n,config:{[i]:j.pG},source:"arrow"});return}if("undefined"===c.type?("prev"===e&&(l=r.length-1),"next"===e&&(l=0)):("prev"===e&&(l=a-1),"next"===e&&(l=a+1)),void 0===r[l]){console.error("index ".concat(l," does not exist"));return}let o=t.get(r[l]);o&&g(o.type),d({type:"setChartConfig",id:n,config:{[i]:{type:"field",value:r[l],...c.reduce&&{reduce:c.reduce}}},source:"arrow"})},e=>{console.error("Error fetching chart schema: ",e)})}(0,s.useEffect)(()=>{k.current&&u&&"x"===i&&p()(a.config,C)&&k.current.focus()},[i,a,u,C]),(0,s.useEffect)(()=>{let e=(0,b.VQ)(a);if(!e)return;let t=new x.n4(e,"","chart");c.value&&t.run(d).then(e=>{if(c.value){let t=e.get(c.value);t&&t.type!==f&&g(t.type)}},e=>{console.error("Error fetching chart schema: ",e)})},[c,i,a,d,f,g]);let N=null!==(t=S[f])&&void 0!==t?t:DataTypeOther;return(0,r.jsxs)(v.vz,{onKeyDown:e=>{if(!y)switch(e.key){case"ArrowLeft":page("prev");break;case"ArrowRight":page("next");break;case"Backspace":case"Delete":d({type:"setChartConfig",id:n,config:{[i]:j.pG},source:"clear"})}},onChange:e=>{d({type:"setChartConfig",id:n,config:{[i]:"__undefined"===e?j.pG:"__"===e.slice(0,2)?{type:"constant",value:e.slice(2)}:{type:"field",value:e,...void 0!==c.reduce&&{reduce:c.reduce}}},source:"dropdown"})},value:"undefined"!==c.type?"".concat(c.value):"__undefined",disabled:!c,className:l()("flex-auto bn br2 br--left",void 0===c.value?u||h?"bg-observable-focus-light-blue":"bg-light-silver":"bg-white","chart-input field-selector"),style:{overflow:"visible"},children:[(0,r.jsxs)(v.Y4,{className:"br2 br--left flex items-center justify-between f6 fw5",style:{margin:0},ref:k,title:"Arrow ←/→ to cycle; delete to clear",children:[(0,r.jsxs)("div",{className:"flex items-center truncate",children:["undefined"!==c.type&&(0,r.jsx)(N,{className:"moon-gray mh1 db flex-shrink-0"}),"undefined"===c.type?(0,r.jsx)("div",{className:"pl2 mid-gray",children:"—"}):(0,r.jsx)("div",{className:"truncate",children:c.value})]}),(0,r.jsx)(v.r9,{className:"inline-flex items-center pr2",children:(0,r.jsx)(m.Z,{})})]}),(0,r.jsx)(v.jI,{style:{maxHeight:"400px",overflowY:"scroll"},children:(0,r.jsx)(FieldSelectorContents,{data:a,channel:i,value:c,dispatch:d,setIsExpanded:w})})]})},ChannelGroup=e=>{let{id:t,data:n,documentType:a,channel:s,value:o,chartSpec:i,focused:d,selected:u,dispatch:m}=e,h=p()(o,{type:"undefined"}),{name:v,title:x}=k[s],g=i&&getGrouping(i).includes(s),b=N.includes(s),y=("x"===s||"y"===s)&&!n.config.x.value&&!n.config.y.value;return(0,r.jsxs)("div",{className:"ma2",children:[(0,r.jsxs)("div",{className:"mb1 pl1 flex justify-between items-center",style:{paddingRight:23},children:[(0,r.jsxs)("div",{className:"ph1 fw4 f7",title:y?"Set x or y to see chart":x+(g?" (grouped)":""),children:[v,y?"*":""]}),b&&(0,r.jsx)(ReduceSelector,{channel:s,options:c.ns,value:o.reduce,chartSpec:i,onChange:e=>{m({type:"setChartConfig",id:t,config:{[s]:"__undefined"===e?{type:o.type,...void 0!==o.value&&{value:o.value}}:"__null"===e?{type:o.type,value:o.value,reduce:null}:{type:"constant"===o.type?"undefined":o.type,value:"constant"===o.type?void 0:o.value,reduce:e}},source:"dropdown"})}})]}),(0,r.jsxs)("div",{className:"flex items-stretch",style:{gap:1},children:["mark"===s?(0,r.jsx)(MarkSelector,{options:c.Vv,value:o.value,chartSpec:i,onChange:e=>{m({type:"setChartConfig",id:t,config:{[s]:"__undefined"===e?{type:"undefined"}:{type:"constant",value:e}},source:"dropdown"})},focusedOrSelected:d||u}):(0,r.jsx)(FieldSelector,{id:t,data:n,documentType:a,channel:s,value:o,dispatch:m,focused:d,selected:u}),(0,r.jsx)("button",{className:l()("br2 br--right chart-button flex-shrink-0 flex items-center justify-center pa0 bn",h?d||u?"bg-observable-focus-light-blue":"bg-light-silver":"pointer bg-white"),style:{width:22},disabled:h,onClick:()=>{m({type:"setChartConfig",id:t,config:{[s]:j.pG},source:"clear"})},title:"Clear",children:(0,r.jsx)(f.Z,{className:h?"o-40":""})})]})]},s)},ChartEditor=e=>{let{node:t,dispatch:n,hovered:a,focused:s,selected:o}=e,{id:d,data:u}=t,{...p}=u.config,m=u.source,{chartSpec:h,documentType:f}=(0,w.v9)(e=>{var t;let{notebook:n}=e;return{chartSpec:null===(t=n.workerStatus.get(d))||void 0===t?void 0:t.chartSpec,documentType:n.type}});return m.name?(0,r.jsxs)("div",{style:{margin:"0 -14px",padding:"0 2px 5px 2px",minHeight:y.T6,borderBottomLeftRadius:s||a?0:void 0},className:"jsx-f939d1f466b891fe "+(l()("br2 br--bottom",s||o?"bg-observable-focus-lightest-blue observable-focus-darker-blue":"bg-near-white mid-gray")||""),children:[(0,r.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(min(100%, ".concat(400,"px), auto))"),boxSizing:"border-box"},className:"jsx-f939d1f466b891fe",children:(function(e,t){let n=[];for(let r=0,a=e.length;r<a;r+=t)n.push(e.slice(r,r+t));return n})(c.CH,2).map((e,t)=>(0,r.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(".concat(200,"px, 1fr))")},className:"jsx-f939d1f466b891fe",children:[e.map(e=>(0,r.jsx)(ChannelGroup,{id:d,data:u,documentType:f,focused:s,selected:o,channel:e,value:p[e]||j.pG,chartSpec:h,dispatch:n},e)),1===e.length&&(0,r.jsx)("div",{className:"jsx-f939d1f466b891fe"})]},t))}),(0,r.jsx)(i(),{id:"f939d1f466b891fe",children:".chart-button:focus{outline:1px solid var(--blue)}.chart-input span:focus{outline:1px solid var(--blue)}.color-option[data-current-nav]{border-color:white!important;outline:1px solid var(--mid-gray)}"})]}):null};var L=n(28141),M=n(47199),R=n(46774),D=n(1925),_=n(20736);let TableEditor=e=>{var t,n,a,o;let{node:i,dispatch:c,hovered:d,focused:u,selected:p,setOperations:m,operations:h,columnsFlash:f,setColumnsFlash:v}=e,{id:x}=i,g=(null!==(a=null===(t=h.filter)||void 0===t?void 0:t.length)&&void 0!==a?a:0)+(null!==(o=null===(n=h.sort)||void 0===n?void 0:n.length)&&void 0!==o?o:0),[b,j]=(0,s.useState)(!1),[w,k]=(0,s.useState)(!1),C=(0,_.GS)(_.ro);return(0,r.jsxs)("div",{className:l()("flex items-stretch flex-wrap br2 br--bottom",u||p?"bg-observable-focus-lightest-blue":"bg-near-white"),style:{margin:"0 -14px",padding:"4px 6px",rowGap:2,minHeight:y.T6,borderBottomLeftRadius:u||d?0:void 0},children:[(0,r.jsx)(M.w,{id:x,flash:b,setFlash:j,mobile:C}),(0,r.jsx)(L.o,{id:x,flash:f,setFlash:v,mobile:C}),(0,r.jsx)(D.PE,{id:x,flash:w,setFlash:k,mobile:C}),(0,r.jsx)(R.p2,{id:x,mobile:C}),(0,r.jsx)("div",{children:(0,r.jsx)("button",{onClick:function(){c({type:"setDataOperations",id:x,operations:{sort:function(){let e=h.sort?[...h.sort]:[],t=[...i.data.operations.sort];return e.length>0&&i.data.operations.sort.length>0&&(t=i.data.operations.sort.filter(t=>e[0].column!==t.column)),[...e,...t]}(),filter:function(){let e=h.filter?[...h.filter]:[],t=[...i.data.operations.filter];return e.length>0&&i.data.operations.filter.length>0&&(t=i.data.operations.filter.filter(t=>{let n=e.find(e=>{let{type:n,operands:r}=e;return r[0].value===t.operands[0].value&&n===t.type});return n?null:t})),[...e,...t]}()},source:"table"}),h.filter&&j(!0),h.sort&&k(!0),m({filter:void 0,sort:void 0})},className:l()("bn br2 f6 fw6 pv1 ph2 ml2 pointer",g>0?"bg-blue white":"bg-white moon-gray"),children:"Save"})})]})};var Z=n(96265),E=n(13961),T=n(13064),filterSliders=e=>(0,r.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",...e,children:[(0,r.jsx)("line",{x1:"12",y1:"11",x2:"12",y2:"15",stroke:"currentColor",strokeWidth:"2"}),(0,r.jsx)("line",{x1:"4",y1:"9",x2:"4",y2:"15",stroke:"currentColor",strokeWidth:"2"}),(0,r.jsx)("circle",{cx:"12",cy:"9",r:"2",stroke:"currentColor",strokeWidth:"2"}),(0,r.jsx)("circle",{cx:"4",cy:"7",r:"2",stroke:"currentColor",strokeWidth:"2"}),(0,r.jsx)("line",{x1:"12",y1:"1",x2:"12",y2:"7",stroke:"currentColor",strokeWidth:"2"}),(0,r.jsx)("line",{x1:"4",y1:"1",x2:"4",y2:"5",stroke:"currentColor",strokeWidth:"2"})]}),F=n(42565),V=n(32471),I=n(88903);let ChartToolbar=e=>{let{node:t,dispatch:n,focused:a,selected:s,documentType:o}=e,{id:i,data:c}=t,d=c.source,u=(0,_.GS)(_.ro),m=(0,_.GS)(_.Mo),h=(0,j.IS)(o).config,v=p()(c.config,h),x="undefined"===c.config.x.type&&"undefined"===c.config.y.type,g=[{title:"Clear Chart Selections",label:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(f.Z,{className:"pr1"}),!m&&"Clear All"]}),onClick:()=>{n({id:t.id,type:"setChartConfig",config:null,source:"clearAll"})},disabled:v},{title:"Swap X and Y Dimensions",label:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(V.H,{className:"pr1"}),!m&&"Swap X/Y"]}),onClick:()=>{n({type:"setChartConfig",id:i,config:{x:c.config.y,y:c.config.x},source:"swap"})},disabled:x},{title:"Customize",label:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(filterSliders,{className:"pr1"}),!m&&"Customize"]}),children:(0,r.jsx)(T.l,{id:i,data:c,dispatch:n}),onClick:u?()=>{n({type:"showModal",modal:"chartCustomize",modalProps:{id:i}})}:()=>{},disabled:!1}];return d.name?u?(0,r.jsx)("div",{className:"flex align-items pr1",children:(0,r.jsx)(I.v2,{children:e=>{let{isExpanded:t}=e;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(I.j2,{className:l()("bn pointer",t?"bg-observable-focus-light-blue br2":"bg-transparent"),children:(0,r.jsx)(F.v,{className:l()("flex align-items hover-black",t?"black":"dark-gray")})}),(0,r.jsx)(I.qy,{position:I.Ly.bottomLeft,children:g.map(e=>{let{title:t,label:n,onClick:a,disabled:l}=e;return(0,r.jsx)("div",{children:(0,r.jsx)(I.sN,{onSelect:a,disabled:l,title:t,className:"flex items-center f7 fw6",children:n})},t)})})]})}})}):(0,r.jsx)("div",{className:"flex items-center",style:{maxHeight:y.T6-4},children:g.map(e=>{let{title:t,label:n,onClick:o,disabled:i,children:c}=e;return(0,r.jsx)("div",{children:(0,r.jsxs)(I.v2,{children:[(0,r.jsx)(I.j2,{onClick:o,disabled:i,title:t,className:l()("flex items-center bg-transparent bn f7 fw6 ph1",m?"mr2":"mr3",i?"moon-gray":"pointer hover-black",a||s?"dark-gray":"mid-gray",{"pointer hover-black pa0 ma0":"Customize"===t}),children:n}),c]})},t)})}):null};var H=n(56065),A=n(91696),P=n(57636),O=n(63258),B=n(99368),U=n(88182),z=n(29020);let DataEditorToolbar=e=>{let{node:t,editorState:n,hovered:a,focusedFromEditor:o,rowId:i=0,allowsLayout:c=!1}=e,{id:d,mode:u,value:p}=t,m=p.length!==n.doc.length||p!==n.doc.toString(),h=c?i:d,{focused:f,selectionFocused:v,pending:x,readonly:g,hasTable:b,documentType:j}=(0,w.v9)(e=>{var t,n;let{notebook:r}=e;return{owner:r.owner,roles:r.roles,focused:r.focusId===d,selectionFocused:r.selectionFocusId===d||r.selection.has(d),pending:(null===(t=r.workerStatus.get(d))||void 0===t?void 0:t.status)==="pending",readonly:(0,z.os)(r),hasTable:!!(null===(n=r.heights.get(h))||void 0===n?void 0:n.display),documentType:r.type}}),k=(0,w.I0)(),C=(0,s.useRef)(null);return(0,s.useEffect)(()=>{if("table"===u&&f&&!o){var e;null===(e=C.current)||void 0===e||e.focus()}},[u,f,o]),(0,r.jsxs)("div",{className:l()("pea flex justify-between items-stretch br2 bb b--white br--top",f||v?"bg-observable-focus-lightest-blue":"bg-near-white"),style:{borderTopLeftRadius:b||f||v||a?0:void 0,borderTopRightRadius:b?0:void 0,borderBottomLeftRadius:"table"===u&&(f||v||a)?0:void 0,margin:"0 -14px",padding:"table"===u?"4px 0":"2px 0",height:y.T6+("table"===u?5:1)},children:[(0,r.jsxs)("div",{className:"flex items-stretch",children:[(0,r.jsx)(P.Q,{node:t,dispatch:k,source:"nodeEditor",autoWidth:!0,className:"bg-transparent",style:{marginLeft:6,boxShadow:"none"},onFocus:f?void 0:e=>{k({type:"focus",id:d}),e.target.focus()},disabled:g,ref:C}),(0,r.jsx)(O.aN,{node:t})]}),(0,r.jsxs)("div",{className:"flex",children:["chart"===u&&(0,r.jsx)(ChartToolbar,{node:t,dispatch:k,focused:f,selected:v,documentType:j}),(0,r.jsx)("button",{title:"Run cell ".concat((0,U.Z)("Shift-Enter")),suppressHydrationWarning:!0,className:l()("bg-transparent bn br2 f6 fw5 flex items-center pointer squishy pr2",m?"blue hover-dark-blue":f||v?"observable-focus-dark-blue hover-blue":"moon-gray hover-mid-gray"),onMouseDown:B.PF,onClick:()=>k({type:"commit",id:d,trigger:"click",source:"nodeEditor"}),children:x?(0,r.jsx)(H.Z,{}):m?(0,r.jsx)(A.s,{}):(0,r.jsx)(A.Z,{})})]})]})};var W=n(31881),q=n(10245),G=n(68227);let SqlEditorSupport=e=>{let{node:{id:t,data:{source:n}},dispatch:r}=e,a=(0,s.useRef)();return(0,s.useEffect)(()=>{if(null===n.name){a.current=void 0,r({type:"sqlDialectUpdated",id:t,dialect:"sql"});return}let e=new x.YG(n);a.current=e,e.run(r).then(n=>{let{dialect:l}=n;e===a.current&&r({type:"sqlDialectUpdated",id:t,dialect:l=(0,b.h8)(l)})},()=>{e===a.current&&r({type:"sqlDialectUpdated",id:t,dialect:"sql"})})},[r,t,n]),null};var Y=n(73935),K=n(39567),X=n(26713),caretLeft=e=>(0,r.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",...e,children:(0,r.jsx)("path",{d:"M9.25 5L6.75 8L9.25 11",stroke:"currentColor",strokeWidth:"2"})}),$=n(14318),J=n(5152),Q=n.n(J);let ee=Q()(()=>Promise.all([n.e(7381),n.e(1918)]).then(n.bind(n,81918)),{loadableGenerated:{webpack:()=>[81918]}}),SignatureHelpComponent=e=>{var t;let{node:n,editors:a}=e,{signatureHelpData:l,signatureHelpNodeId:o}=(0,w.v9)(e=>{let{notebook:t}=e;return{signatureHelpData:t.signatureHelpData,signatureHelpNodeId:t.signatureHelpNodeId}}),c=null==l?void 0:l.selectedItemIndex,[d,u]=(0,s.useState)(null!=c?c:0),repositionTooltip=()=>a.repositionTooltips(n.id);if((0,s.useEffect)(repositionTooltip),(0,s.useEffect)(()=>{void 0!==c&&u(c)},[c,u]),!(null==l?void 0:l.items.length)||o!==n.id||d>=l.items.length)return null;let p=l.items[d];return(0,r.jsxs)("div",{style:{maxHeight:270,fontSize:"0.8125rem"},className:"jsx-208ac902b607ba5c dark-gray bg-white ba b--silver br2 shadow-4 overflow-y-auto",children:[(0,r.jsxs)("div",{className:"jsx-208ac902b607ba5c lh-copy mw6",children:[(0,r.jsx)(SignatureHelpItemComponent,{item:p,argumentIndex:null!==(t=l.argumentIndex)&&void 0!==t?t:0,onReady:repositionTooltip}),l.items.length>1?(0,r.jsxs)("div",{onMouseDown:B.PF,className:"jsx-208ac902b607ba5c bt b--moon-gray pv2 pl2 pr3 flex items-center",children:[(0,r.jsx)(X.hU,{style:{padding:2},disabled:d<=0,"aria-label":"Previous overload",onClick:()=>u(d-1),icon:caretLeft}),(0,r.jsx)("span",{className:"jsx-208ac902b607ba5c mh1 tabular-nums b",children:d+1})," /",(0,r.jsx)("span",{className:"jsx-208ac902b607ba5c mh1 tabular-nums b",children:l.items.length}),(0,r.jsx)("span",{className:"jsx-208ac902b607ba5c ml1",children:"overloads"}),(0,r.jsx)(X.hU,{style:{padding:2},disabled:d>=l.items.length-1,"aria-label":"Next overload",onClick:()=>u(d+1),icon:$.Z})]}):null]}),(0,r.jsx)(i(),{id:"208ac902b607ba5c",children:".tabular-nums.jsx-208ac902b607ba5c{font-variant-numeric:tabular-nums}"})]})},SignatureHelpItemComponent=e=>{let{item:{prefixDisplayParts:t,parameters:n,suffixDisplayParts:a,documentation:l,tags:o},argumentIndex:i,onReady:c}=e;o=o.filter(e=>"param"!==e.name&&"returns"!==e.name);let d=n.length&&n.length>i?n[i].documentation:[];return d.length||l.length||c(),(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"f7 code pv2 ph3 mt1",children:[(0,r.jsx)(DisplayParts,{parts:t}),n.map((e,t)=>(0,r.jsxs)(s.Fragment,{children:[t>0?(0,r.jsx)("span",{children:", "}):null,(0,r.jsx)("span",{className:i===t?"b blue":"",children:(0,r.jsx)(DisplayParts,{parts:e.displayParts})})]},t)),(0,r.jsx)(DisplayParts,{parts:a})]}),d.length?(0,r.jsx)("div",{className:"bt b--silver ph3",children:d.map((e,t)=>(0,r.jsx)(ee,{onReady:c,children:e.text},t))}):null,l.length?(0,r.jsx)("div",{className:"bt b--silver ph3",children:l.map((e,t)=>(0,r.jsx)(ee,{onReady:c,children:e.text},t))}):null,o.length?(0,r.jsx)("div",{className:"bt b--silver pv2 ph3",children:o.map((e,t)=>{var n;return(0,r.jsx)("div",{className:t<o.length-1?"pb1":"",children:e.text?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{children:["@",e.name]}),"link"===e.name?(0,r.jsx)("a",{rel:"ugc nofollow noreferrer",href:(0,K.A)(null===(n=e.text[0])||void 0===n?void 0:n.text),children:(0,r.jsx)(DisplayParts,{parts:e.text})}):(0,r.jsx)("div",{className:"example"===e.name?"code":"",children:(0,r.jsx)(DisplayParts,{parts:e.text})})]}):null},"tag-".concat(t))})}):null]})},DisplayParts=e=>{let{parts:t,boldIndex:n}=e;return(0,r.jsx)(r.Fragment,{children:t.map((e,t)=>(0,r.jsx)("span",{className:l()(e.kind,n===t?" b":""),children:e.text},t))})},SignatureHelp=e=>{let{node:t,editors:n,container:a}=e;return(0,Y.createPortal)((0,r.jsx)(SignatureHelpComponent,{node:t,editors:n}),a)};var et=n(17267),en=n(68404),er=n(77110);let ea=(0,er.V)([[et.Mq?"Alt-Tab":"Shift-Alt-ArrowDown",e=>{let{dispatch:t,id:n}=e;return t({type:"focusAfter",id:n}),!0}],[et.Mq?"Shift-Alt-Tab":"Shift-Alt-ArrowUp",e=>{let{dispatch:t,id:n}=e;return t({type:"focusBefore",id:n}),!0}]]),el=s.memo(function(e){let{node:t,editorState:n,assistFocused:a,focused:o,hovered:i,selected:c,hasPrevious:d,hasNext:u,editors:p,rowId:m=0,allowsLayout:h=!1,compareStyle:f,operations:v,setOperations:x,columnsFlash:g,setColumnsFlash:b}=e,{id:k,value:C,pinned:N}=t,S=n.field(Z.A),L=n.field(E.C),M=(0,w.I0)(),R=(0,s.useRef)(null),D=(0,s.useRef)(null),[T,F]=(0,s.useState)(!1),[V,I]=(0,s.useState)(!1),P=(0,_.GS)(_.ro),O=h?m:k,{hasOutput:z,pending:Y,present:K,type:X}=(0,w.v9)(e=>{var t;let{notebook:n}=e;return{hasOutput:(0,en.Gv)(n.heights.get(O))>0,pending:(null===(t=n.workerStatus.get(k))||void 0===t?void 0:t.status)==="pending",present:n.present,type:n.type}}),$=C.length!==n.doc.length||C!==n.doc.toString();return((0,s.useEffect)(()=>(D.current=P?null:document.createElement("div"),p.attach(S,R.current,D.current),()=>p.detach(S)),[p,P,S]),(0,s.useEffect)(()=>{if(!o)return;let e=R.current;function onFocusin(){F(document.hasFocus())}function onFocus(){F(e.contains(document.activeElement))}function onBlur(){F(!1)}return e.addEventListener("focusin",onFocusin),e.addEventListener("focusout",onBlur),addEventListener("focus",onFocus),addEventListener("blur",onBlur),F(document.hasFocus()&&e.contains(document.activeElement)),()=>{e.removeEventListener("focusin",onFocusin),e.removeEventListener("focusout",onBlur),removeEventListener("focus",onFocus),removeEventListener("blur",onBlur),F(!1)}},[o]),(0,s.useEffect)(()=>{o||I(!1)},[o]),K)?null:(0,r.jsxs)("div",{className:"relative pea",onKeyDown:function(e){(0,j.hN)(t)&&ea({dispatch:M,id:k},e)&&(e.preventDefault(),e.stopPropagation())},children:[D.current?(0,r.jsx)(SignatureHelp,{node:t,editors:p,container:D.current}):null,"sql"===t.mode&&(0,r.jsx)(SqlEditorSupport,{node:t,dispatch:M}),(0,r.jsxs)("div",{onClick:()=>{o||(I(!0),M({type:"focus",id:k}))},children:[(0,j.sO)(t)&&(0,r.jsx)(DataEditorToolbar,{node:t,editorState:n,hovered:i,focusedFromEditor:V,rowId:m,allowsLayout:h}),"table"===t.mode?(0,r.jsx)(TableEditor,{node:t,dispatch:M,hovered:i,focused:o,selected:c,operations:v,setOperations:x,columnsFlash:g,setColumnsFlash:b}):"chart"===t.mode?(0,r.jsx)(ChartEditor,{node:t,dispatch:M,hovered:i,focused:o,selected:c}):null]}),(0,r.jsxs)("div",{ref:R,className:l()(i&&"node-hover",n.readOnly&&"node-readonly",o&&"node-focus",c&&"node-select",o||c||"add"!==f?"":" node-add","sql"===L&&"node-toolbar","relative",(0,j.hN)(t)&&"dn",a&&"node-assist","dashboard"===X&&"z-1"),children:[!("sql"===L||"table"===L)&&(0,r.jsx)("button",{title:"Run cell ".concat((0,U.Z)("Shift-Enter")),suppressHydrationWarning:!0,className:l()("flex items-center absolute top-0 bg-transparent bn br2 pointer squishy pr2",$?"blue hover-dark-blue":o||c?"observable-focus-dark-blue hover-blue":"moon-gray hover-mid-gray","dn-print"),onMouseDown:B.PF,onClick:()=>p.applyCommand(S,(0,q.z)("click","nodeEditor")),style:{right:-14,height:y.T6},children:Y?(0,r.jsx)(H.Z,{}):$?(0,r.jsx)(A.s,{}):(0,r.jsx)(A.Z,{})}),o&&!n.readOnly&&(0,r.jsx)(G.Z,{node:t,dirty:$,editorFocused:T,editorState:n,editors:p,hasPrevious:d,hasNext:u,dispatch:M})]}),(i||o)&&z&&!h&&(0,r.jsx)("div",{className:"flex absolute moon-gray",style:{top:4,left:-55},children:(0,r.jsx)(W.Z,{className:l()(n.readOnly?"":"pointer","squishy",N&&!n.readOnly?"blue":"hover-mid-gray"),role:"button","aria-label":N?"Unpin":"Pin",onMouseDown:B.PF,onClick:()=>n.readOnly?void 0:M({type:"togglePin",id:k}),style:{padding:"3px 0 2px 0"},children:(0,r.jsxs)("title",{suppressHydrationWarning:!0,children:[N?"Unpin":"Pin"," cell ",(0,U.Z)("Mod-.")]})})})]})})},12037:function(e,t,n){var r=n(85893),a=n(5379),l=n.n(a),s=n(94184),o=n.n(s),i=n(99688),c=n(20736),d=n(29020),u=n(60147);t.Z=(0,u.$j)(e=>{let{notebook:t,page:n}=e;return{paddingRight:null!==n.pane&&(0,i.wo)(n.pane).width,paddingLeft:n.collectionsSidebarOpen?216:0,allowsLayout:(0,d.XT)(t),present:t.present}})(e=>{let{className:t="",children:n,paddingRight:a,paddingLeft:s,allowsLayout:i,present:d,...u}=e;return(0,r.jsxs)("div",{style:i&&!d?{paddingRight:"3%"}:void 0,...u,className:l().dynamic([["b9104e8a53b967b6",[c.hs,a?"calc(max(".concat(a,"px - max((100vw - var(--max-width-8))/2, 0px), var(--spacing-extra-large) - var(--spacing-large)) + var(--spacing-large))"):"var(--spacing-extra-large)",a?"calc(max(".concat(a,"px - max((100vw - var(--max-width-page))/2, 0px), 0px) + var(--spacing-large))"):"var(--spacing-large)",s?"calc(max(".concat(s,"px + var(--spacing-large) - max((100vw - var(--max-width-page))/2, 0px), 0px) + var(--spacing-large))"):"var(--spacing-large)"]]])+" "+(u&&null!=u.className&&u.className||o()(i&&d?"w-100 ph4 center":i?"w-90 center":s?"mw-page":"mw8",!i&&"mw-page-xl center ph4 pr5-l body",t)||""),children:[n,(0,r.jsx)(l(),{id:"b9104e8a53b967b6",dynamic:[c.hs,a?"calc(max(".concat(a,"px - max((100vw - var(--max-width-8))/2, 0px), var(--spacing-extra-large) - var(--spacing-large)) + var(--spacing-large))"):"var(--spacing-extra-large)",a?"calc(max(".concat(a,"px - max((100vw - var(--max-width-page))/2, 0px), 0px) + var(--spacing-large))"):"var(--spacing-large)",s?"calc(max(".concat(s,"px + var(--spacing-large) - max((100vw - var(--max-width-page))/2, 0px), 0px) + var(--spacing-large))"):"var(--spacing-large)"],children:"@media ".concat(c.hs,"{.body.__jsx-style-dynamic-selector{padding-right:").concat(a?"calc(max(".concat(a,"px - max((100vw - var(--max-width-8))/2, 0px), var(--spacing-extra-large) - var(--spacing-large)) + var(--spacing-large))"):"var(--spacing-extra-large)","}}@media screen and (min-width:90em){.body.__jsx-style-dynamic-selector{padding-right:").concat(a?"calc(max(".concat(a,"px - max((100vw - var(--max-width-page))/2, 0px), 0px) + var(--spacing-large))"):"var(--spacing-large)","}}@media screen and (min-width:60em){.body.__jsx-style-dynamic-selector{padding-left:").concat(s?"calc(max(".concat(s,"px + var(--spacing-large) - max((100vw - var(--max-width-page))/2, 0px), 0px) + var(--spacing-large))"):"var(--spacing-large)","}}")})]})})},84579:function(e,t,n){n.d(t,{H:function(){return r},r:function(){return a}});let r="The paused version is shown by default when others visit or import from this".concat(" ","notebook."),a="The paused version is shown and imported by".concat(" ","default.")},60107:function(e,t,n){n.d(t,{Q:function(){return Theme},t:function(){return s}});var r=n(85893),a=n(5379),l=n.n(a);let s={backgroundColor:"#f5f5f5",cellBackgroundColor:"white",cellBorderWidth:1,cellBorderStyle:"solid",cellBorderColor:"#e2e2e2",cellBorderRadius:4,overflow:"hidden"};function themeToCssVariables(e){let t=[];for(let[n,r]of Object.entries(e))t.push("--theme-".concat(n,": ").concat(r,";"));return t.join("\n")}let Theme=e=>{let{type:t}=e;return"dashboard"!==t?null:(0,r.jsx)(l(),{id:"7f40b582c4ecd722",dynamic:[themeToCssVariables(s)],children:":root{".concat(themeToCssVariables(s),"\n      }.bg-theme{background-color:var(--theme-backgroundColor)}.bg-theme-cell{background-color:var(--theme-cellBackgroundColor)}")})}},98745:function(e,t,n){n.d(t,{l:function(){return d}});var r=n(85893),a=n(94184),l=n.n(a),s=n(42751),o=n(32341),i=n(79998),c=n(60147);let d=(0,c.$j)(e=>{let{notebook:{spotlightParticipant:t}}=e;return{spotlightParticipant:t}},e=>({dispatch:e}))(e=>{let{dispatch:t,participants:n,spotlightParticipant:a,size:c,...d}=e;return n.length?(0,r.jsx)("div",{className:"flex flex-row-reverse",...d,children:n.map((e,d)=>(0,r.jsx)("button",{className:l()(!e.self&&"pointer","bg-transparent pa0 ma0 bn tooltipped tooltipped-sw"),"aria-label":e.self?"You":a===e.id?"Stop spotlighting ".concat((0,i.KY)(e)):"Spotlight ".concat((0,i.KY)(e)),disabled:e.self,style:{marginLeft:(-(.6*c)*n.length-1)/n.length},children:(0,r.jsx)(s.q,{onClick:()=>{e.self||t({type:"spotlight",id:a===e.id?null:e.id})},user:{...e,type:"individual"},size:c,style:{borderColor:(0,o.Zt)(d),boxShadow:a===e.id?"0 0 8px ".concat((0,o.Zt)(d)):"none"},className:"ba bw1"})},d))}):null})},99688:function(e,t,n){n.d(t,{YE:function(){return tL},wo:function(){return getPane}});var r=n(85893),a=n(5379),l=n.n(a),s=n(94184),o=n.n(s),i=n(5152),c=n.n(i),d=n(28857),u=n(57801),p=n(41664),m=n.n(p),h=n(67294),f=n(53141),v=n(97721);let ChatSparkles=e=>(0,r.jsxs)("svg",{width:"94",height:"95",viewBox:"0 0 94 95",fill:"currentColor",...e,children:[(0,r.jsx)("path",{d:"M14 28.5H83V65.5H38L24 80.5V65.5H14V28.5Z",fill:"#E2E2E2"}),(0,r.jsx)("path",{d:"M23.5 26H11.5V63H21.5V78L35.5 63H58.5",stroke:"#454545",strokeLinecap:"round",strokeLinejoin:"round"}),(0,r.jsx)("path",{d:"M50.3095 9.28693L49.8571 8.32667L49.4048 9.28693L43.8002 21.1851L31.7902 26.7385L30.8087 27.1923L31.7902 27.6461L43.8002 33.1995L49.4048 45.0977L49.8571 46.0579L50.3095 45.0977L55.9141 33.1995L67.9241 27.6461L68.9056 27.1923L67.9241 26.7385L55.9141 21.1851L50.3095 9.28693ZM73.5238 9.28693L73.0714 8.32667L72.6191 9.28693L69.8555 15.1538L63.933 17.8923L62.9515 18.3462L63.933 18.8L69.8555 21.5385L72.6191 27.4054L73.0714 28.3656L73.5238 27.4054L76.2873 21.5385L82.2099 18.8L83.1913 18.3462L82.2099 17.8923L76.2873 15.1538L73.5238 9.28693ZM69.9523 30.5177L69.5 29.5574L69.0477 30.5177L65.1477 38.7971L56.7902 42.6616L55.8087 43.1154L56.7902 43.5692L65.1477 47.4337L69.0477 55.7131L69.5 56.6733L69.9523 55.7131L73.8523 47.4337L82.2099 43.5692L83.1913 43.1154L82.2099 42.6616L73.8523 38.7971L69.9523 30.5177Z",fill:"#C4C4C4",stroke:"#F5F5F5"}),(0,r.jsx)("path",{d:"M48.8571 8.5L54.5393 20.5627L66.7143 26.1923L54.5393 31.822L48.8571 43.8846L43.175 31.822L31 26.1923L43.175 20.5627L48.8571 8.5Z",stroke:"#454545"}),(0,r.jsx)("path",{d:"M72.0714 8.5L74.9125 14.5313L81 17.3462L74.9125 20.161L72.0714 26.1923L69.2304 20.161L63.1429 17.3462L69.2304 14.5313L72.0714 8.5Z",stroke:"#454545"}),(0,r.jsx)("path",{d:"M68.5 29.7308L72.4775 38.1746L81 42.1154L72.4775 46.0561L68.5 54.5L64.5225 46.0561L56 42.1154L64.5225 38.1746L68.5 29.7308Z",stroke:"#454545"})]}),ChatExclamation=e=>(0,r.jsxs)("svg",{width:"94",height:"94",viewBox:"0 0 94 94",fill:"currentColor",...e,children:[(0,r.jsx)("path",{d:"M14 28H83V65H38L24 80V65H14V28Z",fill:"#E2E2E2"}),(0,r.jsx)("path",{d:"M23.5 25.5H11.5V62.5H21.5V77.5L35.5 62.5H58.5",stroke:"#454545",strokeLinecap:"round",strokeLinejoin:"round"}),(0,r.jsx)("path",{d:"M45.4651 15.3628C45.45 14.8002 45.9019 14.3359 46.4647 14.3359H52.5342C53.0974 14.3359 53.5495 14.8008 53.5338 15.3638L52.9041 37.9419C52.889 38.4832 52.4459 38.9141 51.9045 38.9141H47.0712C46.5293 38.9141 46.0861 38.4825 46.0715 37.9409L45.4651 15.3628ZM49.5 51.7363C46.6562 51.7363 44.8789 50.1113 44.8789 47.4961C44.8789 44.8555 46.6562 43.2305 49.5 43.2305C52.3691 43.2305 54.1211 44.8555 54.1211 47.4961C54.1211 50.1113 52.3691 51.7363 49.5 51.7363Z",fill:"#C4C4C4"}),(0,r.jsx)("path",{d:"M51.5342 12.8359H45.4647C44.6205 12.8359 43.9426 13.5323 43.9653 14.3762L44.5717 36.9543C44.5935 37.7668 45.2584 38.4141 46.0712 38.4141H50.9045C51.7166 38.4141 52.3812 37.7677 52.4039 36.9559L53.0336 14.3778C53.0572 13.5333 52.379 12.8359 51.5342 12.8359ZM43.3789 46.4961C43.3789 47.9221 43.867 49.1239 44.7852 49.9655C45.6983 50.8025 46.9849 51.2363 48.5 51.2363C50.0268 51.2363 51.3143 50.803 52.2251 49.9648C53.1407 49.1222 53.6211 47.92 53.6211 46.4961C53.6211 45.0609 53.1416 43.8523 52.2259 43.0059C51.3148 42.1638 50.0268 41.7305 48.5 41.7305C46.9849 41.7305 45.6978 42.1643 44.7844 43.0052C43.8661 43.8506 43.3789 45.0588 43.3789 46.4961Z",stroke:"#454545"})]});var helpCircle=e=>(0,r.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",...e,children:[(0,r.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",fill:"currentColor",d:"M14 8C14 11.3137 11.3137 14 8 14C4.68629 14 2 11.3137 2 8C2 4.68629 4.68629 2 8 2C11.3137 2 14 4.68629 14 8ZM16 8C16 12.4183 12.4183 16 8 16C3.58172 16 0 12.4183 0 8C0 3.58172 3.58172 0 8 0C12.4183 0 16 3.58172 16 8ZM6.98981 6.10635H4.92682C4.94586 4.44326 6.15192 3.35781 8.18317 3.35781C10.1129 3.35781 11.3697 4.37344 11.3697 5.89688C11.3697 6.83633 10.9317 7.48379 9.9986 8.02334C9.12897 8.52481 8.88776 8.81045 8.88776 9.40713V9.70547H6.90729L6.88824 9.45156C6.76764 8.36611 7.08502 7.79482 7.96735 7.28701C8.83063 6.7792 9.0528 6.5126 9.0528 5.954C9.0528 5.43984 8.63385 5.08438 8.03717 5.08438C7.4278 5.08438 7.00885 5.49063 6.98981 6.10635ZM9.24957 11.6669C9.24957 12.3969 8.7735 12.8222 7.95465 12.8222C7.1358 12.8222 6.65338 12.3969 6.65338 11.6669C6.65338 10.9306 7.1358 10.5053 7.95465 10.5053C8.7735 10.5053 9.24957 10.9306 9.24957 11.6669Z"})," "]}),x=n(26279),g=n(42447),b=n(34372),y=n(8122),j=n(81649),w=n(20637),k=n(66338),C=n(10067),N=n(94988),S=n(4530),L=n(60147);let TextDisplay=e=>{let{content:t,node:n}=e,a=[];return a.push({from:n.from,to:n.to,type:"text"}),!function buildSpans(e){for(let n=e.firstChild;n;n=n.nextSibling)switch(n.type.name){case"LinkMark":case"CodeMark":case"ListMark":case"HeaderMark":case"EmphasisMark":case"QuoteMark":if(a.length>0){let e=a[a.length-1];e.from===n.from?e.from=n.to:e.to>=n.to&&(e.to=n.from)}break;case"URL":a.length>0&&(a[a.length-1].url=function(e){let t=new URL(e,"https://observablehq.com");if("https:"===t.protocol||"http:"===t.protocol)return t.toString()}(t.slice(n.from,n.to)));break;case"Link":case"InlineCode":case"Emphasis":case"StrongEmphasis":if(a.length>0){let e=a[a.length-1].to,t=a[a.length-1].type;a[a.length-1].to=n.from,a.push({from:n.from,to:n.to,type:n.type.name}),buildSpans(n),a.push({from:n.to,to:e,type:t})}else a.push({from:n.from,to:n.to,type:n.type.name})}}(n),(0,r.jsx)(r.Fragment,{children:a.filter(e=>e.from!==e.to).map(e=>{switch(e.type){case"text":return(0,r.jsx)(h.Fragment,{children:t.slice(e.from,e.to)},e.from);case"Link":return(0,r.jsx)("a",{href:e.url||"/error",className:"no-underline blue hover-lightest-blue link",rel:"noopener noreferrer",target:"_blank",children:t.slice(e.from,e.to)},e.from);case"InlineCode":return(0,r.jsx)("code",{className:"fw6",children:t.slice(e.from,e.to)},e.from);case"Emphasis":return(0,r.jsx)("em",{children:t.slice(e.from,e.to)},e.from);case"StrongEmphasis":return(0,r.jsx)("strong",{children:t.slice(e.from,e.to)},e.from);default:return(0,r.jsxs)(r.Fragment,{children:["unknown: ",e.type]})}})})},M=h.forwardRef(function(e,t){let{onClick:n,icon:a,className:l="",text:s,...o}=e;return(0,r.jsx)("button",{ref:t,className:"".concat("bn bg-transparent pointer animate-all hover-bg-black-05 f6 fw6 flex justify-center items-center pv2"," ").concat(l),onClick:n,...o,children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(a,{className:"mr1"}),s]})})}),FencedCodeDisplay=e=>{let t,{content:n,node:a,nodeId:l}=e,s=[],o=(0,k.I0)(),{notebook:i,currentUser:c}=(0,L.v9)(e=>({notebook:e.notebook,currentUser:e.currentUser})),d=0,u="sql";function getContent(){return s.map(e=>n.slice(a.from+e.from,a.from+e.to)).join("")}function modeForLanguage(e){switch(e.toLowerCase()){case"javascript":case"typescript":case"js":default:return"js";case"sql":return"sql";case"md":case"markdown":case"text":return"md";case"html":return"html";case"tex":case"latex":return"tex"}}async function copyToClipboard(){await navigator.clipboard.writeText(getContent()),o({type:"showSuccessToast",message:"Copied code to clipboard"}),(0,S.MR)((0,S.ym)({type:"notebook:assist:copy",data:{scope:null===l?"notebook":"cell"},currentUser:c,notebook:i,eventVersion:1}))}a.toTree().iterate({enter:e=>{switch(e.type.name){case"CodeMark":d++;break;case"CodeText":s.push({from:e.from,to:e.to,type:"codeblock"});break;case"CodeInfo":"observable"===(u=n.slice(a.from+e.from,a.from+e.to))&&(u="javascript")}return!0}});let p=s.map(e=>n.slice(a.from+e.from,a.from+e.to)).join("");try{t=w.Z.highlight(p,{language:u||"sql"})}catch(e){console.error("Unable to highligh code for language",u)}return(0,r.jsxs)("div",{className:"br2 bg-near-white pt1",children:[(0,r.jsx)("pre",{className:"hljs f6 br2 pa2 fw5 overflow-x-auto ma0",children:t?(0,r.jsx)(r.Fragment,{children:(0,r.jsx)("code",{dangerouslySetInnerHTML:{__html:t.value}})}):(0,r.jsx)("code",{children:p})}),2===d&&(0,r.jsxs)("div",{className:"bt b--white flex",children:[null===l&&(0,r.jsx)(M,{icon:C.Z,text:"Insert cell",onClick:function(){var e;let t=modeForLanguage(u);o({type:"insertAfter",id:null===(e=i.model.nodes[i.model.nodes.length-1])||void 0===e?void 0:e.id,node:{value:getContent(),mode:t},trigger:"keypress",source:"aiAssist"}),o({type:"blur"})},className:"w-50 blue"}),null!==l&&(0,r.jsx)(M,{icon:C.Z,text:"Replace and run",onClick:()=>(function(e){let t=modeForLanguage(u);"js"!==t&&o({type:"setMode",id:e,source:"aiAssist",trigger:"click",mode:t}),o({type:"editCell",id:e,text:getContent()}),o({type:"commit",id:e,trigger:"click",source:"aiAssist"})})(l),className:"w-50 blue"}),(0,r.jsx)(M,{icon:N.Z,text:"Copy to clipboard",onClick:copyToClipboard,className:"w-50 blue",style:{borderLeft:"1px solid var(--white)"}})]})]})},MarkdownDisplay=e=>{let{content:t,cursor:n,nodeId:a,suppressParagraph:l=!1}=e;if(!n)return null;let s=[];return n.iterate(e=>{var n,o,i,c;switch(e.type.name){case"Document":return s.push((0,r.jsx)("div",{className:"f6 fw4",children:(0,r.jsx)(MarkdownDisplay,{content:t,cursor:null===(n=e.node.firstChild)||void 0===n?void 0:n.cursor(),nodeId:a})},e.from)),!1;case"Paragraph":return l&&0===s.length?s.push((0,r.jsx)(TextDisplay,{content:t,node:e.node},e.from)):s.push((0,r.jsx)("p",{children:(0,r.jsx)(TextDisplay,{content:t,node:e.node})},e.from)),!1;case"FencedCode":return s.push((0,r.jsx)(FencedCodeDisplay,{content:t,node:e.node,nodeId:a},e.from)),!1;case"BulletList":return s.push((0,r.jsx)("ul",{children:(0,r.jsx)(MarkdownDisplay,{content:t,cursor:null===(o=e.node.firstChild)||void 0===o?void 0:o.cursor(),nodeId:a})},e.from)),!1;case"OrderedList":return s.push((0,r.jsx)("ol",{children:(0,r.jsx)(MarkdownDisplay,{content:t,cursor:null===(i=e.node.firstChild)||void 0===i?void 0:i.cursor(),nodeId:a})},e.from)),!1;case"ListItem":return s.push((0,r.jsx)("li",{children:(0,r.jsx)(MarkdownDisplay,{content:t,cursor:null===(c=e.node.firstChild)||void 0===c?void 0:c.cursor(),nodeId:a,suppressParagraph:!0})},e.from)),!1;case"ListMark":return!1;case"ATXHeading1":return s.push((0,r.jsx)("h1",{children:(0,r.jsx)(TextDisplay,{content:t,node:e.node})},e.from)),!1;case"ATXHeading2":return s.push((0,r.jsx)("h2",{children:(0,r.jsx)(TextDisplay,{content:t,node:e.node})},e.from)),!1;case"ATXHeading3":return s.push((0,r.jsx)("h3",{children:(0,r.jsx)(TextDisplay,{content:t,node:e.node})},e.from)),!1;case"ATXHeading4":return s.push((0,r.jsx)("h4",{children:(0,r.jsx)(TextDisplay,{content:t,node:e.node})},e.from)),!1;case"ATXHeading5":return s.push((0,r.jsx)("h5",{children:(0,r.jsx)(TextDisplay,{content:t,node:e.node})},e.from)),!1;case"ATXHeading6":return s.push((0,r.jsx)("h6",{children:(0,r.jsx)(TextDisplay,{content:t,node:e.node})},e.from)),!1;case"Blockquote":return s.push((0,r.jsx)("blockquote",{children:(0,r.jsx)(TextDisplay,{content:t,node:e.node})},e.from)),!1;case"HorizontalRule":return s.push((0,r.jsx)("hr",{},e.from)),!1}return!0}),(0,r.jsx)(r.Fragment,{children:s})};var R=n(88903),D=n(96765),_=n(42751),Z=n(26713),E=n(27554),T=n(5146),F=n(94549),V=n(20736),I=n(82730),H=n(40591),A=n(44911),P=n(41312),O=n(32980),B=n(18818),U=n(17616);let CellPreview=e=>{let{value:t}=e;return t.length?(0,r.jsxs)("div",{id:"ai-assist-cell-preview",className:"flex items-center justify-between bg-near-white bt b--white",children:[(0,r.jsx)("p",{className:"code dark-grey truncate observable-mid-gray ma0 f7 fw4 pl3 pv2",children:t}),(0,r.jsx)(R.v2,{children:e=>{let{isExpanded:t}=e;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(R.j2,{className:o()("flex bn bg-transparent pointer hover-dark-gray pa2",t?"near-black":" observable-mid-gray"),title:"About your data's privacy",children:(0,r.jsx)(helpCircle,{})}),(0,r.jsx)(R.qy,{position:(e,t)=>e&&t?{left:e.right-t.width+pageXOffset-4,top:e.bottom+pageYOffset}:{},className:"pv3 ph3",style:{width:"324px"},children:(0,r.jsx)(R.sd,{children:(0,r.jsxs)("div",{className:"f6 fw4 dark-gray",children:[(0,r.jsxs)("div",{className:"mb3",children:["In the ",(0,r.jsx)("b",{children:"Focused cell"})," tab, ",D.u7," considers the contents of the currently-focused cell (as well as the schema of the selected database for SQL cells) when generating a response. This information is included in the messages sent to OpenAI."]}),(0,r.jsx)(m(),{className:"blue pointer",href:"/@observablehq/introduction-to-ai-assist?collection=@observablehq/notebook-fundamentals",target:"_blank",children:(0,r.jsxs)("span",{className:"inline-flex items-center underline-hover",children:[D.u7," Documentation",(0,r.jsx)(x.Pf,{className:"ml2"})]})})]})})})]})}})]}):null},IntroMessageDisplay=e=>{let{tab:t}=e,n="When you’re in the Focused Cell tab, ".concat(D.u7," will use the contents of the cell to help answer your question better. ")+"Have questions about how we use your content? [Read more in our documentation](/@observablehq/introduction-to-ai-assist?collection=@observablehq/notebook-fundamentals).",a="".concat(D.u7,", powered by OpenAI, can help you write code and build notebooks by:\n")+"- Generating JavaScript, SQL, or HTML code\n- Fixing errors\n- Explaining how code works\n\n"+"When you’re in the General tab, you can ask ".concat(D.u7," general coding questions. ")+"Have questions about how we use your content? Read more in our [documentation](/@observablehq/introduction-to-ai-assist?collection=@observablehq/notebook-fundamentals).\n",l="node"===t?n:a;return(0,r.jsxs)("div",{className:"ph3 pt1 pb2 f5 fw4 dark-gray",children:[(0,r.jsxs)("div",{className:"flex mv2",children:[(0,r.jsx)("span",{className:"flex bg-near-white br2",children:(0,r.jsx)(b.P$,{className:"mid-gray"})}),(0,r.jsx)("span",{className:"ml2 f6 overflow-hidden to-ellipsis observable-mid-gray",children:D.u7})]}),(0,r.jsx)(MarkdownDisplay,{content:l,cursor:(0,u.JH)().language.parser.parse(l).cursor(),nodeId:null})]})},ChatMessageDisplay=e=>{var t;let{item:n}=e,a=(0,L.I0)(),l=(0,I.wS)(n.sender)?(0,r.jsx)("span",{className:"flex bg-near-white br2",children:(0,r.jsx)(b.P$,{className:"mid-gray"})}):(0,r.jsx)(_.q,{user:{...n.sender,type:"individual"},size:16,className:"h1 bg-white bw1"}),s=(0,I.wS)(n.sender)?D.u7:(0,U.RX)(n.sender),[i,c]=(0,h.useState)(null!==(t=n.feedback)&&void 0!==t?t:0),d=0!==i,p=d?"Feedback submitted":"Send feedback";return(0,h.useEffect)(()=>{-1!==i&&n.feedback!==i&&a({type:"chatFeedback",id:n.id,feedback:i})},[a,i,n.id,n.feedback]),(0,r.jsxs)("div",{className:"ph3 pt1 pb2 f5 fw4 dark-gray",children:[(0,r.jsxs)("div",{className:o()("mv1 flex",(0,I.wS)(n.sender)?"justify-between":"justify-end",(0,I.D0)(n)&&"unsent"===n.status?"light-gray":"dark-gray"),children:[(0,r.jsxs)("div",{className:"flex",children:[l,(0,r.jsx)("span",{className:"ml1 f6 overflow-hidden to-ellipsis observable-mid-gray",children:s})]}),(0,I.wS)(n.sender)&&(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("button",{className:o()("flex pa0 bn f6 fw6 ba bg-transparent",!d&&"pointer"),disabled:d,onClick:()=>{1!==i&&c(1)},title:p,children:(0,r.jsx)(j.Z,{className:o()(1===i?"blue":"moon-gray",!d&&"hover-mid-gray"),fill:1===i?"currentColor":"none"})}),(0,r.jsx)("button",{className:o()("flex pa0 bn f6 fw6 ba bg-transparent",!d&&"pointer"),disabled:d,onClick:()=>{a({type:"showModal",modal:"aiAssistFeedback",modalProps:{message:n,setFeedback:c}}),-1!==i&&c(-1)},style:{marginLeft:2},title:p,children:(0,r.jsx)(y.Z,{className:o()(-1===i?"blue":"moon-gray",!d&&"hover-mid-gray"),fill:-1===i?"currentColor":"none"})})]})]}),(0,I.wS)(n.sender)?n.content.body.map((e,t)=>{switch(e.type){case"markdown":return(0,r.jsx)("div",{id:"chat-message-".concat(n.sender.id),children:(0,r.jsx)(MarkdownDisplay,{content:e.text,cursor:(0,u.JH)().language.parser.parse(e.text).cursor(),nodeId:n.node_id})},t);case"br":return(0,r.jsxs)("span",{id:"chat-message-".concat(n.sender.id),style:{wordWrap:"break-word"},className:"f6 fw4",children:[e.text,(0,r.jsx)("br",{})]},t);case"p":default:return(0,r.jsx)("p",{style:{wordWrap:"break-word"},className:"f6 fw4",children:e.text},t);case"options":return null}}):(0,r.jsxs)("div",{id:"chat-message-".concat(n.sender.id),className:"flex",children:[(0,r.jsx)("div",{style:{flexGrow:2}}),(0,r.jsx)("div",{className:"pa2 bg-near-white br3",children:n.content.body.filter(e=>"br"===e.type).map((e,t)=>(0,r.jsx)("div",{className:"ma0 f6 fw4",style:{wordWrap:"break-word"},children:e.text},t))})]})]},n.id)},ChatMessageList=e=>{let{messages:t,nodeId:n,tab:a}=e,l=(0,h.useRef)(null),[s,o]=(0,h.useState)(0),i=(0,h.useMemo)(()=>"node"===a&&null===n?[]:t.filter(e=>!(0,I.t8)(e)&&e.node_id===n),[t,n,a]);(0,h.useEffect)(()=>{if(i.length>s&&l.current){let e=l.current.getBoundingClientRect(),t=e.bottom-e.top,n=l.current.scrollHeight-t;n-l.current.scrollTop>8&&(l.current.scrollTop=n)}i.length<s&&o(0)},[s,i]);let c=i.filter(e=>!(0,I.C6)(e)),d=c[c.length-1],u=c.length&&"assistgpt35turbo"!==d.sender.id&&d.content.body[0].text.length;return(0,r.jsxs)("div",{ref:l,className:"b--light-gray overflow-y-auto",onScroll:()=>{if(l.current){let e=l.current.getBoundingClientRect(),t=e.bottom-e.top;t+l.current.scrollTop+2>l.current.scrollHeight?o(0):o(i.length)}},children:[(0,r.jsx)(IntroMessageDisplay,{tab:a}),c.map(e=>(0,r.jsx)(ChatMessageDisplay,{item:e},e.id)),u?(0,r.jsx)(TypingIndicator,{}):(0,r.jsx)(r.Fragment,{children:" "})]})},TypingIndicator=()=>(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"jsx-947cf7224e9f9266 dot-container mh3 mb2 ph2 br2 flex items-center justify-between bg-near-white",children:[(0,r.jsx)("div",{className:"jsx-947cf7224e9f9266 dot br-100 bg-observable-mid-gray"}),(0,r.jsx)("div",{className:"jsx-947cf7224e9f9266 dot br-100 bg-observable-mid-gray"}),(0,r.jsx)("div",{className:"jsx-947cf7224e9f9266 dot br-100 bg-observable-mid-gray"})]}),(0,r.jsx)(l(),{id:"947cf7224e9f9266",children:".dot-container.jsx-947cf7224e9f9266{height:1rem;width:2.25rem}.dot.jsx-947cf7224e9f9266{width:4px;height:4px;-webkit-animation-name:bounce;-moz-animation-name:bounce;-o-animation-name:bounce;animation-name:bounce;-webkit-animation-duration:1.3s;-moz-animation-duration:1.3s;-o-animation-duration:1.3s;animation-duration:1.3s;-webkit-animation-iteration-count:infinite;-moz-animation-iteration-count:infinite;-o-animation-iteration-count:infinite;animation-iteration-count:infinite}.dot.jsx-947cf7224e9f9266:nth-of-type(2){-webkit-animation-delay:.15s;-moz-animation-delay:.15s;-o-animation-delay:.15s;animation-delay:.15s}.dot.jsx-947cf7224e9f9266:nth-of-type(3){-webkit-animation-delay:.3s;-moz-animation-delay:.3s;-o-animation-delay:.3s;animation-delay:.3s}@-webkit-keyframes bounce{0%,60%,100%{-webkit-transform:translatey(0);transform:translatey(0)}30%{-webkit-transform:translatey(-2px);transform:translatey(-2px)}}@-moz-keyframes bounce{0%,60%,100%{-moz-transform:translatey(0);transform:translatey(0)}30%{-moz-transform:translatey(-2px);transform:translatey(-2px)}}@-o-keyframes bounce{0%,60%,100%{-o-transform:translatey(0);transform:translatey(0)}30%{-o-transform:translatey(-2px);transform:translatey(-2px)}}@keyframes bounce{0%,60%,100%{-webkit-transform:translatey(0);-moz-transform:translatey(0);-o-transform:translatey(0);transform:translatey(0)}30%{-webkit-transform:translatey(-2px);-moz-transform:translatey(-2px);-o-transform:translatey(-2px);transform:translatey(-2px)}}"})]});function autoHeight(e){e.style.height="auto",e.style.height="".concat(Math.min(e.scrollHeight,200),"px")}let AIAssistChatUI=e=>{let{nodeId:t,tab:n}=e,{notebook:a,currentUser:s}=(0,L.v9)(e=>e),{chatMessages:i,model:c,assist:d}=a,u=(0,L.I0)(),[p,x,g]=(0,F.G)({text:"",id:"",includeCode:!1},500),[b,y]=(0,h.useState)(!1),j=(0,h.useRef)(null),w=(0,h.useRef)(null),k=(0,O.ax)(a);(0,h.useEffect)(()=>{let e=i.find(e=>(0,I.t8)(e)&&e.node_id===t);e&&e.id!==p.id&&(x({text:e.content.body.filter(e=>"options"!==e.type).map(e=>e.text).join("\n"),id:e.id,includeCode:e.content.body.some(e=>"options"===e.type&&JSON.parse(e.text).includeCode)}),setTimeout(()=>autoHeight(j.current),1))},[t,i,x,p]),(0,h.useEffect)(()=>y(!!p.text.trim()),[p]);let C=(0,h.useCallback)(e=>{let{text:n,id:r,includeCode:a}=e,l=null!==t?(0,H.DY)(c,t):null,o=!!l&&!(0,A.hN)(l),i=a||o;n?u({type:"chatCreateDraft",message:{id:r,node_id:t,sender:s,status:"draft",complete:!1,local:!0,content:(0,I.dk)(n,i?{includeCode:i}:void 0)}}):r&&u({type:"chatDeleteDraft",id:r})},[u,t,s,c]);function sendDraft(){C(p),x({text:"",id:"",includeCode:p.includeCode}),j.current.value="",autoHeight(j.current),u({type:"chatSendDraft",id:p.id,scope:null===t?"notebook":"cell",cellIncluded:p.includeCode})}(0,h.useEffect)(()=>{C(g)},[g,C]);let N=null!==t?(0,H.DY)(c,t):null,S="node"===n&&null===t,M=!!N&&(0,A.hN)(N),R=!k||S||M;return(0,r.jsxs)(r.Fragment,{children:[k?M?(0,r.jsx)("div",{className:"overflow-y-auto",style:{maxHeight:500},children:(0,r.jsxs)("div",{className:"flex flex-column items-center pa4 tc",children:[(0,r.jsx)(ChatExclamation,{className:"light-gray"}),(0,r.jsxs)("div",{className:"mt3 f7 fw4 mid-gray",children:[D.u7," cannot chat about this type of cell"]})]})}):(0,r.jsxs)(r.Fragment,{children:[N&&(0,r.jsx)(CellPreview,{value:N.value}),(0,r.jsx)(ChatMessageList,{messages:i,nodeId:t,tab:n})]}):(0,r.jsx)("div",{className:"overflow-y-auto",style:{maxHeight:500},children:(0,r.jsxs)("div",{className:"flex flex-column items-center pa4 tc",children:[(0,r.jsx)(ChatSparkles,{className:"light-gray"}),(0,r.jsxs)("div",{className:"mt3 f7 fw4 mid-gray",children:[D.u7," (powered by OpenAI) can help you build notebooks by generating code, fixing errors, and explaining how code works."]}),(0,r.jsxs)("div",{className:"mt3 f7 fw4 dark-gray b--silver",children:["A workspace owner can enable ",D.u7," in"," ",(0,r.jsx)(m(),{href:"".concat((0,U.rF)(a.owner),"#aiAssist"),className:"blue pointer",children:"Settings"}),"."]})]})}),(null==d?void 0:d.quota_exhausted)?(0,r.jsxs)("div",{className:"pb3 flex flex-column items-center fa fa6 dark-gray bt b--light-gray",style:{backgroundColor:"#FBF9F1"},children:[(0,r.jsx)("p",{className:"mv3",children:"Your free message quota has been used up."}),(0,r.jsx)(Z.GY,{className:"ph4",href:"".concat((0,U.rF)(a.owner),"#aiAssist"),text:"Add an OpenAI API Key to continue chatting",targetBlank:!0,icon:f.Z,iconPosition:"right"})]}):(0,r.jsxs)("div",{className:"jsx-ed35353f76d50ffd "+(o()("pa3 bt b--light-gray")||""),children:[(0,r.jsxs)("div",{id:"text-container",className:"jsx-ed35353f76d50ffd "+(o()("br3 ba b--silver flex",R&&"bg-near-white")||""),children:[(0,r.jsx)("div",{className:"jsx-ed35353f76d50ffd pt1 flex-grow-1",children:(0,r.jsx)("textarea",{onFocus:function(){if(w.current&&(w.current.scrollTop=w.current.scrollHeight),j.current){let e=j.current.value;if(e){let t=e.length;j.current.setSelectionRange(t,t)}autoHeight(j.current)}},onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),sendDraft())},ref:j,name:"draft",disabled:R,value:p.text,maxLength:2048,rows:1,placeholder:S?"Focus a cell to chat about it":"Ask anything...",onChange:function(e){autoHeight(j.current),x({...p,text:e.target.value,id:p.id||(0,B.Z)(8)})},style:{resize:"none",borderRightStyle:"none",cursor:k?"auto":"not-allowed"},className:"jsx-ed35353f76d50ffd w-100 bn sans-serif ph2 f6 fw5 dark-gray lh-f6 bg-transparent"})}),(0,r.jsx)("div",{className:"jsx-ed35353f76d50ffd",children:(0,r.jsx)("button",{name:"ask-button",type:"button",disabled:!b,onClick:e=>{e.preventDefault(),e.stopPropagation(),sendDraft()},onMouseDown:e=>e.preventDefault(),title:"Ask",style:{cursor:b?"auto":"not-allowed"},className:"jsx-ed35353f76d50ffd "+(o()("br2 ma1 pa1 f6 fw6 bw0 b--transparent white flex items-center",b?"bg-blue":"bg-moon-gray")||""),children:(0,r.jsx)(v.Z,{})})})]}),(0,r.jsx)(l(),{id:"ed35353f76d50ffd",children:"#text-container.jsx-ed35353f76d50ffd{outline-color:transparent;-webkit-transition:all.1s cubic-bezier(.785,.135,.15,.86);-moz-transition:all.1s cubic-bezier(.785,.135,.15,.86);-o-transition:all.1s cubic-bezier(.785,.135,.15,.86);transition:all.1s cubic-bezier(.785,.135,.15,.86);-webkit-transition-property:border-color,outline;-moz-transition-timing-function:border-color,outline;-o-transition-timing-function:border-color,outline;transition-property:border-color,outline}#text-container.jsx-ed35353f76d50ffd:focus-within{border-color:var(--blue);outline:2px solid var(--faint-blue)}"})]})]})},ChatTrashButton=e=>{let{nodeId:t}=e,n=(0,L.I0)(),{notebook:{chatMessages:a,id:l}}=(0,L.v9)(e=>e),[s,i]=(0,h.useState)(!1),c=!a.some(e=>e.node_id===t),d=s?"Click again to confirm clearing chat history":"Clear chat history";return(0,r.jsxs)("button",{"aria-label":d,className:o()("ml1 flex fw6 pa2 b--none br2 bg-transparent bg-animate",c?"moon-gray":"hover-bg-focus-colorless pointer",s&&"red"),disabled:c,onBlur:()=>i(!1),onClick:e=>{s?(e.preventDefault(),e.stopPropagation(),(0,T.Fv)("/document/".concat(l,"/chat/delete"),{node_id:t}),a.filter(I.t8).forEach(e=>{n({type:"chatDelete",id:e.id})}),i(!1)):i(!0)},title:d,children:[(0,r.jsx)(E.Z,{}),s&&(0,r.jsx)("span",{className:"ml1",children:"Clear\xa0chat?"})]})},QuotaMeter=e=>{let{assist:t}=e;if(!t||t.custom)return null;let{quota_allocated:n,quota_used:a,quota_exhausted:l}=t;if(l)return(0,r.jsx)(g.eA,{"aria-label":"Chat quota used up"});if(n>a){let e="Chat tokens: ".concat(n-a," of ").concat(n," remaining"),t=Math.floor((n-a)*100/n);return t>=95?(0,r.jsx)(g.i4,{title:e}):t>=75?(0,r.jsx)(g.Aw,{title:e}):t>=50?(0,r.jsx)(g.Xt,{title:e}):t>=25?(0,r.jsx)(g.fy,{title:e}):(0,r.jsx)(g.X7,{title:e})}return null},AIAssistPane=()=>{let{notebook:e}=(0,L.v9)(e=>e),t=(0,L.I0)(),{assist:n,focusId:a,model:s}=e,[i,c]=(0,h.useState)();(0,h.useEffect)(()=>{null===a&&null!==a&&t({type:"assistFocus",nodeId:a}),void 0===i&&null!==a&&c("node")},[a,a,t,i]);let d=a&&"node"===i?a:null,u=null!==a?(0,H.DY)(s,a):null,p=u?A.qz[u.mode].icon:null,m=(0,O.ax)(e),v=(0,V.GS)(V.hs);return(0,r.jsxs)("div",{className:"jsx-554e6460060f2a59 flex flex-column flex-grow-1 w-100",children:[(0,r.jsxs)("div",{className:"jsx-554e6460060f2a59 "+(o()("pa3 bb br3 br--top f5 fw6 near-black","b--light-gray","flex justify-between items-center",!v&&"pr4-5")||""),children:[(0,r.jsxs)("div",{className:"jsx-554e6460060f2a59 "+(o()("flex items-center")||""),children:[D.u7,(0,r.jsx)(D.DY,{className:"ml2"})]}),(0,r.jsxs)(R.v2,{children:[(0,r.jsx)(R.j2,{className:"bn bg-transparent pointer pa0",style:{lineHeight:0},children:(0,r.jsx)(QuotaMeter,{assist:n})}),(0,r.jsx)(R.qy,{position:R.Ly.bottomLeft,children:(0,r.jsx)(R.sd,{children:(0,r.jsxs)("div",{style:{width:"300px"},className:"jsx-554e6460060f2a59 ph3 f6 fw4 dark-gray",children:[(0,r.jsxs)("p",{className:"jsx-554e6460060f2a59",children:["Your Observable license includes ",null==n?void 0:n.quota_allocated," ","free tokens (about"," ",1e3*Math.floor(3*((null==n?void 0:n.quota_allocated)||0)/4/1e3)," ","words) to use in ",D.u7," conversations."," "]}),(0,r.jsxs)("p",{className:"jsx-554e6460060f2a59",children:["You’ve used ",(0,r.jsxs)("strong",{className:"jsx-554e6460060f2a59",children:[null==n?void 0:n.quota_used," tokens"]})," so far this month."]}),(0,r.jsx)("p",{className:"jsx-554e6460060f2a59",children:"Go to Settings to add an OpenAI API key and extend your usage limit."}),(0,r.jsxs)("div",{className:"jsx-554e6460060f2a59 flex justify-between",children:[(0,r.jsx)(Z.Ej,{href:"/@observablehq/introduction-to-ai-assist",text:"Docs",iconPosition:"right",icon:f.Z,targetBlank:!0}),(0,r.jsx)(Z.GY,{href:"".concat((0,U.rF)(e.owner),"#aiAssist"),text:"Settings",iconPosition:"right",icon:f.Z,targetBlank:!0})]})]})})})]})]}),(0,r.jsx)(l(),{id:"554e6460060f2a59",children:".pr4-5.jsx-554e6460060f2a59{padding-right:3rem}"}),m&&(0,r.jsxs)("div",{className:"jsx-554e6460060f2a59 bg-near-white flex items-center",children:[(0,r.jsx)("button",{style:{height:32},onClick:()=>c("general"),className:"jsx-554e6460060f2a59 "+(o()("bl-0 br-0 bt-0 bb bw1","ph3 pv2 near-black bg-transparent f6 fw5 lh-solid pointer","node"!==i?"b--near-black":"b--transparent mid-gray")||""),children:"General\xa0chat"}),(0,r.jsx)("div",{className:"jsx-554e6460060f2a59 w-100 overflow-hidden",children:(0,r.jsx)("button",{style:{height:32},onClick:()=>c("node"),className:"jsx-554e6460060f2a59 "+(o()("bl-0 br-0 bt-0 bb bw1","ph3 pv2 near-black bg-transparent f6 fw5 lh-solid pointer mw-100","node"===i?"b--near-black":"b--transparent mid-gray")||""),children:u?(0,r.jsxs)("span",{className:"jsx-554e6460060f2a59 flex items-center",children:[p&&(0,r.jsx)(p,{className:"jsx-554e6460060f2a59 mr1 flex-shrink-0"}),(0,r.jsx)("span",{className:"jsx-554e6460060f2a59 ml1 truncate inline-block",children:(0,P.u2)(u)||"cell ".concat(u.id)})]}):(0,r.jsx)(r.Fragment,{children:"Focused\xa0cell"})})}),(0,r.jsx)("div",{className:"jsx-554e6460060f2a59 flex-grow-1"}),(0,r.jsx)(ChatTrashButton,{nodeId:d})]}),(0,r.jsx)(AIAssistChatUI,{nodeId:d,tab:i})]})};var z=n(78460),W=n(56065),q=n(17238),G=n(88447),Y=n(71261),K=n(68682),X=n(42565),$=n(82173),J=n(51337),Q=n(69583),ee=n(36983),et=n(47489),en=n(63258),er=n(6359),ea=n(4640),el=n(32007),es=n(79998),eo=n(29020),ei=n(42962),ec=n(38423);let TableSchema=e=>{let{db:t,table:n,visible:a}=e,s=(0,L.I0)(),{expandedTables:o,tableSchemas:i}=(0,L.v9)(e=>{let{page:t}=e;return{expandedTables:t.expandedTables,tableSchemas:t.tableSchemas}}),c=(0,el.hS)(t,n),d=o.has(c),u=i.get(c),p=d&&!u,m=(0,h.useRef)();return(0,h.useEffect)(()=>{if(p){let e=new er.n4(t,n,"sql");m.current=e,e.run(s).then(r=>{e===m.current&&s({type:"updateDatabasesPaneTableSchema",db:t,table:n,columns:r})},()=>{e===m.current&&s({type:"updateDatabasesPaneTableSchema",db:t,table:n,columns:null})})}},[t,n,p,s]),a?(0,r.jsxs)("div",{className:"jsx-97de0a3c7c913c4e ml2 mr1",children:[(0,r.jsxs)("div",{className:"jsx-97de0a3c7c913c4e copy-container hover-bg-near-white flex",children:[(0,r.jsx)("button",{onClick:()=>s({type:"toggleDatabasesPaneTable",db:t,table:n}),className:"jsx-97de0a3c7c913c4e bn br2 mw-90 overflow-hidden bg-transparent pointer flex pa1 items-center",children:(0,r.jsxs)("div",{className:"jsx-97de0a3c7c913c4e overflow-hidden flex items-center",children:[(0,r.jsx)(ee.s,{className:"pr1",style:{flexShrink:0}}),(0,r.jsx)("div",{className:"jsx-97de0a3c7c913c4e fw5 truncate dark-gray",children:(0,ei.Vi)(n)})]})}),(0,r.jsx)("button",{title:"Copy name",onClick:e=>{e.stopPropagation(),navigator.clipboard.writeText(function(e){let{database:t,schema:n,table:r}=e;return(0,el.VS)({database:t&&maybeQuote(t),schema:n&&maybeQuote(n),table:maybeQuote(r)})}(n))},className:"jsx-97de0a3c7c913c4e copy bg-transparent squishy pl0 pointer bn br2 gray flex items-center",children:(0,r.jsx)(N.Z,{})}),(0,r.jsx)("div",{className:"jsx-97de0a3c7c913c4e mt1",children:d&&(void 0===u?(0,r.jsx)(W.Z,{}):null===u?(0,r.jsx)(et.Z,{className:"red"}):null)})]}),d&&u&&(0,r.jsx)("div",{className:"jsx-97de0a3c7c913c4e pl1 pb2",children:Array.from(u,e=>{let[t,n]=e;return(0,r.jsxs)("div",{className:"jsx-97de0a3c7c913c4e w-100 flex justify-between pv1 pl2 items-center copy-container",children:[(0,r.jsx)("span",{style:{maxWidth:"70%"},className:"jsx-97de0a3c7c913c4e truncate dark-gray",children:t}),(0,r.jsx)("button",{title:"Copy name",onClick:e=>{e.stopPropagation(),navigator.clipboard.writeText(maybeQuote(t))},className:"jsx-97de0a3c7c913c4e copy mr-auto bg-transparent nt1 nb1 squishy pointer bn gray flex items-center br2",children:(0,r.jsx)(N.Z,{})}),(0,r.jsx)("span",{style:{maxWidth:"30%"},title:n.databaseType,className:"jsx-97de0a3c7c913c4e gray br2",children:n.type})]},t)})}),(0,r.jsx)(l(),{id:"97de0a3c7c913c4e",children:".copy.jsx-97de0a3c7c913c4e{visibility:hidden}.copy-container.jsx-97de0a3c7c913c4e:hover .copy.jsx-97de0a3c7c913c4e{visibility:visible}"})]}):null},DatabaseSchema=e=>{let{db:t,owner:n,readOnly:a,isPrivateInPublic:s=!1,isBucketUnavailable:o=!1,isPrivateBucketError:i=!1}=e,c=(0,L.I0)(),{expandedDatabases:d,databaseSchemas:u}=(0,L.v9)(e=>{let{page:t}=e;return{expandedDatabases:t.expandedDatabases,databaseSchemas:t.databaseSchemas}}),p=(0,L.v9)(e=>{let{currentUser:t}=e;return t}),m=(0,el.x2)(t),f=d.has(m),v=u.get(m),x=f&&!v,g=(0,h.useRef)(),b=(0,O.Vu)(p,n);return((0,h.useEffect)(()=>{if(x){let e=new er.Y2(t);g.current=e,e.run(c).then(n=>{e===g.current&&c({type:"updateDatabasesPaneDatabaseSchema",db:t,tables:n})},()=>{e===g.current&&c({type:"updateDatabasesPaneDatabaseSchema",db:t,tables:null})})}},[t,x,c]),s||o||i)?(0,r.jsxs)("div",{className:"jsx-33e710a8f6457bfc ma3 f7 flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"jsx-33e710a8f6457bfc faux-button flex-column items-center",children:[(0,r.jsx)("div",{className:"jsx-33e710a8f6457bfc flex",children:(0,r.jsxs)("div",{className:"jsx-33e710a8f6457bfc flex items-center pb1",children:[(0,r.jsx)(z.Z,{className:"w1 h1 mr1 white bg-red b--red flex-no-shrink br-pill","aria-label":"Private file"}),(0,r.jsx)("div",{title:t.name,className:"jsx-33e710a8f6457bfc truncate fw6 red",children:t.name})]})}),(0,r.jsx)("div",{className:"jsx-33e710a8f6457bfc overflow-x-hidden",children:(0,r.jsx)("div",{title:i?"Your workspace's S3 bucket can't be reached. Contact your workspace's owner.":"",className:"jsx-33e710a8f6457bfc truncate gray lh-title",children:s?"Only available in private notebooks":o?"Private file storage unavailable":"Unable to access file"})})]}),(0,r.jsxs)("div",{className:"jsx-33e710a8f6457bfc flex flex-shrink-0 items-center",children:[(0,r.jsx)(C.Z,{className:"pa2 ba b--white moon-gray","aria-label":"Insert disabled"}),(0,r.jsx)(X.v,{className:"pa2 ba b--white moon-gray","aria-label":"Menu disabled"})]}),(0,r.jsx)(l(),{id:"33e710a8f6457bfc",children:".faux-button.jsx-33e710a8f6457bfc{padding:1px 6px}"})]}):(0,r.jsxs)("div",{className:"ma3 f7",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("button",{onClick:()=>c({type:"toggleDatabasesPaneDatabase",db:t}),className:"w-100 bn br2 bg-transparent hover-bg-near-white pointer",children:(0,r.jsxs)("div",{className:"flex items-center ",children:[(0,r.jsxs)("div",{className:"tl",children:[(0,r.jsx)("div",{className:"pb1 fw6 near-black",children:t.name}),(0,r.jsxs)("div",{className:"gray",children:[(0,el.w4)(t.dialect)||"Unknown","DatabaseClient"===t.type&&"team"===n.type&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{className:"light-gray",children:" • "}),(0,es.KY)(n)]})]})]}),(0,r.jsx)("div",{children:f&&(void 0===v?(0,r.jsx)(W.Z,{className:"ml2"}):null===v?(0,r.jsx)(et.Z,{className:"red ml2"}):null)})]})}),(0,r.jsxs)("div",{className:"flex flex-shrink-0 items-center",children:[(0,r.jsx)(Z.hU,{icon:C.Z,onClick:()=>c({type:"insertDatabase",source:t}),title:"Insert into notebook"}),(0,r.jsxs)(R.v2,{children:[(0,r.jsx)(Z.hU,{icon:X.v,title:"Database actions",colorless:!0,asMenuButton:!0,disabled:a}),(0,r.jsxs)(R.qy,{style:{width:200},children:[(0,r.jsxs)(R.sN,{onSelect:()=>c({type:"refreshDatabasesPaneSchema",db:t}),disabled:a,children:[(0,r.jsx)(Q.Z,{className:"mr2"})," Refresh schema"]}),(0,r.jsxs)(R.sN,{onSelect:()=>c({type:"insertDatabase",source:t}),disabled:a,children:[(0,r.jsx)(C.Z,{className:"mr2"})," Insert into notebook"]}),"DatabaseClient"===t.type&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(R.sN,{onSelect:()=>c({type:"copyDatabaseCode",db:t}),children:[(0,r.jsx)(N.Z,{className:"mr2"})," Copy usage code"]}),b&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(R.R,{}),(0,r.jsxs)(R.Uk,{href:"".concat((0,U.rF)(n),"/databases?edit=").concat(encodeURIComponent(t.name)),className:"nowrap",children:[(0,r.jsx)(Y.Z,{className:"mr2","aria-label":"Database actions"}),"Edit details"]})]})]})]})]})]})]}),null==v?void 0:v.map(e=>(0,r.jsx)(TableSchema,{visible:f,db:t,table:e},(0,el.VS)(e)))]})},DatabasesPane=()=>{var e;let t=(0,L.I0)(),{nodes:n,owner:a,files:l,allowsConnections:s,teamNotebook:i,readOnly:c,isPublic:d,hasActiveBucket:u,privateBucketStatus:p,focusId:m,notebookType:f}=(0,L.v9)(e=>{var t;let{notebook:n,currentUser:r}=e;return{nodes:n.model.nodes,owner:n.owner,files:n.files,allowsConnections:(0,eo.cE)(n),teamNotebook:(0,eo.p0)(n),readOnly:(0,eo.os)(n),isPublic:(0,eo.HW)(n),hasActiveBucket:(0,eo.uT)(r,n.owner),privateBucketStatus:null===(t=(0,U.xT)(r,n.owner))||void 0===t?void 0:t.private_bucket_status,focusId:n.focusId,notebookType:n.type}}),v=(0,h.useRef)(),[x,g]=(0,h.useState)([]);(0,h.useEffect)(()=>{let e=[],n=new ea.S(async(t,r)=>{t({type:"request_data_sources",mode:"table"});try{for await(let t of r()){if(v.current!==n)return;let{name:r,dialect:a}=t,l={name:"".concat(r),type:"cell",dialect:(0,el.Ov)(a)};e.push(l),e.sort(el.zO),g(e.slice())}}catch(e){console.error("Error fetching database clients: ",e)}});return v.current=n,n.run(t),()=>{v.current=void 0,g([])}},[t]);let{databaseClients:b}=(0,ec.Z)(n),{data:y}=(0,T.h_)(b.size>0&&s?"".concat(i?"/team/".concat(a.id):"/user","/data-connectors?detail=false"):null),j=(0,h.useMemo)(()=>y?y.map(e=>({name:e.name,type:"DatabaseClient",dialect:(0,el.h8)(e.type)})):[],[y]),w=j.filter(e=>{let{name:t}=e;return b.has(t)}),k=(0,h.useMemo)(()=>{let e=[];for(let[t,n]of l){let r=(0,en.S5)(n);null===r||(0,eo.Jw)(n)||e.push({name:t,type:"FileAttachment",dialect:r,inPrivateBucket:null!==n.privateBucketId})}return e},[l]),C=null!==m&&"dashboard"!==f?m:null===(e=n[n.length-1])||void 0===e?void 0:e.id;return(0,r.jsxs)(q.X,{children:[(0,r.jsx)(q.h,{children:"Databases"}),(0,r.jsxs)("div",{className:"mb3",children:[(0,r.jsxs)("div",{className:"ph3 pt3 f6 fw6 flex justify-between items-center",children:[(0,r.jsxs)("div",{className:o()("flex items-center",s?"near-black":"gray"),children:[(0,r.jsx)(G.Z,{className:o()("mr2 pa1 br2",s?"bg-near-white":"bg-white moon-gray")}),"Database connections"]}),(0,r.jsx)(Z.hU,{onClick:()=>t({type:"showModal",modal:"addDatabase",modalProps:{nodeId:C}}),icon:J.ZP,"aria-label":"Add database",colorless:!0,disabled:c||!s,className:"nt2 nb2"})]}),!s&&(0,r.jsx)("div",{className:"ph3 pt2 gray f7",children:"Only available in private notebooks"}),w.length>0&&w.map(e=>(0,r.jsx)(DatabaseSchema,{db:e,owner:a,readOnly:c},(0,el.x2)(e))),x.length>0&&(0,r.jsx)("div",{className:"ph3 pt3 mt3 f6 fw6 flex justify-between items-center bt b--light-silver",children:(0,r.jsxs)("div",{className:"flex items-center near-black",children:[(0,r.jsx)($.Z,{className:"mr2 pa1 br2 bg-near-white"}),"Database cells"]})}),x.length>0&&x.map(e=>(0,r.jsx)(DatabaseSchema,{db:e,owner:a,readOnly:c},(0,el.x2)(e))),k.length>0&&(0,r.jsx)("div",{className:"ph3 pt3 mt3 f6 fw6 flex justify-between items-center bt b--light-silver",children:(0,r.jsxs)("div",{className:"flex items-center near-black",children:[(0,r.jsx)(K.Z,{className:"mr2 pa1 br2 bg-near-white"}),"Database files"]})}),k.length>0&&k.map(e=>(0,r.jsx)(DatabaseSchema,{db:e,owner:a,readOnly:c,isPrivateInPublic:e.inPrivateBucket&&d,isBucketUnavailable:e.inPrivateBucket&&!u,isPrivateBucketError:e.inPrivateBucket&&"error"===p},(0,el.x2)(e)))]})]})};function maybeQuote(e){return/[^0-9A-Z$_]/i.test(e)?'"'.concat(e.replaceAll('"','""'),'"'):e}var ed=n(1316),eu=n(65057),ep=n(93327),em=n(7595),eh=n(49751),ef=n(4870);let DependenciesPane=()=>{let e=(0,L.I0)(),t=(0,L.v9)(e=>{let{notebook:t}=e;return t}),n=(0,L.v9)(e=>{let{page:{dependenciesPaneSpecifier:t}}=e;return t});(0,h.useEffect)(()=>{let t=setTimeout(()=>{n&&e({type:"removeDependenciesPaneSpecifier"})},3e3);return()=>clearTimeout(t)},[n,e]);let a=(0,eh.uF)(t),l=(0,eh.uF)(t,{ignoreResolutions:!0});return a&&l?(0,r.jsx)(DependenciesPaneContent,{dispatch:e,notebook:t,importData:a,latestImportData:l,selectedSpecifier:n}):(0,r.jsxs)(q.X,{children:[(0,r.jsx)(q.h,{children:"Dependencies"}),(0,r.jsx)("div",{className:"flex justify-center pa3",children:(0,r.jsx)(W.Z,{})})]})},DependenciesPaneContent=e=>{let{dispatch:t,notebook:n,importData:a,latestImportData:s,selectedSpecifier:i}=e,{directImports:c}=(0,h.useMemo)(()=>(0,eh.$r)(a),[a]),[d,u]=(0,h.useState)(new Map),p=(0,h.useRef)(!0);(0,h.useEffect)(()=>{let e=setTimeout(()=>{p.current=!1},1e3);return()=>clearTimeout(e)},[]);let m=(0,O.mG)(n),f=(0,eo.os)(n)||!(m&&(0,em.QY)(n))||n.isCompare,v=n.trashed?" because the notebook is in the trash":m?n.isCompare?" while in compare mode":"aborted"===n.clientState?" because there was a connection error":n.autosave?n.isReverting?" because the notebook is reverting":(0,eo.os)(n)?" because the notebook is read-only":null:" while viewing history":" because you don’t have permission to edit this notebook",x=new Set(Array.from(c).flatMap(e=>{let[t,n]=e;return[t,...n.map(e=>{let[,t]=e;return t})]})),g=new Map(Object.entries(s.specifiers).slice(1).flatMap(e=>{let[t,n]=e;return(0,eh.xT)(n)?[]:[[t,ef.Z.parse(n.resolution)]]})),b=new Set(Object.entries(a.specifiers).slice(1).filter(e=>{let[,t]=e;return(0,eh.xT)(t)}).map(e=>{let[t]=e;return t})),y=new Map([...g].filter(e=>{var t;let[n]=e;return!(null===(t=ef.Z.parse(n))||void 0===t?void 0:t.version)})),j=new Map(n.model.resolutions.filter(e=>"notebook"===e.type).map(e=>[e.specifier,ef.Z.parse(e.value)])),w=new Map([...y].filter(e=>{let[t,n]=e,r=j.get(t);return r&&void 0!==r.version&&r.version!==n.version})),k=[...w.keys()].filter(e=>x.has(e)).length;function lockAll(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=new Map(d);if(e)for(let[e,t]of w)n.set(e,t.version);else for(let[e,t]of y){var r;(null===(r=j.get(e))||void 0===r?void 0:r.version)||n.set(e,t.version)}[...j].forEach(e=>{let[t]=e;g.has(t)||n.set(t,void 0)}),t({type:"toggleDependencyLock",locked:!0,bulk:!0}),u(n)}function lockSpecifier(e,t){let n=g.get(e);if(!n)return;let r=j.has(e)?j.get(e).version:null,a=new Map(d);t==r?a.delete(e):a.set(e,t),u(a)}return(0,r.jsxs)(q.X,{children:[(0,r.jsx)(q.h,{children:"Dependencies"}),c.size>0?(0,r.jsxs)(r.Fragment,{children:[f?(0,r.jsxs)("div",{className:l().dynamic([["d01a2c7704b06507",[p.current?"0.25s":"0s"]]])+" f7 pa3 bb b--light-silver bg-washed-yellow",children:["Dependency changes cannot be made",v,"."]}):null,(0,r.jsxs)("div",{className:l().dynamic([["d01a2c7704b06507",[p.current?"0.25s":"0s"]]])+" pa3 flex items-center justify-between lh-copy f6 bb b--light-silver",children:[(0,r.jsx)("div",{className:l().dynamic([["d01a2c7704b06507",[p.current?"0.25s":"0s"]]])+" "+(o()("mr2",k?"fw7":"")||""),children:k?(0,eo.YY)(k,"update available","updates available"):"No updates available"}),(0,r.jsx)(Z.KM,{disabled:f||!k,onClick:()=>lockAll(!0),text:"Update all",className:"nowrap nr2"}),(0,r.jsxs)(R.v2,{children:[(0,r.jsx)(Z.hU,{icon:X.v,title:"Notebook import actions",colorless:!0,asMenuButton:!0}),(0,r.jsxs)(R.qy,{position:R.Ly.bottomLeft,children:[(0,r.jsx)(R.sN,{disabled:f,onSelect:lockAll,children:"Lock all"}),(0,r.jsx)(R.sN,{disabled:f,onSelect:function(){t({type:"toggleDependencyLock",locked:!1,bulk:!0}),u(new Map([...j].map(e=>{let[t]=e;return[t,g.has(t)?null:void 0]})))},children:"Unlock all"})]})]})]}),(0,r.jsxs)("div",{className:l().dynamic([["d01a2c7704b06507",[p.current?"0.25s":"0s"]]])+" pa3",children:[(0,r.jsx)("div",{className:l().dynamic([["d01a2c7704b06507",[p.current?"0.25s":"0s"]]])+" pv2 f6 fw6 lh-title near-black",children:"Direct imports"}),Array.from(x).filter(e=>c.has(e)).sort().map(e=>{var t,n;return(0,r.jsx)("div",{"data-cy":"notebook-import",className:l().dynamic([["d01a2c7704b06507",[p.current?"0.25s":"0s"]]])+" "+(o()("nl1 nr1 mv1",i===e?"blue-fade":"",b.has(e)?"error":"")||""),children:(0,r.jsx)(NotebookImport,{specifier:e,resolvedVersion:d.has(e)?d.get(e):null===(t=j.get(e))||void 0===t?void 0:t.version,latestVersion:null===(n=g.get(e))||void 0===n?void 0:n.version,onLock:t=>lockSpecifier(e,t),isReadonly:f,isDirty:d.has(e)})},e)})]}),x.size>c.size&&(0,r.jsxs)("div",{className:l().dynamic([["d01a2c7704b06507",[p.current?"0.25s":"0s"]]])+" pa3 pt0",children:[(0,r.jsx)("div",{className:l().dynamic([["d01a2c7704b06507",[p.current?"0.25s":"0s"]]])+" pv2 f6 fw6 lh-title near-black",children:"Indirect imports"}),Array.from(x).filter(e=>!c.has(e)).sort().map(e=>{var t,n,s;return(0,r.jsx)("div",{"data-cy":"notebook-import",className:l().dynamic([["d01a2c7704b06507",[p.current?"0.25s":"0s"]]])+" "+(o()("nl1 nr1 mv1",i&&(null===(t=c.get(i))||void 0===t?void 0:t.some(t=>{let[,n]=t;return n===e}))?"blue-fade":"",b.has(e)?"error":"")||""),children:(0,r.jsx)(NotebookImport,{specifier:e,resolvedVersion:d.has(e)?d.get(e):null===(n=j.get(e))||void 0===n?void 0:n.version,latestVersion:null===(s=g.get(e))||void 0===s?void 0:s.version,onLock:t=>lockSpecifier(e,t),isReadonly:f,isDirty:d.has(e),importers:a.imports.filter(t=>{let[,n]=t;return n===e}).map(e=>{let[t]=e;return t})})},e)})]})]}):(0,r.jsx)("div",{className:l().dynamic([["d01a2c7704b06507",[p.current?"0.25s":"0s"]]])+" pa3 mid-gray",children:"This notebook has no dependencies"}),d.size?(0,r.jsxs)("div",{className:l().dynamic([["d01a2c7704b06507",[p.current?"0.25s":"0s"]]])+" pa2 sticky bottom-0 right-0 left-0 flex justify-end br3 br--bottom shadow-1-ns bg-white",children:[(0,r.jsx)(Z.kq,{text:"Cancel",onClick:()=>u(new Map)}),(0,r.jsx)(Z.KM,{text:"Save ".concat((0,eo.YY)(d.size,"change")),onClick:function(){d.size&&(t({type:"resolveDependencies",source:"dependenciesPane",trigger:"click",resolutions:[...d].map(e=>{let[t,n]=e;return{type:"notebook",specifier:t,value:void 0===n?null:"".concat(g.get(t).id).concat(null===n?"":"@".concat(n))}})}),u(new Map))}})]}):null,(0,r.jsx)(l(),{id:"d01a2c7704b06507",dynamic:[p.current?"0.25s":"0s"],children:".error.__jsx-style-dynamic-selector a{color:var(--red)}.blue-fade.__jsx-style-dynamic-selector{-webkit-border-radius:4px;-moz-border-radius:4px;border-radius:4px;-webkit-animation-name:flash;-moz-animation-name:flash;-o-animation-name:flash;animation-name:flash;-webkit-animation-duration:2s;-moz-animation-duration:2s;-o-animation-duration:2s;animation-duration:2s;-webkit-animation-iteration-count:1;-moz-animation-iteration-count:1;-o-animation-iteration-count:1;animation-iteration-count:1;-webkit-animation-timing-function:ease;-moz-animation-timing-function:ease;-o-animation-timing-function:ease;animation-timing-function:ease;-webkit-animation-delay:".concat(p.current?"0.25s":"0s",";-moz-animation-delay:").concat(p.current?"0.25s":"0s",";-o-animation-delay:").concat(p.current?"0.25s":"0s",";animation-delay:").concat(p.current?"0.25s":"0s","}@-webkit-keyframes flash{0%{background-color:var(--observable-focus-light-blue)}60%{background-color:var(--observable-focus-light-blue)}100%{background-color:#fefefe}}@-moz-keyframes flash{0%{background-color:var(--observable-focus-light-blue)}60%{background-color:var(--observable-focus-light-blue)}100%{background-color:#fefefe}}@-o-keyframes flash{0%{background-color:var(--observable-focus-light-blue)}60%{background-color:var(--observable-focus-light-blue)}100%{background-color:#fefefe}}@keyframes flash{0%{background-color:var(--observable-focus-light-blue)}60%{background-color:var(--observable-focus-light-blue)}100%{background-color:#fefefe}}")})]})},NotebookImport=e=>{let{specifier:t,resolvedVersion:n,latestVersion:a,onLock:l,importers:s,isDirty:o,isReadonly:i}=e,c=ef.Z.parse(t);return null===c?(0,r.jsx)(NotebookImportControls,{specifier:t,title:"URL import versions cannot be locked",buttonText:"N/A",locked:!1,rel:"ugc nofollow noreferrer",isReadonly:i,isDirty:o,importers:s,dim:!0}):void 0!==c.version?(0,r.jsx)(NotebookImportControls,{specifier:c,title:'This dependency version is locked via the "@'.concat(c.version,'" in the import statement'),buttonText:"".concat(c.version),locked:!0,isReadonly:i,isDirty:o,importers:s}):void 0===n&&void 0===a?(0,r.jsx)(NotebookImportControls,{specifier:c,title:"Error: specified notebook not found",buttonText:"⚠︎",locked:!1,isReadonly:i,isDirty:o,importers:s,dim:!0}):i?(0,r.jsx)(NotebookImportControls,{specifier:c,title:n?"Version is locked":"Version is not locked",buttonText:n?"".concat(n):"".concat(a),locked:!!n,isReadonly:i,isDirty:o,importers:s}):n||void 0===a?n!==a&&a?(0,r.jsx)(NotebookImportControls,{specifier:c,title:"Update this dependency to ".concat(a),buttonText:"".concat(n," → ").concat(a),locked:!0,isReadonly:i,isDirty:o,importers:s,onLockClick:()=>l(null),onButtonClick:()=>l(a)}):(0,r.jsx)(NotebookImportControls,{specifier:c,title:"This dependency version is the latest",buttonText:"".concat(n),locked:!0,isReadonly:i,isDirty:o,importers:s,onLockClick:()=>l(null)}):(0,r.jsx)(NotebookImportControls,{specifier:c,title:"Lock at version ".concat(a),buttonText:"".concat(a),locked:!1,isReadonly:i,isDirty:o,importers:s,onLockClick:()=>l(a)})},NotebookImportControls=e=>{let{specifier:t,title:n,buttonText:a,locked:l,isReadonly:s,isDirty:i,importers:c,onLockClick:d=null,onButtonClick:u=null,dim:p=!1,rel:m=""}=e,h=(0,L.I0)();return(0,r.jsxs)("div",{className:o()("flex items-center justify-between pa1",p?"gray":""),children:[(0,r.jsx)(ep.Z,{href:t instanceof ef.Z?t.toNotebookURL():t,children:(0,r.jsx)("a",{rel:m,title:"".concat(t).concat(c?"\nImported by:\n".concat(c.join("\n")):""),className:"truncate overflow-hidden nowrap",children:"".concat(t)})}),(0,r.jsxs)("div",{className:"ml2 tr flex justify-end items-center nowrap",title:n,children:[s||null===u?(0,r.jsx)(Z.sn,{disabled:!0,onClick:()=>{},style:{lineHeight:.5,color:"var(--".concat(p?"gray":"dark-gray",")")},className:"bn pr1",text:a}):(0,r.jsx)(Z.KM,{onClick:()=>{u(),h({type:"upgradeDependency"})},style:{lineHeight:.5},className:"bn mr1",text:a}),(0,r.jsx)("button",{"data-cy":"".concat(l?"Locked":"Unlocked"," ").concat(t),disabled:!s&&null===d,style:{color:i?"var(--blue)":void 0,lineHeight:.5},onClick:d?()=>{h({type:"toggleDependencyLock",locked:!l}),d()}:()=>{},className:o()("ph0 flex items-center bn bg-transparent",null!==d?"hover-black pointer dark-gray":"gray"),children:l?(0,r.jsx)(ed.Z,{}):(0,r.jsx)(eu.Z,{})})]})]},"notebook-".concat(t))};var ev=n(86893),ex=n(95591),eg=n(33078),eb=n(71183),ey=n(44532),ej=n(57431),ew=n(55514),ek=n(73515),eC=n(8896);let CloudFileStubMenu=e=>{let{name:t,provider:n,dispatch:a,mimeType:l,size:s,downloadUrl:o}=e;return(0,r.jsx)("div",{className:"flex flex-shrink-0 items-center",children:(0,r.jsxs)(R.v2,{children:[(0,r.jsx)(Z.hU,{icon:X.v,title:"File actions",colorless:!0,asMenuButton:!0}),(0,r.jsxs)(R.qy,{style:{width:200},children:[(0,r.jsxs)(R.sN,{onSelect:()=>a({type:"cloudFileSnippet",name:t,provider:n,mimeType:l,size:s}),children:[(0,r.jsx)(C.Z,{className:"mr2"})," Insert into notebook"]}),o?(0,r.jsxs)(R.Uk,{onClick:()=>a({type:"downloadCloudFile",provider:n,mimeType:l,size:s}),href:o,children:[(0,r.jsx)(eg.Z,{className:"mr2"})," Download"]}):null,(0,r.jsxs)(R.sN,{onSelect:()=>a({type:"removeCloudFile",name:t,provider:n,mimeType:l,size:s}),className:"hover-dark-red hover-bg-washed-red",children:[(0,r.jsx)(E.Z,{className:"mr2"})," Delete"]})]})]})})},MicrosoftCloudFileStub=e=>{var t;let{name:n,path:a,used:l,hasToken:s,dispatch:o}=e,i=(0,eC.Xk)(a),{data:c,error:d}=(0,ex.ZP)(s?"/user/token?provider=microsoftData":null,T.a8,{revalidateOnFocus:!1}),{data:u,error:p=d}=(0,ex.ZP)(()=>!d&&c&&i?(0,eC.g4)(a,c.access_token):null,e=>{let[t,n]=e;return(0,ew.r)(t,n)},{revalidateOnFocus:!1});return(0,r.jsxs)("div",{className:"ma3 flex justify-between items-center",children:[(0,r.jsxs)("div",{className:"flex items-center truncate",children:[(0,r.jsx)(ej.ZP,{className:"flex-shrink-0 mr2",style:{width:24,height:24}}),(0,r.jsxs)("div",{className:"f7 truncate",children:[(0,r.jsx)("div",{className:"fw6 dark-gray flex items-center truncate",children:!p&&s&&i?(0,r.jsx)("div",{className:"truncate",children:(0,r.jsx)("a",{href:null!==(t=null==u?void 0:u.webUrl)&&void 0!==t?t:void 0,className:"hover-blue no-underline",target:"_blank",rel:"noreferrer",children:n})}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(eb.Z,{className:"flex-shrink-0",style:{width:12,height:12},children:(0,r.jsx)("title",{children:null==p?void 0:p.message})}),(0,r.jsx)("div",{className:"ml2 dark-red truncate",children:n})]})}),(0,r.jsxs)("div",{className:"pt1 gray truncate",children:[l?(0,r.jsx)("span",{className:"f7 fw6 blue",children:"In use"}):(0,r.jsx)("span",{className:"f7 gray",children:"Unused"})," • ",(null==c?void 0:c.provider_username)||"No account connected"]})]})]}),(0,r.jsx)(CloudFileStubMenu,{name:n,mimeType:(0,eC.bh)(u,n),size:(0,eC.ap)(u),downloadUrl:u?u["@microsoft.graph.downloadUrl"]:void 0,provider:"microsoftData",dispatch:o})]})},GoogleCloudFileStub=e=>{var t,n;let{name:a,path:l,used:s,hasToken:o,dispatch:i}=e,c=(0,ek.ty)(l),{data:d,error:u}=(0,ex.ZP)(o?"/user/token?provider=googleData":null,T.a8,{revalidateOnFocus:!1}),{data:p,error:m=u}=(0,ex.ZP)(()=>!u&&d&&c?(0,ek.wA)("".concat(l,"?fields=mimeType,size,webContentLink,webViewLink&supportsAllDrives=true"),d.access_token):null,e=>{let[t,n]=e;return(0,ew.r)(t,n)},{revalidateOnFocus:!1});return(0,r.jsxs)("div",{className:"ma3 flex justify-between items-center",children:[(0,r.jsxs)("div",{className:"flex items-center truncate",children:[(0,r.jsx)(ey.Z,{className:"flex-shrink-0 mr2",style:{width:24,height:24}}),(0,r.jsxs)("div",{className:"f7 truncate",children:[(0,r.jsx)("div",{className:"fw6 dark-gray flex items-center truncate",children:!m&&o&&c?(0,r.jsx)("div",{className:"truncate",children:(0,r.jsx)("a",{href:null==p?void 0:p.webViewLink,className:"hover-blue no-underline",target:"_blank",rel:"noreferrer",children:a})}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(eb.Z,{className:"flex-shrink-0",style:{width:12,height:12},children:(0,r.jsx)("title",{children:null==m?void 0:m.message})}),(0,r.jsx)("div",{className:"ml2 dark-red truncate",children:a})]})}),(0,r.jsxs)("div",{className:"pt1 gray truncate",children:[s?(0,r.jsx)("span",{className:"f7 fw6 blue",children:"In use"}):(0,r.jsx)("span",{className:"f7 gray",children:"Unused"})," • ",(null==d?void 0:d.provider_username)||"No account connected"]})]})]}),(0,r.jsx)(CloudFileStubMenu,{name:a,mimeType:null!==(t=null==p?void 0:p.mimeType)&&void 0!==t?t:"",size:+(null!==(n=null==p?void 0:p.size)&&void 0!==n?n:0),downloadUrl:null==p?void 0:p.webContentLink,provider:"googleData",dispatch:i})]})},CloudFileStub=e=>{let{specifier:t,...n}=e;switch(t.provider){case"microsoftData":return(0,r.jsx)(MicrosoftCloudFileStub,{...t,...n});case"googleData":return(0,r.jsx)(GoogleCloudFileStub,{...t,...n})}};var eN=n(56775),eS=n(63302);let FileDragAndDrop=e=>{let{children:t,onDrop:n,dispatch:a,fileSource:l,loginSource:s,currentUser:o,readOnly:i,disabled:c}=e,d=(0,h.useCallback)(e=>{(0,O.Yb)(o)?(a({type:"attachLocalFiles",files:e,source:l,trigger:"dragAndDrop"}),null==n||n(Array.from(e))):o||a({type:"showModal",modal:"login",modalProps:{loginReason:"files"},trigger:"dragAndDrop",source:s})},[o,a,s,l,n]),{getRootProps:u,isDragActive:p}=(0,eN.uI)({onDrop:d,noClick:!0});return(0,r.jsxs)("div",{className:"relative mb3","data-cy":"drop-target",...i||c?null:u(),children:[t,p&&(0,r.jsxs)("div",{className:"flex absolute nb3 right-0 bottom-0 top-0 left-0 tc bg-near-white b--light-silver o-90 b--dashed justify-center flex-column z-max bw1",children:[(0,r.jsx)("div",{className:"f6 fw6 near-black",children:"Upload files"}),(0,r.jsxs)("div",{className:"f7 fw5 dark-gray mt2",children:[(0,es.BU)(eS.D_)," maximum per file"]})]})]})};var eL=n(21756);let FileStub=e=>{let{file:t,dispatch:n,used:a,currentUser:l,isFileDeletable:s,canDeleteFile:o,pane:i,readOnly:c,notebook:d}=e;function insertFile(e){n({type:"insertFile",file:e})}function replaceFile(e,t,r){(0,O.Yb)(l)?n({type:"showModal",modal:"replaceFile",modalProps:{fileToReplace:e}}):l||n({type:"showModal",modal:"login",modalProps:{loginReason:"files"},trigger:t,source:r})}let u=(0,eo.uT)(l,d.owner),p=!u||t.privateBucketId;return(0,r.jsxs)("div",{className:"flex items-center justify-between ma3","data-cy":"file-item",children:[(0,r.jsx)("div",{className:"overflow-x-hidden",children:(0,r.jsx)(ev.J,{file:t,used:a})}),(0,r.jsxs)("div",{className:"flex flex-shrink-0 items-center",children:[(0,r.jsx)(Z.hU,{icon:a?eL.Z:C.Z,onClick:a?()=>replaceFile(t,"click","".concat(i,"PaneReplaceFileButton")):()=>insertFile(t),title:a?"Replace file":"Insert into notebook",disabled:a&&!p}),(0,r.jsxs)(R.v2,{children:[(0,r.jsx)(Z.hU,{icon:X.v,title:"File actions",colorless:!0,asMenuButton:!0}),(0,r.jsxs)(R.qy,{style:{width:200},children:[(0,r.jsxs)(R.sN,{onSelect:()=>insertFile(t),disabled:c,children:[(0,r.jsx)(C.Z,{className:"mr2"})," Insert into notebook"]}),(0,r.jsxs)(R.sN,{onSelect:()=>n({type:"copyFileCode",file:t}),children:[(0,r.jsx)(N.Z,{className:"mr2"})," Copy usage code"]}),(0,r.jsx)(R.R,{}),"downloadUrl"in t&&(0,r.jsx)(R.Uk,{onClick:()=>n({type:"downloadFile",file:t}),href:t.downloadUrl,children:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(eg.Z,{className:"mr2"})," Download"]})}),(0,r.jsxs)(R.sN,{onSelect:()=>replaceFile(t,"click","".concat(i,"PaneMenuReplace")),disabled:!p||!a||c,children:[(0,r.jsx)(eL.Z,{className:"mr2"})," Replace file"]}),o&&!c?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(R.R,{}),(0,r.jsxs)(R.sN,{disabled:!s,onSelect:()=>n({type:"showModal",modal:"deleteFile",modalProps:{name:t.name}}),className:"hover-dark-red hover-bg-washed-red",children:[(0,r.jsx)(E.Z,{className:"mr2"})," Delete"]})]}):null]})]})]})]})};var eM=n(41796),eR=n(67642),eD=n(11026),e_=n(54524),eZ=n(90580);let SectionHeader=e=>{let{title:t,icon:n,"aria-label":a,onAdd:s,disabled:i,allowsPrivate:c=!0}=e;return(0,r.jsxs)("div",{className:"jsx-335f9f217f61bc08 "+(o()("ph3 pt3 f6 fw6 lh-title flex items-center justify-between section-header",c?"near-black":"gray")||""),children:[(0,r.jsxs)("span",{className:"jsx-335f9f217f61bc08 flex items-center",children:[(0,h.createElement)(n,{className:o()("mr2 pa1 br2 border-box",c?"bg-near-white":"bg-white moon-gray"),style:{width:24,height:24}}),t]}),(0,r.jsx)(Z.hU,{onClick:s,icon:J.ZP,"aria-label":a,colorless:!0,disabled:i,className:"nt2 nb2"}),(0,r.jsx)(l(),{id:"335f9f217f61bc08",children:".section-header.jsx-335f9f217f61bc08{border-top:1px solid var(--light-silver);margin-top:var(--spacing-medium)}.section-header.jsx-335f9f217f61bc08:first-of-type{border:none;margin-top:0}"})]})},FilesSection=e=>{var t,n;let{files:a,used:l,currentUser:s,notebook:o,dispatch:i}=e;a=[...a].sort((e,t)=>e.name<t.name?-1:1);let c=a.filter(e=>l.has(e.name)),d=a.filter(e=>!l.has(e.name)),u=(0,eo.HW)(o),p=(0,eo.uT)(s,o.owner),m=(null===(t=(0,U.xT)(s,o.owner))||void 0===t?void 0:t.settings.prohibit_attachments)==="true",h=(null===(n=(0,U.xT)(s,o.owner))||void 0===n?void 0:n.private_bucket_status)==="error",showFile=e=>e.privateBucketId&&(u||!p||h)?(0,r.jsx)("div",{className:"ma3","data-cy":"file-item",children:(0,r.jsx)(ev.J,{file:e,used:!0,isPrivateInPublic:u,isBucketUnavailable:!p,isBucketError:h})},e.name):(0,r.jsx)(FileStub,{isFileDeletable:(0,em.cn)(e,o),canDeleteFile:(0,O.uP)(e,o),file:e,dispatch:i,used:l.has(e.name),currentUser:s,pane:"files",readOnly:(0,eo.os)(o),notebook:o},e.name),f=a.filter(e=>"pending"!==e.status&&"local"!==e.status).reduce((e,t)=>e+(t.size||0),0),v=(0,r.jsxs)(r.Fragment,{children:["File attachments"," ",f>0&&(0,r.jsxs)("span",{className:"ml1 gray",children:["(",(0,es.BU)(f),")"]})]}),x=!(0,em.j5)(s,o);if(0===a.length&&x)return null;let g=(0,eo.os)(o)||!(0,em.j5)(s,o);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(SectionHeader,{title:v,icon:K.Z,"aria-label":"Upload files",disabled:g,allowsPrivate:!g,onAdd:()=>{(0,O.Yb)(s)?(i({type:"notebookFilePickerOpened",source:"filesPane",trigger:"click"}),(0,eR.Z)().then(e=>i({type:"attachLocalFiles",files:e,source:"filesPane",trigger:"click"}))):s||i({type:"showModal",modal:"login",modalProps:{loginReason:"files"},trigger:"click",source:"filesPaneAttachFileButton"})}}),g&&(0,r.jsx)("div",{className:"ph3 pt2 gray f7",children:m?"Not available in this workspace":"Only available in private notebooks"}),c.map(showFile),d.length?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(FileGroupHeader,{children:"Unused"}),d.map(showFile)]}):null]})},FileGroupHeader=e=>{let{children:t}=e;return(0,r.jsxs)("div",{className:"flex ma3",children:[(0,r.jsx)("span",{className:"gray mr1",children:t}),(0,r.jsx)("span",{className:"flex-grow-1 bb b--light-silver",style:{height:9}})]})},CloudFilesSection=e=>{let{cloudFiles:t,notebook:n,currentUser:a,used:l,dispatch:s}=e,o=t.map(e=>(0,eD.a)(e)).filter(e_.K),{data:i}=(0,T.h_)(a&&(0,eo.cE)(n)&&o.length>0&&"/user/tokens");function onAuth(e,t){(0,S.MR)((0,S.ym)({type:"notebook:manage:cloudFileAuth",notebook:n,currentUser:a,data:{provider:e,alreadyAuthenticated:t},eventVersion:1}))}return(0,eo.cE)(n)?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(SectionHeader,{icon:x.ZP,title:"Cloud files","aria-label":"Add cloud file",onAdd:()=>s({type:"showModal",modal:"addCloudFile"}),disabled:(0,eo.os)(n)}),(0,eo.vi)(n).map(e=>(0,r.jsx)(eM.E,{provider:e,alreadyAuthenticated:!!i&&i.some(t=>t.provider===e),onAuth:onAuth,children:(0,r.jsxs)("div",{className:"ph3 mt2 f7 flex items-center",children:[(0,r.jsx)(eb.Z,{className:"mr2 flex-shrink-0"}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("span",{className:"mr1 mid-gray",children:["This notebook encountered an error importing"," ",eZ.c[e].name," files. Please"]}),(0,r.jsx)("button",{type:"submit",className:"blue pointer underline-hover bg-transparent pa0 bn",children:"connect your account"}),"."]})]})},e)),i&&o.length?(0,r.jsxs)(r.Fragment,{children:[Object.entries(eZ.c).map(e=>{let[t,n]=e;return o.some(e=>e.provider===t)&&(0,r.jsx)(eM.E,{provider:t,alreadyAuthenticated:i.some(e=>e.provider===t),onAuth:onAuth,children:(0,r.jsxs)("div",{className:"ph3 mt2 f7",children:[(0,r.jsxs)("span",{className:"mr1 mid-gray",children:["This notebook uses ",n.name," files."]}),(0,r.jsx)("button",{className:"blue pointer underline-hover bg-transparent pa0 bn",type:"submit",children:i.some(e=>e.provider===t)?"Switch account":"Connect account"})]})},t)}),o.map(e=>(0,r.jsx)(CloudFileStub,{specifier:e,used:l.has(e.specifier),dispatch:s,hasToken:i.some(t=>t.provider===e.provider)},e.specifier))]}):null]}):(0,U.Hw)(n)?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(SectionHeader,{icon:x.ZP,title:"Cloud files",disabled:!0,allowsPrivate:!1,onAdd:()=>{}}),(0,r.jsx)("div",{className:"ph3 pt2 gray f7",children:"Only available in private notebooks"})]}):null},eE=(0,L.$j)(e=>{let{notebook:t,currentUser:n}=e;return{notebook:t,currentUser:n}},e=>({dispatch:e}))(e=>{let{notebook:t,currentUser:n,dispatch:a}=e,{model:{nodes:l,resolutions:s},files:o}=t,{fileAttachments:i}=(0,ec.Z)(l),c=s.filter(eo.HC),d=(0,eo.Pu)(o);return(0,r.jsxs)(q.X,{children:[(0,r.jsx)(q.h,{children:"Files"}),(0,r.jsxs)(FileDragAndDrop,{dispatch:a,currentUser:n,fileSource:"filesPane",loginSource:"filesPaneDragAndDrop",readOnly:(0,eo.os)(t),disabled:!(0,em.j5)(n,t),children:[(0,r.jsx)(FilesSection,{files:d,used:i,currentUser:n,dispatch:a,notebook:t}),(0,r.jsx)(CloudFilesSection,{dispatch:a,notebook:t,currentUser:n,cloudFiles:c,used:i})]})]})});var eT=n(24067),eF=n(55288),eV=n(71820),eI=n(17267),eH=n(77110),eA=n(88182),eP=n(49817);let eO=(0,eH.V)([["Enter",e=>{let{dispatch:t}=e;return t({type:"selectNextSearchResult"}),!0}],["Shift-Enter",e=>{let{dispatch:t}=e;return t({type:"selectPreviousSearchResult"}),!0}],["Escape",e=>{let{dispatch:t}=e;return t({type:"dismissPane"}),!0}]]),eB=(0,L.$j)(e=>{let{notebook:t}=e;return{regexSearch:t.regexSearch,searchTerm:t.searchTerm,searchResults:t.searchResults,selectedSearchResult:t.selectedSearchResult}},e=>({dispatch:e}))(e=>{let{regexSearch:t,searchTerm:n,searchResults:a,selectedSearchResult:l,dispatch:s}=e;function setSearchTerm(e){s({type:"setSearchTerm",searchTerm:e})}let o=(0,eP._)(a,l),i=a&&void 0!==o,c=function(){if(n&&t)try{RegExp(n,"gu")}catch(e){return e.message||"invalid regex"}}(),u=(0,h.useRef)(null);return(0,h.useEffect)(()=>{u.current&&u.current!==document.activeElement&&u.current.select()},[]),(0,r.jsxs)("div",{className:"mh3",children:[(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)(eT.x,{type:"text",placeholder:"Find",value:n,ref:u,onChange:e=>{let{target:{value:t}}=e;return setSearchTerm(t)},className:"flex-auto",hasError:c,onKeyDown:function(e){eO({dispatch:s},e)&&(e.preventDefault(),e.stopPropagation())},leftElement:(0,r.jsx)("div",{children:(0,r.jsx)(eV.Z,{className:"db moon-gray"})}),rightElement:n?(0,r.jsx)(Z.hU,{icon:d.Z,onClick:()=>setSearchTerm(""),style:{width:28,height:28,marginRight:2},colorless:!0,disabled:!n}):void 0}),(0,r.jsxs)("div",{className:"flex ml2",children:[(0,r.jsx)(Z.hA,{icon:()=>(0,r.jsx)(eF.Z,{className:i?"":"moon-gray",style:{transform:"rotate(-180deg)"}}),title:"Previous search result ".concat((0,eA.Z)(eI.Mq?"Shift-Mod-G":"Shift-F3")),suppressHydrationWarning:!0,onClick:()=>s({type:"selectPreviousSearchResult"}),disabled:!i,style:{borderRadius:"4px 0 0 4px",width:32,height:32},colorless:!0}),(0,r.jsx)(Z.hA,{icon:()=>(0,r.jsx)(eF.Z,{className:i?"":"moon-gray"}),title:"Next search result ".concat((0,eA.Z)(eI.Mq?"Mod-G":"F3")),suppressHydrationWarning:!0,onClick:()=>s({type:"selectNextSearchResult"}),disabled:!i,style:{borderRadius:"0 4px 4px 0",width:32,height:32,marginLeft:1},colorless:!0})]})]}),c&&(0,r.jsx)("div",{className:"red mt2",children:c})]})});var eU=n(6059),ez=n(14318),eW=n(91),eq=n(75919);let eG=(0,eH.V)([["Enter",e=>{let{dispatch:t}=e;return t({type:"replaceCurrent",trigger:"keypress",source:"findPane"}),!0}],["Mod-Enter",e=>{let{dispatch:t}=e;return t({type:"replaceAll",trigger:"keypress",source:"findPane"}),!0}]]),eY=(0,L.$j)(e=>{var t;let{page:n,notebook:r}=e;return{replaceInputExpanded:n.replaceInputExpanded,replaceTerm:r.replaceTerm,canReplace:!!r.selectedSearchResult&&!!(null===(t=r.searchResults)||void 0===t?void 0:t.size)&&!(0,eo.os)(r)}},e=>({dispatch:e}))(e=>{let{canReplace:t,replaceInputExpanded:n,replaceTerm:a,dispatch:l}=e;return(0,r.jsxs)("div",{className:"flex flex-column mt3 pa3 bt b--light-silver",children:[(0,r.jsxs)("button",{className:"f6 fw6 bn flex items-center bg-transparent b--transparent relative pointer pa0",onClick:()=>l({type:"toggleReplaceInputExpanded"}),children:[n?(0,r.jsx)(eU.Z,{className:"mr1"}):(0,r.jsx)(ez.Z,{className:"mr1"}),"Replace"]}),n&&(0,r.jsxs)("div",{className:"flex mt2",children:[(0,r.jsx)(eT.x,{type:"text",placeholder:"Replace",value:a,onChange:e=>{let{target:{value:t}}=e;return l({type:"setReplaceTerm",replaceTerm:t})},className:"flex-auto",leftElement:(0,r.jsx)(eL.Z,{className:"moon-gray"}),onKeyDown:function(e){eG({dispatch:l},e)&&(e.preventDefault(),e.stopPropagation())},rightElement:a?(0,r.jsx)(Z.hU,{icon:d.Z,onClick:()=>l({type:"setReplaceTerm",replaceTerm:""}),style:{width:28,height:28,marginRight:2},colorless:!0,disabled:!a}):void 0}),(0,r.jsxs)("div",{className:"flex ml2",children:[(0,r.jsx)(Z.hA,{icon:()=>(0,r.jsx)(eq.x,{className:t?"":"moon-gray"}),title:"Replace current ".concat((0,eA.Z)("Enter")),suppressHydrationWarning:!0,onClick:()=>l({type:"replaceCurrent",trigger:"click",source:"findPane"}),disabled:!t,style:{borderRadius:"4px 0 0 4px",width:32,height:32},colorless:!0}),(0,r.jsx)(Z.hA,{icon:()=>(0,r.jsx)(eW.E,{className:t?"":"moon-gray"}),title:"Replace all ".concat((0,eA.Z)("Mod-Enter")),suppressHydrationWarning:!0,onClick:()=>l({type:"replaceAll",trigger:"click",source:"findPane"}),disabled:!t,style:{borderRadius:"0 4px 4px 0",width:32,height:32,marginLeft:1},colorless:!0})]})]})]})});var eK=n(56770);let FindPaneNodeResults=e=>{let{selectedSearchResult:t,node:n,searchResults:a,dispatch:l}=e,s=A.qz[n.mode].icon,i=(0,P.u2)(n),c=(0,h.useRef)(null);return(0,h.useEffect)(()=>{c.current&&t&&(0,eK.zT)(c.current)},[t]),(0,r.jsxs)("div",{className:"ma3",children:[(0,r.jsxs)("div",{className:"mt3 mb1 flex items-center dark-gray monospace-bold",children:[(0,r.jsx)(s,{className:"mr1"}),i||(0,r.jsxs)("span",{className:"i",children:["unnamed (#",n.id,")"]})]}),a.map((e,a)=>{let s=(null==t?void 0:t.nodeResultIndex)===a&&t.nodeId===n.id;return(0,r.jsx)("div",{className:"mh3",ref:s?c:null,"data-cy":"find-result-row",children:(0,r.jsxs)("button",{className:o()("w-100 pa1 tl bn br2 monospace",s?"bg-blue white":"bg-transparent hover-bg-light-silver"),onClick:()=>l({type:"selectSearchResult",selectedSearchResult:{nodeId:n.id,nodeResultIndex:a}}),children:[(0,r.jsx)("span",{className:s?"o-70":"o-50",children:e.beforeText}),(0,r.jsx)("span",{className:o()("br1",s?"bg-observable-orange black":"bg-observable-yellow"),children:e.termText}),(0,r.jsx)("span",{className:s?"o-70":"o-50",children:e.afterText})]})},a)})]})},eX=(0,L.$j)(e=>{let{notebook:t}=e;return{model:t.model,selectedSearchResult:t.selectedSearchResult,searchResults:t.searchResults}},e=>({dispatch:e}))(e=>{let{model:t,selectedSearchResult:n,searchResults:a,dispatch:l}=e;if(!a)return null;if(!(0,eP.n)(a))return(0,r.jsx)("div",{className:"pa3",children:"No results"});let s=[];for(let e of t.nodes){let t=a.get(e.id);t&&s.push((0,r.jsx)(FindPaneNodeResults,{node:e,selectedSearchResult:n,searchResults:t,dispatch:l},e.id))}return(0,r.jsx)("div",{className:"overflow-y-auto flex-auto bt b--light-silver",children:(0,r.jsx)("div",{children:s})})});var e$=n(92862);let eJ=(0,L.$j)(e=>{let{page:t,notebook:n}=e;return{findOptionsInputExpanded:t.findOptionsInputExpanded,caseSensitiveSearch:n.caseSensitiveSearch,wholeWordSearch:n.wholeWordSearch,regexSearch:n.regexSearch}},e=>({dispatch:e}))(e=>{let{findOptionsInputExpanded:t,caseSensitiveSearch:n,wholeWordSearch:a,regexSearch:l,dispatch:s}=e;return(0,r.jsxs)("div",{className:"flex flex-column pa3 bt b--light-silver",children:[(0,r.jsxs)("button",{className:"f6 fw6 bn flex items-center bg-transparent b--transparent relative pointer pa0",onClick:()=>s({type:"toggleFindOptionsExpanded"}),children:[t?(0,r.jsx)(eU.Z,{className:"mr1"}):(0,r.jsx)(ez.Z,{className:"mr1"}),"Settings"]}),t&&(0,r.jsxs)("div",{className:"mt2",children:[(0,r.jsx)(e$.X,{checked:n,onChange:()=>s({type:"toggleCaseSensitiveSearch"}),label:"Case sensitive"}),(0,r.jsx)(e$.X,{checked:a,onChange:()=>s({type:"toggleWholeWordSearch"}),label:"Whole word"}),(0,r.jsx)(e$.X,{checked:l,onChange:()=>s({type:"toggleRegexSearch"}),label:"Regular expression"})]})]})}),eQ=(0,L.$j)(e=>{let{notebook:t}=e;return{searchResults:t.searchResults,selectedSearchResult:t.selectedSearchResult}},null)(e=>{let{searchResults:t,selectedSearchResult:n}=e,a=(0,V.GS)("(max-width: 960px)",!1),l=(0,eP._)(t,n),s=(0,eP.n)(t);return(0,r.jsxs)("div",{className:o()("flex align-items pa3",a?"mr3 pr4":""),children:[(0,r.jsx)("div",{className:"f5 fw6 near-black flex-auto lh-title",children:"Find and replace"}),(0,r.jsx)("div",{className:"f6 dark-gray",children:t?void 0===n?(0,r.jsx)(r.Fragment,{children:s}):(0,r.jsxs)(r.Fragment,{children:[l+1,(0,r.jsx)("span",{className:"gray",children:" of "}),s]}):null})]})}),e0=(0,eH.V)([["ArrowDown","Shift-ArrowDown",e=>{let{dispatch:t}=e;return t({type:"selectNextSearchResult"}),!0}],["ArrowUp","Shift-ArrowUp",e=>{let{dispatch:t}=e;return t({type:"selectPreviousSearchResult"}),!0}]]),e1=(0,L.$j)(null,e=>({dispatch:e}))(e=>{let{dispatch:t}=e;return(0,r.jsxs)(q.X,{className:"flex flex-column",onKeyDown:function(e){e0({dispatch:t},e)&&(e.preventDefault(),e.stopPropagation())},children:[(0,r.jsxs)("div",{className:"flex flex-column",children:[(0,r.jsx)(eQ,{}),(0,r.jsx)(eB,{}),(0,r.jsx)(eY,{}),(0,r.jsx)(eJ,{})]}),(0,r.jsx)(eX,{})]})});var e2=n(33234),e5=n(45065),e3=n(62825),e4=n(7183),e6=n(38716),e9=n(31881),e7=n(84579),e8=n(94179),te=n(4293);function eventDescriptionText(e){let{node_id:t,mode:n}=e,{node_name:r,node_value_start:a}=e,l=r||a||"table"===n?"":" empty cell";switch(e.type){case"insert_node":return"Added".concat(l);case"modify_node":if(e.is_new)return"Added".concat(l);return e.node_old_name?"Renamed":"Edited".concat(l);case"remove_node":return"Removed".concat(l);case"move_node":return"Moved".concat(l);case"pin_node":return"Pinned".concat(l);case"unpin_node":return"Unpinned".concat(l);case"modify_title":return"Titled “".concat(e.title,"”");case"modify_license":return null===e.license?"Removed license":"Licensed ".concat((0,e8.ax)(e.license));case"modify_copyright":return""!==e.copyright?"Copyright".concat(e.copyright.replace(/^copyright\b/i,"")):"Removed copyright notice";case"revert":return"Reverted to ".concat(t);case"create":return e.fork?"Forked from “".concat(e.fork.title,"”"):"Created";case"mode_node":{let{label:t}=A.qz[e.mode]||{label:""};return"Mode ".concat(t)}case"resolve_dependency":{var s,o;let{specifier_type:t,specifier:n,value:r}=e;if("notebook"!==t)return"";if(!r||!(null===(s=ef.Z.parse(r))||void 0===s?void 0:s.version))return"Version lock for ".concat(n," was removed");let a=null===(o=ef.Z.parse(r))||void 0===o?void 0:o.version;return"Locked ".concat(n," to version ").concat(a)}case"modify_data":return"Edited".concat(l);case"modify_name":return e.node_old_name?"Renamed":"Named";default:return""}}let HistoryEventSet=e=>{let{events:t,isVersioned:n,currentVersion:a,dispatch:s,focusId:i,id:c}=e,[,...d]=t,u=!!d.length,p=!t.slice(1).some(e=>e.version===a),[m,f]=(0,h.useState)(!p),v=(0,V.GS)(V.ro),x=v?{width:"2em",height:"2em"}:{width:"1.5em",height:"1.5em"},g=v?"3em":"2em",b=(0,L.v9)(e=>({roles:e.notebook.roles}));return(0,r.jsx)(r.Fragment,{children:t.map((e,t)=>{if(p&&!m&&t>0)return null;let d=function(e){if(e.publish_time&&!e.paused_version)return e5.Z;switch(e.type){case"create":return e4.Z;case"modify_license":case"modify_copyright":return e3.Z;case"pin_node":case"unpin_node":return e9.Z;case"resolve_dependency":{var t;let{specifier_type:n,value:r}=e;if("notebook"!==n)return ed.Z;if(!r||!(null===(t=ef.Z.parse(r))||void 0===t?void 0:t.version))return eu.Z;return ed.Z}case"revert":return Q.Z;default:return Y.Z}}(e),h=0===t,y=e.version===a,j=n&&y,w=null!==i&&e.node_id===i&&!j,k=e.paused_version,C=j?"bg-light-blue":"bg-transparent",N=p?j?"white":"near-black":"moon-gray",S=p?j?"hover-light-silver":"hover-dark-gray":"",L=j?"white":"gray",M=j?"white":k?"gray":"moon-gray",{user:R}=e.merge?e.merge:e;function onClick(){s({type:"loadVersion",version:e.version})}return(0,r.jsxs)("div",{style:{display:"contents"},className:l().dynamic([["5dee8b5464a935d5",[g]]])+" hide-child show-children",children:[(0,r.jsx)("div",{className:l().dynamic([["5dee8b5464a935d5",[g]]])+" "+(o()("cell cellStart",C)||""),children:h&&u&&(0,r.jsx)("button",{onClick:e=>{e.stopPropagation(),f(!m)},disabled:!p,style:{width:v?g:"auto"},title:m?"Collapse history range":"Expand history range",className:l().dynamic([["5dee8b5464a935d5",[g]]])+" "+(o()("flex items-center justify-center pointer f7 lh-solid fw6 bg-transparent b--transparent br2 bn pa0 h-100",N,S)||""),children:m?(0,r.jsx)(eU.Z,{...x}):(0,r.jsx)(ez.Z,{...x})})}),(0,r.jsx)("div",{title:e.time&&(0,te.Dh)(e.time),onClick:onClick,className:l().dynamic([["5dee8b5464a935d5",[g]]])+" "+(o()("cell fw5 tr nowrap",C,j?"white":h?"black":"gray")||""),children:e.time&&(0,te.jD)(e.time)}),(0,r.jsx)("div",{title:(0,U.RX)(R),onClick:onClick,className:l().dynamic([["5dee8b5464a935d5",[g]]])+" "+(o()("cell",C)||""),children:(0,r.jsx)(_.q,{user:{...R,type:"individual"},size:16,className:"v-top"})}),(0,r.jsx)("div",{onClick:onClick,className:l().dynamic([["5dee8b5464a935d5",[g]]])+" "+(o()("cell",C)||""),children:(0,r.jsx)(d,{className:l().dynamic([["5dee8b5464a935d5",[g]]])+" "+(L||"")})}),(0,r.jsx)("button",{onClick:onClick,tabIndex:0,className:l().dynamic([["5dee8b5464a935d5",[g]]])+" "+(o()("cell br0 bn",C,w?"mid-gray fw7":L)||""),children:e.publish_time&&!k?(0,r.jsx)("span",{title:"Published. ".concat(eventDescriptionText(e)),className:l().dynamic([["5dee8b5464a935d5",[g]]])+" truncate",children:"Published"}):(0,r.jsx)("span",{className:l().dynamic([["5dee8b5464a935d5",[g]]])+" truncate",children:function(e){let{merge:t}=e;if(t){let e="Merged “".concat(t.document.title,"”");return(0,r.jsx)("span",{title:e,children:e})}let{node_old_name:n,node_name:a,node_value_start:l,node_id:s}=e,o=eventDescriptionText(e);return(0,r.jsxs)("span",{title:"".concat(o," ").concat("Renamed"===o?"".concat(n," to "):"").concat(a||l||""),children:[o," ","Renamed"===o&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{style:{fontSize:"0.8rem"},className:"code",children:n})," ","to"," "]}),a||l||s?(0,r.jsxs)("span",{style:{fontSize:"0.8rem"},className:"code",children:[a||l||"cell ".concat(s)," "]}):null]})}(e)})}),(0,r.jsxs)("div",{onClick:onClick,className:l().dynamic([["5dee8b5464a935d5",[g]]])+" "+(o()("cell cellEnd flex justify-end relative",C,M)||""),children:[k&&(0,r.jsx)("span",{title:(0,O.mG)(b)?e7.H:e7.r,className:l().dynamic([["5dee8b5464a935d5",[g]]])+" pr1",children:(0,r.jsx)(e6.Z,{})}),(0,r.jsxs)("span",{style:{minWidth:"var(--spacing-medium)"},className:l().dynamic([["5dee8b5464a935d5",[g]]])+" "+(o()("tr",M,!y&&"show-child")||""),children:["v",e.version]}),(0,r.jsx)("div",{className:l().dynamic([["5dee8b5464a935d5",[g]]])+" absolute",children:!y&&(0,r.jsx)(Z.I_,{className:"child",icon:e2.Z,href:"/compare/".concat(c,"@").concat(Math.min(e.version,a),"...").concat(c,"@").concat(Math.max(e.version,a)),onClick:e=>e.stopPropagation(),style:{borderRadius:"var(--border-radius-2)",padding:"0.125rem",right:-3},title:"Compare v".concat(Math.max(e.version,a)," to v").concat(Math.min(e.version,a))})})]}),(0,r.jsx)(l(),{id:"5dee8b5464a935d5",dynamic:[g],children:".cell.__jsx-style-dynamic-selector{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;padding:4px;height:".concat(g,";max-width:100%;overflow:hidden;cursor:pointer}button.cell.__jsx-style-dynamic-selector{padding:4px 2px}.cellStart.__jsx-style-dynamic-selector{-webkit-border-top-left-radius:4px;-moz-border-radius-topleft:4px;border-top-left-radius:4px;-webkit-border-bottom-left-radius:4px;-moz-border-radius-bottomleft:4px;border-bottom-left-radius:4px;margin-left:var(--spacing-small)}.cellEnd.__jsx-style-dynamic-selector{-webkit-border-top-right-radius:4px;-moz-border-radius-topright:4px;border-top-right-radius:4px;-webkit-border-bottom-right-radius:4px;-moz-border-radius-bottomright:4px;border-bottom-right-radius:4px;margin-right:var(--spacing-small);padding-right:var(--spacing-small)}")})]},t)})})},HistoryRange=e=>{let{range:{folds:t,events:n,title:a},isVersioned:s,currentVersion:o,dispatch:i,isFirst:c,focusId:d,id:u}=e;return n.length?(0,r.jsxs)(r.Fragment,{children:[!c&&(0,r.jsx)("div",{style:{height:1},className:"jsx-6c50030ed6403049 span-grid flex-auto mt3 bg-light-silver"}),(0,r.jsx)("div",{className:"jsx-6c50030ed6403049 span-grid pt3 pb2 ph3 flex",children:(0,r.jsx)("span",{className:"jsx-6c50030ed6403049 mr1 f6 fw6 near-black",children:a})}),t.map((e,t)=>{let l=n.slice(e[0],e[1]+1);return(0,r.jsxs)(h.Fragment,{children:[(0,r.jsx)(HistoryEventSet,{events:l,isVersioned:s,dispatch:i,currentVersion:o,focusId:d,id:u}),l.some(e=>e.first_public_version&&!e.oldest_version)&&(0,r.jsxs)("div",{className:"jsx-6c50030ed6403049 span-grid flex items-center mh3",children:[(0,r.jsx)("div",{className:"jsx-6c50030ed6403049 w-100 bt mr2 b--lightest-green"}),(0,r.jsx)("div",{className:"jsx-6c50030ed6403049 nowrap f7 lh-f7 fw5 bg-washed-green dark-green pa1 br2",children:"Made public"})]})]},"".concat(a).concat(t))}),(0,r.jsx)(l(),{id:"6c50030ed6403049",children:".span-grid.jsx-6c50030ed6403049{grid-column-start:1;grid-column-end:7}"})]}):null},tt=(0,L.$j)(e=>{let{notebook:t,currentUser:n}=e;return{notebook:t,currentUser:n}})(e=>{let{notebook:t,currentUser:n}=e,{suggestionsTo:a}=t;return a.length?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"jsx-448bdbec10f793c0 pt3 pb1 ph3 flex suggestionsEntry",children:[(0,r.jsx)("span",{className:"jsx-448bdbec10f793c0 mr1 f6 fw6 near-black",children:"Suggestions"}),(0,r.jsx)("hr",{style:{height:1,marginTop:"0.65em"},className:"jsx-448bdbec10f793c0 flex-auto mt2 bn bg-light-gray v-base"})]}),a.map((e,a)=>{let{creator:l,description:s,from_id:o,to_id:i}=e;return(0,r.jsx)("div",{title:"View suggestion",className:"jsx-448bdbec10f793c0 br2 pa2 mt2 mh3 bg-washed-yellow suggestionsEntry",children:(0,r.jsx)(ep.Z,{href:"/compare/".concat(i,"...").concat(o),children:(0,r.jsxs)("a",{onClick:()=>(function(e){let{to_id:r,to_owner:a,from_id:l,from_owner:s}=e;(0,S.MR)((0,S.ym)({type:"notebook:view:suggestion",data:{base:(0,S.tb)({id:r,owner:a},n),target:(0,S.tb)({id:l,owner:s},n),trigger:"click",source:"historyPane"},eventVersion:1,notebook:t,currentUser:n}))})(e),className:"jsx-448bdbec10f793c0 no-underline",children:[(0,r.jsxs)("div",{className:"jsx-448bdbec10f793c0 flex items-center",children:[(0,r.jsx)(_.q,{user:{...l,type:"individual"},className:"mr2",size:16}),(0,U.RX)(l)]}),(0,r.jsxs)("div",{className:"jsx-448bdbec10f793c0 mid-gray f7 pt2",children:["“",s,"”"]})]})})},a)}),(0,r.jsx)(l(),{id:"448bdbec10f793c0",children:".suggestionsEntry.jsx-448bdbec10f793c0{grid-column-start:1;grid-column-end:7}"})]}):null}),tn=new Set(["revert"]),tr=new Set(["pin","unpin"]),ta=(0,h.memo)(function(e){let{history:t,forkOf:n,autosave:a,version:s,dispatch:o,focusId:i,id:c,isPausedLoad:d,modes:u}=e,p=function(e){let t,{history:{events:n,first_public_version:r,identifiers:a,merges:l,paused_version:s,users:o},forkOf:i,modes:c,now:d=new Date}=e,u=new Map;for(let e of o)u.set(e.id,e);for(let e of l)u.set(e.user.id,e.user);let p=u.size;n=n.slice().reverse().filter(e=>"noop"!==e.type);let m=[];for(let e=0;e<n.length;e++){let t=n[e],{user_id:a,publish_user_id:o,time:d,publish_time:p,...h}=t,f=l.find(e=>t.version===e.to_end_version);m.push({...h,user:u.get(a),publish_user:u.get(o),time:d,publish_time:p,fork:i&&i.version===t.version?i:null,merge:f,paused_version:s===h.version,first_public_version:r===h.version,latest_version:0===e,mode:t.node_id?c.get(t.node_id):void 0})}let h=new Map,f=new Map,v=new Map,x=new Map(a);for(let e=m.length-1;e>=0;e--){let t=m[e];switch(t.type){case"modify_node":case"insert_node":{let e=h.get(t.node_id);e&&t.node_name&&e!==t.node_name&&(t.node_old_name=e),h.set(t.node_id,t.node_name),f.set(t.node_id,t.node_value_start);break}case"modify_data":case"move_node":case"pin_node":case"unpin_node":case"remove_node":h.get(t.node_id)?t.node_name=h.get(t.node_id):f.get(t.node_id)?t.node_value_start=f.get(t.node_id):x.has(t.node_id)&&Object.assign(t,x.get(t.node_id));break;case"modify_name":{let e=h.get(t.node_id);e&&t.node_name&&e!==t.node_name&&(t.node_old_name=e),h.set(t.node_id,t.node_name);break}case"revert":v.set(t.version,t.node_id)}}let g=m.findIndex(e=>"create"===e.type);g>=0&&m.splice(g+1,m.length);let b=0;for(let[e,n]of m.entries()){let r=+n.publish_time;if(r&&r>b&&(b=r,t=n),"revert"===n.type){let e=n.node_id;for(;v.has(e);)e=v.get(e);n.node_id=e}n.oldest_version=e===m.length-1}t&&(t.latest_publish=!0);let y=new Map;for(let e of m){let t;t=e.time?(0,te.gE)(e.time,d)?(0,te.vm)(e.time):(0,te.um)(e.time,d)?(0,te.mr)(e.time,{month:"short",day:"numeric"}):(0,te.mr)(e.time,{month:"short",day:"numeric",year:"numeric"}):"Earlier";let n=y.get(t);n?n.push(e):(n=[e],y.set(t,n))}let j=[];for(let[e,t]of y){let n=function(e,t){let n;if(!e.length)return;let r=[];for(let t=0;t<e.length;t++)!function(e,t){let n=t.at(e),r=t.at(e-1);return n&&!tr.has(n.type)&&!!(tn.has(n.type)||0===e||n.merge||n.paused_version||n.first_public_version&&!n.oldest_version||n.publish_time||"create"===n.type&&n.fork||(null==r?void 0:r.time)&&n.time&&r.time.getTime()-n.time.getTime()>6e5)}(t,e)?n?n[1]=t:n=[t,t]:(n&&r.push(n),r.push([t,t]),n=void 0);return n&&r.push(n),{folds:r,events:e,title:t}}(t,e);n&&j.push(n)}return{ranges:j,events:m,userCount:p}}({history:t,forkOf:n,modes:u});return(0,r.jsx)("div",{className:"overflow-y-auto",children:(0,r.jsxs)("div",{className:"jsx-d511b6cc9924123c history pb3",children:[(0,r.jsx)(tt,{}),p.ranges.map((e,t)=>(0,r.jsx)(HistoryRange,{range:e,dispatch:o,isVersioned:!a&&!d,currentVersion:s,isFirst:0===t,focusId:i,id:c},t)),(0,r.jsx)(l(),{id:"d511b6cc9924123c",children:".history.jsx-d511b6cc9924123c{display:grid;grid-template-columns:auto auto auto auto 1fr auto;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center}"})]})})}),tl=(0,L.$j)(e=>{let{notebook:t}=e;return{notebook:t}},e=>({dispatch:e}))(e=>{let{notebook:{autosave:t,id:n,forkOf:a,saveVersion:l,model:{version:s,nodes:o},focusId:i,isPausedLoad:c},dispatch:d}=e,{data:u}=(0,T.h_)("/document/".concat(n,"/history")),p=new Map(o.map(e=>{let{id:t,mode:n}=e;return[t,n]}));return(0,r.jsxs)(q.X,{children:[(0,r.jsx)(q.h,{children:"Version history"}),u?(0,r.jsx)(ta,{history:u,forkOf:a,autosave:t,version:t?s:l,dispatch:d,id:n,focusId:i,isPausedLoad:c,modes:p}):(0,r.jsx)("div",{className:"flex justify-center pa4",children:(0,r.jsx)(W.Z,{})})]})}),ts=c()(()=>Promise.all([n.e(5610),n.e(9671)]).then(n.bind(n,69671)),{loadableGenerated:{webpack:()=>[69671]}});var to=n(98745),ti=n(54687),tc=n(63343),td=n(79941);let tu="var(--moon-gray)",Wire=e=>{let{from:t,to:n,sign:a,yScale:l}=e,s="circular"===(0,td.Do)(t,n);return(0,r.jsx)("path",{d:"M ".concat(3*a," 0 H ").concat(14*a/2," v ").concat(l(t.node,n.node)," h ").concat(a*(s?-1:1)*4),fill:"none",strokeWidth:"2",stroke:"currentColor"})},Preview=e=>{let{node:t,nameClassName:n}=e,a=(0,P.Qc)(t),l=(0,P.u2)(t);!l&&(0,A.hN)(t)&&(l="cell ".concat(t.id));let s=a.id,o=t.value;return s&&(o="".concat(o.slice(0,s.start)," ").concat(o.slice(s.end))),(o=o.trim()).length>255&&(o="".concat(o.slice(0,255),"…")),(0,r.jsxs)("div",{className:"truncate code f7",title:"".concat(l?"".concat(l," "):"").concat(o),children:[l&&(0,r.jsxs)("span",{className:n,children:[l," "]}),o]})},tp=(0,h.memo)(function(e){let{node:t,connections:n,focusedNode:a,participants:s,selected:i,error:c,yScale:d,dispatch:u,onSelect:p,readOnly:m}=e,{id:f}=t,v=n.get(t),{up:x,down:g,isIsland:b}=v,y=(0,h.useRef)(null);(0,tc._)(f,y,void 0,!0,m,u,"minimap-cell","minimap-cells");let j=a?(0,td.Do)(v,n.get(a)):"none",w="same"===j,k="direct downstream"===j||"indirect downstream"===j,C="direct upstream"===j||"indirect upstream"===j,N="direct downstream"===j||"direct upstream"===j;return(0,r.jsxs)("button",{ref:y,"data-cy":j,"data-node-id":f,style:{height:21,fontFamily:"inherit",color:c?"var(--red)":w||N?"var(--blue)":b?tu:a?tu:"black",paddingLeft:45,paddingTop:1,paddingBottom:1},onClick:e=>{e[eI.Ao]?u({type:"selectionToggle",id:f}):p({type:w?"blur":"focus",id:f},{focused:w,downstream:k,upstream:C,direct:N})},className:"jsx-5b348d2ff6ad01ac bg-white minimap-cell br2 bn pv0 pr0 bg-transparent tl w-100 flex relative pointer justify-between items-center",children:[(0,r.jsxs)("div",{style:{boxShadow:i?"inset 0 0 0 1.5px var(--washed-blue)":void 0},className:"jsx-5b348d2ff6ad01ac "+(o()("flex minimap-cell-label h-100 w-100 ph1 items-center moon-gray br2",w?"bg-blue white focused":"")||""),children:[(0,r.jsx)(Preview,{node:t,nameClassName:w?"fw6":N?"blue":a?"":"black"}),s&&(0,r.jsx)("span",{className:"jsx-5b348d2ff6ad01ac ml3",children:(0,r.jsx)(to.l,{size:14,link:!1,participants:s})})]}),(0,r.jsxs)("svg",{style:{overflow:"visible",top:10.5,left:"calc(var( --spacing-extra-small ) + ".concat(17,"px)"),width:30,height:30},className:"jsx-5b348d2ff6ad01ac "+(o()("absolute","z-".concat(w?2:1))||""),children:[(0,r.jsxs)("g",{transform:"translate(".concat(a?k?14:C?-14:0:0,", 0)"),className:"jsx-5b348d2ff6ad01ac",children:[!(a&&"none"===j)&&(0,r.jsxs)("g",{className:"jsx-5b348d2ff6ad01ac",children:[x.length&&(0,r.jsx)("path",{d:"M 0 0 h ".concat(-8),fill:"none",strokeWidth:"2",stroke:"currentColor",className:"jsx-5b348d2ff6ad01ac"}),g.length&&(0,r.jsx)("path",{d:"M 0 0 h ".concat(8),fill:"none",strokeWidth:"2",stroke:"currentColor",className:"jsx-5b348d2ff6ad01ac"})]}),(0,r.jsx)("circle",{r:b?1.5:3,fill:"currentColor",className:"jsx-5b348d2ff6ad01ac"})]}),w&&(0,r.jsxs)("g",{className:"jsx-5b348d2ff6ad01ac pen",children:[g.map((e,t)=>(0,r.jsx)(Wire,{from:v,to:n.get(e),sign:1,yScale:d},t)),x.map((e,t)=>(0,r.jsx)(Wire,{from:v,to:n.get(e),sign:-1,yScale:d},t))]})]}),(0,r.jsx)(l(),{id:"5b348d2ff6ad01ac",children:".minimap-cell.jsx-5b348d2ff6ad01ac:hover .minimap-cell-label.jsx-5b348d2ff6ad01ac:not(.focused){background-color:var(--near-white)}"})]})}),tm=(0,L.$j)(e=>{let{notebook:t,currentUser:n}=e;return{notebook:t,currentUser:n}},e=>({dispatch:e}))(e=>{let{notebook:t,currentUser:n,dispatch:a}=e,{model:l,editorStates:s,participants:o,focusId:i,selectionFocusId:c,selection:d,dropId:u,type:p}=t,{nodes:m}=l,f=(0,eo.os)(t),v=(0,h.useMemo)(()=>(function(e){let t=new Map;for(let n of e){let{node_ids:e}=n;for(let r of e)t.has(r)?t.get(r).push(n):t.set(r,[n])}return t})(o),[o]),x=(0,h.useMemo)(()=>(0,td.E6)(m),[m]),g=(0,h.useMemo)(()=>(e,t)=>(m.indexOf(t)-m.indexOf(e))*21,[m]),b=(0,V.GS)(V.ro),[y,j]=(0,h.useState)(null),w=(null==y?void 0:y.type)==="focus"?(0,H.DY)(l,y.id):(null==y?void 0:y.type)==="blur"?void 0:null!==i?(0,H.DY)(l,i):null!==c?(0,H.DY)(l,c):void 0;function onCellSelect(e,r){b?j(e):a(e),(0,S.MR)((0,S.ym)({type:"notebook:view:minimapClick",data:r,eventVersion:2,notebook:t,currentUser:n}))}let k=(0,h.useRef)(!1);return(0,h.useEffect)(()=>(k.current=!0,()=>{k.current=!1}),[]),(0,h.useEffect)(()=>()=>{y&&!k.current&&a(y)},[a,y]),(0,r.jsxs)(q.X,{children:[(0,r.jsx)(q.h,{children:"Minimap"}),m.length>0?(0,r.jsx)("div",{className:"pa3 mb1 relative minimap-cells",children:m.map(e=>{var t;return(0,r.jsxs)(h.Fragment,{children:[u===e.id&&(0,r.jsx)("div",{className:"absolute bt b--blue",style:{marginTop:-.5,width:"calc(100% - 2 * var( --spacing-medium ))"}}),(0,r.jsx)(tp,{node:e,connections:x,focusedNode:w,selected:d.has(e.id),participants:v.get(e.id),error:!!(null===(t=s.get(e.id))||void 0===t?void 0:t.field(ti.ei).length),yScale:g,onSelect:onCellSelect,dispatch:a,readOnly:f})]},e.id)})}):(0,r.jsxs)("div",{className:"pa3 mid-gray",children:["This ",p," has no cells"]})]})});var th=n(12782),tf=n(3940),tv=n(26281),tx=n(59168),tg=n(80159),tb=n(82959),ty=n(76770),tj=n(11797);let tw=[{type:"assist",title:D.u7,content:()=>(0,r.jsxs)(r.Fragment,{children:[D.u7," can help you build notebooks by generating JavaScript and SQL, fixing errors, and explaining how code works"]})},{type:"help",title:"Want help?",content:()=>(0,r.jsxs)(r.Fragment,{children:["Get started quickly with tutorials in the"," ",(0,r.jsxs)("b",{className:"dark-gray",children:[(0,r.jsx)(tv.Z,{className:"nb1"})," Help"]})," ","pane. You’ll also find shortcuts, docs, and support."]})},{type:"settings",title:"Welcome!",content:()=>(0,r.jsxs)(r.Fragment,{children:["Finish setting up your public profile in"," ",(0,r.jsxs)("b",{className:"dark-gray",children:[(0,r.jsx)(tf.Z,{className:"nb1"})," Settings"]}),"."]})},{type:"insertmenu",title:"Shortcuts",content:()=>(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("p",{children:["Press ",(0,r.jsx)(tg.e,{shortcut:"Mod-Enter"})," to open this menu"]}),(0,r.jsx)("p",{children:"Type to search"}),(0,r.jsxs)("div",{children:["Press ",(0,r.jsx)(tg.e,{shortcut:"Alt-Mod-Enter"})," or double-click"," ",(0,r.jsx)(tx.W,{icon:J.ZP,className:"dark-gray"})," to create a JavaScript cell"]})]})}],tk=(0,ty.$j)(e=>{let{currentUser:t,decorations:n}=e;return{currentUser:t,currentSignpost:n.signpost}},e=>({dispatch:e}))(e=>{let{type:t,top:n,right:a,bottom:l,left:s,children:o,currentUser:i,currentSignpost:c,dispatch:u}=e,p=(0,h.useRef)(null),m=(0,tb.E)(p),f=tw.find(e=>e.type===t),v=null===c&&(0,tj.M)(i,t),[x,g]=(0,h.useState)(!1);return((0,h.useEffect)(()=>{v&&m&&!x&&(g(!0),u({type:"requestSignpost",signpost:t}))},[v,m,x,t,u]),(0,h.useEffect)(()=>{if(x)return()=>u({type:"hideSignpost",signpost:t})},[x,t,u]),c!==t)?null===c&&v?(0,r.jsx)("div",{className:"relative",ref:p,children:o}):(0,r.jsx)(r.Fragment,{children:o}):(0,r.jsxs)("div",{className:"relative",children:[o,(0,r.jsxs)("div",{className:"absolute",style:{top:n,right:a,bottom:l,left:s,filter:"drop-shadow(0 0 10px rgba(0,0,0,0.1))",willChange:"transform"},children:[(0,r.jsxs)("div",{className:"absolute w5 bg-white mid-gray ba b--silver pa3 br2",style:{top:-30,right:void 0!==s?14:void 0,left:void 0!==a?14:void 0},children:[(0,r.jsxs)("div",{className:"flex mb2 near-black",children:[(0,r.jsxs)("div",{className:"flex items-center flex-grow-1 fw6",children:[(0,r.jsx)("span",{className:"bg-light-purple white f7 fw7 pa1 br2 mr2",children:"Tip"}),f.title]}),(0,r.jsx)("button",{className:"flex dark-gray bg-transparent hover-bg-black-05 pointer pa2 nt1 nb1 nr1 bn br-100",title:"Hide tip","aria-label":"Hide tip",onClick:()=>u({type:"dismissSignpost",trigger:"click"}),children:(0,r.jsx)(d.Z,{})})]}),(0,r.jsx)("div",{className:"lh-copy",children:(0,r.jsx)(f.content,{})})]}),(0,r.jsx)("svg",{className:"absolute",style:{top:-20,left:void 0!==s?-16:void 0,right:void 0!==a?-16:void 0},width:"16",height:"40",children:(0,r.jsx)("path",{stroke:"#E8E8E8",fill:"white",transform:void 0!==s?"rotate(180 8,20)":void 0,d:"M15,5 L0,20 L10,30 L15,35"})})]})]})});var tC=n(90271);let tN=c()(()=>n.e(3098).then(n.bind(n,63098)),{loadableGenerated:{webpack:()=>[63098]}}),tS=c()(()=>n.e(847).then(n.bind(n,10847)),{loadableGenerated:{webpack:()=>[10847]}});function getPane(e){let t=tC.j;switch(e){case"help":return{pane:(0,r.jsx)(tN,{}),closeLabel:"help",width:t};case"files":return{pane:(0,r.jsx)(eE,{}),closeLabel:"files",width:t};case"history":return{pane:(0,r.jsx)(tl,{}),closeLabel:"history",width:t};case"guide":return{pane:(0,r.jsx)(tS,{}),closeLabel:"guide",width:t};case"minimap":return{pane:(0,r.jsx)(tm,{}),closeLabel:"minimap",width:tC.l6};case"dependencies":return{pane:(0,r.jsx)(DependenciesPane,{}),closeLabel:"dependencies",width:t};case"insights":return{pane:(0,r.jsx)(ts,{}),closeLabel:"insights",width:t};case"find":return{pane:(0,r.jsx)(e1,{}),closeLabel:"find",width:t};case"databases":return{pane:(0,r.jsx)(DatabasesPane,{}),closeLabel:"databases",width:t};case"aiassist":return{pane:(0,r.jsx)(AIAssistPane,{}),closeLabel:"aiassist",width:1.25*t};case"schedule":return{pane:(0,r.jsx)(th.QY,{}),closeLabel:"schedule",width:t};default:return{pane:null,closeLabel:"",width:0}}}let tL=(0,L.$j)(e=>{let{page:t}=e;return{paneType:t.pane,helpArticlesOpen:t.helpArticlesOpen}},e=>({dispatch:e}))(e=>{let{dispatch:t,paneType:n,helpArticlesOpen:a,panes:s}=e,i=(0,V.GS)(V.ro),{pane:c,closeLabel:u,width:p}=getPane(n),m=(0,L.v9)(e=>e.decorations.bannerProps),h=tC.Lv+m.height;return(0,r.jsxs)("div",{className:l().dynamic([["81931f5aec6a9b7c",[h,V.hs,V.pp,h,tC.Sf,p]]])+" flex fixed z-1",children:[i&&"guide"===n?null:c&&(0,r.jsxs)("div",{className:l().dynamic([["81931f5aec6a9b7c",[h,V.hs,V.pp,h,tC.Sf,p]]])+" mt3-l shadow-1-ns br3 self-start bg-white flex pane",children:[(0,r.jsx)("button",{style:{top:"2px"},onClick:()=>t({type:"dismissPane"}),className:l().dynamic([["81931f5aec6a9b7c",[h,V.hs,V.pp,h,tC.Sf,p]]])+" absolute dn-l dismiss-button pointer pa3 bn bg-transparent z-4",children:(0,r.jsx)(d.Z,{className:o()({white:"guide"===n}),"aria-label":"Close ".concat(u," pane")})}),c]},[n,...a].join()),(0,r.jsx)("div",{className:l().dynamic([["81931f5aec6a9b7c",[h,V.hs,V.pp,h,tC.Sf,p]]])+" gray hover-black mt3 ml1 sidebar animate-all dn db-l",children:s.map(e=>{let{type:a,icon:l,label:s,badgeLabel:o,signpost:i,badgeStyle:d,unimplemented:u,disabled:p}=e,m=!(u||p),h=(0,r.jsx)(Z.Ct,{badgeLabel:o,badgeStyle:d,disabled:!m,colorless:!0,selected:n===a,children:(0,r.jsx)(Z.hU,{icon:l,onClick:m?()=>t({type:"togglePane",pane:a}):void 0,onKeyDown:m?e=>"Escape"===e.key&&t({type:"dismissPane"}):void 0,disabled:!m,selected:n===a,className:"ma2",colorless:!0,solidBackground:!0,title:(0,es.fm)(u?"".concat(s," is not yet implemented"):"".concat(n===a?"Close":"Open"," ").concat(s))})},a);return i&&!c?(0,r.jsx)(tk,{type:i,top:16,left:8,children:h},a):h})}),(0,r.jsx)(l(),{id:"81931f5aec6a9b7c",dynamic:[h,V.hs,V.pp,h,tC.Sf,p],children:".fixed.__jsx-style-dynamic-selector{top:".concat(h,"px;right:var(--spacing-medium);bottom:0}@media ").concat(V.hs,"{.fixed.__jsx-style-dynamic-selector{right:0}}.pane.__jsx-style-dynamic-selector{position:fixed;top:0;right:0;bottom:0;left:0}@media ").concat(V.pp,"{.pane.__jsx-style-dynamic-selector{position:static;max-height:-webkit-calc(100vh - ").concat(h,"px - ").concat(tC.Sf,"px - 38px);max-height:-moz-calc(100vh - ").concat(h,"px - ").concat(tC.Sf,"px - 38px);max-height:calc(100vh - ").concat(h,"px - ").concat(tC.Sf,"px - 38px);width:-webkit-calc(\n              ").concat(p,"px - 2 * var(--spacing-small) - var(--spacing-extra-small) -\n                var(--width-2) \n            );width:-moz-calc(\n              ").concat(p,"px - 2 * var(--spacing-small) - var(--spacing-extra-small) -\n                var(--width-2) \n            );width:calc(\n              ").concat(p,"px - 2 * var(--spacing-small) - var(--spacing-extra-small) -\n                var(--width-2) \n            )}}.dismiss-button.__jsx-style-dynamic-selector{top:0;right:0}")})]})})},63258:function(e,t,n){n.d(t,{aN:function(){return DataSourceSelector},S5:function(){return getMaybeFileSourceDialect}});var r=n(85893),a=n(41269),l=n(27522),s=n(94184),o=n.n(s),i=n(67294),c=n(78460),d=n(26713),u=n(10998),p=n(17),m=n(88447),h=n(51337),f=n(47489),v=n(93327),x=n(74364),g=n(56065),b=n(6359),y=n(20736),j=n(32007),w=n(44911),k=n(29020),C=n(42962),N=n(60147);let TableSelector=e=>{let{node:t}=e,{id:n,data:a,mode:l}=t,{operations:{from:{table:s}}}=a,c=(0,j.M7)(a),d=(0,N.I0)(),{disabled:p}=(0,N.v9)(e=>{let{notebook:t}=e;return{disabled:t.safe||(0,k.os)(t)}}),m=(0,y.GS)(y.pp),[h,f]=(0,i.useState)(),v=(0,i.useRef)();async function setTable(e){d({type:"setDataOperations",id:n,operations:{...w.Zu.defaultNode.data.operations,from:{table:e},...(null==h?void 0:h.dialect)!=="sqlite"&&(null==h?void 0:h.dialect)!=="duckdb"&&{select:{columns:await new b.n4(c,e,l).run(d).then(e=>Array.from(e.keys()),()=>null)},slice:{from:0,to:1e3}}}})}return(0,i.useEffect)(()=>{let e=new b.YG(c);v.current=e,e.run(d).then(t=>{e===v.current&&f(t)},()=>{e===v.current&&f(null)})},[d,c]),h?h.hasDescribeTables?(0,r.jsxs)(x.vz,{"data-cy":"table-selector",value:JSON.stringify(s)||"",className:"flex items-center dark-gray hover-black focus-black-05 br2 br--right mr1",disabled:p,onChange:e=>setTable(JSON.parse(e)),children:[(0,r.jsx)(x.Y4,{children:(0,r.jsxs)("div",{className:o()("inline-flex items-center justify-between w-100",p&&"moon-gray"),children:[(0,r.jsx)("div",{className:"mr1 truncate",style:{maxWidth:m?200:75},children:s?(0,C.Vi)(s):"Select a table…"}),(0,r.jsx)(x.r9,{className:"inline-flex items-center",children:(0,r.jsx)(u.Z,{})})]})}),(0,r.jsx)(TableSelectorPopover,{source:c,table:s})]}):(0,r.jsx)(TableNameInput,{table:s,setTable:e=>setTable(e),disabled:p}):null},TableSelectorPopover=e=>{let{source:t,table:n}=e,a=(0,N.I0)(),s=(0,i.useRef)(),[o,c]=(0,i.useState)(),{isExpanded:d}=(0,l.kR)(),u=(0,y.GS)(y.pp);return(0,i.useEffect)(()=>c(void 0),[t]),(0,i.useEffect)(()=>{if(d){let e=new b.Y2(t);s.current=e,e.run(a).then(t=>{e===s.current&&c(t.sort(C.Tf))},t=>{e===s.current&&console.error("Error fetching list of tables: ",t)})}},[a,d,t]),(0,r.jsx)(x.jI,{style:{marginLeft:-8,maxHeight:"40vh",minWidth:u?250:200,width:"auto"},children:(0,r.jsx)(x.uf,{style:{padding:0,margin:0},children:(0,r.jsxs)("div",{className:"pv12",children:[(0,r.jsx)("div",{className:"gray f7 ph12 pb12",children:"Tables"}),o?o.length?o.map((e,t)=>(0,r.jsx)(x.wt,{className:"flex items-center justify-between nowrap",style:{padding:"2px 12px",margin:0},value:JSON.stringify(e),children:(0,r.jsxs)("span",{className:"flex items-center",title:(0,C.Vi)(e),style:{maxWidth:u?400:150},children:[(0,r.jsx)("span",{className:"truncate",children:(0,C.Vi)(e)}),(0,C.YY)(n,e)&&(0,r.jsx)(p.Z,{className:"ml2 near-black flex-shrink-0"})]})},t)):(0,r.jsx)("div",{className:"ph12 gray","data-cy":"no-tables",children:"No tables found"}):(0,r.jsx)("div",{className:"ph12 dark-gray",children:(0,r.jsx)(g.Z,{})})]})})})},TableNameInput=e=>{let{table:t,setTable:n,disabled:a}=e,l=(0,y.GS)(y.hs),[s,o]=(0,i.useState)(t?(0,C.Vi)(t):"");return(0,r.jsx)("input",{name:"tablename",type:"text","data-cy":"table-input-selector",className:"ba b--light-gray br2 br--right ph2 flex items-center",placeholder:"Enter a table…",value:s,onChange:e=>o(e.target.value.replace(/\s/g,"")),onBlur:()=>n(function(e){let t="",n="",r=[];for(let a=0;a<e.length;a++){let l=e[a];if("."===l){r.push(n),n="";continue}if(0===n.length){if("`"===l||'"'===l||"'"===l){t=l;continue}n+=l;continue}let s=a+1<e.length?e[a+1]:"";if(l===t&&s===t){n+=l,a++;continue}if("\\"===l&&s===t){n+=s,a++;continue}if(l===t){t="";continue}n+=l}return(n&&r.push(n),0===r.length)?null:r.length>2?{database:r[0],schema:r[1],table:r[2]}:r.length>1?{schema:r[0],table:r[1]}:r.length>0?{table:r[0]}:null}(s)),title:s,disabled:a,onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),e.target.blur())},spellCheck:!1,style:{width:l?340:110,marginLeft:-2}})};var S=n(4640),L=n(5146),M=n(7595),R=n(67642),D=n(44966),_=n(32980),Z=n(17616);let DataSourceSelector=e=>{let{node:t}=e,{mode:n,data:{source:l}}=t,s=(0,N.I0)(),[o,c]=(0,i.useState)(),d=(0,i.useRef)();(0,i.useEffect)(()=>{if(null===l.name)d.current=void 0,c(null);else{let e=new b.FJ(l);d.current=e,e.run(s).then(t=>{e===d.current&&c(t)},()=>{e===d.current&&c(null)})}},[s,l]);let u="table"===n&&null!==l.name&&!!o&&!(0,a.yD)(o.dialect);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(SourceSelector,{node:t,right:u}),u&&(0,r.jsx)(TableSelector,{node:t}),(0,r.jsx)("button",{className:"flex items-center bn bg-transparent pointer dark-gray hover-black",title:"Show databases",onClick:()=>s({type:"togglePane",pane:"databases"}),children:(0,r.jsx)(m.Z,{})})]})},SourceSelector=e=>{var t;let{node:n,right:a}=e,{id:l,data:{source:s}}=n,i=(0,N.I0)(),{disabled:c}=(0,N.v9)(e=>{let{notebook:t}=e;return{disabled:t.safe||(0,k.os)(t)}}),d=(0,N.v9)(e=>{let{currentUser:t}=e;return t}),p=(0,y.GS)(y.pp);return(0,r.jsxs)(x.vz,{"data-cy":"data-source-selector",value:JSON.stringify(s),className:o()("flex items-center mr-tiny ml1 focus-black-05 dark-gray hover-black",a&&"br--left"),disabled:c,onKeyDown:e=>{"Space"!==e.key&&"Enter"!==e.key||e.metaKey||e.ctrlKey||e.preventDefault()},onChange:e=>{let t=JSON.parse(e);(0,j.U_)(s,t)||i({type:"setDataSource",id:l,source:t})},children:[(0,r.jsx)(x.Y4,{className:"flex items-center",children:(0,r.jsxs)("div",{className:o()("inline-flex items-center justify-between",c&&"moon-gray"),children:[(0,r.jsx)("div",{className:"mr1 truncate",style:{maxWidth:p?200:75},children:null!==(t=s.name)&&void 0!==t?t:"Select a data source…"}),(0,r.jsx)(x.r9,{className:"inline-flex items-center",children:(0,r.jsx)(u.Z,{})})]})}),(0,r.jsx)(SourceSelectorPopover,{node:n,currentUser:d})]})};function getMaybeFileSourceDialect(e){let{name:t,mimeType:n}=e;switch(n){case"application/x-sqlite3":return"sqlite";case"text/csv":return"csv";case"text/tab-separated-values":return"tsv";case"application/json":return"json";default:if(/\.arrow$/i.test(t))return"arrow";if(/\.parquet$/i.test(t))return"parquet"}return null}let SourceSelectorPopover=e=>{let{node:t,currentUser:n}=e,{id:a,mode:s,data:{source:o},name:c}=t,d=(0,N.I0)(),u=(0,y.GS)(y.pp),{isExpanded:p}=(0,l.kR)(),m=(0,i.useRef)(),{allowPrivateData:h,allowAddDatabase:f,allowAddAttachments:v,readOnly:g,owner:b,files:C}=(0,N.v9)(e=>{let{notebook:t}=e,r=(0,k.cE)(t);return{allowPrivateData:r,allowAddDatabase:r&&(0,Z.NF)(t),allowAddAttachments:(0,M.j5)(n,t),readOnly:(0,k.os)(t),owner:t.owner,files:t.files}}),{data:E}=(0,L.h_)(h&&p&&(0,w.KO)(s)?"".concat("team"===b.type?"/team/".concat(b.id):"/user","/data-connectors?detail=false"):null),[T,F]=(0,i.useState)([]),V="cell"===o.type&&!T.some(e=>e.name===o.name),I=("database"===o.type||"DatabaseClient"===o.type)&&!(null==E?void 0:E.some(e=>e.name===o.name)),H="FileAttachment"===o.type&&!C.has(o.name),A=(0,i.useMemo)(()=>{let e=[];for(let[t,n]of C){let r=getMaybeFileSourceDialect(n);null!==r&&!(0,k.Jw)(n)&&("chart"===s?("csv"===r||"tsv"===r||"json"===r)&&e.push({name:t,type:"FileAttachment",dialect:r,fileType:r,inPrivateBucket:null!==n.privateBucketId}):e.push({name:t,type:"FileAttachment",dialect:r,inPrivateBucket:null!==n.privateBucketId}))}return e},[C,s]);return(0,i.useEffect)(()=>{if(!p)return;let e=[],t=new S.S(async(n,r)=>{n({type:"request_data_sources",mode:s});try{for await(let n of r()){if(m.current!==t)return;let{name:r,dialect:a}=n;if(r===c)continue;let l={name:"".concat(r),type:"cell",dialect:(0,j.Ov)(a)};e.push(l),e.sort(j.zO),F(e.slice())}}catch(e){console.error("Error fetching database clients: ",e)}});return m.current=t,t.run(d).catch(e=>{console.error("Error fetching database clients: ",e),F([])}),()=>{m.current=void 0,F([])}},[s,d,p,c]),(0,r.jsx)(x.jI,{style:{minWidth:u?"10vw":"40vw",width:"auto",marginLeft:-8,maxHeight:"40vh"},"aria-label":"List of data sources",children:(0,r.jsxs)(x.uf,{style:{padding:0,margin:0},children:[(T.length>0||V||!(0,w.KO)(s))&&(0,r.jsx)("div",{className:"bb b--light-silver pv12",children:(0,r.jsx)(SourceList,{sources:T,stale:!!V,sectionTitle:"Cells",source:o,mode:s})}),(!g&&v||A.length>0)&&(0,r.jsx)("div",{className:"bb b--light-silver pv12",children:(0,r.jsx)(SourceList,{sources:A,stale:!!H,sectionTitle:"File attachments",source:o,mode:s,addDisabled:g||!v,onAdd:()=>{(0,_.Yb)(n)?(d({type:"notebookFilePickerOpened",source:"filesPane",trigger:"click"}),(0,R.Z)({multiple:!1}).then(e=>{if(d({type:"attachLocalFiles",files:e,source:"filesPane",trigger:"click"}),e.length>0){let t=e[0],n={name:t.name,mimeType:t.type,createTime:new Date(t.lastModified),status:"pending"},r=getMaybeFileSourceDialect(n);if(r){let e={name:t.name,type:"FileAttachment",dialect:r};d({type:"setDataSource",id:a,source:e})}}})):n||d({type:"showModal",modal:"login",modalProps:{loginReason:"files"},trigger:"click",source:"filesPaneAttachFileButton"})}})}),(0,w.KO)(s)&&(0,r.jsx)("div",{className:"pv12",children:(0,r.jsx)(SourceList,{sources:E?E.map(e=>{let{name:t,type:n}=e;return{name:t,type:"DatabaseClient",dialect:n}}):[],stale:!!I,sectionTitle:"Databases",source:o,mode:s,link:"/".concat("team"===b.type?"team/@".concat(b.login,"/"):"","settings/databases"),onAdd:()=>d({type:"addedDatabase",id:a}),addDisabled:!f})})]},[(0,D.Z)(T),(0,D.Z)(C),E&&(0,D.Z)(E)].join())})},SourceList=e=>{let{sources:t,stale:n,source:a,sectionTitle:l,link:s="",onAdd:o=()=>{},addDisabled:i=!0}=e,{isPublic:u,hasActiveBucket:m,privateBucketError:f}=(0,N.v9)(e=>{let{notebook:t,currentUser:n}=e;return{isPublic:(0,k.HW)(t),hasActiveBucket:(0,k.uT)(n,t.owner),privateBucketError:(0,Z.xT)(n,t.owner)}}),g=(0,y.GS)(y.pp),b={maxWidth:g?350:150};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"dark-gray f7 ph12 flex justify-between items-center",style:{marginBottom:t.length>0?10:0},children:[l,"Databases"===l&&!i&&(0,r.jsx)("button",{className:"bn bg-transparent pa0 ma0",onClick:o,children:(0,r.jsx)(v.Z,{href:s,children:(0,r.jsx)("div",{className:"pointer pa2 nt2 nb2 f6 fw6 br-100 flex items-center ba b--transparent hover-bg-black-05",children:(0,r.jsx)(h.ZP,{})})})}),"File attachments"===l&&!i&&(0,r.jsx)(d.hU,{onClick:o,icon:h.ZP,"aria-label":"Upload file",colorless:!0,className:"nt2 nb2"})]}),t.map((e,t)=>(0,r.jsxs)(x.wt,{className:"flex items-center justify-between nowrap",style:{padding:"2px 12px",margin:0},value:JSON.stringify(e),children:[(0,r.jsx)("span",{className:"flex items-center overflow-x-hidden",title:e.name,style:b,children:e.inPrivateBucket&&(u||!m||f)?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(c.Z,{className:"w1 h1 mr1 white bg-red b--red flex-no-shrink br-pill","aria-label":"Private file"}),(0,r.jsx)("span",{className:"truncate red",children:e.name}),(0,j.U_)(a,e)&&(0,r.jsx)(p.Z,{className:"ml1 red flex-shrink-0"})," "]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{className:"truncate",children:e.name}),(0,j.U_)(a,e)&&(0,r.jsx)(p.Z,{className:"ml1 near-black flex-shrink-0"})]})}),(0,r.jsx)("span",{className:"mid-gray fw4 ml4",children:(0,j.w4)(e.dialect)})]},t)),n?(0,r.jsx)(StaleListboxOption,{source:a,style:b}):t.length||"Cells"!==l?null:(0,r.jsx)("div",{className:"i gray ph3 pt2",children:"Add data to a cell in your notebook"})]})},StaleListboxOption=e=>{let{source:t,style:n}=e;return(0,r.jsx)(x.wt,{className:"flex items-center justify-between nowrap gray",style:{padding:"2px 12px",margin:0},value:JSON.stringify(t),children:(0,r.jsxs)("span",{className:"flex items-center overflow-x-hidden",title:t.name,style:n,children:[(0,r.jsx)("span",{className:"truncate",children:t.name}),(0,r.jsx)(p.Z,{className:"ml1 flex-shrink-0"}),(0,r.jsx)(f.Z,{className:"ml1 flex-shrink-0"})]})})}},49847:function(e,t,n){n.d(t,{V:function(){return ew}});var r=n(85893),a=n(5379),l=n.n(a),s=n(41269),o=n(94184),i=n.n(o),c=n(67294),d=n(15100),u=n(91696),p=n(51337),m=n(71820),h=n(20637),f=n(24067),v=n(94988),x=n(26281),g=n(88903),b=n(36869);let y={sample:{label:null,link:null,examples:[{label:"Reference a cell value",value:"CELL_NAME",readonly:!0},{label:"Reference column",value:'row["COLUMN"]'},{label:"Currency to number",value:'+row["COLUMN"].replace("$", "")'},{label:"Keep only digits",value:"row[\"COLUMN\"].replace(/\\D/g,'')"},{label:"Extract before",value:'row["COLUMN"].split("A")[0]'}]},string:{label:"String operations",link:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String",examples:[{label:"At",value:'row["COLUMN"].at("A")'},{label:"Concat",value:'row["COLUMN"].concat("A")'},{label:"Ends with",value:'row["COLUMN"].endsWith("A")'},{label:"Includes",value:'row["COLUMN"].includes("A")'},{label:"Replace",value:'row["COLUMN"].replace("A", "B")'},{label:"Slice",value:'row["COLUMN"].slice(N)'},{label:"Split",value:'row["COLUMN"].split("expr")[0]'},{label:"Substring",value:'row["COLUMN"].substr(N, N)'},{label:"To Lowercase",value:'row["COLUMN"].toLowerCase()'},{label:"Trim whitespace",value:'row["COLUMN"].trim()'}]},number:{label:"Number operations",link:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math",examples:[{label:"Absolute value",value:'Math.abs(row["COLUMN"])'},{label:"Ceiling",value:'Math.ceil(row["COLUMN"])'},{label:"Cosine",value:'Math.cos(row["COLUMN"])'},{label:"Floor",value:'Math.floor(row["COLUMN"])'},{label:"Log",value:'Math.log(row["COLUMN"])'},{label:"Max",value:'Math.max(row["COLUMN"], VALUE)'},{label:"Random",value:"Math.random()"}]},date:{label:"Date operations",link:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date",examples:[{label:"Get hour",value:'row["COLUMN"].getUTCHour()'},{label:"Get day of month",value:'row["COLUMN"].getUTCDate()'},{label:"Get year",value:'row["COLUMN"].getUTCFullYear()'},{label:"Get day of the week",value:'d3.utcFormat("%A")(row["COLUMN"])'},{label:"Get month name",value:'d3.utcFormat("%B")(row["COLUMN"])'}]}},CodeExampleMenu=()=>{let[e,t]=(0,c.useState)(""),n=(0,c.useMemo)(()=>(0,b.v)(e),[e]),exampleFilter=e=>n.test(e.label)||n.test(e.value);return(0,r.jsxs)(g.v2,{children:[(0,r.jsx)(g.j2,{className:"bg-near-white bn pointer moon-gray flex items-center",style:{width:29,height:29},children:(0,r.jsx)(x.Z,{})}),(0,r.jsx)(g.YI,{children:(0,r.jsxs)("div",{className:"bg-white b--silver mt2 ba br2 shadow-4 outline-0",children:[(0,r.jsx)("div",{className:"bb b--silver pa2",children:"Write an expression to be evaluated once per row."}),(0,r.jsxs)("div",{className:"flex items-center pa2",children:[(0,r.jsx)("div",{className:"gray f7 mb2",style:{width:"150px"},children:"Examples"}),(0,r.jsx)("div",{style:{flex:1},className:"near-black lh-copy relative flex items-center bg-near-white",children:(0,r.jsx)(f.x,{type:"text",placeholder:"Search examples...",value:e,onChange:e=>{let{target:{value:n}}=e;return t(n)},className:"flex-auto bg-transparent bn",style:{backgroundColor:"var(--near-white)"},leftElement:(0,r.jsx)(m.Z,{className:"db moon-gray bg-near-white bn"})})})]}),(0,r.jsx)("div",{style:{maxHeight:200},className:"ph2 overflow-y-scroll",children:Object.entries(y).map(e=>{let[t,{label:a,link:l,examples:s}]=e,o=n.test(t)?s:s.filter(exampleFilter);return o.length?(0,r.jsxs)("div",{children:[a&&(0,r.jsx)("div",{className:"bt b--silver pt2 gray",children:a}),o.map(e=>{let{label:t,value:n,readonly:a}=e;return(0,r.jsxs)("div",{className:"pv1 mv2 flex copy-container f6",children:[(0,r.jsx)("div",{style:{width:"150px"},children:t}),(0,r.jsxs)("div",{className:"ml1 code flex",children:[(0,r.jsx)("code",{dangerouslySetInnerHTML:{__html:h.Z.highlight(n,{language:"js"}).value}}),!0!==a&&(0,r.jsx)("button",{className:"copy mr-auto bg-transparent nt1 nb1 squishy pointer bn gray flex items-center br2",title:"Copy derivation code",onClick:e=>{e.stopPropagation(),navigator.clipboard.writeText(n)},children:(0,r.jsx)(v.Z,{})})]})]},t)}),l&&(0,r.jsx)("div",{className:"gray f7 mb2",children:(0,r.jsxs)("a",{href:l,target:"_blank",rel:"noreferrer",children:["See JavaScript docs for additional ",t," methods and information"]})})]},t):null})})]})})]})};var j=n(45383),w=n(58037),k=n(59119),C=n(78120),N=n(14456),S=n(35524);let L=N.tk.theme({"&":{color:"var(--syntax-normal)",wordBreak:"break-word",borderLeft:"solid ".concat(4,"px transparent")},"&.cm-focused":{outline:"none !important"},"&.cm-focused .cm-activeLine":{borderLeft:"solid ".concat(4,"px var(--observable-focus-blue)"),marginLeft:"-".concat(4,"px")},"&.cm-focused .cm-activeLine.cm-errorLine":{borderLeftColor:"var(--dark-red)"},"&.cm-focused .cm-matchingBracket":{backgroundColor:"transparent",color:"var(--syntax-matchbracket)"},".cm-scroller":{font:"var(--monospace-font)",overflow:"initial"},".cm-matchingBracket, &:not(.cm-focused) .cm-selectionMatch":{backgroundColor:"transparent"},".cm-line":{padding:"0 2px 0 4px","&:first-child":{marginRight:"20px"}},".cm-activeLine":{backgroundColor:"inherit"},".cm-matchingBracket, .cm-nonmatchingBracket":{color:"inherit"}}),FormulaEditor=e=>{let{editingColumnName:t,setFormula:n,formula:a,saveDeriveColumn:l}=e,s=(0,c.useMemo)(()=>new C.F6,[]),o=(0,c.useRef)(null),[i,d]=(0,c.useState)(),u=(0,c.useCallback)(e=>{l(t,e)},[t,l]);return(0,c.useEffect)(()=>{var e;let t=N.tk.updateListener.of(e=>{e.docChanged&&n(e.state.doc.toString())}),r=C.yy.create({extensions:[(0,w.eJ)(),(0,j.m8)(),(0,k.nF)(S.$d),L,t,(0,N.W$)("Column formula..."),C.yy.transactionFilter.of(e=>e.newDoc.lines>1?[]:e),s.of(N.$f.of([...j.wQ,...j.f$]))]}),a=new N.tk({state:r});return d(a),null===(e=o.current)||void 0===e||e.appendChild(a.dom),a.focus(),()=>{a.destroy()}},[n,s]),(0,c.useEffect)(()=>{void 0!==i&&(0===i.state.doc.length&&a?i.dispatch({changes:{from:0,to:i.state.doc.length,insert:a},selection:{anchor:a.length}}):void 0===a&&i.dispatch({changes:{from:0,insert:'row["COLUMN"]'},selection:{anchor:5,head:11}}))},[i,a]),(0,c.useEffect)(()=>{null==i||i.dispatch({effects:s.reconfigure(N.$f.of([...j.wQ,...j.f$,{key:"Shift-Enter",run:e=>(u(e.state.doc.toString()),!1)}]))})},[i,u,s]),(0,r.jsx)("div",{ref:o})};var M=n(7138),R=n(80583),D=n(71183),_=n(42962),Z=n(60147);let TableBodyCellMenu=e=>{let{node:t,value:n,formattedValue:a,displayValue:l,columnName:s,columnSummary:o,error:c}=e,d=(0,_.O$)(o.type,n),u=(0,Z.I0)();return(0,r.jsxs)(R.v2,{children:[(0,r.jsxs)(g.j2,{className:i()(o.type,c&&"mid-gray bg-lightest-red flex items-center","w-100 h-100 bn bg-transparent pointer"),title:a,style:{font:"inherit",fontVariantNumeric:"inherit",padding:"4px 6px",textAlign:"inherit"},children:[c&&(0,r.jsx)(D.Z,{washed:!0,width:14,height:14,className:"mr1"}),l]}),(0,r.jsx)(R.YI,{className:"bg-white ba b--silver br2 shadow-4 outline-0 overflow-auto","data-cy":"cell-filter-popover",children:(0,r.jsxs)(g.sd,{children:[(0,r.jsx)(g.sN,{onSelect:async()=>await navigator.clipboard.writeText(a),children:(0,r.jsxs)("div",{className:"flex items-center pv1",children:[(0,r.jsx)(v.Z,{className:"mr1"}),"Copy value"]})}),(0,r.jsx)("div",{className:"bt b--light-gray"}),(0,r.jsxs)("div",{className:"gray ph3 pv2 f7",children:["Filter ",(0,r.jsx)("span",{className:"fw6",children:s})," by value"]}),d.map(e=>(0,r.jsx)(g.sN,{style:{fontWeight:500,maxWidth:300},onSelect:()=>{var r;let a;return r=o.type,void(a="v"===e||"nv"===e?{type:"primitive",value:r}:"date"===o.type?{type:"date",value:Number(n)}:{type:"primitive",value:n},u({id:t.id,type:"setDataOperations",operations:{filter:[...t.data.operations.filter,{type:e,operands:[{type:"column",value:s},a]}]}}))},children:(0,r.jsx)("div",{className:"truncate",children:"".concat((0,_.a8)(e,o.type)).concat("v"!==e&&"nv"!==e?" ".concat(a):"")})},e))]})})]})},E=(0,c.memo)(function(e){let{data:t,node:n,summary:a,hoveredCell:s,setHoveredCell:o,colWidths:c,searchInfo:d,editingColumn:u,allowDerivedColumns:p}=e,{mode:m}=n;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("tbody",{className:l().dynamic([["7c0ce4f72d0d3120",[p?"td:nth-last-child(3) {\n              border-right: 1px solid var(--light-silver);\n            }":""]]])+" "+(i()("table"===m&&"pointer")||""),children:null==t?void 0:t.rows.map((e,h)=>{let f=new Map(d?d[h].matches:[]);return(0,r.jsxs)("tr",{"data-cy":"cell-table-result-row",onPointerEnter:()=>o({row:h}),onPointerLeave:()=>o(void 0),className:l().dynamic([["7c0ce4f72d0d3120",[p?"td:nth-last-child(3) {\n              border-right: 1px solid var(--light-silver);\n            }":""]]]),children:[(0,r.jsx)("td",{className:l().dynamic([["7c0ce4f72d0d3120",[p?"td:nth-last-child(3) {\n              border-right: 1px solid var(--light-silver);\n            }":""]]]),children:d?d[h].index:h}),a&&Array.from(a.columns,(a,d)=>{var v,x;let[g,b]=a,y=null===(v=t.operations.sort)||void 0===v?void 0:v.find(e=>{let{column:t}=e;return t===g}),j=(0,_.t2)(g,t.operations),w=y||j,k=u===g,C=e[g],N=(0,M.getTypeValidator)(b.type),S=N(C)?(0,_.QI)(b.type)(C):C instanceof Error?"<unavailable>":"".concat(C),L=f.get(g)?function(e,t){if(!e)return e;let n=new Set(t.map(e=>Array.from({length:e[1]-e[0]},(t,n)=>n+e[0])).flat()),a=[];for(let t=0;t<e.length;t++){let r=n.has(t),l=a.length>0?a[a.length-1]:null;(null==l?void 0:l.highlighted)===r?l.part+=e[t]:a.push({highlighted:r,part:e[t]})}return a.map((e,t)=>{let{highlighted:n,part:a}=e;return n?(0,r.jsx)("span",{className:"b",children:a},"".concat(a).concat(t)):a})}(S,f.get(g)):S,R=(null==c?void 0:c.get(g))||150,Z=(null==s?void 0:s.column)===g&&s.row===h,E=null===(x=b.errors)||void 0===x?void 0:x.get(h),T="table"===m&&Z&&!k;return(0,r.jsx)("td",{style:T?{backgroundColor:"var(--light-silver)",border:"1px solid var(--moon-gray)"}:void 0,title:null!=E?E:7*S.length>R?S:void 0,onPointerEnter:()=>o({column:g,row:h}),onPointerLeave:()=>o(void 0),className:l().dynamic([["7c0ce4f72d0d3120",[p?"td:nth-last-child(3) {\n              border-right: 1px solid var(--light-silver);\n            }":""]]])+" "+(i()(E?"bg-washed-red":k?(null==s?void 0:s.row)===h?"bg-observable-focus-light-blue":"bg-observable-focus-lightest-blue":w?"bg-washed-yellow":"",b.type,N(C)&&""!==C?"":"gray fw4",E&&"error")||""),children:T?(0,r.jsx)(TableBodyCellMenu,{node:n,value:C,formattedValue:S,displayValue:L,columnName:g,columnSummary:b,error:E}):E?(0,r.jsxs)("div",{style:{padding:"4px 6px"},className:l().dynamic([["7c0ce4f72d0d3120",[p?"td:nth-last-child(3) {\n              border-right: 1px solid var(--light-silver);\n            }":""]]])+" flex items-center mid-gray",children:[E&&(0,r.jsx)(D.Z,{washed:!0,width:14,height:14,className:"mr1"}),L]}):(0,r.jsx)("div",{style:{padding:"4px 6px"},className:l().dynamic([["7c0ce4f72d0d3120",[p?"td:nth-last-child(3) {\n              border-right: 1px solid var(--light-silver);\n            }":""]]]),children:L})},d)}),(0,r.jsx)("td",{style:{width:"99%",...p?{borderLeft:"none",borderRight:"none"}:null},className:l().dynamic([["7c0ce4f72d0d3120",[p?"td:nth-last-child(3) {\n              border-right: 1px solid var(--light-silver);\n            }":""]]])}),"table"===m&&p&&(0,r.jsx)("td",{style:{width:"40px",borderLeft:"none"},className:l().dynamic([["7c0ce4f72d0d3120",[p?"td:nth-last-child(3) {\n              border-right: 1px solid var(--light-silver);\n            }":""]]])})]},h)})}),(0,r.jsx)(l(),{id:"7c0ce4f72d0d3120",dynamic:[p?"td:nth-last-child(3) {\n              border-right: 1px solid var(--light-silver);\n            }":""],children:"tbody.__jsx-style-dynamic-selector{max-height:300px;overflow-y:scroll}td.__jsx-style-dynamic-selector{padding:0px;border:1px solid var(--light-silver);border-bottom:solid 1px transparent;border-right:solid 1px transparent;white-space:nowrap;overflow:hidden;-o-text-overflow:ellipsis;text-overflow:ellipsis}tr.__jsx-style-dynamic-selector:hover{background-color:var(--near-white)}tr.__jsx-style-dynamic-selector:hover>td.error.__jsx-style-dynamic-selector{background-color:var(--lightest-red)}tr.__jsx-style-dynamic-selector:first-child td.__jsx-style-dynamic-selector{border-top:solid 1px transparent}td.__jsx-style-dynamic-selector:first-child{border-left:none}td.__jsx-style-dynamic-selector:nth-child(1){text-align:center;color:var(--moon-gray);padding:0 4px}.number.__jsx-style-dynamic-selector,.integer.__jsx-style-dynamic-selector,.bigint.__jsx-style-dynamic-selector{text-align:right}.number.__jsx-style-dynamic-selector,.integer.__jsx-style-dynamic-selector,.bigint.__jsx-style-dynamic-selector,.date.__jsx-style-dynamic-selector{font-variant-numeric:tabular-nums}".concat(p?"td:nth-last-child(3) {\n              border-right: 1px solid var(--light-silver);\n            }":"","\n      ")})]})});var T=n(73507),columnSort=e=>{let{direction:t,...n}=e;return(0,r.jsxs)("svg",{width:"8",height:"12",viewBox:"0 0 8 12",fill:"none",...n,children:[(0,r.jsx)("path",{d:"M2.08062 5.5L5.91938 5.5C6.75788 5.5 7.22405 4.53007 6.70024 3.8753L4.78087 1.47609C4.38054 0.975679 3.61946 0.97568 3.21913 1.47609L1.29976 3.87531C0.775945 4.53007 1.24212 5.5 2.08062 5.5Z",fill:"asc"===t?"var(--dark-blue)":"desc"===t?"var(--faint-blue)":"var(--washed-blue)"}),(0,r.jsx)("path",{d:"M5.91938 6.5H2.08062C1.24212 6.5 0.775946 7.46993 1.29976 8.1247L3.21913 10.5239C3.61946 11.0243 4.38054 11.0243 4.78087 10.5239L6.70024 8.12469C7.22405 7.46993 6.75788 6.5 5.91938 6.5Z",fill:"desc"===t?"var(--dark-blue)":"asc"===t?"var(--faint-blue)":"var(--washed-blue)"})]})},F=n(84372),V=n(27554),I=n(47213),H=n(28857),A=n(69583),P=n(61091);let ColumnNameInput=e=>{var t;let{dispatch:n,id:a,nodeData:s,name:o,schema:d}=e,[u,p]=(0,c.useState)(o),[m,h]=(0,c.useState)(),f=(0,c.useRef)(null),v=null===(t=s.operations.derive)||void 0===t?void 0:t.some(e=>e.name===o);function rename(e){var t,r;if(0===e.length){p(o);return}let l=null!==(t=s.operations.names)&&void 0!==t?t:[],i=new Map(l.map(e=>{let{column:t,name:n}=e;return[t,n]})),c=l.map(e=>{let{name:t}=e;return t}).concat(d?Array.from(d.keys()).filter(e=>!i.has(e)):[]),u=(0,P.Q)(e,new Set(c)),m=null===s.operations.select.columns&&(null==d?void 0:d.size)?Array.from(d.keys()):s.operations.select.columns;if(v)n({id:a,type:"setDataOperations",operations:{select:{columns:m?m.map(e=>e===o?u:e):null},derive:null===(r=s.operations.derive)||void 0===r?void 0:r.map(e=>e.name===o?{...e,name:u}:e)}});else{let e=l.find(e=>{let{name:t}=e;return t===o}),t=e?e.column:o;n({id:a,type:"setDataOperations",operations:{select:{columns:m},names:[...l.filter(e=>{let{column:n}=e;return n!==t}),...t!==u?[{column:t,name:u}]:[]]}})}}return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("input",{ref:f,type:"text",maxLength:256,value:u,placeholder:o,onKeyDown:e=>{if("Enter"===e.key){let t=e.target;t.value!==o&&rename(t.value),t.blur()}},onFocus:()=>h(!0),onBlur:e=>{e.target.value!==o&&rename(e.target.value),h(!1)},onChange:e=>p("".concat(e.target.value)),className:"jsx-bc569f74a99de77c "+(i()(m&&"w-100","dark-gray truncate b br1 ph0 mv1 bg-transparent")||"")}),m&&!v&&(0,r.jsx)("button",{onMouseDown:e=>e.preventDefault(),onClick:()=>{var e,t,r;let l=null===(e=s.operations.names)||void 0===e?void 0:e.find(e=>{let{name:t}=e;return t===o});p(null!==(t=null==l?void 0:l.column)&&void 0!==t?t:o),l&&n({id:a,type:"setDataOperations",operations:{names:null===(r=s.operations.names)||void 0===r?void 0:r.filter(e=>{let{name:t}=e;return t!==o})}})},className:"jsx-bc569f74a99de77c bn bg-transparent gray pointer",children:(0,r.jsx)(A.Z,{height:14,width:14})}),(0,r.jsx)(l(),{id:"bc569f74a99de77c",children:"input.jsx-bc569f74a99de77c{border:none}input.jsx-bc569f74a99de77c:hover,input.jsx-bc569f74a99de77c:focus{-webkit-box-shadow:0 0 0 1px var(--light-gray);-moz-box-shadow:0 0 0 1px var(--light-gray);box-shadow:0 0 0 1px var(--light-gray)}input.jsx-bc569f74a99de77c::-webkit-input-placeholder{color:var(--gray)}input.jsx-bc569f74a99de77c:-moz-placeholder{color:var(--gray)}input.jsx-bc569f74a99de77c::-moz-placeholder{color:var(--gray)}input.jsx-bc569f74a99de77c:-ms-input-placeholder{color:var(--gray)}input.jsx-bc569f74a99de77c::-ms-input-placeholder{color:var(--gray)}input.jsx-bc569f74a99de77c::placeholder{color:var(--gray)}"})]})};var O=n(2461),B=n(88398),U=n(18776),z=n(83062),W=n(918),q=n(23838);let SummaryText=e=>{let{color:t="var(--observable-mid-gray)",text:n="Some values",backgroundColor:a="#E2E2E2",borderColor:l="#E2E2E2",height:s=30,width:o=160}=e;return(0,r.jsx)("div",{className:"tc observable-mid-gray fw4 sans-serif",style:{height:s,width:o,padding:"5px",border:"1px solid ".concat(l),backgroundColor:a,color:t,marginTop:"4px",borderRadius:"5px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},title:n,children:n})};var G=n(19799),Y=n(38887),K=n(36978),X=n(85235),$=n(96199),J=n(66549),Q=n(22828),ee=n(26599),et=n(84839),en=n(62841);let er={empty:{background:"rgba(211, 152, 23, .4)",rect:"rgb(211, 152, 23)",text:"#8D640D",stroke:"none"},unique:{background:"#E2E2E2",rect:"#E2E2E2",text:"#6E6E6E",stroke:"#E2E2E2"},default:{background:"rgba(123,146,209, .4)",rect:"rgba(123,146,209)",text:"#2B50B0",stroke:"#97BBF4"}};function countFormat(e){let t=(0,G.WU)(",");return t(e)}function getHoverText(e,t){return"".concat(countFormat(e)," ").concat(1===e?"row":"rows","  (").concat(function(e){let t=(0,G.WU)(".2p");return"100%"===t(e)&&1!==e?">99%":t(e)}((e||t)/t),")")}let Histogram=e=>{var t,n,a,l,s,o;let{name:i,colSummary:d,colFilteredSummary:u,ready:p,formatter:m=String,hoveredValue:h,filters:f,setOperations:v,sendOperationsAnalyticsEvent:x,setChartLabel:g}=e,[b,y]=(0,c.useState)(-1),{numMissing:j,nRows:w,type:k,data:C}=d,{data:N,numMissing:S}=null!=u?u:{},pointerMove=e=>{var t;let n=e.nativeEvent.offsetX>F.range()[1]?j>0?-2:-1:D?0:(0,O.ml)(Z,F.invert(e.nativeEvent.offsetX))-1;y(n);let r=-2===n?j:null===(t=C[n])||void 0===t?void 0:t.count;g(r?getHoverText(r,w):void 0)},L=(0,c.useRef)(null);function UnderBar(e){let{x:t}=e;return(0,r.jsx)("rect",{x:t,width:I,height:2,fill:"black",y:31,pointerEvents:"none"})}let R=0===C.length&&j>0,D=1===C.length&&C[0].x1===C[0].x2,_=R||D&&0===j,{x1:Z,xMin:E,xMax:T,xScale:F,yScale:V,binWidth:I}=(0,c.useMemo)(()=>{var e,t;let n=C.map(e=>e.x1),r=0===j?130:130/(C.length+2)*C.length,a=null!==(e=(0,B.Z)(C,e=>e.x1))&&void 0!==e?e:0,l=null!==(t=(0,U.Z)(C,e=>e.x2))&&void 0!==t?t:1,s=(0,W.Z)().domain([a,l]).range([0,r]),o=C.length?D?r:s(C[0].x2)-s(C[0].x1)-1:0,i=(0,U.Z)([j||0,(0,U.Z)(C,e=>e.count)||0]),c=(0,W.Z)().domain([0,i]).range([30,0]);return{x1:n,xMin:a,xMax:l,xScale:s,yScale:c,binWidth:o}},[C,130,30,j,D]),H="symbol"!=typeof h,A=(0,M.getTypeValidator)(k),P=!A(h,k),ea=f&&f.filter(e=>e.operands[0].value===i&&"nv"===e.type).length>0,el=-1===b?null:-2===b?{x1:F.invert(+F.range()[1]+I),x2:F.invert(130),count:j}:C[b],es=(s=b<0?E:null==el?void 0:el.x1,o=b<0?T:null==el?void 0:el.x2,"date"===k?e=>{var t,n;return(t=new Date(s||0),(n=new Date(o||0))>Y.ol.offset(t)?(0,en.g0)("'%y"):n>K.me.offset(t)?(0,en.g0)("%b '%y"):n>X.pI.offset(t)?(0,en.g0)("%b %e"):n>$.AN.offset(t)?(0,en.g0)("%a %e"):n>J.lM.offset(t)?(0,en.g0)("%I %p"):n>Q.rz.offset(t)?(0,en.g0)("%I:%M"):n>ee.E.offset(t)?(0,en.g0)(":%S"):n>et.A.offset(t)?(0,en.g0)(".%L"):(0,en.g0)("%a %e"))(e)}:e=>(function(e,t,n){let r;switch(n){case"integer":case"bigint":if(r=(0,G.WU)("d"),t-e<=30)return e=>r(e-1e-12);break;case"number":r=(0,G.WU)("~f");break;default:throw Error("Unsupported number type: ".concat(n))}let a=Math.max(...[e,t].map(Math.abs));if(a<10||a>=1e4){let n=a<1?"~f":"~s";for(let a=2;a<8&&(r=(0,G.WU)(",.".concat(++a).concat(n)))(e)===r(t);++a);}return r})(s||0,o||0,k)(e));function drawRects(e,t,n){return(0,r.jsxs)("g",{children:[t>0&&(0,r.jsx)("rect",{x:+F.range()[1]+I,width:I,height:Math.max(1,V(0)-V(t)),y:Math.min(V(t),V(0)-1),fill:null!=n?n:er.empty.rect,fillOpacity:H&&!P||b>-1?.4:1,stroke:ea?"black":"none"}),e.map((e,t)=>(0,r.jsx)("rect",{x:D?F.range()[0]:F(e.x1),width:I,height:0===e.count?0:(0,U.Z)([1,V(0)-V(e.count)]),y:0===e.count?V(0):Math.min(V(e.count),V(0)-1),fill:n||er.default.rect,fillOpacity:H||t!==b&&-1!==b?.4:1},t))]})}let eo=j>0?F.range()[1]:130,ei=(0,c.useMemo)(()=>(0,z.Yu)().extent([[0,0],[eo,31]]).on("brush end",e=>{var t;let n=f?f.filter(e=>e.operands[0].value!==i):[];if(void 0===e.sourceEvent)return;if(!e.selection){v(e=>n.length||e.filter?{...e,filter:n.length?n:void 0}:e),x({filter:n.length?n:void 0});return}let[r,a]=D?F.domain():e.selection.map(F.invert);n.push({type:"gte",operands:[{type:"column",value:"".concat(i)},{type:"date"===k?k:"primitive",value:r}]}),n.push({type:"lte",operands:[{type:"column",value:i},{type:"date"===k?k:"primitive",value:a}]}),n.push({type:"v",operands:[{type:"column",value:i},{type:"primitive",value:k}]}),v(e=>({...e,filter:n})),"end"===e.type&&(null===(t=e.sourceEvent)||void 0===t?void 0:t.type)==="mouseup"&&x({filter:n})}),[eo,f,30,i,v,F,k,D,x]),ec=p?()=>{let e;L.current&&(0,q.Z)(L.current).call(ei.clear);let t=[];for(let n of null!=f?f:[])n.operands[0].value!==i?t.push(n):"nv"===n.type&&(e=!0);e||t.push({type:"nv",operands:[{type:"column",value:i},{type:"primitive",value:k}]}),t=0===t.length?void 0:t,v(e=>({...e,filter:t})),x({filter:t})}:void 0;(0,c.useEffect)(()=>{var e,t;if(void 0===f)return;let n=f.filter(e=>e.operands[0].value===i),r=null===(e=n.find(e=>"gte"===e.type))||void 0===e?void 0:e.operands[1],a=null===(t=n.find(e=>"lte"===e.type))||void 0===t?void 0:t.operands[1];if(void 0===r||void 0===a||r.value===a.value||!L.current)return;let l=(0,q.Z)(L.current);l.call(ei),l.call(ei.move,[F(r.value),F(a.value)])},[F,f,ei,i]),(0,c.useEffect)(()=>{if(!p||!L.current)return;let e=(0,q.Z)(L.current);e.call(ei),f||e.call(ei.move,null)},[f,ei,i,p]);let ed=-2===b?"invalid ".concat(k):es(null!==(t=null==el?void 0:el.x1)&&void 0!==t?t:E),eu=-2===b?"":es(null!==(n=null==el?void 0:el.x2)&&void 0!==n?n:T);return eu===ed&&(eu=""),(0,r.jsxs)("div",{style:{marginBottom:"12px"},children:[_&&(0,r.jsx)(SummaryText,{backgroundColor:R?er.empty.background:er.default.background,color:R?er.empty.text:er.default.text,borderColor:R?er.empty.text:er.default.text,height:30,width:130,text:R?"all values: invalid ".concat(k):"all values: ".concat(m(C[0].x1||0))}),!_&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("svg",{style:{overflow:"visible"},height:30,width:130,children:[drawRects(C,j,f?"#d1d1d1":void 0),N&&drawRects(N,null!=S?S:0),(0,r.jsx)("line",{y1:31,y2:31,x1:F.range()[0],x2:F.range()[1],strokeWidth:.5,stroke:"#d3d3d3"}),(0,r.jsx)("rect",{onPointerEnter:pointerMove,onPointerMove:pointerMove,onPointerLeave:function(){y(-1),g(void 0)},width:132,x:-1,height:50,fillOpacity:.1,fill:"white"}),H&&(j>0&&P?(0,r.jsx)(UnderBar,{x:+F.range()[1]+I}):(0,r.jsx)("line",{x1:F(h),x2:F(h),y1:0,y2:30,strokeWidth:2,stroke:er.default.rect})),-1!==b&&(0,r.jsx)(UnderBar,{x:-2===b?+F.range()[1]+I:D?F.range()[0]:F(null==el?void 0:el.x1)}),j>0&&-1===b&&(0,r.jsx)("text",{className:"fw4",x:+F.range()[1]+3*I/2,y:45,fill:er.empty.rect,textAnchor:"middle",children:"⌀"}),j>0&&p&&(0,r.jsx)("rect",{fill:"none",stroke:(null==f?void 0:f.some(e=>e.operands[0].value===i&&"n"===e.type))?"#d2d2d2":"none",width:I,x:+F.range()[1]+I,onPointerDown:ec,height:30,style:{cursor:"pointer"}}),(0,r.jsx)("g",{ref:L})]}),(0,r.jsxs)("div",{className:"fw4 relative mid-gray",style:{pointerEvents:"none",zIndex:-1},children:[!(H&&P)&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"absolute",style:{left:"".concat(-2===b?+F.range()[1]+ +I:F(null!==(a=null==el?void 0:el.x1)&&void 0!==a?a:E),"px"),transform:el?"translate(-100%, 0)":"",color:-2===b?er.empty.rect:"#555555"},children:ed}),(0,r.jsx)("div",{className:"absolute",style:{left:"".concat(F(null!==(l=null==el?void 0:el.x2)&&void 0!==l?l:T),"px"),transform:el?"translate(0, 0)":"translate(-100%, 0)"},children:eu})]}),H&&(j>0&&P?(0,r.jsx)("div",{className:"bg-white absolute",style:{left:"".concat(+F.range()[1]+I,"px"),transform:"translate(-100%, 0)",color:er.empty.rect},children:"invalid ".concat(k)}):(0,r.jsx)("div",{className:"bg-white absolute",style:{left:"".concat(F(h),"px"),paddingLeft:"4px",paddingRight:"4px",borderRadius:"5px",transform:"translate(-50%, 0)",color:"rgb(44, 85, 172)"},children:h?m(h):h}))]})]})]})};var ea=n(72255),el=n(40477),es=n(98837);let eo="<empty string>",StackedBar=e=>{let{colSummary:t,hoveredValue:n,name:a,ready:l,setOperations:s,filters:o,filteredData:d,sendOperationsAnalyticsEvent:u,setChartLabel:p}=e,m=(0,c.useMemo)(()=>null==o?void 0:o.filter(e=>e.operands[0].value===a),[o,a]),{type:h,data:f,isUnique:v,numCategories:x}=t,g=(0,c.useMemo)(()=>(null==m?void 0:m.map(e=>{let{type:t}=e;if("nv"===t)return"invalid ".concat(h);if("in"===t)return e.operands.filter(e=>"primitive"===e.type).map(e=>e.value);if("nin"===t){let t=e.operands.filter(e=>"primitive"===e.type).map(e=>e.value);return f.filter(e=>1!==e.categoryType&&!t.includes(e.label)).map(e=>e.label)}return[]}).flat())||[],[f,m,h]),b=null==m?void 0:m.map(e=>{let{type:t}=e;return t}),[y,j]=(0,c.useState)(-1),w=l?e=>{var t;let n=e.nativeEvent.offsetX<=5?1:e.nativeEvent.offsetX-5,r=C.invert(n),l=(0,O.Nw)(k,r)-1,i=S[l],c=[];if(1===i.categoryType){let e=null==b?void 0:b.includes("nv");e||c.push({type:"nv",operands:[{type:"column",value:a},{type:"primitive",value:h}]})}else if(2===i.categoryType){let e=null==b?void 0:b.includes("nin");if(!e){let e={type:"nin",operands:[{type:"column",value:a}]};for(let t of S)0===t.categoryType&&e.operands.push({type:"primitive",value:t.label});c.push({type:"v",operands:[{type:"column",value:a},{type:"primitive",value:h}]}),c.push(e)}}else{let t=i.label,n=(null==b?void 0:b.includes("in"))?g:[];if(e.getModifierState("Meta")){let e=n.indexOf(t);e>-1?n.splice(e,1):n.push(t)}else n=1===n.length&&n[0]===t?[]:[t];n.length>=1&&c.push({type:"in",operands:[{type:"column",value:a},...n.map(e=>({type:"primitive",value:e}))]})}let d=[...null!==(t=null==o?void 0:o.filter(e=>{let{operands:t}=e;return t[0].value!==a}))&&void 0!==t?t:[],...c];s(e=>({...e,filter:d.length?d:void 0})),u({filter:d.length?d:void 0})}:void 0;function getColor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"rect";return 1===e?er.empty[t]:2===e?er.unique[t]:er.default[t]}let{x1:k,xScale:C,total:N,allScaled:S,displayData:L,filteredScaled:M,smallCategories:R}=(0,c.useMemo)(()=>{let e=f.map(e=>e.x1),t=(0,W.Z)().domain([0,1]).range([0,130]),n=(0,ea.Z)(f,e=>e.count),r=f.map(e=>({width:t(e.x2-e.x1),...e})),a=-1,l=-1,s=r.filter((e,t)=>1===e.categoryType?(a=t,!1):2!==e.categoryType||(l=t,!1)),o=d&&d.length>0?new Map(d.map(e=>["".concat(e.label).concat(e.categoryType),e.count])):void 0,i=(0,el.Z)(es.Z).right(s.map(e=>e.width),2),c=s.slice(0,i);i<s.length-1&&c.push(s.slice(i,s.length).reduce((e,t)=>({label:"small display",categoryType:3,x1:0,x2:0,count:e.count+t.count,width:e.width+t.width}))),l>=0&&c.push(r[l]),a>=0&&c.push(r[a]);let u=r.filter(e=>e.width<2);return{x1:e,xScale:t,total:n,allScaled:r,displayData:c,filteredScaled:o,smallCategories:u}},[f,d]);(0,c.useEffect)(()=>{var e,t;if(n===_.V8){j(-1),p(void 0);return}let r=typeof n!==h?null:n,a=null===r?S.find(e=>1===e.categoryType):null!==(e=S.find(e=>e.label===r))&&void 0!==e?e:S.find(e=>2===e.categoryType),l=null!==(t=null==a?void 0:a.x1)&&void 0!==t?t:0,s=(0,O.Nw)(k,l);j(s),p(s>=0&&s<S.length?getHoverText(S[s].count,N):void 0)},[n,k,S,h,p,N]);let D=-1===y?null:S[y];return(0,r.jsxs)("div",{className:"relative",style:{marginBottom:"16px"},children:[(v||1===x)&&(0,r.jsx)(SummaryText,{height:30,backgroundColor:2===f[0].categoryType?er.unique.background:1===f[0].categoryType?er.empty.background:er.default.background,color:2===f[0].categoryType?er.unique.text:1===f[0].categoryType?er.empty.text:er.default.text,borderColor:2===f[0].categoryType?er.unique.text:1===f[0].categoryType?er.empty.text:er.default.text,text:2===f[0].categoryType?f[0].label:1===f[0].categoryType?"all values: invalid ".concat(h):'all values: "'.concat(f[0].label,'"'),width:130}),!v&&x>1&&(0,r.jsxs)("div",{style:{position:"relative"},children:[(0,r.jsxs)("div",{style:{width:130,height:30,marginBottom:"3px",display:"flex",borderRadius:"5px",overflow:"hidden"},children:[L.map((e,t)=>{let n=!!(2===e.categoryType&&(null==b?void 0:b.includes("nin")))||!!(1===e.categoryType&&(null==b?void 0:b.includes("nv")))||g.includes(e.label),a=o?((null==M?void 0:M.get("".concat(e.label).concat(e.categoryType)))||0)/e.count*100:100,l=2===e.categoryType?"unique":"".concat(""===e.label?eo:e.label);return(0,r.jsx)("div",{title:l,className:"flex items-center fw4 sans-serif",style:{background:3===e.categoryType?"repeating-linear-gradient(\n                      to right,\n                      ".concat(o?"#d1d1d1":er.default.rect," 0px,\n                      ").concat(o?"#d1d1d1":er.default.rect," 1px,\n                      ").concat(o?"white":er.default.stroke," 1px,\n                      ").concat(o?"white":er.default.stroke," 2px\n                    )"):o?"linear-gradient(to top, ".concat(getColor(e.categoryType,"rect")," ").concat(a,"%, #d1d1d1 ").concat(a,"%, #d1d1d1 ").concat(100-a,"%)"):getColor(e.categoryType,"rect"),width:e.width,height:30,borderColor:n?"black":o?"white":getColor(e.categoryType,"stroke"),borderWidth:n?"1px":t===L.length-1?"0px":"0px 1px 0px 0px",borderStyle:"solid",opacity:-1===y?1:(null==D?void 0:D.label)===e.label&&D.categoryType===e.categoryType&&D.width>=1?1:.4,textAlign:"center",borderRadius:0===t?"5px 0px 0px 5px":t===L.length-1?"0px 5px 5px 0px":"0px",position:"relative",boxSizing:"border-box"},children:e.count/N>.1&&"small display"!==e.label&&(0,r.jsx)("span",{style:{overflow:"hidden",width:"calc(100% - 4px + ".concat(n?"1px":"0px",")"),left:n?"-1px":"0px",position:"absolute",padding:"0px 2px",color:2===e.categoryType?er.unique.text:"white"},children:l})},"".concat(e.label,"_").concat(e.categoryType))}),m&&R.length>0&&g.map(e=>{var t;let n=null===(t=R.find(t=>t.label===e))||void 0===t?void 0:t.x1;return void 0===n?null:(0,r.jsx)("div",{style:{width:130*n,height:30,position:"absolute",borderRight:"1px solid ".concat(er.default.rect)}},"highlight-mark".concat(e))}),D&&D.width<2&&(0,r.jsx)("div",{style:{width:130*D.x1,height:30,position:"absolute",borderRight:"1px solid ".concat(er.default.rect)}})]}),(0,r.jsx)("div",{onPointerMove:e=>{let t=e.nativeEvent.offsetX<5?1:e.nativeEvent.offsetX-5,n=C.invert(t),r=(0,O.Nw)(k,n)-1;j(r),p(r>=0&&r<S.length?getHoverText(S[r].count,N):void 0)},onPointerLeave:function(){p(void 0),j(-1)},onPointerDown:w,className:i()("absolute",l?"pointer":""),style:{top:"0px",left:"-".concat(5,"px"),width:"".concat(140,"px"),height:50,backgroundColor:"rgba(255,255,255, .01)"}}),(0,r.jsx)("div",{className:"mid-gray fw4 absolute",style:{pointerEvents:"none",height:"15px",maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis"},children:D?"".concat(""===D.label?eo:D.label):g.length>0?g.map(e=>""===e?eo:e).join(", "):"".concat(countFormat(x)," ").concat(x>1?"categories":"category")})]})]})};var ei=n(27522),ec=n(66338),ed=n(10998),eu=n(17);let ColumnTypeSelector=e=>{let{value:t,inferredType:n,node:a,name:l,disabled:o}=e,i=(0,ec.I0)(),c=["raw","other","array","object","buffer","integer"];return(0,r.jsxs)(ei.vz,{onChange:e=>{var t,r,s;let o=(null===(r=a.data.operations.names)||void 0===r?void 0:null===(t=r.find(e=>{let{name:t}=e;return l===t}))||void 0===t?void 0:t.column)||l,c=a.data.operations.filter.filter(e=>{let t=e.operands[0].value;return t!==o});i({type:"setDataOperations",id:a.id,operations:{types:[...(null!==(s=a.data.operations.types)&&void 0!==s?s:[]).filter(e=>e.name!==o),{name:l,type:"auto"===e?n:e}],filter:c}})},value:t===n?"auto":t,className:"pointer",style:{flexShrink:"0"},disabled:o,children:[(0,r.jsxs)(ei.Y4,{className:"flex items-center fw4 mid-gray outline-0 mb2",children:[(0,r.jsx)("div",{style:{maxWidth:"150px",overflow:"hidden",textOverflow:"ellipsis"},children:t}),(0,r.jsx)(ei.r9,{className:"inline-flex items-center gray ml1",children:(0,r.jsx)(ed.Z,{})})]}),(0,r.jsxs)(ei.jI,{className:"shadow-4 bg-white ba b--silver br2 mt1 pb1 pt1",style:{width:"160px"},children:[(0,r.jsx)("div",{className:"gray f7 ph2 pt1 pb1",children:"Column type"}),(0,r.jsx)("div",{className:"bb b--silver mt1 mb1"}),(0,r.jsxs)(ei.uf,{className:"outline-0",style:{padding:0,margin:0},children:[(0,r.jsx)(ColumnOption,{value:"auto",selected:n===t,sideLabel:n},"auto"),(0,r.jsx)(ColumnOption,{value:"raw",selected:"raw"===t},"raw"),(0,r.jsx)("div",{className:"bb b--silver mt1 mb1"}),Array.from(s.IG).filter(e=>!c.includes(e)).map(e=>(0,r.jsx)(ColumnOption,{value:e,selected:e===t&&n!==t},e))]})]})]})},ColumnOption=e=>{let{value:t,selected:n,sideLabel:a}=e;return(0,r.jsxs)(ei.wt,{value:t,className:"flex pl2 pr3 pv1 f6 fw5 dark-gray pointer",style:{gap:"8px"},children:[n?(0,r.jsx)(eu.Z,{style:{flex:"0 0 16px"}}):(0,r.jsx)("div",{style:{flex:"0 0 16px"}}),(0,r.jsxs)("div",{className:i()("flex selected",a&&"items-center justify-between w-100 truncate"),children:[(0,r.jsx)("span",{className:"truncate",children:t}),a&&(0,r.jsx)("span",{className:"gray fw4",children:a})]})]},t)};var ep=n(20736);let em={summaryType:"empty",data:[],maxLength:0,type:"string",inferred:"string"},TableHeadCell=e=>{var t,n,a,s;let{name:o,canShowSummaries:i,setDraggingColumn:d,width:u,node:p,schema:m,setColumnsFlash:h,colSummary:f,colFilteredSummary:v,operations:x,hoveredValue:g,setOperations:b,isUntypedDialect:y,ready:j,embed:w,editingColumn:k,editingColumnName:C,finishEditingColumn:N,startEditingColumn:S,allowDerivedColumns:L}=e,{id:M,mode:R}=p,D=(0,Z.I0)(),{pending:E}=(0,Z.v9)(e=>{var t;let{notebook:n}=e;return{pending:(null===(t=n.workerStatus.get(M))||void 0===t?void 0:t.status)==="pending"}}),T=null===(t=x.sort)||void 0===t?void 0:t.find(e=>{let{column:t}=e;return t===o}),V=(0,_.t2)(o,x),I=k===o,H="table"===R&&L&&(I||!!(null===(n=p.data.operations.derive)||void 0===n?void 0:n.some(e=>e.name===o))),A=(0,ep.GS)(ep.Hb),[P,O]=(0,c.useState)(!1),[B,U]=(0,c.useState)(),z=(0,c.useCallback)(e=>{let{filter:t,sort:n}=e;D({type:"setLocalOperations",id:M,operations:{filter:t,sort:n}})},[D,M]);return(0,c.useEffect)(()=>U(void 0),[f.type]),(0,r.jsxs)("th",{onMouseUp:()=>d(void 0),style:{width:u,padding:5,height:i?70:void 0,background:I?"var(--observable-focus-lightest-blue)":T||V?"var(--washed-yellow)":""},className:"jsx-86b862ef0ed2c097 fw4 mid-gray",children:[(0,r.jsxs)("div",{style:{height:25},className:"jsx-86b862ef0ed2c097 flex justify-between items-center",children:["table"!==R||I?(0,r.jsx)("div",{title:C||o,className:"jsx-86b862ef0ed2c097 dark-gray truncate b",children:C||o}):(0,r.jsx)(ColumnNameInput,{dispatch:D,id:M,nodeData:p.data,name:o,schema:m}),!I&&(0,r.jsxs)("div",{style:{visibility:!A||P||void 0!==T?"visible":void 0},className:"jsx-86b862ef0ed2c097 pl1 flex items-center column-menu",children:[(0,r.jsx)("button",{onClick:e=>{var t;return t=e.shiftKey,void b(e=>{var n;let r=null===(n=e.sort)||void 0===n?void 0:n.find(e=>{let{column:t}=e;return t===o}),a=void 0===r?{column:o,direction:t?"desc":"asc"}:"asc"===r.direction?{column:o,direction:"desc"}:void 0;return z({sort:a?[a]:void 0}),{...e,sort:a?[a]:void 0}})},title:"Sort column",className:"jsx-86b862ef0ed2c097 pointer bn pl1 pr0 pv1 bg-transparent",children:(0,r.jsx)(columnSort,{direction:(null==T?void 0:T.column)===o?T.direction:void 0})}),!w&&(0,r.jsx)(TableHeadMenu,{node:p,setFocus:O,hide:function(){let e=Array.from((null==m?void 0:m.keys())||[]);if(!E&&"table"===R){var t,n,r;let a=null===(t=p.data.operations.names)||void 0===t?void 0:t.find(e=>{let{name:t}=e;return t===o}),l=null!==(n=null==a?void 0:a.column)&&void 0!==n?n:o;D({type:"setDataOperations",id:M,operations:{select:{columns:(null!==(r=p.data.operations.select.columns)&&void 0!==r?r:e).filter(e=>e!==l)}},source:"table"}),null==h||h(!0)}},currentSort:null===(s=x.sort)||void 0===s?void 0:null===(a=s.find(e=>{let{column:t}=e;return t===o}))||void 0===a?void 0:a.direction,onSort:function(e){b(t=>{let n=e?[{column:o,direction:e}]:void 0;return z({sort:n}),{...t,sort:n}})},name:o,isBeingEdited:I,startEditingColumn:S,finishEditingColumn:N,allowDeriveActions:H,allowDerivedColumns:L})]})]}),(0,r.jsxs)("div",{className:"jsx-86b862ef0ed2c097 mb2 h1 flex justify-between",children:[B||(y&&"table"===R?(0,r.jsx)(ColumnTypeSelector,{value:f.type,inferredType:f.inferred,node:p,name:o,disabled:I}):f.type),H&&(0,r.jsx)(F.Z,{className:"hover-mid-gray moon-gray pointer",onClick:()=>{I?N():S(o)}})]}),i&&("categorical"===f.summaryType?(0,r.jsx)(StackedBar,{name:o,colSummary:f,ready:j,filteredData:null==v?void 0:v.data,hoveredValue:g,setOperations:b,filters:x.filter,sendOperationsAnalyticsEvent:z,setChartLabel:U}):"continuous"===f.summaryType?(0,r.jsx)(Histogram,{colSummary:f,ready:j,colFilteredSummary:v,formatter:(0,_.QI)(f.type),hoveredValue:g instanceof Date||"symbol"==typeof g||null==g?g:Number(g),name:o,filters:x.filter,setOperations:b,sendOperationsAnalyticsEvent:z,setChartLabel:U}):null),(0,r.jsx)("button",{onMouseDown:()=>d(o),className:"jsx-86b862ef0ed2c097 resize-handle"}),(0,r.jsx)(l(),{id:"86b862ef0ed2c097",children:"th.jsx-86b862ef0ed2c097{position:relative;background:var(--white);border-bottom:solid 1px var(--light-silver);border-left:solid 1px var(--light-silver);z-index:1}th.jsx-86b862ef0ed2c097 .column-menu.jsx-86b862ef0ed2c097{visibility:hidden}th.jsx-86b862ef0ed2c097:hover .column-menu.jsx-86b862ef0ed2c097{visibility:visible}th.jsx-86b862ef0ed2c097:first-child{border-left:none;vertical-align:top;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:30px;padding:7px}th: hover {z-index:9999}.resize-handle.jsx-86b862ef0ed2c097{background-color:var(--transparent);border:none;display:block;padding:0px;position:absolute;cursor:col-resize;width:3px;right:0;top:0;z-index:1;height:100px}.resize-handle.jsx-86b862ef0ed2c097:hover{background-color:var(--light-silver)}"})]},o)},TableHeadMenu=e=>{var t;let{node:n,onSort:a,hide:l,currentSort:s,setFocus:o,name:i,isBeingEdited:c,startEditingColumn:u,finishEditingColumn:m,allowDeriveActions:h,allowDerivedColumns:f}=e,{id:v,mode:x,data:b}=n,y="operations"in b&&(null===(t=b.operations.derive)||void 0===t?void 0:t.some(e=>{let{name:t}=e;return t===i})),j=[void 0,"asc","desc"],w=(0,Z.I0)(),k="flex w-100 pv1 ph2 bg-transparent bn hover-bg-light-silver items-center pointer hover-b--silver fw6 tl";return(0,r.jsx)(g.v2,{children:e=>{let{isExpanded:t}=e;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(g.j2,{title:"Column actions","aria-label":"Column actions",onClick:()=>o(t),className:"bn pa0 bg-transparent washed-blue pointer",children:(0,r.jsx)(I.Z,{})}),(0,r.jsx)(g.YI,{style:{width:"200px"},"data-cy":"table-head-menu-popover",className:"bg-white ba b--silver br2 shadow-4 outline-0",children:(0,r.jsxs)(g.sd,{className:"dark-gray fw6 pv1",children:["table"===x&&f&&(0,r.jsxs)(r.Fragment,{children:[y?(0,r.jsxs)(g.sN,{title:"Toggle editing","aria-label":"Toggle editing",className:k,onSelect:()=>{c?m():u(i)},children:[c?(0,r.jsx)(d.Z,{className:"pr2"}):(0,r.jsx)(F.Z,{className:"pr2"}),(0,r.jsx)("div",{children:c?"Finish editing":"Edit expression"})]}):(0,r.jsxs)(g.sN,{title:"Derive column","aria-label":"Derive column",className:k,onSelect:()=>{u(void 0,i)},children:[(0,r.jsx)(p.ZP,{className:"mr2"}),"Derive column"]}),(0,r.jsx)("div",{className:"mv1 bt b--silver"})]}),j.map(e=>{let t=e?"Sort ".concat(e,"ending"):"No sorting";return(0,r.jsxs)(g.sN,{title:t,className:k,onSelect:()=>a(e),children:[(0,r.jsx)(T.E,{className:"flex",checked:e?s===e:!s,readOnly:!0}),(0,r.jsx)(columnSort,{direction:e,className:"mr2"}),(0,r.jsx)("div",{children:t})]},null!=e?e:"undefined")}),"table"===x&&!c&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"mv1 bt b--silver"}),(0,r.jsxs)(g.sN,{title:"Hide column","aria-label":"Hide column",onSelect:l,children:[(0,r.jsx)(H.Z,{className:"pr2"}),(0,r.jsx)("div",{children:"Hide"})]}),h&&(0,r.jsxs)(g.sN,{title:"Delete column","aria-label":"Delete column",onSelect:()=>{var e,t;let n=b.operations.select.columns;w({type:"setDataOperations",id:v,operations:{select:{columns:n?n.filter(e=>e!==i):null},derive:[...null!==(t=null===(e=b.operations.derive)||void 0===e?void 0:e.filter(e=>e.name!==i))&&void 0!==t?t:[]]}})},children:[(0,r.jsx)(V.Z,{className:"pr2"}),(0,r.jsx)("div",{children:"Delete"})]})]})]})})]})}})};var eh=n(55288),ef=n(71256);let TableHead=e=>{var t,n;let{node:a,summary:o,filteredSummary:i,hoveredRow:d,operations:u,setOperations:p,colWidths:m,setColWidths:h,setColumnsFlash:f,embed:v,tableRef:x,editingColumn:g,editingColumnName:b,finishEditingColumn:y,startEditingColumn:j,sourceInfo:w,allowDerivedColumns:k}=e,{id:C,data:N}=a,S=(0,Z.I0)(),L=(0,c.useRef)(0),M=(0,c.useRef)(null),R=(0,ef.pN)(N,S,a.mode,!0,C),[D,E]=(0,c.useState)(),T=(null===(t=N.display)||void 0===t?void 0:t.mode)!=="table"||null===(n=N.display.showSummaries)||void 0===n||n,F=!!T&&null!=o&&!!o.nRows&&o.nRows>1;function scroll(){var e;M.current=requestAnimationFrame(scroll),null===(e=x.current)||void 0===e||e.scrollBy(L.current,0),h(e=>{if(!D)return e;let t=new Map(e),n=e.get(D);return t.set(D,Math.max(150,(null!=n?n:0)+L.current)),t})}let V=(0,c.useCallback)(()=>{E(void 0),M.current&&(cancelAnimationFrame(M.current),M.current=null)},[]);return(0,c.useEffect)(()=>(window.addEventListener("mouseup",V),()=>window.removeEventListener("mouseup",V)),[V]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("thead",{onPointerMove:e=>{D&&(h(t=>{let n=new Map(t),r=t.get(D);return n.set(D,Math.max(150,(null!=r?r:0)+e.movementX)),n}),function(e){var t;let n=null===(t=x.current)||void 0===t?void 0:t.getBoundingClientRect();L.current=n&&e-n.right+30>0?5:0,L.current&&!M.current?M.current=requestAnimationFrame(scroll):M.current&&!L.current&&(cancelAnimationFrame(M.current),M.current=null)}(e.clientX))},className:l().dynamic([["381d3ebf4f57e123",[k?"th:nth-last-child(3) {\n              border-right: 1px solid var(--light-silver);\n            }":""]]])+" sticky top-0 v-top tl",children:(0,r.jsxs)("tr",{className:l().dynamic([["381d3ebf4f57e123",[k?"th:nth-last-child(3) {\n              border-right: 1px solid var(--light-silver);\n            }":""]]]),children:[(0,r.jsx)("th",{role:"button","data-cy":"cell-table-header-row",onClick:()=>{S({type:"setDisplay",id:C,display:{mode:"table",showSummaries:!T}})},className:l().dynamic([["381d3ebf4f57e123",[k?"th:nth-last-child(3) {\n              border-right: 1px solid var(--light-silver);\n            }":""]]]),children:(0,r.jsx)(eh.Z,{style:{transform:T?"":"rotate(-90deg)",transition:"transform 150ms ease"}})}),o&&Array.from(o.columns,e=>{let[t,n]=e,l=d?d[t]:_.V8,c=(null==m?void 0:m.get(t))||150;return(0,r.jsx)(TableHeadCell,{name:t,hoveredValue:l,width:c,canShowSummaries:F,colSummary:n,colFilteredSummary:null==i?void 0:i.columns.get(t),operations:u,setOperations:p,node:a,setDraggingColumn:E,ready:o.ready,setColumnsFlash:f,isUntypedDialect:(0,s.$S)(null==w?void 0:w.dialect),schema:R,embed:v,editingColumn:g,editingColumnName:b,finishEditingColumn:y,startEditingColumn:j,allowDerivedColumns:k},t)}),(0,r.jsx)("th",{style:{width:"99%",...k?{borderLeft:"none",borderRight:"none"}:null},className:l().dynamic([["381d3ebf4f57e123",[k?"th:nth-last-child(3) {\n              border-right: 1px solid var(--light-silver);\n            }":""]]])}),"table"===a.mode&&k&&(0,r.jsx)("th",{style:{width:"40px",borderLeft:"none"},className:l().dynamic([["381d3ebf4f57e123",[k?"th:nth-last-child(3) {\n              border-right: 1px solid var(--light-silver);\n            }":""]]])})]})}),(0,r.jsx)(l(),{id:"381d3ebf4f57e123",dynamic:[k?"th:nth-last-child(3) {\n              border-right: 1px solid var(--light-silver);\n            }":""],children:"th{position:relative;background:var(--white);border-bottom:solid 1px var(--light-silver);border-left:solid 1px var(--light-silver)}th:first-child{border-left:none;vertical-align:top;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:30px;padding:7px}.resize-handle{background-color:var(--transparent);border:none;display:block;padding:0px;position:absolute;cursor:col-resize;width:3px;right:0;top:0;z-index:1;height:100px}.resize-handle:hover{background-color:var(--light-silver)}".concat(k?"th:nth-last-child(3) {\n              border-right: 1px solid var(--light-silver);\n            }":"","\n      ")})]})};var ev=n(6359),ex=n(4640),eg=n(94549),eb=n(90271),ey=n(41312);let SummaryDisplayTask=class SummaryDisplayTask extends ex.i{async process(e){return await e({type:"request_table_summary",node_id:this._id,filters:this._filters})}constructor(e,t){super(),this._id=e,this._filters=t}};let RowsDisplayTask=class RowsDisplayTask extends ex.i{async process(e){let t=await e({type:"request_table_rows",node_id:this._id,operations:this._operations,start:this._start,end:this._end,search:this._search});return{rows:t.rows,searchInfo:t.searchInfo,error:t.error}}constructor(e,t,n,r,a){super(),this._id=e,this._start=t,this._end=n,this._operations=r,this._search=a}};let ej="var(--border-radius-2)",ew=c.memo(function(e){var t,n,a,o;let{node:h,operations:f,setOperations:v,setColumnsFlash:x,embed:g}=e,{id:b,pinned:y}=h,j=(0,Z.I0)(),w=(0,c.useDeferredValue)(f),[k,C]=(0,c.useState)(),[N,S]=(0,c.useState)(),[L,M]=(0,c.useState)(),[R,D]=(0,c.useState)(20),[_,T]=(0,c.useState)(),[F,V]=(0,c.useState)(new Map),[I,H,A]=(0,eg.G)(""),[O,B]=(0,c.useState)(null),[U,z]=(0,c.useState)(),[W,q]=(0,c.useState)(""),[G,Y]=(0,c.useState)(),[K,X]=(0,c.useState)(),{generation:$,leftRadius:J,bottomRadius:Q,allowDerivedColumns:ee,inPresentMode:et}=(0,Z.v9)(e=>{var t,n,r;let{notebook:{hoverId:a,focusId:l,workerStatus:o,present:i,type:c}}=e;return{generation:null!==(r=null===(n=o.get(b))||void 0===n?void 0:null===(t=n.display)||void 0===t?void 0:t.generation)&&void 0!==r?r:-1,leftRadius:a===b||l===b?void 0:ej,bottomRadius:l===b||y?void 0:ej,allowDerivedColumns:(0,s.$S)(null==O?void 0:O.dialect)&&!i,inPresentMode:i&&"dashboard"===c}}),en=(0,ef.pN)(h.data,j,"table",!0,b),er=(0,c.useRef)(null),ea=(0,c.useRef)(null),el=(0,c.useRef)(null),es=(0,c.useRef)(),eo=(0,c.useRef)(),ei=(0,c.useRef)(),ec=(0,c.useRef)(),ed=(null==k?void 0:k.generation)===$&&k.operations===w&&k.debouncedSearch===A?k.rows.length:0;(0,c.useEffect)(()=>{void 0!==U&&(q(U),S(e=>{if(void 0===e||e.columns.has(U))return e;let t=new Map(e.columns);return t.set(U,em),{...e,columns:t}}))},[U]),(0,c.useEffect)(()=>{var e,t;void 0!==U&&(null==N?void 0:null===(e=N.columns.get(U))||void 0===e?void 0:e.summaryType)==="empty"&&(null===(t=er.current)||void 0===t||t.scrollTo({left:er.current.scrollWidth}))},[U,N]),(0,c.useEffect)(()=>{if(null===h.data.source.name)ec.current=void 0,B(null);else{let e=new ev.FJ(h.data.source);ec.current=e,e.run(j).then(t=>{e===ec.current&&B(t)},()=>{e===ec.current&&B(null)})}},[j,h.data.source]),(0,c.useEffect)(()=>{let e=new SummaryDisplayTask(b);es.current=e,e.run(j).then(t=>{e===es.current&&S(t)},t=>{e===es.current&&console.error("table data failed: ".concat(t))})},[b,j,$]),(0,c.useEffect)(()=>{if(!w.filter){M(void 0);return}let e=new SummaryDisplayTask(b,w.filter);eo.current=e,e.run(j).then(t=>{e===eo.current&&M(t)},t=>{e===eo.current&&console.error("table data failed: ".concat(t))})},[b,j,$,w.filter]),(0,c.useEffect)(()=>{if((null==k?void 0:k.error)!==void 0&&0===k.rows.length&&void 0!==en){let e=new Map(Array.from(en).map(e=>{let[t]=e;return[t,em]}));S({columns:e,nRows:0,ready:!0})}},[en,null==k?void 0:k.error,null==k?void 0:k.rows.length]),(0,c.useEffect)(()=>{if(ed>=R)return;let e=new RowsDisplayTask(b,ed,R,w,A);ei.current=e,e.run(j).then(t=>{e===ei.current&&(C(e=>{let n=(null==e?void 0:e.generation)!==$||e.operations!==w||e.debouncedSearch!==A;return{rows:n?t.rows:e.rows.concat(t.rows),searchInfo:t.searchInfo,generation:$,operations:w,debouncedSearch:A,error:t.error}}),t.error&&j({id:b,type:"tableDisplayError"}))},t=>{e===ei.current&&console.error("table data failed: ".concat(t))})},[b,j,w,$,ed,R,A]),(0,c.useEffect)(()=>{v(e=>{var t;if(void 0===N||void 0===e.filter&&void 0===e.sort)return e;let n=[];if(e.filter){let t=e.filter.reduce((e,t)=>{let n=t.operands[0].value;return e.has(n)?e.get(n).push(t):e.set(n,[t]),e},new Map);for(let[e,r]of t.entries()){let t=function(e,t){if(void 0===t)return[];let n=[];if("continuous"===t.summaryType){var r,a,l;let s=e.find(e=>{let{type:t}=e;return"nv"===t});if(void 0!==s)return t.numMissing>0?e:[];let o=e.find(e=>{let{type:t}=e;return"gte"===t}),i=e.find(e=>{let{type:t}=e;return"lte"===t});if(void 0===i||void 0===o||(r=o.operands[1].value,a=i.operands[1].value,l=t.min,!(r<t.max)||!(l<a)))return[];for(let r of e){let e=r.operands[0];if("in"!==r.type&&"nin"!==r.type){if("lte"===r.type){let a=r.operands[1].value;if("number"==typeof a&&a>t.max){let a={type:r.type,operands:[e,{type:"primitive",value:t.max}]};n.push(a);continue}}if("gte"===r.type){let a=r.operands[1].value;if("number"==typeof a&&a<t.min){let a={type:r.type,operands:[e,{type:"primitive",value:t.min}]};n.push(a);continue}}n.push(r)}}}else{let r=new Set(t.data.map(e=>e.label));for(let t of e){let e=t.operands[0];if("lt"!==t.type&&"gt"!==t.type&&("in"===t.type||"nin"===t.type)){let a=t.operands.filter(e=>{let{type:t,value:n}=e;return"primitive"===t&&r.has(n)});a.length>0&&n.push({type:t.type,operands:[e,...a]})}}}return n}(r,N.columns.get(e));n=[...n,...t]}}let r=Array.from(N.columns.keys()),a=null===(t=e.sort)||void 0===t?void 0:t.filter(e=>r.includes(e.column));return{filter:n.length?n:void 0,sort:(null==a?void 0:a.length)?a:void 0}})},[N,v]),(0,c.useEffect)(()=>{var e;null===(e=er.current)||void 0===e||e.scrollTo({top:0}),D(20)},[h,w,A]),(0,c.useEffect)(()=>{(null==N?void 0:N.columns)&&V(new Map(Array.from(N.columns.entries(),e=>{var t;let[n,r]=e,a=null!==(t=r.maxLength)&&void 0!==t?t:0;return[n,7*a<150?150:7*a<250?250:350]})))},[N]),(0,c.useEffect)(()=>{A&&j({id:b,type:"tableSearch"})},[j,b,A]);let eu=(0,c.useCallback)((e,t)=>{if("sql"===h.mode||!e||!t)return;let n=e;e!==U&&(n=(0,P.Q)(e,new Set(null==N?void 0:N.columns.keys())));let r=h.data.operations.derive?[...h.data.operations.derive]:[],a=r.findIndex(e=>e.name===U);a>-1?r[a]={name:n,value:t}:r=[...r,{name:n,value:t}];let l=h.data.operations.select.columns;if(null!==l){let e=l.findIndex(e=>e===U);e>-1?(l=[...l])[e]=n:l=[...l,n]}j({type:"setDataOperations",id:h.id,operations:{derive:r,select:{columns:l}}}),z(n)},[j,U,h.id,h.mode,h.data,null==N?void 0:N.columns]),ep=(0,c.useCallback)(()=>{var e;G?eu(W,G):!U||(null===(e=h.data.operations.derive)||void 0===e?void 0:e.find(e=>{let{name:t}=e;return t===U}))||S(e=>{if(void 0===e)return e;let t=new Map(e.columns);return t.delete(U),{...e,columns:t}}),z(void 0),q(""),Y(void 0)},[U,W,G,h.data,eu]),eh=(0,c.useCallback)((e,t)=>{var n,r;if("sql"===h.mode)return;void 0!==U&&ep();let a=null!=e?e:(0,P.Q)(null!=t?t:"newColumn",new Set(null==N?void 0:N.columns.keys()));z(a);let l=null===(r=h.data.operations.derive)||void 0===r?void 0:null===(n=r.find(t=>t.name===e))||void 0===n?void 0:n.value;l?Y(l):void 0!==t&&Y('row["'.concat(t,'"]'))},[U,ep,h.data,h.mode,null==N?void 0:N.columns]);return(0,c.useEffect)(()=>{let e=new ResizeObserver(e=>{var t;let n=null===(t=e[0])||void 0===t?void 0:t.target;n&&X(n.offsetWidth-n.clientWidth)}),t=er.current;return t&&e.observe(t),()=>{t&&e.unobserve(t)}},[]),(0,r.jsxs)("div",{className:"jsx-fec60529c9a8369d relative pea",children:[(0,r.jsxs)("div",{ref:er,onScroll:e=>{let{currentTarget:t}=e;t.scrollHeight-t.scrollTop<492&&ed>=R&&D(R+20)},style:{margin:et?"0":"0 -14px",borderTopLeftRadius:J,borderTopRightRadius:ej,borderWidth:1},className:"jsx-fec60529c9a8369d "+(i()("container bt bl br b--light-silver bg-theme-cell",(null==k?void 0:k.error)===void 0?"overflow-auto":"overflow-x-auto")||""),children:["table"===h.mode&&ee&&(0,r.jsx)("div",{style:{top:"6px",right:(null!=K?K:0)>2?"1px":"-12px"},className:"jsx-fec60529c9a8369d absolute z-1",children:U?(0,r.jsx)("button",{onClick:ep,title:"Finish editing column",className:"jsx-fec60529c9a8369d bg-transparent bn p0",children:(0,r.jsx)(d.Z,{className:"bg-white b--silver ba pointer br2 shadow-2 outline-0 mid-gray hover-near-black pa1"})}):(0,r.jsx)("button",{title:"Insert new column",onClick:()=>eh(void 0),className:"jsx-fec60529c9a8369d bg-transparent bn p0",children:(0,r.jsx)(p.ZP,{className:"bg-white b--silver ba pointer br2 shadow-2 outline-0 mid-gray hover-near-black pa1"})})}),(0,r.jsxs)("table",{style:{tableLayout:"fixed"},ref:ea,className:"jsx-fec60529c9a8369d w-100 dark-gray ma0 nowrap overflow-visible",children:[N&&(0,r.jsx)(TableHead,{node:h,summary:N,filteredSummary:L,hoveredRow:_?null==k?void 0:k.rows[_.row]:void 0,operations:w,setOperations:v,colWidths:F,setColWidths:V,setColumnsFlash:x,embed:g,tableRef:er,editingColumn:U,editingColumnName:W,startEditingColumn:eh,finishEditingColumn:ep,sourceInfo:O,allowDerivedColumns:ee}),k&&(void 0===k.error||k.rows.length>0)&&(0,r.jsx)(E,{data:k,node:h,summary:N,hoveredCell:_,setHoveredCell:T,colWidths:F,searchInfo:k.searchInfo,editingColumn:U,allowDerivedColumns:ee})]})]}),(null==k?void 0:k.error)&&(0,r.jsx)("div",{style:{margin:et?"0":"0 -14px"},className:"jsx-fec60529c9a8369d "+(i()("code observable-red fw5 f6 pa2 b--light-silver ba bg-theme-cell",0===k.rows.length&&"bt-0")||""),children:k.error}),"table"===h.mode&&U?(0,r.jsxs)("div",{style:{margin:et?"0":"0 -14px"},className:"jsx-fec60529c9a8369d flex items-center pa2 ba b--light-silver bg-theme-cell",children:[(0,r.jsx)("div",{style:{width:150},className:"jsx-fec60529c9a8369d mr2",children:(0,r.jsx)("input",{title:"Edit derived column name",style:{boxShadow:"0 0 0 1px var(--light-gray)"},value:W,placeholder:"newColumn",onChange:e=>{q(e.target.value)},className:"jsx-fec60529c9a8369d dark-gray truncate b bn br1 pv1 bg-transparent w-100"})}),(0,r.jsxs)("div",{className:"jsx-fec60529c9a8369d flex w-100 overflow-hidden",children:[(0,r.jsx)("div",{className:"jsx-fec60529c9a8369d w-100 overflow-hidden bg-near-white br2 br--left",children:(0,r.jsx)(FormulaEditor,{editingColumnName:W,formula:G,setFormula:Y,saveDeriveColumn:eu},U)}),(0,r.jsx)(CodeExampleMenu,{}),(0,r.jsx)("button",{style:{width:29,height:29},onClick:()=>{eu(W,G)},className:"jsx-fec60529c9a8369d bn br2 br--right items-center align-center justify-center flex pointer bg-near-white",children:(0,r.jsx)(u.Z,{className:""})}),(0,r.jsx)("button",{style:{height:29},onClick:ep,className:"jsx-fec60529c9a8369d bn ml1 br2 bg-blue items-center align-center justify-center flex pointer white fw6",children:"Done"})]})]}):(null==N?void 0:N.nRows)!==void 0?(0,r.jsxs)("div",{style:{margin:et?"0":"0 -14px",height:eb.T6+16+2,borderBottomLeftRadius:J&&Q,borderBottomRightRadius:Q},className:"jsx-fec60529c9a8369d "+(i()("mid-gray f7 flex items-center justify-between b--light-silver pa2 bg-theme-cell",!(N.nRows>0)||(null==k?void 0:k.error)?"br bl bb":"ba")||""),children:[(0,ey.u2)(h)&&(0,r.jsx)("div",{className:"jsx-fec60529c9a8369d mr2",children:(0,ey.u2)(h)}),(0,r.jsxs)("div",{style:{padding:"2px"},className:"jsx-fec60529c9a8369d ba b--light-silver flex items-center br2",children:[(0,r.jsx)("button",{onClick:()=>{var e;return null===(e=el.current)||void 0===e?void 0:e.focus()},className:"jsx-fec60529c9a8369d bn pa0 bg-transparent flex items-center gray pointer",children:(0,r.jsx)(m.Z,{})}),(0,r.jsx)("input",{ref:el,value:I,style:{font:"13px/1.2 var(--sans-serif)"},disabled:!N.ready,onChange:e=>{H(e.target.value)},name:"search",placeholder:"Search",className:"jsx-fec60529c9a8369d bn fw5"})]}),(null==k?void 0:k.searchInfo)&&(0,r.jsx)("div",{className:"jsx-fec60529c9a8369d ml1",children:"".concat(k.searchInfo.length.toLocaleString()," ").concat(1===k.searchInfo.length?"match":"matches")}),(0,r.jsx)("div",{className:"jsx-fec60529c9a8369d ml-auto",children:(null!==(a=null===(t=w.filter)||void 0===t?void 0:t.length)&&void 0!==a?a:0)+(null!==(o=null===(n=w.sort)||void 0===n?void 0:n.length)&&void 0!==o?o:0)>0&&(0,r.jsx)("button",{onClick:()=>{let e={filter:void 0,sort:void 0};v(e),j({type:"setLocalOperations",id:b,operations:e})},className:"jsx-fec60529c9a8369d bn br2 f6 fw6 pv1 ph2 mr2 bg-white blue pointer",children:"Reset"})}),(0,r.jsxs)("div",{style:{fontVariantNumeric:"tabular-nums"},className:"jsx-fec60529c9a8369d",children:[(null==L?void 0:L.nRows)!==void 0&&"".concat(L.nRows.toLocaleString()," of "),N.nRows.toLocaleString(),1===N.nRows?" row":" rows"]})]}):null,(0,r.jsx)(l(),{id:"fec60529c9a8369d",children:".container.jsx-fec60529c9a8369d{max-height:369px}table.jsx-fec60529c9a8369d{font:13px/1.2 var(--sans-serif);border-collapse:separate;border-spacing:0}input.jsx-fec60529c9a8369d::-webkit-input-placeholder{font-weight:500;color:var(--gray)}input.jsx-fec60529c9a8369d:-moz-placeholder{font-weight:500;color:var(--gray)}input.jsx-fec60529c9a8369d::-moz-placeholder{font-weight:500;color:var(--gray)}input.jsx-fec60529c9a8369d:-ms-input-placeholder{font-weight:500;color:var(--gray)}input.jsx-fec60529c9a8369d::-ms-input-placeholder{font-weight:500;color:var(--gray)}input.jsx-fec60529c9a8369d::placeholder{font-weight:500;color:var(--gray)}"})]})})},57384:function(e,t,n){n.d(t,{Z:function(){return Worker}});var r=n(85893),a=n(63999),l=n(64063),s=n.n(l),o=n(11163),i=n.n(o),c=n(67294),d=n(60107),u=n(40123),p=n(4778),m=n(5146),h=n(20736),f=n(7595),v=n(11026),x=n(28174);let g=(0,x.J)(()=>({type:"layoutUpdated",layout:[]}));var b=n(78756),y=n(11252),j=n(96817),w=n(6434),k=n(44403),C=n(40591),N=n(68404),S=n(27507),L=n(90271),M=n(63302),R=n(32980),D=n(4870),_=n(29020),Z=n(32219),E=n(60147);function isOptionalString(e){return void 0===e||"string"==typeof e}let T=new Map,F=0;function Worker(e){var t;let{state:n,currentUser:l,dispatch:o,hiddenNodes:x,allowInternalNavigation:V=!0,location:I}=e,{id:H,owner:A,model:P,files:O,heights:B,workerTasks:U}=n,z=(0,_.DF)(n),W=(0,_.cE)(n),q=(0,_.uT)(l,A),G=(0,R.ng)(l,n),Y=(0,R.xn)(l),K=(0,c.useRef)(),X=(0,c.useRef)(),$=(0,c.useRef)(),J=(0,c.useRef)(),Q=(0,c.useRef)(),ee=(0,c.useRef)(),et=(0,c.useRef)(P.nodes[0]),en=(0,c.useRef)(),er=(0,c.useRef)(),ea=(0,c.useRef)(),el=(0,c.useRef)(),es=(0,c.useRef)(),eo=(0,c.useRef)(),ei=(0,c.useRef)(),ec=(0,c.useRef)(),ed=(0,c.useRef)(new Map),eu=(0,c.useRef)(),ep=(0,c.useRef)(n.saveVersion),em=(0,c.useRef)(P),eh=(0,c.useRef)(new Map),ef=(0,c.useRef)(),ev=(0,c.useRef)(n.present),ex=(0,h.GS)(h.ro),eg=(0,_.XT)(n)&&(!ex||!ev.current);eu.current=n.saveVersion,em.current=P;let{authorization:eb}=(0,E.v9)(e=>{let{authorization:t}=e;return{authorization:t}}),ey=eb.apiKey;function postRequest(e,t,n){let r,a;void 0===t&&void 0===n?(r=!1,a=new Promise((e,r)=>{t=e,n=r})):r=!0;let l=++F;return e.id=l,T.set(l,[t,n,r]),$.current(e),a}async function updateTitle(){if("dashboard"===n.type)return;let e=P.nodes.at(0);if(!e)return;let t=e.id,r=await postRequest({type:"extract_title",node_id:t});o({type:"title",value:"".concat(r).slice(0,255)})}function updatePath(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window.location,{pathname:n,search:r,hash:a}=t;(ei.current!==n||ec.current!==a)&&(ei.current=n,ec.current=a,e.push({type:"navigate",pathname:n,search:r,hash:a}))}function resolutionsSpecifierVersion(){return Math.min(ep.current,em.current.version)}function resolutionsSpecifier(){return"".concat(n.id,"@").concat(resolutionsSpecifierVersion())}function moduleURL(e){return e.toModuleURL(resolutionsSpecifier())}async function fetchResolutions(e){try{let{specifiers:t}=await (0,m.a8)("/document/".concat(e,"/imports?resolutions=").concat(resolutionsSpecifier(),"&importer=").concat(W?A.login:"anonymous"),{signal:eo.current});return Object.entries(t).filter(e=>{let[,{owner:t}]=e;return t!==A.login}).map(e=>{let[t,{resolution:n}]=e;return{type:"notebook",specifier:t,value:n}})}catch(e){if(404===e.status)return[];throw e}}function alreadyCaptured(e){return void 0!==em.current.resolve("notebook",e)}function resolutionsAreSynced(){return!((0,f.QY)(n)&&(0,R.mG)(n))||eu.current>=resolutionsSpecifierVersion()}function isPublicImport(e){return!W||void 0!==e.login&&e.login!==A.login}async function resolveImport(e,t,n,r){let a={id:t,specifier:"".concat(n)};if(ed.current.set(e,a),r&&!alreadyCaptured(n)){let t=await fetchResolutions(n);if(ed.current.get(e)!==a)return;t.length&&function(e){for(let{specifier:t,value:n}of e)eh.current.set(t,n);o({type:"resolveDependencies",resolutions:e,trigger:"implicit",source:"cellEvaluation"})}(t)}if(isPublicImport(n)){a.module=moduleURL(n),maybeSendResolvedImports();return}a.needsToBeSigned=!0,maybeSignPrivateImports(),maybeSendResolvedImports()}function maybeSignPrivateImports(){if(resolutionsAreSynced())for(let[,e]of ed.current)e.needsToBeSigned&&(e.needsToBeSigned=!1,signPrivateImport(e))}async function signPrivateImport(e){try{var t,n;let{import_path:r,owner:a,secrets:l,database_clients:s,notification_clients:o}=await (t=e.specifier,n={signal:eo.current},ey?(0,m.a8)("/document/".concat(H,"/").concat(t,"/embed/import?v=4&resolutions=").concat(resolutionsSpecifier()),{...n,...ey?{headers:{"Content-Type":"application/json",Authorization:"apikey ".concat(ey)}}:{}}):(0,m.a8)("/document/".concat(t,"/import?v=4&resolutions=").concat(resolutionsSpecifier()),n));a.id===A.id?(e.module="".concat("https://api.observablehq.com").concat(r),l&&await resolveSecrets(l),s&&resolveDatabases(s),o&&resolveNotifications(o)):e.module=moduleURL(D.Z.parse(e.specifier))}catch(t){if("AbortError"===t.name)return;e.error=t instanceof S.ZP&&404===t.status?"Notebook '".concat(e.specifier,"' not found"):t.message}maybeSendResolvedImports()}function maybeSendResolvedImports(){if(!resolutionsAreSynced())return;let e=$.current;for(let[t,n]of ed.current){let{id:r,specifier:a,module:l,error:s}=n;s?(e({type:"resolve_import",id:r,specifier:a,error:s}),ed.current.delete(t)):"string"==typeof l&&(e({type:"resolve_import",id:r,specifier:a,module:l}),ed.current.delete(t))}}async function resolveSecrets(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(!W)return;if(!e.length){void 0===er.current&&(er.current=null,n.unshift({type:"reset_secret",delay:!1}));return}er.current||(er.current=fetchSecrets());let r=$.current,a=en.current,l=er.current;e.some(e=>!a.has(e))&&(n.unshift({type:"reset_secret",delay:!0}),t=!0);let s=await l,o=[];for(let t of e)!a.has(t)&&(a.add(t),s.has(t)&&o.push([t,s.get(t)]));(o.length||t)&&r({type:"resolve_secrets",secrets:o})}async function fetchSecrets(){let e;if(ey)e=await (0,m.a8)("/document/".concat(n.id,"/secrets/embed"),{headers:{"Content-Type":"application/json",Authorization:"apikey ".concat(ey)}});else if("team"===A.type)e=await (0,m.a8)("/team/".concat(A.id,"/secrets"));else if(e=await (0,m.a8)("/user/secrets"),A.id!==(null==l?void 0:l.id))throw Error("access denied");return new Map(e.map(e=>{let{name:t,value:n}=e;return[t,n]}))}function resolveDatabases(e){if(W)for(let t of e)ea.current.add(t)}function resolveNotifications(e){if(W)for(let t of e)el.current.add(t)}(0,c.useEffect)(()=>{function hashchanged(){let e=[];updatePath(e,I),e.length&&$.current({type:"bundle",events:e})}return addEventListener("hashchange",hashchanged),()=>removeEventListener("hashchange",hashchanged)},[I]),(0,c.useEffect)(()=>{function onFocus(){$.current({type:"blur"})}function onBlur(){if(document.activeElement===X.current){var e;o({type:"selectionClear"}),null===(e=window.getSelection())||void 0===e||e.removeAllRanges()}}return onBlur(),addEventListener("focus",onFocus),addEventListener("blur",onBlur),()=>{removeEventListener("focus",onFocus),removeEventListener("blur",onBlur)}},[o]),(0,c.useEffect)(()=>{n.present!==ev.current&&($.current({type:"present",present:n.present,theme:d.t}),ev.current=n.present)});let ej=(0,j.y)(l,n,"current_user_emails");(0,c.useEffect)(()=>{if(l&&z){let{login:e,name:t,bio:n,home_url:r,avatar_url:a,identities:s}=l;es.current={login:e,name:t,bio:n,url:r,avatar:a,...ej&&{email:s.concat(l).map(e=>e.email).find(e=>!!e)}}}else es.current=void 0},[z,ej,l]),(0,c.useEffect)(()=>{let e=(0,M.vE)(A),t=new AbortController,n=[];eg&&n.push({type:"in_dashboard",present:ev.current,theme:d.t}),ev.current&&n.push({type:"present",present:ev.current,theme:d.t}),V&&n.push({type:"allow_internal_navigation"});let r=document.createElement("iframe");r.style.width="calc(100% + ".concat(2*L.Mv,"px)"),r.style.margin="0 ".concat(-L.Mv,"px"),r.style.border="none",r.scrolling="no",r.sandbox=M.Ar,r.allow=M.sq,r.src="".concat(e,"/next/").concat(p.xF),addEventListener("message",messaged),K.current.appendChild(r);let a=r.contentWindow;function messaged(t){if(!t.isTrusted||t.origin!==e||t.source!==a)return;let l=t.data;if(void 0!==l.id){let{id:e}=l,t=T.get(e);if(t){let[n,r,a]=t,{error:s}=l;a?((void 0!==s||l.done)&&T.delete(e),void 0!==s?r(s):n(l)):(T.delete(e),void 0!==s?r(s):n(l.value));return}}else switch(l.type){case"hello":(function(){if(n){for(let t of n)a.postMessage(t,e);n=null}})();return;case"layout":ef.current=l.layout,g(o,e=>{let{layout:t}=e;t.splice(0,t.length),t.push(...l.layout)});return;case"resize":(function(e){let{node_id:t,row_id:n,height:r}=e,a=eg?n:t;(0,N.qX)(o,e=>{let{heights:t}=e;return t.push({type:"worker",id:+a,height:+r})})})(l);return;case"hover":(function(e){let{node_id:t}=e;o({type:"hover",id:+t})})(l);return;case"errors":(function(e){let{errors:t}=e;if(t instanceof Map){for(let[e,n]of t)if("number"!=typeof e||null!==n&&!(isOptionalString(n.input)&&isOptionalString(n.stack)&&isOptionalString(n.message)&&isOptionalString(n.name)))return;o({type:"workerErrors",errors:t})}})(l);return;case"navigate":V&&function(e){let{pathname:t,search:n,hash:r}=e,a="".concat(t).concat(n).concat(r);i().push(a)}(l);return;case"display":(function(e){let{node_id:t,mode:n}=e;(0,b.I)(o,e=>{let{displayModes:r}=e;return r.set(+t,n)})})(l);return;case"pending":case"fulfilled":case"rejected":(function(e){let{type:t,node_id:n,suggestions:r,chartSpec:a}=e;(0,b.I)(o,e=>{let{statuses:l,suggestions:s,chartSpecs:o}=e;l.set(+n,"".concat(t)),void 0!==r&&s.set(+n,r),void 0!==a&&o.set(+n,a)})})(l);return;case"request_database_token":onRequestDatabaseToken(l.name);return;case"request_cloud_file":onRequestCloudFile(l.name);return;case"request_private_file":(function(e){let t=$.current;t(W?q?{type:"resolve_private_file",name:e}:{type:"resolve_private_file",name:e,error:"Unable to load file: ".concat(e)}:{type:"resolve_private_file",name:e,error:u.Js})})(l.name);return;case"request_notification_client":onRequestNotificationClient(l.specifier);return;case"request_notification":(function(e){let{requestId:t,provider:n,address:r,content:a}=e,l=$.current;o({type:"addNotificationRequest",requestId:t,notification:{provider:n,address:r,content:a,onConfirm:e=>void l({type:"resolve_notification",requestId:t,status:e}),onReject:e=>void l({type:"resolve_notification",requestId:t,error:e})}})})(l);return;case"current_user":onCurrentUser();return;case"escape":document.activeElement===r&&(window.focus(),o({type:"blur"}));return}}async function onRequestDatabaseToken(e){let t;let n=$.current;if(!W){n({type:"resolve_database_token",name:e,error:u.uW});return}if(!ea.current.has(e)){n({type:"resolve_database_token",name:e,error:"Database not allowed"});return}try{t=ey?await (0,m.Fv)("/document/".concat(H,"/data-connector/token/embed"),{name:e},{headers:{"Content-Type":"application/json",Authorization:"apikey ".concat(ey)}}):await (0,m.Fv)("".concat("team"===A.type?"/team/".concat(A.id):"/user","/data-connector/token"),{name:e})}catch(t){n({type:"resolve_database_token",name:e,error:"Database not found"});return}n({type:"resolve_database_token",name:e,token:t})}async function onRequestCloudFile(e){let t=$.current;if(!W){t({type:"resolve_cloud_file",name:e,error:u.Px});return}let n=em.current.resolve("cloud_file",e);if(!n){t({type:"remove_file",name:e});return}try{let r=await (0,v.w)(A,{type:"cloud_file",specifier:e,value:n});t({type:"resolve_cloud_file",name:e,url:r})}catch(n){t({type:"resolve_cloud_file",name:e,error:n.message})}}async function onRequestNotificationClient(e){let t=$.current;if(!Y){t({type:"resolve_notification_client",specifier:e,error:"Not available"});return}if(!W){t({type:"resolve_notification_client",specifier:e,error:y.K.NOTIFICATION_PRIVATE_ERROR});return}if(!el.current.has(e)){t({type:"resolve_notification_client",specifier:e,error:y.K.NOTIFICATION_DESTINATION_NOT_ALLOWED});return}let[n]=e.split(":");if("slack"===n)try{await (0,m.a8)("/team/".concat(A.id,"/token?provider=slackNotifications")),t({type:"resolve_notification_client",specifier:e})}catch(n){t({type:"resolve_notification_client",specifier:e,error:y.K.NOTIFICATION_PROVIDER_NOT_AUTHORIZED})}else t({type:"resolve_notification_client",specifier:e})}async function onCurrentUser(){let e=$.current;await e({type:"current_user",currentUser:es.current})}return X.current=r,$.current=t=>{n?n.push(t):a.postMessage(t,e)},J.current=-1,Q.current=new Map,ee.current=new Map,en.current=new Set,ea.current=new Set,el.current=new Set,ef.current=[],eo.current=t.signal,()=>{o({type:"workerGoodbye"}),removeEventListener("message",messaged),$.current=void 0,J.current=void 0,Q.current=void 0,ee.current=void 0,en.current=void 0,er.current=void 0,ea.current=void 0,el.current=void 0,eo.current=void 0,ei.current=void 0,ec.current=void 0,X.current=void 0,r.remove(),r.src="about:blank",t.abort()}},[z,V,W,A,o,x,ey,H,q,eg,G,Y]);let ew=ev.current?null===(t=ef.current)||void 0===t?void 0:t.filter(e=>{var t,n;let r=P.nodes.find(t=>t.id===e.slots[0].nodeId);return!(null==r?void 0:null===(n=r.display)||void 0===n?void 0:null===(t=n.presentation)||void 0===t?void 0:t.hidden)}):ef.current,ek=eg?(null==ew?void 0:ew.length)||0:ev.current?P.nodes.filter(e=>{var t,n;return!(null===(n=e.display)||void 0===n?void 0:null===(t=n.presentation)||void 0===t?void 0:t.hidden)}).length:P.nodes.length-(x?x.length:0);return(0,c.useEffect)(()=>{var e;if(!X.current)return;let t=(0,N.hY)(B)+(ek+(eg?0:1))*L.KI+(!ev.current&&(eg||(null===(e=ef.current)||void 0===e?void 0:e.length)&&ef.current.length>0)?ek*L.dL+L.xe:0);X.current.style.height="".concat(t,"px")},[ek,B,eg]),(0,c.useEffect)(()=>{let e=[],t=[],r=[],l=[],o=[];if(function(e,t,n,r,l,o,i,c,d,u,p){let m=e.current<0?a.Z.create(t).events.filter(e=>e):t.history.slice(e.current),h=new Set,f=!1;for(let a of m){let{type:m}=a;switch(m){case"modify_data":if(function(e){let{type:t,old_node_data:n,new_node_data:r}=e;return"modify_data"===t&&!s()(null==n?void 0:n.display,null==r?void 0:r.display)}(a)){let{node_id:e,new_node_data:t}=a;n.push({type:"modify_display",node_id:e,new_node_data:t});continue}case"mode_node":case"insert_node":case"modify_node":case"modify_name":{let{node_id:s,new_next_node_id:c,new_node_mode:d,new_node_data:f,new_combine:v,new_node_display:x}=a,g=(0,Z.Z)((0,C.DY)(t,s)||{value:"",mode:"js",name:null}),b={type:m,node_id:s,new_node_value:g,new_next_node_id:c,new_node_mode:d,new_node_data:f,new_combine:v,new_node_display:x,hidden:null==p?void 0:p.includes(s)};"import"===g.type?r.push({nodeId:s,value:g,shouldCapture:e.current>=0&&a.version>u}):(g.secrets&&l.push(...g.secrets),g.databaseClients&&o.push(...g.databaseClients),g.notificationClients&&i.push(...g.notificationClients)),h.add(s),n.push(b);break}case"move_node":{let{node_id:e,new_next_node_id:t,new_combine:r,new_node_display:l}=a;n.push({type:m,node_id:e,new_next_node_id:t,new_combine:r,new_node_display:l});break}case"remove_node":{let{node_id:e}=a;n.push({type:m,node_id:e});break}case"resolve_dependency":{let{version:e,specifier:t,specifier_type:r,new_resolution:l}=a;if("cloud_file"===r)l?n.push({type:"insert_file",name:t,cloud:!0,mimeType:(0,k.L)(t)}):n.push({type:"remove_file",name:t});else if("notebook"===r){let n=d.get(t);n&&n===l?d.delete(t):c.current<e&&(f=!0,c.current=e)}}}}f&&function(e,t,n,r){for(let a of e.nodes){if(t.has(a.id))continue;t.add(a.id);let l=(0,Z.Z)((0,C.DY)(e,a.id)||{value:"",mode:"js",name:null});"import"===l.type&&(n.push({nodeId:a.id,value:l,shouldCapture:!1}),r.push({type:"modify_node",node_id:a.id,new_node_value:l}))}}(t,h,r,n),e.current=t.history.length}(J,P,e,t,r,l,o,ep,eh.current,n.saveVersion,x),function(e,t,n){if(e.current!==t){let r=e.current;for(let[a,l]of(e.current=t,t)){let e=r.get(a);if((0,w.ki)(l)){if((0,w.ki)(e)){if("pending"===e.status&&void 0===e.blob&&"pending"!==l.status){let{url:e,mimeType:t}=l;n.push({type:"modify_file",name:a,url:e,mimeType:t})}else if("pending"===e.status&&e.blob&&"pending"!==l.status&&e.mimeType!==l.mimeType){let{blob:e,mimeType:t}=l;n.push({type:"modify_file",name:a,blob:e,mimeType:t})}}else{let{url:e,blob:t,mimeType:r,privateBucketId:s}=l;n.push({type:"insert_file",name:a,url:e,blob:t,mimeType:r,privateBucketId:s})}}}for(let[e,a]of r){let r=t.get(e);!(0,w.ki)(r)&&(0,w.ki)(a)&&n.push({type:"remove_file",name:e})}}}(Q,O,e),function(e,t,n,r){if(e.current!==t){let a=e.current;for(let[l,{editor:s,comments:o,display:i}]of(e.current=t,t)){let e=s+o+i,t=a.has(l)?a.get(l).editor+a.get(l).comments+a.get(l).display:0;t!==e&&n.push(r?{type:"offset_row",row_id:l,height:e}:{type:"offset_node",node_id:l,height:e})}for(let[e,{editor:l}]of a)t.has(e)||0===l||n.push(r?{type:"offset_row",row_id:e,height:0}:{type:"offset_node",node_id:e,height:0})}if(n.length){let e=new Map;for(let{type:a,node_id:l,row_id:s}of n){let n=r?s:l;switch(a){case"insert_node":{let r=t.get(n);r&&e.set(n,r.editor+r.comments+r.display);break}case"remove_node":e.delete(n)}}for(let[t,a]of e)n.push(r?{type:"offset_row",row_id:t,height:a}:{type:"offset_node",node_id:t,height:a})}}(ee,B,e,eg),function(e){for(let{nodeId:t,value:n,shouldCapture:r}of e){let e=D.Z.parse(n.specifier);null===e?n.module=n.specifier:(n.notebook=e.toNotebookURL(),isPublicImport(e)&&(!r||alreadyCaptured(e))&&resolutionsAreSynced()?n.module=moduleURL(e):(n.module=++F,resolveImport(t,n.module,e,r)))}}(t),resolveSecrets(r,e),resolveDatabases(l),resolveNotifications(o),updatePath(e,I),e.length&&$.current({type:"bundle",events:e}),function(e,t,n){let r=t.nodes[0];return!!(r!==e.current||n.some(e=>{let{type:t,node_id:n}=e;return"modify_node"===t&&n===r.id}))&&(e.current=r,!0)}(et,P,e)){let e=P.version>n.initialLatestVersion||P.version>n.saveVersion;e&&updateTitle()}(function(e){if(e.size)for(let t of[...e])e.delete(t),t.resolve(t.process(postRequest))})(U),maybeSignPrivateImports(),maybeSendResolvedImports()}),(0,r.jsx)("div",{ref:K})}},49556:function(e,t,n){n.d(t,{k:function(){return useHashScroll}});var r=n(67294),a=n(17267),l=n(90271),s=n(41312);function useHashScroll(e,t,n,o,i){let[c,d]=(0,r.useState)(a.Qg&&!!location.hash),[u,p]=(0,r.useState)(!0),m=(0,r.useRef)();(0,r.useEffect)(()=>{if(c){let e=setTimeout(()=>p(!1),3e3);return()=>clearTimeout(e)}},[c]),(0,r.useEffect)(()=>{if(c){let c=location.hash.slice(1),f=!1,v=201;if(c.startsWith("comment-")){let e=document.getElementById(c);if(e)v=e.getBoundingClientRect().top,f=!0;else{let e=c.slice(8);for(let[t,r]of n)if(r.some(t=>t.id===e)){o({type:"showComments",nodeId:t,trigger:"Implicit",source:"hash"});break}}}else for(let n of e){var r,a,h;let e=i?null===(r=i.find(e=>e.slots.find(e=>e.nodeId===n.id)))||void 0===r?void 0:r.id:n.id;if(!e||u&&!(null===(a=t.get(e))||void 0===a?void 0:a.worker))break;if((0,s.u2)(n)===c||"cell-".concat(n.id)===c){f=!0;break}v+=((null===(h=t.get(e))||void 0===h?void 0:h.total)||0)+l.KI}if(f){if(u)m.current&&clearTimeout(m.current),m.current=setTimeout(()=>p(!1),150);else{let e=v-l.MT-5;Math.abs(window.scrollY-e)>l.MT&&scrollTo(0,e),d(!1)}}else u||d(!1)}return()=>{m.current&&clearTimeout(m.current)}},[c,u,e,t,n,o,i])}},82959:function(e,t,n){n.d(t,{E:function(){return useVisible}});var r=n(67294);let a="undefined"!=typeof IntersectionObserver;function useVisible(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{root:n=null,rootMargin:l="0px",threshold:s=0,defaultValue:o=!a}=t,[i,c]=(0,r.useState)(o),d=(0,r.useMemo)(()=>a?new IntersectionObserver(e=>{let[t]=e;c(t.isIntersecting)},{root:n,rootMargin:l,threshold:s}):null,[n,l,s]);return(0,r.useEffect)(()=>{let t=e.current;return t&&d?(d.observe(t),()=>{d.disconnect()}):void 0},[d,e]),i}},11026:function(e,t,n){n.d(t,{a:function(){return getCloudFileSpecifier},w:function(){return getCloudFileDownloadUrl}});var r=n(64487),a=n(40123),l=n(5146),s=n(90580);function getCloudFileSpecifier(e){let t=/^([a-zA-Z]+):\/\/(.*)$/.exec(e.specifier);if(!t)return null;let n=Object.entries(s.c).find(e=>{let[,{shorthand:n}]=e;return n===t[1]});return n?{provider:n[0],name:t[2],specifier:e.specifier,path:e.value}:null}async function getCloudFileDownloadUrl(e,t){let n=getCloudFileSpecifier(t);if(!n)throw(0,r.uT)("Invalid cloud file path: ".concat(t.value)),Error("Invalid cloud file path.");return getDownloadUrl(e,n)}async function getDownloadUrl(e,t){let n;try{let r="team"===e.type?"/team/".concat(e.id):"/user";n=await (0,l.Fv)("".concat(r,"/cloud-file/token"),{provider:t.provider,path:t.path})}catch(e){throw Error(a.t5)}return"".concat("https://connector.observableusercontent.com","/file?token=").concat(encodeURIComponent(n))}},55514:function(e,t,n){n.d(t,{r:function(){return fetchJson}});var r=n(27507);async function fetchJson(e,t){let n=await fetch(e,{headers:{authorization:"Bearer ".concat(t),"content-Type":"application/json"}});if(!n.ok){let e=n.headers.get("content-type");if(null==e?void 0:e.startsWith("application/json")){let{error:e}=await n.json();throw Error(e.message)}throw new r.ZP(n.status,n.url)}return n.json()}},44403:function(e,t,n){n.d(t,{L:function(){return mimeTypeFromFilename}});function mimeTypeFromFilename(e){let t=e.lastIndexOf(".");if(-1===t)return"application/octet-stream";switch(e.substring(t+1)){case"png":return"image/png";case"jpg":case"jpeg":return"image/jpeg";case"gif":return"image/gif";case"bmp":return"image/bmp";case"json":return"application/json";case"db":return"application/x-sqlite3";case"zip":return"application/zip";case"css":return"text/css";case"csv":return"text/csv";case"txt":return"text/plain";case"html":return"text/html";case"js":return"text/javascript";case"mp3":return"audio/mpeg";case"mp4":return"video/mp4";case"tsv":return"text/tab-separated-values";case"xlsx":return"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";case"pptx":return"application/vnd.openxmlformats-officedocument.presentationml.presentation";case"docx":return"application/vnd.openxmlformats-officedocument.wordprocessingml.document";default:return"application/octet-stream"}}},73515:function(e,t,n){let r;function isValidGooglePath(e){return!!/drive\/v3\/files\/.*/.test(e)}n.d(t,{N6:function(){return l},SW:function(){return getGoogleExportMimeType},__:function(){return getGapi},eJ:function(){return a},ty:function(){return isValidGooglePath},wA:function(){return getGoogleKey}});let a="614404957759",l="AIzaSyAjxeAzLAiTpmClMsnQ6OuZMg5BC7AckCA",s=new Map([["application/vnd.google-apps.document","text/html"],["application/vnd.google-apps.drawing","image/svg+xml"],["application/vnd.google-apps.form","text/html"],["application/vnd.google-apps.map","text/html"],["application/vnd.google-apps.photo","image/jpeg"],["application/vnd.google-apps.presentation","application/pdf"],["application/vnd.google-apps.script","text/plain"],["application/vnd.google-apps.site","text/html"],["application/vnd.google-apps.spreadsheet","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"]]);function getGoogleKey(e,t){return["".concat("https://www.googleapis.com").concat(e),t]}function getGoogleExportMimeType(e){return s.get(e)||e}async function getGapi(){return r||(r=new Promise(e=>{let t="gapiLoaded".concat(Math.random()),n=document.createElement("script");n.src="https://apis.google.com/js/api.js?onload=".concat(t),window[t]=function(){e(window.gapi),delete window[t]},document.head.appendChild(n)})),r}},54524:function(e,t,n){n.d(t,{K:function(){return isNotNull}});function isNotNull(e){return null!==e}},12307:function(e,t,n){function some(e,t){for(let n of e)if(t(n))return!0;return!1}function shallowArrayCompare(e,t){return e.length===t.length&&e.every(e=>t.includes(e))&&t.every(t=>e.includes(t))}n.d(t,{G:function(){return some},u:function(){return shallowArrayCompare}})},77110:function(e,t,n){n.d(t,{V:function(){return createKeymap}});var r=n(17267);function createKeymap(e){let t=new Map;for(let n of e){let e=n.length-1,a=n[e];for(let l=0;l<e;++l){let e=n[l],s=function(e){let t=e.split(/-(?!$)/),n=t.pop();if(!n)throw Error("Missing key: ".concat(e));"space"===(n=n.toLowerCase())&&(n=" ");let a=!1,l=!1,s=!1,o=!1;for(let e of t)switch(e.toLowerCase()){case"meta":a=!0;break;case"alt":l=!0;break;case"ctrl":s=!0;break;case"shift":o=!0;break;case"mod":r.Mq?a=!0:s=!0;break;default:throw Error("Unrecognized modifier: ".concat(e))}return getEventName({key:n,ctrlKey:s,altKey:l,shiftKey:o,metaKey:a})}(e);if(t.has(s))throw Error("Duplicate entry: ".concat(e));t.set(s,a)}}return(e,n)=>{let r=t.get(getEventName(n));return!!r&&r(e,n)}}function getEventName(e){let t=[];return e.ctrlKey&&t.push("Control"),e.altKey&&t.push("Alt"),e.shiftKey&&t.push("Shift"),e.metaKey&&t.push("Meta"),t.push(e.key.toLowerCase()),t.join("-")}},94179:function(e,t,n){n.d(t,{B5:function(){return l},ax:function(){return licenseTitle},nm:function(){return defaultCopyright}});var r=n(17616);let a=new Map(Object.entries({"agpl-3.0":{short:"GNU AGPLv3",long:"GNU Affero General Public License v3.0"},"apache-2.0":{short:"Apache 2.0",long:"Apache License "},"bsd-3-clause":{short:"BSD 3-Clause",long:"BSD 3-Clause “New” or “Revised” License"},"cc-by-4.0":{short:"CC BY 4.0",long:"Creative Commons Attribution 4.0 International"},"cc-by-sa-4.0":{short:"CC BY-SA 4.0",long:"Creative Commons Attribution Share Alike 4.0 International"},"gpl-3.0":{short:"GNU GPLv3",long:"GNU General Public License v3.0"},isc:{short:"ISC",long:"ISC License"},"lgpl-3.0":{short:"GNU LGPLv3",long:"GNU Lesser General Public License v3.0"},mit:{short:"MIT",long:"MIT License"},other:{short:"Other",long:"Other"}})),l=Array.from(a.keys());function licenseTitle(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"short";if(!e)return"None";let n=a.get(e);if(!n)throw Error("Unknown license identifier: ".concat(e));return n[t]}function defaultCopyright(e){return"Copyright ".concat(new Date().getFullYear()," ").concat((0,r.RX)(e))}},8896:function(e,t,n){n.d(t,{Xk:function(){return isValidMicrosoftPath},Z8:function(){return fetchMicrosoftDrives},ap:function(){return getSize},bh:function(){return getMimeType},g4:function(){return getMicrosoftKey},mL:function(){return getMicrosoftKeyLoader},sZ:function(){return callTeamsFn}});var r=n(17267),a=n(55514),l=n(44403),s=n(54524);function getMicrosoftKey(e,t){return["".concat("https://graph.microsoft.com","/v1.0").concat(e),t]}function getMicrosoftKeyLoader(e,t){return(n,r)=>t&&(!r||r["@odata.nextLink"])?r&&0!==n?[r["@odata.nextLink"],t]:getMicrosoftKey(e,t):null}async function fetchMicrosoftDrives(e){let[,t,n]=e,r=n?await (0,a.r)(...getMicrosoftKey("/me/memberOf/microsoft.graph.group",t)):{value:[]},l=await Promise.all([(0,a.r)(...getMicrosoftKey("/me/drives",t)).catch(()=>null),...r.value.map(e=>(0,a.r)(...getMicrosoftKey("/groups/".concat(e.id,"/drives"),t)).catch(()=>null))]);return l.filter(s.K).flatMap(e=>e.value)}function getMimeType(e,t){var n,r;let a=(null==e?void 0:e.remoteItem)?null===(n=e.remoteItem.file)||void 0===n?void 0:n.mimeType:null==e?void 0:null===(r=e.file)||void 0===r?void 0:r.mimeType;return a&&"application/vnd.ms-excel"!==a?a:(0,l.L)(null!=t?t:"")}function getSize(e){return(null==e?void 0:e.remoteItem)?e.remoteItem.size:null==e?void 0:e.size}function isValidMicrosoftPath(e){return!!/\/drives\/[!a-zA-Z0-9-_]+\/items\/([!a-zA-Z0-9-_]+)/.test(e)}function callTeamsFn(e){r.Qg&&n.e(2303).then(n.t.bind(n,52303,23)).then(t=>e(t))}},44966:function(e,t,n){n.d(t,{Z:function(){return objectKey}});let r=0,a=new WeakMap;function objectKey(e){let t=a.get(e);return void 0===t&&a.set(e,t=r++),t}},49751:function(e,t,n){n.d(t,{$r:function(){return groupDirectImports},ng:function(){return getImportSpecifierInfo},uF:function(){return useStickyImports},xT:function(){return hasError}});var r=n(33083),a=n(67294),l=n(40591),s=n(41312),o=n(4870),i=n(5146);function hasError(e){return!!e&&"error"in e}function groupDirectImports(e){let{imports:t}=e,[[n]=[]]=t;if(!n)return{mainSpecifier:n,directImports:new Map};let r=[...new Set(t.flat())],a=r.map(e=>({specifier:e,children:[],childrenSet:new Set})),l=new Map(a.map(e=>[e.specifier,e])),s=new Map;for(let[e,r]of t){e===n&&s.set(r,[]);let t=l.get(e),a=l.get(r);t.childrenSet.has(r)||(t.childrenSet.add(r),t.children.push(a))}for(let e of s.keys())s.set(e,function traverse(e,t){let{specifier:n,children:r}=e,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Set;return a.has(n)?[]:(a.add(n),[[t,n],...r.flatMap(e=>traverse(e,n,a))])}(l.get(e),n));return{mainSpecifier:n,directImports:s}}function getImportSpecifierInfo(e,t,n){let r=new Map(n.filter(e=>"notebook"===e.type).map(e=>{let{specifier:t,value:n}=e;return[t,o.Z.parse(n)]})),a=new Map(Object.entries(e).map(e=>{var t;let[n,a]=e,l=r.has(n)?r.get(n).version:void 0,s=hasError(a)?void 0:null===(t=o.Z.parse(a.resolution))||void 0===t?void 0:t.version;return[n,{lockStatus:void 0!==l?"locked":"unlocked",version:l,latestVersion:s,updatesAvailable:void 0!==l&&l!==s}]}));for(let[e,n]of t){let t=0,r=!1;for(let[,e]of n){let n=a.get(e);t+=(null==n?void 0:n.lockStatus)==="locked"?1:0,r||(r=!!(null==n?void 0:n.updatesAvailable))}let l=a.get(e);l&&(l.lockStatus=t===n.length?"locked":0===t?"unlocked":"mixed",l.updatesAvailable=r)}return a}function useStickyImports(e){let{id:t,saveVersion:n,model:o}=e,{ignoreResolutions:c}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},d=(0,a.useRef)(n),u=(0,a.useRef)(o.history.length),p=(0,a.useRef)(),m=(0,a.useRef)(new Set(o.nodes.map(e=>(0,r.oo)((0,s.Qc)(e))?e.id:void 0).filter(e=>e))),h=o.history.slice(u.current);for(let e of h){let{type:t,version:n}=e;switch(t){case"insert_node":case"modify_node":{let{node_id:t}=e,a=(0,l.DY)(o,t);if(!a)break;(0,r.oo)((0,s.Qc)(a))&&(m.current.add(t),d.current=n);break}case"remove_node":{let{node_id:t}=e;m.current.has(t)&&(m.current.delete(t),d.current=n);break}case"resolve_dependency":d.current=n}}u.current=o.history.length;let f="".concat(t,"@").concat(Math.min(n,d.current)),v="/document/".concat(f,"/imports").concat(c?"":"?resolutions=".concat(f)),{data:x,error:g}=(0,i.h_)(v);return g?console.error("notebook import resolutions failed to load."):x&&(p.current=x),p.current}},65920:function(e,t,n){n.d(t,{O:function(){return loadCompare}});var r=n(11163),a=n.n(r);let loadCompare=(e,t)=>{let{base:n,target:r}=t,l="".concat(n.id).concat(n.version?"@".concat(n.version):""),s="".concat(r.id).concat(r.version?"@".concat(r.version):"");a().push("/compare/".concat(l,"...").concat(s))}},22127:function(e,t,n){let r;n.d(t,{C:function(){return P}});var a=n(4530),l=n(40591);let insertAnalytic=(e,t)=>{let{notebook:n,currentUser:r}=e,{type:l,id:s,trigger:o,source:i}=t;(0,a.MR)((0,a.ym)({type:"notebook:cells:manage:insert",data:{cellIds:[s],trigger:o,source:i,before:"insertBefore"===l},eventVersion:3,notebook:n,currentUser:r}))},moveAnalytic=(e,t)=>{let{notebook:n,currentUser:r}=e,{id:l}=t;(0,a.MR)((0,a.ym)({type:"notebook:cells:manage:move",data:{cellIds:[l]},eventVersion:3,notebook:n,currentUser:r}))},splitAnalytic=(e,t)=>{let{notebook:n,currentUser:r}=e,{type:s,id:o,trigger:i}=t;(0,a.MR)((0,a.ym)({type:"notebook:cells:manage:split",data:{cellIds:[o],mode:(0,l.DY)(n.model,o).mode,trigger:i,source:"nodeEditor",before:"splitBefore"===s},eventVersion:1,notebook:n,currentUser:r}))};function truncate(e,t){return e.length>t?"".concat(e.slice(0,t-1),"…"):e}var s=n(63302),o=n(49817),i=n(26886);function sendPaneDismissedEvent(e,t,n,r){switch(e){case"aiassist":(0,a.MR)((0,a.ym)({type:"notebook:view:assistPaneDismissed",data:{newPaneOpened:t},eventVersion:1,notebook:n,currentUser:r}));break;case"help":(0,a.MR)((0,a.ym)({type:"notebook:view:helpPaneDismissed",data:{newPaneOpened:t},eventVersion:1,notebook:n,currentUser:r}));break;case"files":(0,a.MR)((0,a.ym)({type:"notebook:view:filesPaneDismissed",data:{newPaneOpened:t},eventVersion:1,notebook:n,currentUser:r}));break;case"history":(0,a.MR)((0,a.ym)({type:"notebook:view:historyPaneDismissed",data:{newPaneOpened:t},eventVersion:1,notebook:n,currentUser:r}));break;case"minimap":(0,a.MR)((0,a.ym)({type:"notebook:view:minimapPaneDismissed",data:{newPaneOpened:t},eventVersion:1,notebook:n,currentUser:r}));break;case"insights":(0,a.MR)((0,a.ym)({type:"notebook:view:insightsPaneDismissed",data:{newPaneOpened:t},eventVersion:1,notebook:n,currentUser:r}));break;case"find":(0,a.MR)((0,a.ym)({type:"notebook:view:findPaneDismissed",data:{newPaneOpened:t},eventVersion:1,notebook:n,currentUser:r}));break;case"dependencies":(0,a.MR)((0,a.ym)({type:"notebook:view:dependenciesPaneDismissed",data:{newPaneOpened:t},eventVersion:1,notebook:n,currentUser:r}));break;case"guide":(0,a.MR)((0,a.ym)({type:"notebook:view:guidePaneDismissed",data:{newPaneOpened:t},eventVersion:1,notebook:n,currentUser:r}));break;case"databases":(0,a.MR)((0,a.ym)({type:"notebook:view:databasesPaneDismissed",data:{newPaneOpened:t},eventVersion:1,notebook:n,currentUser:r}));break;case"schedule":(0,a.MR)((0,a.ym)({type:"notebook:view:schedulePaneDismissed",data:{newPaneOpened:t},eventVersion:1,notebook:n,currentUser:r}))}}var c=n(41269),d=n(6359),u=n(4640),p=n(32007),m=n(42962);let h=[{pattern:RegExp("^@notebook show columns from ((?<tableName>\\w+))$"),handler:(e,t)=>{let{dispatch:n,nodeId:r,notebook:a}=e,{tableName:s}=t;if(!s)return Promise.resolve("");let o=null!==r?(0,l.DY)(a.model,r):null;if(o&&"sql"===o.mode){let e=(0,p.VQ)(o.data);if(!e)return Promise.resolve("");let t=new d.n4(e,s,o.mode,void 0,void 0,o.id);return t.run(n).then(e=>JSON.stringify(Object.fromEntries(e)),e=>(console.error("Error fetching schema for chat: ",e),""))}return Promise.resolve("")}},{pattern:/^@notebook show tables$/,handler:e=>{let{dispatch:t,nodeId:n,notebook:r}=e,a=null!==n?(0,l.DY)(r.model,n):null;if(a&&"sql"===a.mode){let e=(0,p.VQ)(a.data);if(!e)return Promise.resolve("");let n=new d.Y2(e),r=(0,p.w4)((0,c.yD)(e.dialect)?"duckdb":(0,p.h8)(e.dialect));return n.run(t).then(e=>JSON.stringify({dialect:r,tables:e.map(e=>(0,m.Vi)(e))}),e=>(console.error("Error fetching schema for chat: ",e),""))}return Promise.resolve("")}},{pattern:/^@notebook show schemas$/,handler:e=>{let{dispatch:t,notebook:n}=e;async function getCellSchemas(){let e=[],n=new u.S(async(t,n)=>{t({type:"request_data_sources",mode:"table"});try{for await(let t of n()){let{name:n,dialect:r}=t,a={name:"".concat(n),type:"cell",dialect:(0,p.Ov)(r)};e.push(a)}}catch(e){console.error("Error fetching cell schemas: ",e)}});for(let r of(await n.run(t),e)){let e=new d.n4(r,"unknown","table");try{r.schema=JSON.stringify(Object.fromEntries(await e.run(t)))}catch(e){console.error("Error fetching schema for cell: ",r.name)}}return JSON.stringify(e)}return r&&r.id===n.id&&r.version===n.model.version?r.results:(r={id:n.id,version:n.model.version,results:getCellSchemas()}).results}}];var f=n(46047),v=n(36891),x=n(843),g=n(43318),b=n(65920),y=n(78546),j=n(45495),w=n(87480);let downloadNotebook=async e=>{let{notebook:t}=e,{id:n,saveVersion:r}=t,a=await fetch("".concat("https://api.observablehq.com","/document/").concat(n,"@").concat(r,"/download?v=3"),{credentials:"include"}),{tarball_path:l}=await a.json();(0,w.G)("".concat("https://api.observablehq.com").concat(l))};var k=n(9039),C=n(73466),N=n(80833),S=n(66652),L=n(47716),M=n(82244),R=n(90772),D=n(30743),_=n(28826),Z=n(85478),E=n(33251);let setNotebookDataConnectorListener=async(e,t,n)=>{let{context:{context:r},notebook:{focusId:a,model:{nodes:l},type:s}}=e,{dataConnector:o,nodeId:i}=t,{name:c}=o;n({type:"showProcessingToast",key:"setDataConnector",message:'Saving data connector "'.concat(c,'"…')});try{await (0,E.qE)(o,null==r?void 0:r.id),n({type:"showSuccessToast",key:"setDataConnector",message:'Saved data connector "'.concat(c,'".')});let e=void 0!==i?i:null!==a&&"dashboard"!==s?a:l[l.length-1].id;n({type:"insertAfter",id:e,node:{mode:"sql",data:{source:{type:"database",name:c}}},trigger:"Implicit",source:"dataConnectorModal"})}catch(e){n({type:"showErrorToast",key:"setDataConnector",message:"Oops, saving data connector failed. Try again?"})}};var T=n(90805),F=n(59771),V=n(34513),I=n(10327),H=n(69948),A=n(5634);let P={acceptCompletion:(e,t)=>{let{notebook:n,currentUser:r}=e,{origin:l}=t;(0,a.MR)((0,a.ym)({type:"notebook:cells:manage:acceptCompletion",data:{origin:l},eventVersion:1,notebook:n,currentUser:r}))},acceptSnippet:F.eY,acknowledgeSuggestionClosed:I.G6,addTag:H._U,addedDatabase:(e,t)=>{let{notebook:n,currentUser:r}=e,{id:l}=t;(0,a.MR)((0,a.ym)({type:"notebook:cells:manage:addDatabase",data:{cellIds:[l]},eventVersion:1,notebook:n,currentUser:r}))},chatFeedback:(e,t)=>{let{notebook:n,currentUser:r}=e,{id:l,feedback:s,reason:o}=t;s&&(0,a.MR)((0,a.ym)({type:"notebook:assist:feedback",data:{chatId:l,feedback:s,reason:o||"none"},eventVersion:1,notebook:n,currentUser:r}))},chatsReceived:(e,t,n)=>{let{notebook:r,currentUser:a}=e,{chats:l}=t;for(let{id:e,ref_id:t,content:s,node_id:o}of l){if([...r.chatMessages,...l].find(t=>t.ref_id===e))continue;let i=function(e){for(let t of h){let n=t.pattern.exec(e);if(n)return{handler:t.handler,args:n.groups}}}(s.body[0].text);if(i){let l=r.chatMessages.find(e=>e.id===t);if(!l||!("local"in l))continue;i.handler({notebook:r,nodeId:o,dispatch:n},i.args||{}).then(t=>n({type:"chatSend",node_id:o,ref_id:e,sender:a,content:{body:[{type:"system",text:t}]}}))}}},chatSendDraft:(e,t)=>{let{notebook:n,currentUser:r}=e,{scope:l,cellIncluded:s}=t;(0,a.MR)((0,a.ym)({type:"notebook:assist:draftsent",data:{scope:l,cellIncluded:s},eventVersion:1,notebook:n,currentUser:r}))},closeSuggestion:I.nK,closeSuggestionSucceeded:i.JB,cloudFileSnippet:y.zX,commentComposeCancel:(e,t)=>{var n;let{notebook:r,currentUser:l}=e,{nodeId:s,trigger:o,content:i,source:c}=t;(0,a.MR)((0,a.ym)({type:"notebook:cells:comment:cancel",data:{cellIds:[s],length:i.length,trigger:o,source:c},eventVersion:4,notebook:r,currentUser:l})),r.comments.has(s)&&(null===(n=r.comments.get(s))||void 0===n?void 0:n.length)!==0||(0,a.MR)((0,a.ym)({type:"notebook:cells:comment:hideComments",data:{cellIds:[s],cancelCompose:!0,trigger:o,source:"commentBox"},eventVersion:2,notebook:r,currentUser:l}))},commentComposeOpen:(e,t)=>{let{notebook:n,currentUser:r}=e,{nodeId:l,trigger:s,source:o}=t;(0,a.MR)((0,a.ym)({type:"notebook:cells:comment:openCompose",data:{cellIds:[l],trigger:s,source:o},eventVersion:3,notebook:n,currentUser:r}))},commentCreated:(e,t)=>{let{notebook:n,currentUser:r}=e,{nodeId:l,source:o}=t,i=(0,s.o7)(n,l),c=(0,s.HS)(n,l),d=new Set;for(let e of c)d.add(e.user.id);for(let e of i)d.add(e.user.id);let u=c.some(e=>e.user.id===(null==r?void 0:r.id))||i.some(e=>e.user.id===(null==r?void 0:r.id));(0,a.MR)((0,a.ym)({type:"notebook:cells:comment:submit",data:{cellIds:[l],commentsOnCell:c.length+i.length,unresolvedCommentsOnCell:c.length,commentersOnCell:d.size,userHasCommentedOnCell:u,trigger:"click",source:o},eventVersion:4,notebook:n,currentUser:r}))},commentDeleted:(e,t)=>{let{notebook:n,currentUser:r}=e,{comment:l,trigger:s,source:o}=t;(0,a.MR)((0,a.ym)({type:"notebook:cells:comment:delete",data:{cellIds:[l.node_id],userIsCommentAuthor:l.user.id===(null==r?void 0:r.id),trigger:s,source:o},eventVersion:3,notebook:n,currentUser:r}))},commit:(e,t)=>{let{notebook:n,currentUser:r}=e,{id:l,trigger:s,source:o}=t;(0,a.MR)((0,a.ym)({type:"notebook:cells:edit:evaluate",data:{cellIds:[l],trigger:s,source:o},eventVersion:6,notebook:n,currentUser:r})),gtag("event","Edit",{event_category:"Notebook"})},confirmNotificationRequest:L.Q1,copyDatabaseCode:y.ZG,copyFileCode:[k.Nz,i.Hf],deleteTag:H.Pn,disableAutosave:e=>{let{notebook:t,currentUser:n}=e;(0,a.MR)((0,a.ym)({type:"notebook:view:autosaveDisabled",eventVersion:1,notebook:t,currentUser:n}))},dismissPane:e=>{let{notebook:t,page:n,currentUser:r}=e;null!==n.pane&&sendPaneDismissedEvent(n.pane,null,t,r)},dismissWelcomeMatBanner:()=>{(0,a.MR)((0,a.a$)({type:"marketing:view:dismissWelcomeBanner",data:{experiment:null},eventVersion:1,currentUser:null}))},dragEnded:moveAnalytic,downloadCode:[downloadNotebook,i.kg],downloadCloudFile:y.Tv,downloadFile:i.lA,exitVersionedMode:v.Q,createDocumentKey:j.H,fileMarkedForDeletion:i.hO,replaceFile:k.bC,fileReplaced:i.tq,focusDefinition:(e,t)=>{let{notebook:n,currentUser:r}=e,{id:l,trigger:s,source:o}=t;(0,a.MR)((0,a.ym)({type:"notebook:cells:view:focusDefinition",data:{cellIds:[l],trigger:s,source:o},eventVersion:1,notebook:n,currentUser:r}))},focusError:(e,t)=>{let{notebook:n,currentUser:r}=e,{id:l}=t;(0,a.MR)((0,a.ym)({type:"notebook:cells:view:focusError",data:{cellIds:[l]},eventVersion:1,notebook:n,currentUser:r}))},forkRequested:C.J1,embedModalCopy:i.M6,helpPaneLinkClicked:(e,t)=>{let{notebook:n,currentUser:r}=e,{section:l,url:s}=t;(0,a.MR)((0,a.ym)({type:"notebook:view:helpPaneLink",data:{section:l,url:s},eventVersion:1,notebook:n,currentUser:r}))},hideComments:(e,t)=>{let{notebook:n,currentUser:r}=e,{nodeId:l,trigger:s,source:o}=t;(0,a.MR)((0,a.ym)({type:"notebook:cells:comment:hideComments",data:{cellIds:[l],cancelCompose:!1,trigger:s,source:o},eventVersion:2,notebook:n,currentUser:r}))},insertAfter:insertAnalytic,insertBefore:insertAnalytic,insertCloudFile:y.Xm,insertDatabase:y._E,insertFile:i.Nl,insertSnippet:F.ns,like:S.v,liked:(e,t)=>{let{notebook:n,currentUser:r}=e,{liked:l}=t;(0,a.MR)((0,a.ym)({type:l?"notebook:social:like":"notebook:social:unlike",data:{},eventVersion:4,notebook:n,currentUser:r})),gtag("event","Like",{event_category:"Social"})},loadCompare:[b.O,(e,t)=>{let n,{notebook:r,currentUser:l}=e,{trigger:s,source:o,base:i,target:c,loadType:d}=t;if("reverse"!==d){switch(d){case"fork":n="notebook:view:compareFork";break;case"latest":n="notebook:view:compareLatest";break;case"published":n="notebook:view:comparePublished"}(0,a.MR)((0,a.ym)({type:n,data:{base:(0,a.tb)(i,l),target:(0,a.tb)(c,l),trigger:s,source:o},eventVersion:1,notebook:r,currentUser:l}))}}],loadVersion:N.n,loadedVersion:(e,t)=>{let{notebook:n,currentUser:r}=e,{body:l}=t;(0,a.MR)((0,a.ym)({type:"notebook:view:historyNavigate",data:{loadedVersion:l.version,navigationType:"version"},eventVersion:5,notebook:n,currentUser:r}))},attachLocalFiles:k.Mq,localFilesAttached:i.fe,moveDown:moveAnalytic,moveUp:moveAnalytic,notebookFilePickerOpened:i.Bv,openHelpArticle:(e,t)=>{let{notebook:n,currentUser:r}=e,{article:l}=t;(0,a.MR)((0,a.ym)({type:"notebook:view:helpArticleOpened",data:{article:l},eventVersion:1,notebook:n,currentUser:r}))},closeInsertMenu:(e,t)=>{let{notebook:n,currentUser:r}=e,{trigger:l,filter:s,selectedItem:o,ignoreInAnalytics:i}=t;i||(void 0!==o&&(o=truncate(o,50)),(0,a.MR)((0,a.ym)({type:"notebook:view:nodeInserterMenuClosed",data:{trigger:l,filter:truncate(s,50),selectedItem:o},eventVersion:1,notebook:n,currentUser:r})),gtag("event","Node inserter menu",{event_category:"Notebook",event_label:o}))},enterPresent:i._D,enterEdit:i.Um,openInsertMenu:(e,t)=>{let{notebook:n,currentUser:r}=e,{before:l,trigger:s,source:o}=t;(0,a.MR)((0,a.ym)({type:"notebook:view:nodeInserterMenuOpened",data:{trigger:s,source:o,before:l},eventVersion:1,notebook:n,currentUser:r}))},pauseLiveEdits:R.Dq,pauseLiveEditsSuccess:R.Z6,relicense:i.mB,remove:(e,t)=>{let{notebook:n,currentUser:r}=e,{id:s}=t,o=(0,l.DY)(n.model,s);(0,a.MR)((0,a.ym)({type:"notebook:cells:manage:delete",data:{cellIds:[s],includesLastCell:1===n.model.nodes.length,mode:null==o?void 0:o.mode},eventVersion:5,notebook:n,currentUser:r}))},requestSnippets:F.d1,removeCloudFile:y.kc,resolveComments:(e,t)=>{let{notebook:n,currentUser:r}=e,{nodeId:l,trigger:o,source:i}=t;(0,a.MR)((0,a.ym)({type:"notebook:cells:comment:resolve",data:{cellIds:[l],commentCount:(0,s.HS)(n,l).length,trigger:o,source:i},eventVersion:3,notebook:n,currentUser:r}))},resumeLiveEdits:R.gY,resumeLiveEditsSuccess:R.SK,revertRequested:D._$,replaceCurrent:(e,t)=>{let{notebook:n,currentUser:r}=e,{trigger:l,source:s}=t,{caseSensitiveSearch:i,wholeWordSearch:c,regexSearch:d}=n;(0,a.MR)((0,a.ym)({type:"notebook:edit:replaceCurrent",data:{numSearchResults:(0,o.n)(n.searchResults),caseSensitiveSearch:i,wholeWordSearch:c,regexSearch:d,trigger:l,source:s},eventVersion:1,notebook:n,currentUser:r}))},replaceAll:[_.Rt,(e,t)=>{let{notebook:n,currentUser:r}=e,{trigger:l,source:s}=t,{caseSensitiveSearch:i,wholeWordSearch:c,regexSearch:d}=n;(0,a.MR)((0,a.ym)({type:"notebook:edit:replaceAll",data:{numSearchResults:(0,o.n)(n.searchResults),caseSensitiveSearch:i,wholeWordSearch:c,regexSearch:d,trigger:l,source:s},eventVersion:1,notebook:n,currentUser:r}))}],reportAbuse:g.e5,selectionCut:Z.S2,selectionCopy:Z.S2,selectionInsert:(e,t)=>{let{notebook:n,currentUser:r}=e,{trigger:s,before:o=!1,inherit:i=!1}=t,{selectionFocusId:c}=n;null!==c&&(0,a.MR)(i?(0,a.ym)({type:"notebook:cells:manage:split",data:{cellIds:[c],mode:(0,l.DY)(n.model,c).mode,trigger:s,source:"nodeSelection",before:o},eventVersion:1,notebook:n,currentUser:r}):(0,a.ym)({type:"notebook:cells:manage:insert",data:{cellIds:[c],trigger:s,source:"nodeSelection",before:o},eventVersion:3,notebook:n,currentUser:r}))},sendSuggestion:I.gd,sendSuggestionFailed:i.Hh,sendSuggestionSucceeded:i.yy,setAuthorAcceptance:f.jp,setAuthors:f.Yx,setMode:(e,t)=>{let{notebook:n,currentUser:r}=e,{id:l,source:s,trigger:o,mode:i}=t;(0,a.MR)((0,a.ym)({type:"notebook:cells:manage:setMode",data:{cellIds:[l],source:s,trigger:o,mode:i},eventVersion:1,notebook:n,currentUser:r}))},setChartConfig:(e,t)=>{let{notebook:n,currentUser:r}=e,{id:l,config:s,options:o,source:i}=t,c=s&&Object.keys(s).filter(e=>"options"!==e).map(e=>{var t,n,r;return"mark"===e?{key:e,value:null===(t=s[e])||void 0===t?void 0:t.value}:{key:e,type:null===(n=s[e])||void 0===n?void 0:n.type,reduce:null===(r=s[e])||void 0===r?void 0:r.reduce}}),d=o&&Object.keys(o);(0,a.MR)((0,a.ym)({type:"notebook:cells:manage:setChartConfig",data:{cellIds:[l],config:c,options:d,source:i},eventVersion:1,notebook:n,currentUser:r}))},setDataConnector:setNotebookDataConnectorListener,setDataSource:(e,t)=>{let{notebook:n,currentUser:r}=e,{id:l,source:s}=t;(0,a.MR)((0,a.ym)({type:"notebook:cells:manage:setDataSource",data:{cellIds:[l],source:s.type},eventVersion:1,notebook:n,currentUser:r}))},setDataOperations:(e,t)=>{let{notebook:n,currentUser:r}=e,{id:s,operations:o,source:i="editor"}=t;if((0,a.MR)((0,a.ym)({type:"notebook:cells:manage:setDataOperations",data:{cellIds:[s],operations:Object.keys(o),source:i},eventVersion:3,notebook:n,currentUser:r})),"derive"in o){var c,d,u,p;let e=(0,l.DY)(n.model,s),t=(null!==(u=null===(c=o.derive)||void 0===c?void 0:c.length)&&void 0!==u?u:0)-(null!==(p=null==e?void 0:null===(d=e.data.operations.derive)||void 0===d?void 0:d.length)&&void 0!==p?p:0);t>0?(0,a.MR)((0,a.ym)({type:"notebook:cells:manage:tableDerive",data:{cellIds:[s],eventType:"add"},eventVersion:1,notebook:n,currentUser:r})):t<0&&(0,a.MR)((0,a.ym)({type:"notebook:cells:manage:tableDerive",data:{cellIds:[s],eventType:"delete"},eventVersion:1,notebook:n,currentUser:r}))}},setLocalOperations:(e,t)=>{var n,r,s,o,i;let{notebook:c,currentUser:d}=e,{id:u,operations:p}=t,m=null===(n=(0,l.DY)(c.model,u))||void 0===n?void 0:n.mode,h=null!==(o=null===(r=p.filter)||void 0===r?void 0:r.map(e=>{let{type:t}=e;return t}))&&void 0!==o?o:null,f=null!==(i=null===(s=p.sort)||void 0===s?void 0:s.map(e=>{let{direction:t}=e;return t}))&&void 0!==i?i:null;(0,a.MR)((0,a.ym)({type:"notebook:cells:manage:setLocalOperations",data:{cellIds:[u],filter:h,sort:f,mode:m},eventVersion:1,notebook:c,currentUser:d}))},setName:(e,t)=>{let{notebook:n,currentUser:r}=e,{id:s,source:o}=t,i=(0,l.DY)(n.model,s);if(!i)return;let{mode:c}=i;(0,a.MR)((0,a.ym)({type:"notebook:cells:manage:setName",data:{cellIds:[s],source:o,trigger:"keypress",mode:c},eventVersion:1,notebook:n,currentUser:r}))},setOpenCollection:[M.Ge,e=>{let{notebook:t,currentUser:n}=e;(0,a.MR)((0,a.ym)({type:"notebook:view:changeCurrentCollection",data:{trigger:"click",source:"collectionsSidebar"},eventVersion:1,notebook:t,currentUser:n}))}],setSchedule:T.A,showModal:[A.k,(e,t)=>{let{currentUser:n,notebook:r}=e;switch(t.modal){case"license":(0,a.MR)((0,a.ym)({type:"notebook:view:licenseModal",data:{},eventVersion:2,notebook:r,currentUser:n}));break;case"addDatabase":(0,a.MR)((0,a.ym)({type:"notebook:view:addDatabaseModal",data:{},eventVersion:1,notebook:r,currentUser:n}));break;case"addCloudFile":(0,a.MR)((0,a.ym)({type:"notebook:view:cloudProviderModal",data:{},eventVersion:1,notebook:r,currentUser:n}));break;case"cloudFile":{let{provider:e}=t.modalProps;(0,a.MR)((0,a.ym)({type:"notebook:view:cloudFileModal",data:{provider:e},eventVersion:1,notebook:r,currentUser:n}));break}case"replaceFile":(0,a.MR)((0,a.ym)({type:"notebook:view:replaceFileModal",data:{},eventVersion:1,notebook:r,currentUser:n}));break;case"embed":(0,a.MR)((0,a.ym)({type:"notebook:manage:embedModalOpen",data:{trigger:"click",source:t.source},eventVersion:3,notebook:r,currentUser:n}))}}],showComments:(e,t)=>{let{notebook:n,currentUser:r}=e,{nodeId:l,trigger:s,source:o}=t;(0,a.MR)((0,a.ym)({type:"notebook:cells:comment:showComments",data:{cellIds:[l],trigger:s,source:o},eventVersion:2,notebook:n,currentUser:r}))},showPane:M._k,showFindPane:_.zI,splitBefore:splitAnalytic,splitAfter:splitAnalytic,dismissSuggestionOpenBanner:e=>{let{notebook:t,currentUser:n}=e;(0,a.MR)((0,a.ym)({type:"notebook:view:suggestionOpenBannerDismissed",data:{base:(0,a.tb)(t.forkOf,n),target:(0,a.tb)(t,n)},eventVersion:1,notebook:t,currentUser:n}))},resolveDependencies:i.hX,showNotebookDependencyDetails:i.dX,signatureHelp:(e,t)=>{var n;let{notebook:r,currentUser:s}=e,{id:o,data:i}=t,{model:c,signatureHelpDismissedSpan:d}=r,u=(0,l.DY)(c,o),p=null==i?void 0:null===(n=i.applicableSpan)||void 0===n?void 0:n.start;u&&(!p||p!==d)&&void 0!==p&&(0,a.MR)((0,a.ym)({type:"notebook:cells:view:showSignatureHelp",eventVersion:1,notebook:r,currentUser:s}))},signatureHelpDismiss:(e,t)=>{let{notebook:n,currentUser:r}=e,{id:s,source:o}=t,{model:i,signatureHelpData:c}=n,d=(0,l.DY)(i,s);d&&c&&(0,a.MR)((0,a.ym)({type:"notebook:cells:view:dismissSignatureHelp",data:{source:o},eventVersion:1,notebook:n,currentUser:r}))},tableDisplayError:(e,t)=>{let{notebook:n,currentUser:r}=e,{id:l}=t;(0,a.MR)((0,a.ym)({type:"notebook:cells:view:tableDisplayError",data:{cellIds:[l]},eventVersion:1,notebook:n,currentUser:r}))},tableSearch:(e,t)=>{let{notebook:n,currentUser:r}=e,{id:l}=t;(0,a.MR)((0,a.ym)({type:"notebook:cells:manage:tableSearch",data:{cellIds:[l]},eventVersion:2,notebook:n,currentUser:r}))},toggleHelpPaneSection:(e,t)=>{let{notebook:n,page:r,currentUser:l}=e,{section:s}=t;r.helpPaneSectionsOpen.has(s)?(0,a.MR)((0,a.ym)({type:"notebook:view:helpPaneSectionCollapsed",data:{section:s},eventVersion:1,notebook:n,currentUser:l})):(0,a.MR)((0,a.ym)({type:"notebook:view:helpPaneSectionExpanded",data:{section:s},eventVersion:1,notebook:n,currentUser:l}))},toggleCollectionsSidebar:e=>{let{notebook:t,currentUser:n,page:r}=e;(0,a.MR)((0,a.ym)({type:r.collectionsSidebarOpen?"notebook:view:collectionsSidebarDismissed":"notebook:view:collectionsSidebarOpened",data:{},eventVersion:1,notebook:t,currentUser:n}))},toggleDependencyLock:i.JS,upgradeDependency:i.Nz,togglePane:[M.Ez,(e,t)=>{let{page:n,notebook:r,currentUser:l}=e,{pane:s}=t;n.pane===s?sendPaneDismissedEvent(s,null,r,l):(n.pane&&sendPaneDismissedEvent(n.pane,s,r,l),function(e,t,n){switch(e){case"aiassist":(0,a.MR)((0,a.ym)({type:"notebook:view:assistPaneOpened",data:{},eventVersion:1,notebook:t,currentUser:n}));break;case"help":(0,a.MR)((0,a.ym)({type:"notebook:view:helpPaneOpened",data:{},eventVersion:1,notebook:t,currentUser:n}));break;case"files":(0,a.MR)((0,a.ym)({type:"notebook:view:filesPaneOpened",data:{},eventVersion:1,notebook:t,currentUser:n}));break;case"history":(0,a.MR)((0,a.ym)({type:"notebook:view:historyOpen",data:{},eventVersion:5,notebook:t,currentUser:n}));break;case"minimap":(0,a.MR)((0,a.ym)({type:"notebook:view:minimapPaneOpened",data:{},eventVersion:1,notebook:t,currentUser:n}));break;case"insights":(0,a.MR)((0,a.ym)({type:"notebook:view:insightsPaneOpened",data:{},eventVersion:1,notebook:t,currentUser:n}));break;case"find":(0,a.MR)((0,a.ym)({type:"notebook:view:findPaneOpened",data:{},eventVersion:1,notebook:t,currentUser:n}));break;case"dependencies":(0,a.MR)((0,a.ym)({type:"notebook:view:dependenciesPaneOpened",data:{},eventVersion:1,notebook:t,currentUser:n}));break;case"guide":(0,a.MR)((0,a.ym)({type:"notebook:view:guidePaneOpened",data:{},eventVersion:1,notebook:t,currentUser:n}));break;case"databases":(0,a.MR)((0,a.ym)({type:"notebook:view:databasesPaneOpened",data:{},eventVersion:1,notebook:t,currentUser:n}));break;case"schedule":(0,a.MR)((0,a.ym)({type:"notebook:view:schedulePaneOpened",data:{},eventVersion:1,notebook:t,currentUser:n}))}}(s,r,l))}],togglePin:(e,t)=>{let{notebook:n,currentUser:r}=e,{id:s}=t,o=!(0,l.DY)(n.model,s).pinned;(0,a.MR)((0,a.ym)({type:o?"notebook:cells:manage:pin":"notebook:cells:manage:unpin",data:{cellIds:[s]},eventVersion:3,notebook:n,currentUser:r}))},toggleResolvedComments:(e,t)=>{let{notebook:n,currentUser:r}=e,{nodeId:l,trigger:s,source:o}=t;(0,a.MR)((0,a.ym)({type:"notebook:cells:comment:toggleResolved",data:{cellIds:[l],expanded:!n.expandedResolvedComments.has(l),trigger:s,source:o},eventVersion:2,notebook:n,currentUser:r}))},updateCommentingLock:[x.h,i.F5],updateSubscription:V.M,updateSubscriptionSucceeded:(e,t)=>{let{notebook:n,currentUser:r}=e,{status:l,trigger:s,source:o}=t;void 0!==s&&(0,a.MR)((0,a.ym)({type:"notebook:social:updateSubscription",data:{status:l,trigger:s,source:o},eventVersion:1,notebook:n,currentUser:r}))},welcomeMatNotebookClick:(e,t)=>{let{currentUser:n}=e,{clickedNotebookId:r}=t;(0,a.MR)((0,a.a$)({type:"marketing:view:welcomeMatNotebookClick",data:{clickedNotebookId:r},eventVersion:1,currentUser:n}))}}},28996:function(e,t,n){n.d(t,{c:function(){return initialPageState},q:function(){return s}});var r=n(82244),a=n(32007),l=n(28826);function initialPageState(){let{initialCollection:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{pane:null,collectionsSidebarOpen:!!e,suggestionOpenBannerDismissed:!1,helpPaneSectionsOpen:r.y3,helpArticlesOpen:[],replaceInputExpanded:!1,findOptionsInputExpanded:!1,guide:null,expandedDatabases:new Set,expandedTables:new Set,databaseSchemas:new Map,tableSchemas:new Map}}let s={togglePane:r.lx,dismissPane:r.rE,toggleCollectionsSidebar:r.P4,openCollectionsSidebar:r._O,dismissSuggestionOpenBanner:()=>({suggestionOpenBannerDismissed:!0}),collectionsUpdated:r.Yd,toggleHelpPaneSection:r.GJ,closeHelpArticle:r.Gr,openHelpArticle:r.LZ,showNotebookDependencyDetails:(e,t)=>{let{specifier:n}=t;return{pane:"dependencies",dependenciesPaneSpecifier:n}},removeDependenciesPaneSpecifier:()=>({dependenciesPaneSpecifier:void 0}),toggleFindOptionsExpanded:l.lc,toggleReplaceInputExpanded:l.$k,toggleDatabasesPaneDatabase:(e,t)=>{let{expandedDatabases:n}=e,{db:r}=t,l=(0,a.x2)(r);return(n=new Set(n)).has(l)?n.delete(l):n.add(l),{expandedDatabases:n}},toggleDatabasesPaneTable:(e,t)=>{let{expandedTables:n}=e,{db:r,table:l}=t,s=(0,a.hS)(r,l);return(n=new Set(n)).has(s)?n.delete(s):n.add(s),{expandedTables:n}},updateDatabasesPaneDatabaseSchema:(e,t)=>{let{databaseSchemas:n}=e,{db:r,tables:l}=t;return(n=new Map(n)).set((0,a.x2)(r),l),{databaseSchemas:n}},updateDatabasesPaneTableSchema:(e,t)=>{let{tableSchemas:n}=e,{db:r,table:l,columns:s}=t;return(n=new Map(n)).set((0,a.hS)(r,l),s),{tableSchemas:n}},refreshDatabasesPaneSchema:(e,t)=>{let{expandedDatabases:n,databaseSchemas:r,tableSchemas:l}=e,{db:s}=t;n=new Set(n),r=new Map(r),l=new Map(l);let o=(0,a.x2)(s);n.add(o);let i=r.get(o);if(r.delete(o),i)for(let e of i)l.delete((0,a.hS)(s,e));return{tableSchemas:l,databaseSchemas:r,expandedDatabases:n}}}},33251:function(e,t,n){n.d(t,{ZU:function(){return setDataConnectorListener},lA:function(){return setDataConnectorSucceededListenerAnalytic},my:function(){return setDataConnectorSucceededDataConnectorReducer},qE:function(){return postDataConnector}});var r=n(5146),a=n(4530);async function postDataConnector(e,t){let{allow_guests:n,credentials:a,local:l,name:s,type:o}=e;"bigquery"===o&&(a=a.connectionInfo||a),await (0,r.Fv)(t?"/team/".concat(t,"/data-connector"):"/user/data-connector",{allow_guests:n,credentials:a,local:l,name:s,type:o})}let setDataConnectorListener=async(e,t,n)=>{let{context:{context:r},dataConnectors:{dataConnectors:a}}=e,{dataConnector:l}=t,{local:s,name:o}=l;n({type:"showProcessingToast",key:"setDataConnector",message:'Saving data connector "'.concat(o,'"…')});try{await postDataConnector(l,null==r?void 0:r.id),n({type:"showSuccessToast",key:"setDataConnector",message:'Saved data connector "'.concat(o,'".')}),n({type:"setDataConnectorSucceeded",dataConnector:l}),s&&!a.some(e=>e.name===o)&&n({type:"resetDataConnectorSecret",dataConnector:l}),s||n({type:"testDataConnector",dataConnector:l})}catch(e){n({type:"showErrorToast",key:"setDataConnector",message:"Oops, saving data connector failed. Try again?"})}};function redactPassword(e){if(!("password"in e.credentials))return e;let{credentials:t}=e,n=""===t.password||void 0===t.password?void 0:null;return{...e,credentials:{...t,password:n}}}let setDataConnectorSucceededListenerAnalytic=(e,t)=>{let{context:n,currentUser:r,dataConnectors:l}=e,{dataConnector:s}=t,o=n.context,i=!l.dataConnectors.some(e=>e.name===s.name),c={type:s.type,local:s.local};o?(0,a.MR)((0,a.gv)({type:i?"team:manage:createDataConnectorData":"team:manage:updateDataConnectorData",data:c,eventVersion:1,team:o,currentUser:r})):(0,a.MR)((0,a.a$)({type:i?"user:manage:createDataConnectorData":"user:manage:updateDataConnectorData",data:c,eventVersion:1,currentUser:r}))},setDataConnectorSucceededDataConnectorReducer=(e,t)=>{let{dataConnectors:n}=e,{dataConnector:r}=t;return{dataConnectors:n=n.some(e=>e.name===r.name)?n.map(e=>e.name!==r.name?e:redactPassword(r)):[...n,redactPassword(r)].sort((e,t)=>e.name.localeCompare(t.name))}}},4778:function(e){e.exports=JSON.parse('{"xF":"worker-2b3bcb9c.html","Bl":"worker-embed-preview-4cda3f23.html"}')}}]);