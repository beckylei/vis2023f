(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5746],{61187:function(e,t,n){var r={".":7138,"./":7138,"./arquero":29391,"./arquero.js":29391,"./arrow":57938,"./arrow.js":57938,"./dependencies":67363,"./dependencies.js":67363,"./dependency":10170,"./dependency.js":10170,"./dom":81820,"./dom/":81820,"./dom/canvas":76342,"./dom/canvas.js":76342,"./dom/context2d":24937,"./dom/context2d.js":24937,"./dom/download":32938,"./dom/download.js":32938,"./dom/element":63380,"./dom/element.js":63380,"./dom/index":81820,"./dom/index.js":81820,"./dom/input":37585,"./dom/input.js":37585,"./dom/range":57170,"./dom/range.js":57170,"./dom/select":31106,"./dom/select.js":31106,"./dom/svg":55895,"./dom/svg.js":55895,"./dom/text":30281,"./dom/text.js":30281,"./dom/uid":81831,"./dom/uid.js":81831,"./duckdb":93874,"./duckdb.js":93874,"./fileAttachment":12149,"./fileAttachment.js":12149,"./files":46155,"./files/":46155,"./files/buffer":43825,"./files/buffer.js":43825,"./files/index":46155,"./files/index.js":46155,"./files/text":9974,"./files/text.js":9974,"./files/url":12174,"./files/url.js":12174,"./generators":26785,"./generators/":26785,"./generators/disposable":12238,"./generators/disposable.js":12238,"./generators/filter":7254,"./generators/filter.js":7254,"./generators/index":26785,"./generators/index.js":26785,"./generators/input":28044,"./generators/input.js":28044,"./generators/map":33921,"./generators/map.js":33921,"./generators/observe":61367,"./generators/observe.js":61367,"./generators/queue":49042,"./generators/queue.js":49042,"./generators/range":52707,"./generators/range.js":52707,"./generators/valueAt":15890,"./generators/valueAt.js":15890,"./generators/worker":8179,"./generators/worker.js":8179,"./html":46566,"./html.js":46566,"./index":7138,"./index.js":7138,"./leaflet":53861,"./leaflet.js":53861,"./library":64739,"./library.js":64739,"./md":21715,"./md.js":21715,"./mermaid":98843,"./mermaid.js":98843,"./mutable":30221,"./mutable.js":30221,"./now":3666,"./now.js":3666,"./promises":15898,"./promises/":15898,"./promises/delay":52984,"./promises/delay.js":52984,"./promises/index":15898,"./promises/index.js":15898,"./promises/tick":22989,"./promises/tick.js":22989,"./promises/when":37782,"./promises/when.js":37782,"./require":95922,"./require.js":95922,"./resolve":95545,"./resolve.js":95545,"./sqlite":64054,"./sqlite.js":64054,"./svg":54745,"./svg.js":54745,"./table":77466,"./table.js":77466,"./template":19225,"./template.js":19225,"./tex":40667,"./tex.js":40667,"./that":5243,"./that.js":5243,"./vegalite":70423,"./vegalite.js":70423,"./width":10282,"./width.js":10282,"./xlsx":40538,"./xlsx.js":40538};function webpackAsyncContext(e){return Promise.resolve().then(function(){if(!n.o(r,e)){var t=Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n(r[e])})}webpackAsyncContext.keys=function(){return Object.keys(r)},webpackAsyncContext.id=61187,e.exports=webpackAsyncContext},17492:function(e,t,n){"use strict";let r;n.d(t,{Hk:function(){return autocomplete_autocomplete},f8:function(){return M},Y_:function(){return ensureNewline},b2:function(){return safeLabel}});var i=n(34790),o=n(59119),l=n(14456),s=n(74374),a=n(68092),d=n(12720),c=n(13961),u=n(23939),p=n(25227),h=n(85623),m=n(83687),f=n(85893);let Transform=e=>(0,f.jsxs)("svg",{width:"50",height:"30",viewBox:"5 5 50 30",fill:"none",...e,children:[(0,f.jsx)("path",{d:"M35.625 24.5C28.875 24.5 28.875 15.5 22.125 15.5",stroke:"currentColor",strokeWidth:"2"}),(0,f.jsx)("path",{d:"M37.875 15.5L34.5 18.875V12.125L37.875 15.5Z",fill:"currentColor"}),(0,f.jsx)("path",{d:"M37.875 24.5L34.5 27.875V21.125L37.875 24.5Z",fill:"currentColor"}),(0,f.jsx)("path",{d:"M35.625 15.5C28.875 15.5 28.875 24.5 22.125 24.5",stroke:"currentColor",strokeWidth:"2"})]});var g=n(4640),v=n(35512);let AutocompleteTask=class AutocompleteTask extends g.i{async process(e){var t;let n=await e({type:"autocomplete",variable:this._variable,paths:this._paths});return(t=Array.from(n,e=>({label:e,type:v.JY.JavaScript,boost:v.UW.JavaScript,detail:v.$d.Property,origin:"worker"})),e=>{if(!t.length)return null;let{name:n,from:r}=(0,o.qz)(e.state).resolve(e.pos,-1);return{from:"PropertyName"===n?r:e.pos,options:t,span:/\w*$/}})(this._context)}constructor(e,t,n){super(),this._context=e,this._variable=t,this._paths=n}};var y=n(5146),x=n(64580),b=n(13729);let w=[["function ${name}(${params}) {\n	${}\n}","function"],["class ${Name} {\n	constructor(${params}) {\n		${}\n	}\n}","class"]].map(e=>{let[t,n]=e;return{apply:(0,i.DB)(t),label:safeLabel(n),type:v.JY.JavaScript,boost:v.UW.JavaScript,detail:v.$d.Snippet,origin:"javascriptSnippets"}});function safeLabel(e){if(!/^[a-z0-9.`[\]_\- ()]+$/i.test(e))throw Error("invalid label: ".concat(e));return e.replace(/ /g,"\xa0")}let C=[["md`${}`","md`` [Markdown]",recomplete],["htl.html`${}`","html``"],["htl.svg`${}`","svg``"],["tex`${}`","tex``"],["dot`${}`","dot`` [Graphviz]",recomplete],["mermaid`${}`","mermaid``",recomplete]].map(e=>{let[t,n,r=e=>e]=e;return{apply:r((0,i.DB)(t)),label:safeLabel(n),type:v.JY.Stdlib,boost:v.UW.Stdlib,detail:v.$d.Stdlib,origin:"stdlib"}}),j=[['DatabaseClient("${}")',"DatabaseClient",recomplete],['FileAttachment("${}")',"FileAttachment",recomplete],['Secret("${}")',"Secret",recomplete],["Generators.observe(notify => {\n	${}\n})","Generators.observe"],["Promises.delay(${duration})","Promises.delay"],["Promises.tick(${duration})","Promises.tick"],["invalidation"],["visibility()","visibility"],["width"],["now"],["d3","D3"],["_","_ [Lodash]"],["vl","vl [Vega-Lite]"],["Inputs"],["Plot"],["aq","aq [Arquero]"],["Arrow","Apache Arrow"],["L","L [Leaflet]"],["htl","htl [Hypertext Literal]"],["DuckDBClient.of({${name}: ${data}})","DuckDBClient"],["SQLiteDatabaseClient.open(${source})","SQLiteDatabaseClient"],["topojson","TopoJSON"],["aapl"],["alphabet"],["cars"],["citywages"],["diamonds"],["flare"],["industries"],["miserables"],["olympians"],["penguins"],["pizza"],["weather"]].map(e=>{let[t,n=t,r=e=>e]=e;return{apply:r((0,i.DB)(t)),label:safeLabel(n),type:v.JY.Stdlib,boost:v.UW.Stdlib,detail:v.$d.Stdlib,origin:"stdlib"}});function recomplete(e){return(t,n,r,o)=>{e(t,n,r,o),t instanceof l.tk&&(0,i.WA)(t)}}let S=[["let ${name};","let"],["const ${name} = ${value};","const"],["for (let ${index} = 0; ${index} < ${length}; ++${index}) {\n	${}\n}","for loop"],["for (const ${value} of ${values}) {\n	${}\n}","for of loop"],["try {\n	${}\n} catch (${error}) {\n	${}\n}","try catch"]].map(e=>{let[t,n]=e;return{apply:(0,i.DB)(t),label:safeLabel(n),type:v.JY.JavaScript,boost:v.UW.JavaScript,detail:v.$d.Snippet,origin:"blockSnippets"}}),k=[{text:x.gT.IMPORT_NOTEBOOK_CELL,label:"Import cell"},{text:x.gT.IMPORT_NOTEBOOK_LIBRARY,label:"Import library"},{text:x.gT.IMPORT_REQUIRE_LIBRARY,label:"Require library"}].map(e=>{let{text:t,label:n}=e;return{apply:(0,i.DB)(t),label:safeLabel(n),type:v.JY.JavaScript,boost:v.UW.Snippet,detail:v.$d.Snippet,origin:"importSnippets"}}),E=[{text:'${weather}.filter((${d}, i) => ${d.location === "New York"})',label:"Filter array"},{text:"${weather}.map((${d}, i) => ${d.temp_max})",label:"Map array"},{text:"${1:weather}.reduce((reduce, d, i) => ${2:reduce + d.precipitation}, ${3:0})",label:"Reduce array"},{text:"[...${weather}].sort((a, b) => b.${precipitation} - a.${precipitation})",label:"Sort array"}].map(e=>{let{text:t,label:n}=e;return{thumbnail:Transform,apply:(0,i.DB)(t),label:safeLabel(n),type:v.JY.Snippet,boost:v.UW.Snippet,detail:v.$d.Snippet,origin:"transformSnippets"}}),_=[{text:x.gT.PLOT_AREA,label:"Area chart"},{text:x.gT.PLOT_AREA_BAND,label:"Band area chart"},{text:x.gT.PLOT_AREA_STACKED,label:"Stacked area chart"},{text:x.gT.PLOT_ARROW,label:"Arrow chart"},{text:x.gT.PLOT_BAR,label:"Bar chart"},{text:x.gT.PLOT_BAR_HORIZONTAL,label:"Horizontal bar chart"},{text:x.gT.PLOT_BAR_TEMPORAL,label:"Temporal bar chart"},{text:x.gT.PLOT_BOX,label:"Box plot"},{text:x.gT.PLOT_CELL,label:"Cell chart"},{text:x.gT.PLOT_FACETED,label:"Faceted chart"},{text:x.gT.PLOT_HISTOGRAM,label:"Histogram chart"},{text:x.gT.PLOT_LINE,label:"Line chart"},{text:x.gT.PLOT_MOVING_AVERAGE,label:"Moving average line chart"},{text:x.gT.PLOT_MULTI_SERIES_LINE,label:"Multi-series line chart"},{text:x.gT.PLOT_LINE_SCATTER,label:"Scatterplot chart"},{text:x.gT.PLOT_TICK,label:"Tick chart"},{text:x.gT.PLOT_TOP10_BAR,label:"Top 10 bar chart"},{text:x.gT.PLOT_TOP10_BAR_WEIGHTED,label:"Weighted top 10 bar chart"},{text:x.gT.PLOT_HEXBIN,label:"Hexbin chart"},{text:x.gT.PLOT_BEESWARM,label:"Beeswarm chart"},{text:x.gT.PLOT_LINEAR_REGRESSION,label:"Linear regression",newUntil:new Date(Date.UTC(2022,7,15))},{text:x.gT.PLOT_VORONOI,label:"Voronoi diagram",newUntil:new Date(Date.UTC(2022,7,15))},{text:x.gT.PLOT_DENSITY_CONTOUR,label:"Density contours",newUntil:new Date(Date.UTC(2022,7,15))}].map(e=>{let{text:t,label:n,newUntil:r}=e;return{apply:(0,i.DB)(t),label:safeLabel(n),type:v.JY.Snippet,boost:v.UW.Snippet,detail:v.$d.Snippet,origin:"plotSnippets",newUntil:r}}),N=[{apply:x.Up.INPUT_BUTTON,label:"Button input"},{apply:x.Up.INPUT_CHECKBOX,label:"Checkbox input"},{apply:x.Up.INPUT_COLOR,label:"Color input"},{apply:x.Up.INPUT_DATE,label:"Date input"},{apply:x.Up.INPUT_FILE,label:"File input"},{apply:x.Up.INPUT_RADIO,label:"Radio input"},{apply:x.Up.INPUT_RANGE,label:"Range input"},{apply:x.Up.INPUT_SEARCH,label:"Search input"},{apply:x.Up.INPUT_SELECT,label:"Select input"},{apply:x.Up.INPUT_TABLE,label:"Table input"},{apply:x.Up.INPUT_TEXT,label:"Text input"},{apply:x.Up.INPUT_TEXTAREA,label:"Textarea input"},{apply:x.Up.INPUT_TOGGLE,label:"Toggle input"},{apply:x.Up.INPUT_FORM,label:"Form input"}].map(e=>{let{apply:t,label:n}=e;return{apply:t,label:safeLabel(n),type:v.JY.Snippet,boost:v.UW.Snippet,detail:v.$d.Snippet,origin:"inputSnippets"}}),L=[{apply:x.Ob.apply,label:"Fetch from a URL",type:v.JY.Snippet,boost:v.UW.Snippet,detail:v.$d.Snippet,origin:"dataSnippets"}],I=w.concat(C,_,E),T=[[(0,x.eu)(e=>"#{".concat(e("name"),"} = #{1 + 2}")),"expression cell"],[(0,x.eu)(e=>"#{".concat(e("name"),"} = {\n	for (let i = 0; i < 100; ++i) {\n		yield i;\n	}\n}")),"generator cell"],[(0,x.eu)(e=>"#{".concat(e("name"),"} = {\n	return #{1 + 2};\n}")),"block cell"],[(0,x.eu)(e=>"mutable #{".concat(e("name"),"} = #{1 + 2}")),"mutable cell"],[(0,x.eu)(e=>"viewof #{".concat(e("name"),"} = htl.html`#{<input type=range>}`")),"viewof cell"]].map(e=>{let[t,n]=e;return{apply:t,label:safeLabel(n),type:v.JY.JavaScript,boost:v.UW.JavaScriptCell,detail:v.$d.Snippet,origin:"basicCellSnippets"}}),D=T.concat(k,L,N);function acceptCompletion(e){let t=(0,i.s1)(e.state),n=(0,i.dk)(e),r=e.state.field(a.l);return n&&r&&(r({type:"acceptSnippet",id:e.state.field(u.X),source:"Autocomplete menu"}),t&&r({type:"acceptCompletion",origin:t.origin})),n}let M=[{key:"Tab",run:acceptCompletion},{key:"Ctrl-Space",run:function(e){let t=(0,i.WA)(e),n=e.state.field(a.l);return t&&n&&n({type:"requestSnippets",id:e.state.field(u.X),trigger:"keypress",source:"Ctrl-Space"}),t}},{key:"Escape",run:i._B},{key:"ArrowDown",run:(0,i.gq)(!0)},{key:"ArrowUp",run:(0,i.gq)(!1)},{key:"PageDown",run:(0,i.gq)(!0,"page")},{key:"PageUp",run:(0,i.gq)(!1,"page")},{key:"Enter",run:acceptCompletion}],P=new Set(["PropertyName",".",".?","MemberExpression","VariableName"]);function workerAutocompleteForMemberExpression(e){let t=e.state.field(a.l),n=(0,o.qz)(e.state),r=n.cursorAt(e.pos,-1),i="?."===r.name||"."===r.name,l=[];do{let{name:n,from:o,to:s}=r;if(!P.has(n))break;if("PropertyName"===n&&i&&l.push(e.state.sliceDoc(o,s)),("?."===n||"."===n)&&(i=!0),"VariableName"===n){let n=e.state.sliceDoc(o,s);return new AutocompleteTask(e,n,l).run(t)}}while(r.prev());return null}function autocomplete_autocomplete(){return[(0,i.ys)({defaultKeymap:!1,override:[filter(e=>H(e)&&q(e),(0,i.Mb)(D)),filter(e=>isJavaScript(e)&&Y(e),(0,i.Mb)(S)),filter(e=>isJavaScript(e)&&($(e)||Y(e)||q(e)||Z(e)),(0,i.Mb)(I)),filter(e=>isJavaScript(e)&&B(e),workerAutocompleteForMemberExpression),filter(e=>isJavaScript(e)&&$(e),e=>(0,i.Mb)((void 0!==r?r:r=j.concat(Array.from((0,b.r)(),e=>({apply:(0,i.DB)(e),label:e,type:v.JY.JavaScript,boost:v.UW.JavaScript,detail:v.$d.Global,origin:"global"})))).concat(Array.from(e.state.field(h.rr),e=>({apply:(0,i.DB)(e),label:e,type:v.JY.Reference,boost:v.UW.Reference,detail:v.$d.Cell,origin:"references"}))))(e)),filter(e=>H(e)&&F(e),e=>(0,i.Mb)(function(e){let t=(0,o.qz)(e.state).cursorAt(e.pos,-1),n=t.node.type.name;if("VariableName"!==n&&"PropertyName"!==n&&"PrivatePropertyName"!==n)return[];let r=[];do{let n=t.node;t.parent()&&t.firstChild();do t.node!==n&&function findDeclarations(e,t,n,r){switch(e.type.name){case"ParamList":case"ObjectPattern":case"ArrayPattern":for(let i=e.firstChild;i;i=i.nextSibling)findDeclarations(i,t,n,r);break;case"PropertyDeclaration":case"VariableDeclaration":case"MethodDeclaration":case"FunctionDeclaration":case"ClassDeclaration":{let r=[...e.getChildren("VariableDefinition"),...e.getChildren("PrivatePropertyDefinition"),...e.getChildren("PropertyDefinition"),...e.getChildren("ObjectPattern")];for(let i of r)findDeclarations(i,t,n,e)}break;case"PatternProperty":findDeclarations(e.lastChild,t,n,r);break;case"PrivatePropertyName":case"PrivatePropertyDefinition":case"PropertyName":case"PropertyDefinition":case"VariableDefinition":{if(e===r)break;let i=n.state.sliceDoc(e.from,e.to);if("constructor"===i&&("PropertyDefinition"===r.type.name||"MethodDeclaration"===r.type.name))break;t.push(function(e,t){switch(t.type.name){case"VariableDeclaration":case"ParamList":case"ClassDeclaration":case"FunctionDeclaration":case"MethodDeclaration":case"PropertyDeclaration":return{label:e,type:v.JY.JavaScript,boost:v.UW.JavaScriptLocal,detail:v.$d.Local,origin:"local"}}return{label:e,type:v.JY.JavaScript,origin:"local"}}(i,r))}}}(t.node,r,e,t.node);while(t.nextSibling())}while(t.parent());return r}(e))(e)),filter(e=>isJavaScript(e)&&R(e),e=>(0,i.Mb)(e.state.field(d._).map(e=>({apply:(0,i.DB)(e),label:e,type:v.JY.Data,boost:v.UW.Data,detail:v.$d.File,origin:"fileAttachments"})))(e)),filter(e=>isJavaScript(e)&&A(e),async e=>(0,i.Mb)(await databases(e))(e)),filter(e=>isJavaScript(e)&&O(e),async e=>(0,i.Mb)(await secrets(e))(e)),filter(e=>{var t;return isJavaScript(e)&&K(t=e)&&isLineStart(t)},e=>(0,i.Mb)(function(e){switch(function(e){let t=(0,o.qz)(e.state).resolve(e.pos,-1),n=t.prevSibling;return(null==n?void 0:n.name)==="VariableName"?e.state.sliceDoc(n.from,n.to):null}(e)){case"dot":return W;case"md":return G;case"mermaid":return z;default:return[]}}(e))(e)),filter(e=>U(e)&&!V(e)&&isLineStart(e),(0,i.Mb)(G)),filter(e=>isJavaScript(e),e=>(async e=>{let{state:t,pos:n}=e,r=t.field(m.c);if(!r||"js"!==(0,s.yq)(t))return null;let o=t.field(u.X);try{let t=await r.getCompletionsAtPosition(o,n);if(!t||t.isGlobalCompletion||t.isNewIdentifierLocation)return null;let l=t.entries.filter(e=>!e.isFromUncheckedFile);return l.length&&(isIn(["String"],0)(e)||B(e))&&(e.explicit=!0),(0,i.Mb)(l.map(e=>({label:e.name,detail:e.kind,type:v.JY.JavaScript,boost:v.UW.JavaScript,origin:"typescript"})))(e)}catch(e){return console.error(e),null}})(e))]}),l.tk.domEventHandlers({blur(e,t){(0,i._B)(t),(0,i.Rn)(t)}})]}function filter(e,t){return n=>e(n)?t(n):null}function isBuiltin(e){return t=>{var n,r;let i=(0,o.qz)(t.state).resolve(t.pos,-1),{name:l}=i;if("String"===l&&(null===(n=i.parent)||void 0===n?void 0:n.name)==="ArgList"&&(null===(r=i.parent.prevSibling)||void 0===r?void 0:r.name)==="VariableName"&&t.pos===i.to-1){let{from:n,to:r}=i.parent.prevSibling,o=t.state.sliceDoc(n,r);return o===e}return!1}}let R=isBuiltin("FileAttachment"),A=isBuiltin("DatabaseClient"),O=isBuiltin("Secret");function is(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;return n=>{let r=(0,o.qz)(n.state).resolve(n.pos,t);return e.includes(r.name)}}function isIn(e){let t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;return i=>{if(i===n)return t;n=i;for(let n=(0,o.qz)(i.state).resolve(i.pos,r);n;n=n.parent)if(e.includes(n.name))return t=!0;return t=!1}}let F=is(["VariableDefinition","VariableName","PropertyName","PrivatePropertyName","Number"]),B=is([".","?.","PropertyName"]),$=is(["VariableName"]),V=isIn(["Interpolation"]),Z=is(["InterpolationOpenMark"]);function isCellMode(e){return t=>t.state.field(c.C)===e}let H=isCellMode("js"),U=isCellMode("md");function isJavaScript(e){return H(e)||V(e)}function isContext(e){return t=>{var n,r;let i=(0,o.qz)(t.state).resolve(t.pos,-1);return i.name===e||"VariableName"===i.name&&(null===(n=i.parent)||void 0===n?void 0:n.name)==="ExpressionStatement"&&(null===(r=i.parent.parent)||void 0===r?void 0:r.name)===e}}let q=isContext("Cell"),Y=isContext("Block"),z=[["graph TD\na-->b\nb-->c","graph TD"],["graph LR\na-->b\nb-->c","graph LR"]].map(e=>{let[t,n]=e;return{apply:(0,i.DB)(t),label:safeLabel(n),type:v.JY.Snippet,boost:v.UW.Snippet,detail:v.$d.Mermaid,origin:"mermaidSnippets"}}),W=[["graph g {\n	a -- b -- c;\n}","graph"],["digraph g {\n	a -> b -> c;\n}","digraph"]].map(e=>{let[t,n]=e;return{apply:(0,i.DB)(t),label:safeLabel(n),type:v.JY.Snippet,boost:v.UW.Snippet,detail:v.$d.Dot,origin:"dotSnippets"}}),G=[{text:"# ${heading}",label:"Heading 1"},{text:"## ${heading}",label:"Heading 2"},{text:"### ${heading}",label:"Heading 3"},{text:x.mH.TABLE.text,label:x.mH.TABLE.label,wrap:ensureNewline},{text:"- ${text}",label:"Bulleted list"},{text:"1. ${text}",label:"Numbered list"},{text:"> ${text}",label:"Blockquote"},{text:"![${text}](${url})",label:"Image"},{text:"~~~\n${}\n~~~",label:"Code block",wrap:ensureNewline},{text:"---${}",label:"Horizontal rule",wrap:ensureNewline}].map(e=>{let{text:t,label:n,wrap:r=e=>e}=e;return{apply:r((0,i.DB)(t)),label:safeLabel(n),type:v.JY.Snippet,boost:v.UW.Snippet,detail:v.$d.Markdown,origin:"mdSnippets"}});function ensureNewline(e){return(t,n,r,i)=>{t instanceof l.tk&&i!==t.state.doc.lineAt(i).to&&t.dispatch({changes:[{from:i,insert:"\n"}]}),e(t,n,r,i)}}function isLineStart(e){let t=e.state.doc.lineAt(e.pos);return!e.state.sliceDoc(t.from,e.pos).includes(" ")}let K=is(["TemplateString"]);async function databases(e){let t=e.state.field(p.Z);if(!t)return[];let n=await (0,y.a8)("".concat("team"===t.type?"/team/".concat(t.id):"/user","/data-connectors?detail=false"));return n.map(e=>{let{name:t}=e;return{apply:(0,i.DB)(t),label:t,type:v.JY.Data,boost:v.UW.Data,detail:v.$d.Database,origin:"databases"}})}async function secrets(e){let t=e.state.field(p.Z);if(!t)return[];let n=await (0,y.a8)("".concat("team"===t.type?"/team/".concat(t.id):"/user","/secrets"));return n.map(e=>{let{name:t}=e;return{apply:(0,i.DB)(t),label:t,type:v.JY.Data,boost:v.UW.Data,detail:v.$d.Secret,origin:"secrets"}})}},41888:function(e,t,n){"use strict";n.d(t,{Y:function(){return i},d:function(){return o}});var r=n(28682);let[i,o]=(0,r.Z)("notebook")},31432:function(e,t,n){"use strict";function empty(e){return 0===e.doc.length}n.d(t,{Z:function(){return empty}})},32986:function(e,t,n){"use strict";n.d(t,{Xl:function(){return F},_g:function(){return O},Hk:function(){return P},Bt:function(){return R}});var r=n(34790),i=n(45383),o=n(59119),l=n(49892),s=n(78120),a=n(14456),d=n(35524),c=n(17492),u=n(93156),p=n(74374),h=n(68092),m=n(41888),f=n(51265),g=n(80400);let v={visibility:"hidden"};var y=n(54687),x=n(96265),b=n(65678),w=n(13961),C=n(85623),j=n(35810),S=n(7897),k=n(32341),E=n(25993),_=n(83687),N=n(56564),L=n(23939),I=n(10245),T=n(35329),D=n(44911),M=n(48764).Buffer;"undefined"==typeof btoa&&(n.g.btoa=e=>M.from("".concat(e),"binary").toString("base64"));let P={keymap:new s.F6,closeBrackets:new s.F6,modeExtensions:new s.F6,readOnly:new s.F6,sql:new s.F6,vimKeys:new s.F6},R=[...b.Y,...i.f$];function normalizeUrl(e){return e.replace(/\/$/,"").trim()}function isAbsoluteUrl(e){try{let t=new URL(e);return normalizeUrl(t.href)===normalizeUrl(e)}catch(e){return!1}}let A=[(0,c.Hk)(),s.Wl.highest(a.$f.of(c.f8))],O=[(0,r.vQ)(),s.Wl.high(a.$f.of(r.GA))],F=[j.zT,a.tk.theme({"&":{backgroundColor:"var(--near-white)",color:"var(--syntax-normal)",margin:"0px -14px",wordBreak:"break-word",borderRadius:"0.25rem",borderLeft:"solid ".concat(4,"px transparent"),"&.cm-focused":{outline:"none !important"},"&.cm-focused .cm-activeLine":{borderLeft:"solid ".concat(4,"px var(--observable-focus-blue)"),marginLeft:"-".concat(4,"px")},"&.cm-focused .cm-activeLine.cm-errorLine":{borderLeftColor:"var(--dark-red)"},"&.cm-focused .cm-matchingBracket":{backgroundColor:"transparent",color:"var(--syntax-matchbracket)"},"&:not(.cm-focused) .cm-cursor":v,"&:not(.cm-focused) .cm-placeholder":v,"&:not(.cm-focused) .cm-selectionBackground":v},".cm-scroller":{font:"var(--monospace-font)",overflow:"initial"},".cm-matchingBracket, &:not(.cm-focused) .cm-selectionMatch":{backgroundColor:"transparent"},".cm-line":{padding:"0 2px 0 10px","&:first-child":{marginRight:"20px"}},".cm-activeLine":{backgroundColor:"inherit"},".cm-errorLine":{borderLeft:"solid ".concat(4,"px var(--red)"),marginLeft:"-".concat(4,"px")},".cm-gutter-lint":{width:"0px"},".cm-gutters":{borderRight:"none"},".cm-lint-marker-error":{position:"absolute",borderLeft:"solid ".concat(4,"px var(--red)"),height:"21px",marginTop:"-3px",marginLeft:"-7px",content:"''"},".cm-lint-marker-error:before":{content:"''"},".cm-lintPoint":{position:"absolute",marginTop:"13px",marginLeft:"-3px",content:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:'viewBox="0 0 40 40"';return'url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" '.concat(t,">").concat(encodeURIComponent(e),"</svg>')")}('<path d="M10 6L6 2 2 6" fill="none" stroke="red" />','fill="none" viewBox="0 0 12 8" width="16" height="16" stroke-width="1.5" stroke-linecap="round"')},".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",borderRadius:"var(--border-radius-2)",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-tooltip-hover":{backgroundColor:"var(--white)",border:"solid 1px var(--silver)",borderRadius:"var(--border-radius-2)",boxShadow:"var(--box-shadow-4)",color:"var(--dark-gray)",font:"var(--font-size-6) var(--sans-serif)"},".cm-matchingBracket, .cm-nonmatchingBracket":{color:"inherit"},".node-hover &":{borderRadius:"0 0.25rem 0.25rem 0"},".node-focus &, .node-readonly &":{borderRadius:(0,g.t)()?"0 0.25rem 0 0":"0 0.25rem 0.25rem 0"},".node-select &, .node-toolbar &":{borderRadius:"0 0 0.25rem 0.25rem"},".node-toolbar.node-focus &, .node-toolbar.node-hover &, .node-toolbar.node-readonly &":{borderRadius:"0 0 0.25rem 0"},".node-focus &, .node-select &":{backgroundColor:"var(--observable-focus-lightest-blue)"},".dashboard .node-focus &":{border:"1px solid rgba(22, 144, 233, 0.6)",borderRadius:"0.25rem",marginTop:"8px"},".node-readonly &":{color:"var(--gray)"},".node-add &":{backgroundColor:"var(--washed-green)"},".node-assist &":{border:"solid 2px var(--light-purple)",borderRadius:"var(--border-radius-2)"},".cm-tooltip.cm-tooltip-autocomplete":{border:"none",background:"none",marginTop:"2px","& > ul":{backgroundColor:"var(--white)",border:"solid 1px var(--silver)",borderRadius:"var(--border-radius-2)",boxShadow:"var(--box-shadow-4)",color:"var(--dark-gray)",font:"var(--font-size-6) var(--sans-serif)",minWidth:"min(212px, 95vw)",maxHeight:"212px","& > li":{padding:"4px 6px",lineHeight:"24px"},"& > li[aria-selected]":{color:"var(--near-black)",backgroundColor:"var(--observable-focus-lightest-blue)"}}},".cm-completionDetail":{fontStyle:"normal",opacity:"1",color:"var(--gray)",float:"right"},".cm-completionMatchedText":{fontWeight:"bold",textDecoration:"none"},".cm-completionIcon":{width:"24px",position:"relative",marginRight:"4px",opacity:"1","&:after":{content:"''",position:"absolute",width:"24px",height:"24px",bottom:"-7px",left:"0px",borderRadius:"var(--border-radius-1)",backgroundImage:"url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none'%3E%3Cstyle%3E.a%7Bfill:%23929292;%7D%3C/style%3E%3Cpath d='M16.9 17.1C16.3 17.7 15.5 18 14.6 18H13.5V16H14.6C15 16 15.3 15.8 15.5 15.7 15.6 15.5 15.7 15.3 15.7 15V14.5C15.7 14.2 15.7 13.8 16.1 13 16.5 12.4 17.3 12 17.3 12 17.3 12 16.5 11.7 16.1 11.1 15.7 10.3 15.7 9.8 15.7 9.5V9C15.7 8.7 15.6 8.5 15.5 8.3 15.3 8.2 15 8 14.6 8H13.5L13.5 6H14.6C15.5 6 16.3 6.3 16.9 6.9 17.5 7.5 17.7 8.3 17.7 9V9.5C17.7 9.7 17.7 10.1 17.9 10.5 18 10.6 18.1 10.7 18.2 10.8 18.4 10.9 18.6 11 19 11V13C18.6 13 18.4 13.1 18.2 13.2 18.1 13.3 18 13.4 17.9 13.5 17.7 13.9 17.7 14.3 17.7 14.5V15C17.7 15.7 17.5 16.5 16.9 17.1Z' class='a'/%3E%3Cpath d='M7.1 17.1C7.7 17.7 8.5 18 9.4 18H10.5V16H9.4C9 16 8.7 15.8 8.5 15.7 8.4 15.5 8.3 15.3 8.3 15V14.5C8.3 14.2 8.3 13.8 7.9 13 7.5 12.4 6.8 12 6.8 12 6.8 12 7.5 11.7 7.9 11.1 8.3 10.3 8.3 9.8 8.3 9.5V9C8.3 8.7 8.4 8.5 8.5 8.3 8.7 8.2 9 8 9.4 8H10.5L10.5 6H9.4C8.5 6 7.7 6.3 7.1 6.9 6.5 7.5 6.3 8.3 6.3 9V9.5C6.3 9.7 6.3 10.1 6.1 10.5 6 10.6 5.9 10.7 5.8 10.8 5.6 10.9 5.4 11 5 11V13C5.4 13 5.6 13.1 5.8 13.2 5.9 13.3 6 13.4 6.1 13.5 6.3 13.9 6.3 14.3 6.3 14.5V15C6.3 15.7 6.5 16.5 7.1 17.1Z' class='a'/%3E%3C/svg%3E \")",backgroundSize:"'cover'"}},".cm-snippetFieldPosition":{verticalAlign:"initial"},".cm-completionIcon-data":{"&:after":{backgroundImage:"url(\"data:image/svg+xml, %3csvg width='24' height='24' viewBox='-4 -4 24 24' fill='none' xmlns='http://www.w3.org/2000/svg' stroke-width='2' %3e%3cpath d='M7.19855 2.52175L7.88131 1.79111L7.19855 2.52175ZM12.6 11.7764L13.2581 11.0234L12.6 11.7764ZM5.34191 6.76078L11.9419 12.5293L13.2581 11.0234L6.65809 5.2549L5.34191 6.76078ZM10.8958 13.6864L3.35462 6.63385L1.98852 8.09459L9.52965 15.1472L10.8958 13.6864ZM6.51578 3.25238L13.8172 10.0755L15.1828 8.61419L7.88131 1.79111L6.51578 3.25238ZM3.08395 3.55474C3.91017 2.45311 5.50967 2.31219 6.51578 3.25238L7.88131 1.79111C6.0058 0.0384695 3.02413 0.301162 1.48395 2.35474L3.08395 3.55474ZM3.35462 6.63385C2.49183 5.82695 2.37516 4.49978 3.08395 3.55474L1.48395 2.35474C0.162683 4.11642 0.380169 6.59044 1.98852 8.09459L3.35462 6.63385ZM11.993 13.6551C11.6977 13.9647 11.2082 13.9786 10.8958 13.6864L9.52965 15.1472C10.6432 16.1886 12.3878 16.1388 13.4402 15.0356L11.993 13.6551ZM11.9419 12.5293C12.2764 12.8216 12.2996 13.3337 11.993 13.6551L13.4402 15.0356C14.5328 13.8903 14.4499 12.0651 13.2581 11.0234L11.9419 12.5293Z' fill='%23929292' /%3e%3c/svg%3e\")"}},".cm-completionIcon-snippet":{"&:after":{backgroundImage:"url(\"data:image/svg+xml,%0A%3Csvg width='24' height='24' viewBox='-4 -4 24 24' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M13 3H3C2.44772 3 2 3.44772 2 4V12C2 12.5523 2.44772 13 3 13H13C13.5523 13 14 12.5523 14 12V4C14 3.44772 13.5523 3 13 3Z' stroke='%23929292' stroke-width='2' /%3E%3Crect x='4' y='9' width='2' height='2' rx='0.5' fill='%23929292' /%3E%3Crect x='7' y='5.5' width='2' height='5.5' rx='0.5' fill='%23929292' /%3E%3Crect x='10' y='7' width='2' height='4' rx='0.5' fill='%23929292' /%3E%3C/svg%3E%0A\")"}},".cm-completionIcon-reference, .cm-completionIcon-stdlib":{"&:after":{backgroundImage:"url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='-4 -4 24 24' fill='%23929292' fillRule='evenodd' clipRule='evenodd' %3E%3Cpath d='M3 1.75C2.30964 1.75 1.75 2.30964 1.75 3C1.75 3.69036 2.30964 4.25 3 4.25C3.69036 4.25 4.25 3.69036 4.25 3C4.25 2.30964 3.69036 1.75 3 1.75ZM0.25 3C0.25 1.48122 1.48122 0.25 3 0.25C4.51878 0.25 5.75 1.48122 5.75 3C5.75 4.51878 4.51878 5.75 3 5.75C1.48122 5.75 0.25 4.51878 0.25 3Z' /%3E%3Cpath d='M13 11.75C12.3096 11.75 11.75 12.3096 11.75 13C11.75 13.6904 12.3096 14.25 13 14.25C13.6904 14.25 14.25 13.6904 14.25 13C14.25 12.3096 13.6904 11.75 13 11.75ZM10.25 13C10.25 11.4812 11.4812 10.25 13 10.25C14.5188 10.25 15.75 11.4812 15.75 13C15.75 14.5188 14.5188 15.75 13 15.75C11.4812 15.75 10.25 14.5188 10.25 13Z' /%3E%3Cpath d='M10 12C9.44771 12 9 11.5523 9 11V5C9 3.34315 7.65685 2 6 2H5V4H6C6.55228 4 7 4.44772 7 5V11C7 12.6569 8.34315 14 10 14H11V12H10Z' /%3E%3C/svg%3E\")"}},".cm-completionIcon-text":{"&:after":{backgroundImage:"url(\"data:image/svg+xml,%0A%3Csvg width='24' height='24' viewBox='0 0 24 24' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M7.29552 11.1791C8.0027 11.1791 8.6196 10.8922 8.83526 10.4595H8.93557V11.1013H10.9417V7.38168C10.9417 6.18557 10.0239 5.5 8.41396 5.5C6.79398 5.5 5.76582 6.18071 5.6956 7.29902H7.51119C7.62654 7.04618 7.88233 6.92463 8.28858 6.92463C8.6848 6.92463 8.92554 7.09967 8.92554 7.38168V7.78524L7.81211 7.84845C6.31751 7.93111 5.5 8.51943 5.5 9.51619C5.5 10.5178 6.21721 11.1791 7.29552 11.1791ZM8.09799 9.83709C7.70679 9.83709 7.46103 9.65233 7.46103 9.36546C7.46103 9.09804 7.7118 8.923 8.14313 8.89382L8.92554 8.84034V9.16125C8.92554 9.5405 8.55941 9.83709 8.09799 9.83709Z' fill='%23929292'/%3E%3Cpath d='M16.2832 15.4043C17.6925 15.4043 18.5 14.3833 18.5 12.594C18.5 10.7901 17.7076 9.78361 16.2832 9.78361C15.5108 9.78361 14.924 10.1337 14.6632 10.7463H14.5629V7.84845H12.5066V15.3265H14.5127V14.4805H14.613C14.8588 15.064 15.4757 15.4043 16.2832 15.4043ZM15.4757 11.3201C16.0324 11.3201 16.3935 11.8209 16.3935 12.594C16.3935 13.3768 16.0374 13.8679 15.4757 13.8679C14.909 13.8679 14.5579 13.3816 14.5529 12.5988C14.5579 11.816 14.919 11.3201 15.4757 11.3201Z' fill='%23929292'/%3E%3Cpath d='M11.2878 15.0284C11.1925 13.5746 10.2396 12.7626 8.62461 12.7626C6.68363 12.7626 5.69559 13.7302 5.69559 15.6264C5.69559 17.5324 6.68363 18.5 8.62461 18.5C10.2045 18.5 11.1975 17.6734 11.2878 16.2828H9.42707C9.36689 16.7593 9.09606 17.0024 8.62461 17.0024C8.02275 17.0024 7.75192 16.5794 7.75192 15.6264C7.75192 14.6832 8.02275 14.2601 8.62461 14.2601C9.09606 14.2601 9.36689 14.5227 9.42707 15.0284H11.2878Z' fill='%23929292'/%3E%3C/svg%3E%0A\")"}},...(0,f.pK)("var(--observable-focus-dark-blue)")}),(0,S.yC)(),(0,a.ZO)(),(0,a.AE)(),(0,l.sW)(),(0,o.nF)(d.$d),a.tk.lineWrapping,(0,i.m8)(),(0,a.Uw)(),s.yy.allowMultipleSelections.of(!0),s.yy.tabSize.of(2),(0,o.nY)(),(0,o.n$)(),(0,a.Zs)(),s.yy.changeFilter.of(e=>e.changes.newLength<=65536),s.yy.transactionFilter.of(e=>{let t=[];if(e.changes.iterChanges((e,n,r,i,o)=>{let l=r;for(let e of o){let n=-1;for(;(n=e.indexOf("\x00",n+1))>=0;)t.push({from:l+n,to:l+n+1,insert:"�"});l+=e.length}}),t.length){let n=s.as.of(t,e.changes.newLength);return{...e,changes:e.changes.compose(n)}}return e}),(0,f.W$)(),(0,y.tU)(),(0,u.Cw)(),(0,k.kh)(),(0,C.vt)(),x.A,h.l,_.c,m.Y,E.L7,E.UP,E.ss,a.tk.contentAttributes.of({"data-cy":"editor"}),s.yy.transactionExtender.of(function(e){let{effects:t,startState:n}=e,r=t.filter(e=>e.is(w.g)),i=[];if(r.length>0){let e=n.field(w.C),{mode:t,data:o}=r[r.length-1].value;if(t!==e){let e=D.qz[t];i=[P.modeExtensions.reconfigure(e.extensions({settings:n.field(N.i),data:o})),P.keymap.reconfigure([a.$f.of([...e.keymap,...R])])]}}return{effects:i}}),s.yy.transactionFilter.of(function(e){let{newDoc:t,startState:n}=e,r=n.field(w.C);if(e.isUserEvent("input.paste")&&"md"===r){let r="";return(e.changes.iterChanges((e,n,i,o)=>{r||(r=t.sliceString(i,o))}),isAbsoluteUrl(r))?n.changeByRange(e=>{let{from:t,to:i}=e,[o,l]=["](",")"],a=n.sliceDoc(t,i),d=(0,p.AB)(n,e,o,l),c=n.doc.sliceString(d.from,d.to),u=c.startsWith(o)&&c.endsWith(l),h=!a.length||u||isAbsoluteUrl(a)?r:"[".concat(a,"](").concat(r,")"),m=t+h.length;return{range:s.xm.fromJSON({anchor:m,head:m}),changes:{from:t,to:i,insert:h}}}):e}return e}),a.tk.updateListener.of(e=>{let{view:t,state:n,focusChanged:r}=e;(0,T.f)(t,()=>{let e=n.field(L.X),i=n.field(h.l);i&&(i({type:"edit",id:e,state:n}),t.hasFocus&&r&&i({type:"focus",id:e}))})}),function(){function maybeDrop(e,t,n){let r=n.state.field(h.l);if(!r||!t)return!1;let i=Array.prototype.filter.call(t.items,e=>"file"===e.kind);if(!i.length)return!1;let o=Array.prototype.some.call(t.items,e=>"text/plain"===e.type);if(o)return!1;let{fileUploadsOn:l,loginToUpload:s}=n.state.field(N.i);return l?(r({type:"attachLocalFiles",files:i.map(e=>e.getAsFile()),nodeId:n.state.field(L.X),nodeMode:n.state.field(w.C),source:"nodeEditor",trigger:"dragAndDrop"}),e.preventDefault(),!0):(s&&r({type:"showModal",modal:"login",modalProps:{loginReason:"files"},trigger:"dragAndDrop",source:"nodeEditorDragAndDrop"}),!1)}return a.tk.domEventHandlers({drop:(e,t)=>!t.state.readOnly&&maybeDrop(e,e.dataTransfer,t),paste:(e,t)=>!t.state.readOnly&&maybeDrop(e,e.clipboardData,t)})}(),(0,I.p)(),(0,E.Tl)(),...A]},12720:function(e,t,n){"use strict";n.d(t,{C:function(){return o},_:function(){return i}});var r=n(28682);let[i,o]=(0,r.Z)([])},26271:function(e,t,n){"use strict";n.d(t,{D:function(){return findNodeAfterEquals},G:function(){return findNameNode}});var r=n(59119);let i=new Set(["LineComment","BlockComment"]),o=new Set(["NamedBlockCell","NamedExpressionCell","NamedClassCell","NamedFunctionCell"]);function findNameNode(e,t){let n=(0,r.qz)(e);if("Cell"!==n.topNode.type.name)return null;let{firstChild:l}=n.topNode;for(;l&&i.has(l.type.name);)l=l.nextSibling;if(l&&o.has(l.type.name)){let e=l.getChild("VariableDefinition");if(e)return e;let n=l.getChild("QualifiedVariableDefinition");if(n)return t?n:n.getChild("VariableDefinition")}return null}function findNodeAfterEquals(e){let t=(0,r.qz)(e);if("Cell"===t.topNode.type.name&&t.topNode.firstChild&&["NamedBlockCell","NamedExpressionCell"].includes(t.topNode.firstChild.type.name)){let e=t.topNode.firstChild.getChild("Equals");if(null==e?void 0:e.nextSibling)return e.nextSibling}return null}},96265:function(e,t,n){"use strict";n.d(t,{A:function(){return o}});var r=n(78120);let i=0,o=r.QQ.define({create:()=>i++,update:e=>e})},25227:function(e,t,n){"use strict";n.d(t,{N:function(){return o},Z:function(){return i}});var r=n(28682);let[i,o]=(0,r.Z)(null)},51265:function(e,t,n){"use strict";n.d(t,{W$:function(){return placeholder},pK:function(){return placeholderTheme},vT:function(){return u}});var r=n(78120),i=n(14456),o=n(31432),l=n(13961),s=n(88182),a=n(44911);let d="".concat((0,s._)("Alt-Backspace")," to delete this cell."),c=r.Py.define(),u=c.of(d);function defaultHint(e){let t=e.field(l.C),n=a.qz[t],r="tex"===t||"html"===t?"":" ".concat((0,s._)("Ctrl-space")," for more options."),i=n.convertible?" Arrow ↑/↓ to switch modes.":"";return"Type ".concat(n.label,", then ").concat((0,s._)("Shift-Enter"),".").concat(r).concat(i)}let p=r.QQ.define({create:e=>defaultHint(e),update(e,t){for(let n of((0,o.Z)(t.state)&&(e=defaultHint(t.state)),t.effects))n.is(c)&&(e=n.value);return e}});let PlaceholderWidget=class PlaceholderWidget extends i.l9{toDOM(){let e=document.createElement("div");return e.className="cm-placeholder",e.textContent=this.value,e}constructor(e){super(),this.value=e}};let h=i.lg.fromClass(class{update(e){((0,o.Z)(e.startState)!==(0,o.Z)(e.state)||e.startState.field(p)!==e.state.field(p))&&this.updateDeco(e.state)}updateDeco(e){this.placeholder=(0,o.Z)(e)?i.p.set(i.p.widget({widget:new PlaceholderWidget(e.field(p))}).range(0)):i.p.none}get decorations(){return this.placeholder}constructor(e){this.placeholder=i.p.none,this.updateDeco(e.state)}},{decorations:e=>e.decorations});function placeholderTheme(e){return{".cm-placeholder":{color:e,position:"absolute",fontFamily:"var(--sans-serif)",pointerEvents:"none",userSelect:"none",opacity:.6,overflowX:"hidden",whiteSpace:"nowrap",maxWidth:"95%","&::first-letter":{"text-transform":"uppercase"}}}}function placeholder(){return[p,h]}},7897:function(e,t,n){"use strict";n.d(t,{K5:function(){return p},YE:function(){return a},j5:function(){return c},yC:function(){return search}});var r=n(14456),i=n(23939),o=n(28682);let l=r.tk.baseTheme({".cm-searchResult":{backgroundColor:"var(--observable-yellow)"},".cm-selectedSearchResult":{backgroundColor:"var(--observable-orange)"}}),[s,a]=(0,o.Z)(null),[d,c]=(0,o.Z)(null),[u,p]=(0,o.Z)(!1);function search(){return[l,s,d,u,f]}let h=r.p.mark({attributes:{class:"cm-searchResult"}}),m=r.p.mark({attributes:{class:"cm-selectedSearchResult"}}),f=r.lg.fromClass(class{update(e){let t=e.state.field(s),n=e.state.field(d),r=e.state.field(u);(e.viewportChanged||t!==this._previousSearchResults||n!==this._previousSelectedSearchResult||r!==this._previousSearchResultsVisible)&&(this._previousSearchResults=t,this._previousSelectedSearchResult=n,this._previousSearchResultsVisible=r,this.decorations=this.searchResultsDeco(e.view,t,n,r))}searchResultsDeco(e,t,n,o){if(!t||!o)return r.p.set([]);let l=e.state.field(i.X),s=[];for(let{from:r,to:i}of e.visibleRanges)for(let e=0;e<t.length;e++){let{pos:o,matchLength:a}=t[e];o>=r&&o<=i&&(n&&n.nodeId===l&&n.nodeResultIndex===e?s.push(m.range(o,o+a)):s.push(h.range(o,o+a)))}return r.p.set(s)}constructor(e){this.view=e,this._previousSearchResults=null,this._previousSelectedSearchResult=null,this._previousSearchResultsVisible=!1,this.decorations=this.searchResultsDeco(e,null,null,!1)}},{decorations:e=>e.decorations})},32341:function(e,t,n){"use strict";n.d(t,{JN:function(){return s},Zt:function(){return getParticipantColor},_O:function(){return l},kh:function(){return selectionPresence},mQ:function(){return getParticipantColorName}});var r=n(78120),i=n(14456);let o=[["gold","translucent-gold"],["pink","translucent-pink"],["light-green","translucent-green"],["light-purple","translucent-purple"],["orange","translucent-orange"],["light-blue","translucent-blue"]];function getParticipantColorName(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return"".concat(o[(e+1)%o.length][t?1:0])}function getParticipantColor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return"var(--".concat(getParticipantColorName(e,t),")")}function selectionPresence(){return[s,a]}let l=r.Py.define(),s=r.QQ.define({create:()=>[],update(e,t){let{effects:n}=t;return 0===(n=n.filter(e=>e.is(l))).length?e:n.map(e=>e.value).filter(e=>e)}});let Cursor=class Cursor extends i.l9{toDOM(){var e;let t=document.createElement("span");return t.className="presence-widget",t.title=this.name,t.style.borderColor=getParticipantColor(this.order),t.style.setProperty("--presence-initials",'"'.concat((e=this.name,this.avatar?"":e.split(" ").filter(e=>e).map(e=>e.charAt(0).toUpperCase()).join("").substring(0,2)),'"')),t.style.setProperty("--presence-avatar","url(".concat(this.avatar,")")),t.style.setProperty("--presence-color",getParticipantColor(this.order)),t}constructor(e,t,n){super(),this.name=e,this.avatar=t,this.order=n}};let mark=e=>i.p.mark({attributes:{style:"background-color: ".concat(getParticipantColor(e,!0),";")}}),widget=(e,t,n)=>i.p.widget({widget:new Cursor(e,t,n)}),a=i.lg.fromClass(class{update(e){this.selectionsChanged(e)?this.decorations=this.decorationSet(e.state):this.decorations=this.decorations.map(e.changes)}selectionsChanged(e){return e.state.field(s)!==e.startState.field(s)}decorationSet(e){let t=e.field(s);return i.p.set(Array.from(this.getDecorations(t)),!0)}*getDecorations(e){for(let{selection:t,name:n,avatar:r,order:i}of e)for(let{head:e,empty:o,from:l,to:s}of t.ranges)yield widget(n,r,i).range(e),o||(yield mark(i).range(l,s))}constructor(e){this.view=e,this.decorations=this.decorationSet(e.state)}},{decorations:e=>e.decorations})},25993:function(e,t,n){"use strict";n.d(t,{L7:function(){return c},LV:function(){return u},Tl:function(){return signatureHelp},UP:function(){return m},dF:function(){return f},ss:function(){return p},t2:function(){return dismissSignatureHelp},vo:function(){return h}});var r=n(78120),i=n(14456),o=n(74374),l=n(68092),s=n(23939),a=n(28682),d=n(83687);function dismissSignatureHelp(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"implicit",n=e.state.field(s.X),r=e.state.field(c),i=e.state.field(p),o=e.state.field(l.l);return!!i&&!!o&&!r&&(o({type:"signatureHelpDismiss",id:n,source:t}),!0)}let[c,u]=(0,a.Z)(null),[p,h]=(0,a.Z)(!1),[m,f]=(0,a.Z)(null),g=r.QQ.define({create:getSignatureHelpTooltip,update(e,t){let{state:n,docChanged:r,selection:i,startState:o}=t;return r||i?getSignatureHelpTooltip(n,o):e},provide:e=>i.hJ.computeN([e],t=>t.field(e))});function getSignatureHelpTooltip(e,t){let n=e.field(d.c);if(!n||"js"!==(0,o.yq)(e))return[];let r=e.selection.ranges.filter(e=>e.empty);if(!r.length)return[];let i=r[r.length-1].from,a=null==t?void 0:t.doc.toString().charAt(i-1),c=e.doc.toString().charAt(i-1),u="("===c&&"("!==a,h=e.field(p),f=e.field(s.X),g=e.field(m);if(!g)return[];let v=document.createElement("div");return v.appendChild(g),v.setAttribute("class","cm-contextual-info cm-tooltip cm-tooltip-autocomplete"),n.getSignatureHelpItems(f,i,e.doc.toString()).then(t=>{let n=e.field(l.l);if(!t)return null==n?void 0:n({type:"signatureHelp",id:f});u||h?null==n||n({type:"signatureHelp",id:f,data:t}):null==n||n({type:"signatureHelp",id:f})}),[{pos:i,above:!0,create:()=>({dom:v,overlap:!0,offset:{x:0,y:4}})}]}function signatureHelp(){return[g]}},83687:function(e,t,n){"use strict";n.d(t,{P:function(){return o},c:function(){return i}});var r=n(28682);let[i,o]=(0,r.Z)(null)},56564:function(e,t,n){"use strict";n.d(t,{C:function(){return o},i:function(){return i}});var r=n(28682);let[i,o]=(0,r.Z)({prettierOn:!1,closeBracketsOn:!0,fileUploadsOn:!1,loginToUpload:!0,spellcheckOn:!1,defaultCellMode:void 0,vimKeys:!1,defaultOpenAddCellMenu:!0})},39273:function(e,t,n){"use strict";n.d(t,{R:function(){return i},W:function(){return loadVim}});var r=n(23939);let i={loaded:!1};function loadVim(e){return n.e(1972).then(n.bind(n,1226)).then(t=>{function blur(t){e({type:"blur",id:t.cm6.state.field(r.X)})}return Object.assign(i,{loaded:!0,...t}),t.Vim.defineEx("write","w",function(t){e({type:"commit",id:t.cm6.state.field(r.X),trigger:"keypress",source:"nodeEditor"})}),t.Vim.defineEx("quit","q",blur),t.Vim.defineEx("wq","wq",blur),t.Vim.defineEx("x","x",blur),t.Vim.map("ZZ",":x","normal"),i})}},13064:function(e,t,n){"use strict";n.d(t,{X:function(){return CustomizePopoverContents},l:function(){return Customize}});var r=n(85893),i=n(5379),o=n.n(i),l=n(41269),s=n(27522),a=n(4447),d=n(76010),c=n(67294),u=n(92862),p=n(24067),h=n(73507),m=n(26026),f=n(6059),g=n(17),v=n(74364),y=n(88903);let x={Sequential:["Blues","Greens","Greys","Oranges","Purples","Reds","Turbo","Viridis","Inferno","Magma","Plasma","Cividis","Warm","Cool","BuGn","BuPu","GnBu","OrRd","PuBuGn","PuBu","PuRd","RdPu","YlGnBu","YlGn","YlOrBr","YlOrRd"],Diverging:["BrBG","PRGn","PiYG","PuOr","RdBu","RdGy","RdYlBu","RdYlGn","Spectral"],Cyclical:["Sinebow","Turbo"],Categorical:["Category10","Accent","Dark2","Paired","Pastel1","Pastel2","Set1","Set2","Set3","Tableau10"]},b={Sequential:"Blues",Diverging:"BrBG",Cyclical:"Rainbow",Categorical:"Category10"},ColorSwatch=e=>{let t,{name:n}=e,i=60,o=x.Categorical.includes(n);if(o)return Array.isArray(t=d["scheme".concat(n)])&&t.length?(i=t.length,(0,r.jsx)("svg",{viewBox:"0 0 ".concat(i," 1"),style:{display:"block",width:5*i,height:16},children:t.map((e,t)=>(0,r.jsx)("rect",{x:t,y:-1,width:1,height:3,fill:e},e))})):null;let l=d["interpolate".concat(n)];if("function"!=typeof l)return null;t=[];for(let e=0;e<i;++e)t.push((0,a.B8)(l(e/(i-1))).hex());let s=document.createElement("canvas");s.width=i,s.height=16;let c=s.getContext("2d");if(!c)return null;for(let e=0;e<i;++e)c.fillStyle=t[e],c.fillRect(e,0,1,16);return(0,r.jsx)("img",{className:"bn br2",alt:n,src:s.toDataURL()})},MaybeCheck=e=>{let{show:t}=e;return t?(0,r.jsx)(g.Z,{}):(0,r.jsx)("div",{})},ListOption=e=>{let{option:t,value:n,label:i,children:o}=e;return i=i||t,(0,r.jsxs)(v.wt,{value:t,className:"ph12",style:{display:"grid",gridTemplateColumns:"19px 90px 1fr",alignItems:"center"},children:[(0,r.jsx)(MaybeCheck,{show:t===n}),i,o]},i)},ListInputContents=e=>{let{value:t,label:n,children:i}=e;return(0,r.jsxs)(v.uf,{style:{padding:"4px 0",margin:0},children:[(0,r.jsx)("div",{className:"gray f7 ph12 mb2 mt1",children:n}),(0,r.jsx)("div",{className:"bb b--light-gray ma0 mb1"}),(0,r.jsxs)(v.wt,{value:"__undefined",className:"ph12",style:{display:"grid",gridTemplateColumns:"19px 1fr",alignItems:"center"},children:[(0,r.jsx)(MaybeCheck,{show:"__undefined"===t}),"Auto"]},"__undefined"),i]})},ListInput=e=>{let{id:t,value:n,label:i,channel:o,option:l,options:a,children:d,dispatch:c}=e;return n=void 0===n?"__undefined":n,(0,r.jsx)("div",{children:(0,r.jsxs)(s.vz,{onChange:e=>{c({type:"setChartConfig",id:t,options:{[o]:{...a[o],[l]:"__undefined"===e?void 0:e}},source:"customize"})},value:n,className:"b--solid ba br2 b--light-gray",style:{padding:"4px 8px",height:26},children:[(0,r.jsxs)(v.Y4,{className:"flex items-center justify-between f6 fw5 dark-gray",style:{margin:0},children:[(0,r.jsx)("div",{className:"flex items-center",children:"__undefined"===n?(0,r.jsx)("div",{className:"mid-gray",children:"Auto"}):(0,r.jsx)("div",{children:n})}),(0,r.jsxs)(v.r9,{className:"flex items-center",children:["color"===o&&(0,r.jsx)(ColorSwatch,{name:n}),(0,r.jsx)(f.Z,{className:"moon-gray pl1"})]})]}),(0,r.jsx)(v.jI,{className:"absolute",style:{minWidth:"200px",maxHeight:"225px",overflowY:"scheme"===l?"scroll":"auto"},portal:!1,children:(0,r.jsx)(ListInputContents,{value:n,label:i,children:d})})]})})},NumberInput=e=>{var t;let{id:n,options:i,name:o,disabled:l,dispatch:s}=e;return(0,r.jsx)(p.Z,{style:{width:60,padding:"4px 8px"},type:"number",min:0,disabled:l,value:null!==(t=i[o])&&void 0!==t?t:"",onKeyDown:e=>{"e"===e.key.toLowerCase()&&e.preventDefault()},onChange:e=>s({type:"setChartConfig",id:n,options:{[o]:isNaN(e.target.valueAsNumber)?void 0:e.target.valueAsNumber},source:"customize"})})},Row=e=>{let{label:t,spacing:n="mt1",labelStyle:i={display:"flex",alignItems:"center"},children:o}=e;return(0,r.jsxs)("div",{className:n,style:{display:"grid",gridTemplateColumns:"115px minmax(200px, auto)"},children:[(0,r.jsx)("div",{className:"fw4 f6 dark-gray",style:i,children:t}),o]})},CustomizePopoverContents=e=>{var t,n,i,s,a,d,f,g,v,y,w,C,j,S,k,E,_,N,L,I,T,D;let{id:M,options:P,dispatch:R}=e,A=["Top","Right","Bottom","Left"],O=(null===(t=P.color)||void 0===t?void 0:t.legend)!==!1,[F,B]=(0,c.useState)(void 0===P.width?"auto":"width"===P.width?"full":"custom");return(0,c.useEffect)(()=>{void 0===P.width&&B("auto"),"width"===P.width&&B("full")},[P.width]),(0,r.jsxs)("div",{className:o().dynamic([["289a11491dc03ccc",[64]]]),children:[(0,r.jsxs)("div",{style:{width:370},className:o().dynamic([["289a11491dc03ccc",[64]]]),children:[(0,r.jsx)(Row,{label:"Title",children:(0,r.jsx)(p.Z,{id:"title",name:"title",spellCheck:!1,value:null!==(j=P.title)&&void 0!==j?j:"",style:{padding:"4px 8px"},onChange:e=>R({type:"setChartConfig",id:M,options:{title:e.target.value||void 0},source:"customize"})})}),(0,r.jsx)(Row,{label:"Subtitle",children:(0,r.jsx)(p.Z,{id:"subtitle",name:"subtitle",spellCheck:!1,value:null!==(S=P.subtitle)&&void 0!==S?S:"",style:{padding:"4px 8px"},onChange:e=>R({type:"setChartConfig",id:M,options:{subtitle:e.target.value||void 0},source:"customize"})})}),(0,r.jsx)(Row,{label:"Caption",labelStyle:{marginTop:10},children:(0,r.jsx)(m.g,{name:"caption",rows:2,style:{resize:"none",width:"100%"},value:null!==(k=P.caption)&&void 0!==k?k:"",onChange:e=>{R({type:"setChartConfig",id:M,options:{caption:e.target.value||void 0},source:"customize"})}})}),(0,r.jsx)(Row,{label:"Height",spacing:"mt3",children:(0,r.jsx)(NumberInput,{options:P,id:M,name:"height",dispatch:R})}),(0,r.jsx)(Row,{label:"Width",children:(0,r.jsxs)("div",{className:o().dynamic([["289a11491dc03ccc",[64]]])+" flex",children:[(0,r.jsx)(h.E,{label:"Auto",className:"mr3 dark-gray font-input",checked:"auto"===F,onChange:()=>{B("auto"),R({type:"setChartConfig",id:M,options:{width:void 0},source:"customize"})}}),(0,r.jsxs)("div",{className:o().dynamic([["289a11491dc03ccc",[64]]])+" flex",children:[(0,r.jsx)(h.E,{className:"dark-gray font-input",checked:"custom"===F,onChange:()=>B("custom")}),(0,r.jsx)(NumberInput,{options:P,id:M,name:"width",disabled:"custom"!==F,dispatch:R})]}),(0,r.jsx)(h.E,{label:"Full",className:"dark-gray font-input ml3",checked:"full"===F,onChange:()=>{B("full"),R({type:"setChartConfig",id:M,options:{width:"width"},source:"customize"})}})]})}),(0,r.jsx)(Row,{label:"Margin",labelStyle:{display:"flex",alignItems:"center",marginTop:34},children:(0,r.jsxs)("div",{className:o().dynamic([["289a11491dc03ccc",[64]]])+" location mt3 mr4 gray",children:[A.map(e=>(0,r.jsx)("span",{className:o().dynamic([["289a11491dc03ccc",[64]]])+" fw4 f7 mb1",children:e},e)),A.map(e=>(0,r.jsx)("div",{className:o().dynamic([["289a11491dc03ccc",[64]]]),children:(0,r.jsx)(NumberInput,{options:P,id:M,name:"margin".concat(e),dispatch:R})},"margin".concat(e)))]})}),(0,r.jsx)(Row,{label:"Inset",children:(0,r.jsx)("div",{className:o().dynamic([["289a11491dc03ccc",[64]]])+" location",children:A.map(e=>(0,r.jsx)("div",{className:o().dynamic([["289a11491dc03ccc",[64]]]),children:(0,r.jsx)(NumberInput,{options:P,id:M,name:"inset".concat(e),dispatch:R})},"inset".concat(e)))})}),(0,r.jsx)(Row,{label:"Legend",spacing:"mt3",children:(0,r.jsxs)("div",{className:o().dynamic([["289a11491dc03ccc",[64]]])+" flex",children:[(0,r.jsx)(h.E,{label:"Auto",className:"mr3 dark-gray font-input",checked:O,onChange:()=>R({type:"setChartConfig",id:M,options:{color:{...P.color,legend:void 0}},source:"customize"})}),(0,r.jsx)(h.E,{label:"None",className:"dark-gray font-input",checked:!O,onChange:()=>R({type:"setChartConfig",id:M,options:{color:{...P.color,legend:!1}},source:"customize"})})]})}),(0,r.jsx)(Row,{label:"X label",spacing:"mt3",children:(0,r.jsx)(p.Z,{id:"xaxis",name:"xaxis",spellCheck:!1,value:null!==(E=null===(n=P.x)||void 0===n?void 0:n.label)&&void 0!==E?E:"",style:{padding:"4px 8px"},onChange:e=>R({type:"setChartConfig",id:M,options:{x:{...P.x,label:e.target.value||void 0}},source:"customize"})})}),(0,r.jsx)(Row,{label:"X scale",children:(0,r.jsxs)(ListInput,{id:M,value:null===(i=P.x)||void 0===i?void 0:i.type,label:"Scale",channel:"x",option:"type",options:P,dispatch:R,children:[(0,r.jsx)("div",{className:o().dynamic([["289a11491dc03ccc",[64]]])+" bb b--light-gray ma0 mb1"}),[...l.A2].map(e=>{var t;return(0,r.jsx)(ListOption,{option:e,value:null===(t=P.x)||void 0===t?void 0:t.type},e)})]})}),(0,r.jsx)(Row,{label:"X options",children:(0,r.jsxs)("div",{style:{height:24},className:o().dynamic([["289a11491dc03ccc",[64]]])+" flex items-center",children:[(0,r.jsx)(u.X,{spacing:"pv0",font:"font-input",label:"Grid",checked:null!==(_=null===(s=P.x)||void 0===s?void 0:s.grid)&&void 0!==_&&_,onChange:e=>R({type:"setChartConfig",id:M,options:{x:{...P.x,grid:e.target.checked||void 0}},source:"customize"})}),(0,r.jsx)(u.X,{spacing:"pv0 ml3",font:"font-input",label:"Reverse",checked:null!==(N=null===(a=P.x)||void 0===a?void 0:a.reverse)&&void 0!==N&&N,onChange:e=>R({type:"setChartConfig",id:M,options:{x:{...P.x,reverse:e.target.checked||void 0}},source:"customize"})})]})}),(0,r.jsx)(Row,{label:"Y label",spacing:"mt3",children:(0,r.jsx)(p.Z,{id:"yaxis",name:"yaxis",spellCheck:!1,value:null!==(L=null===(d=P.y)||void 0===d?void 0:d.label)&&void 0!==L?L:"",style:{padding:"4px 8px"},onChange:e=>{R({type:"setChartConfig",id:M,options:{y:{...P.y,label:e.target.value||void 0}},source:"customize"})}})}),(0,r.jsx)(Row,{label:"Y scale",children:(0,r.jsxs)(ListInput,{id:M,value:null===(f=P.y)||void 0===f?void 0:f.type,label:"Scale",channel:"y",option:"type",options:P,dispatch:R,children:[(0,r.jsx)("div",{className:o().dynamic([["289a11491dc03ccc",[64]]])+" bb b--light-gray ma0 mb1"}),[...l.A2].map(e=>{var t;return(0,r.jsx)(ListOption,{option:e,value:null===(t=P.y)||void 0===t?void 0:t.type},e)})]})}),(0,r.jsx)(Row,{label:"Y options",children:(0,r.jsxs)("div",{style:{height:24},className:o().dynamic([["289a11491dc03ccc",[64]]])+" flex items-center",children:[(0,r.jsx)(u.X,{spacing:"pv0",font:"font-input",label:"Grid",checked:null!==(I=null===(g=P.y)||void 0===g?void 0:g.grid)&&void 0!==I&&I,onChange:e=>R({type:"setChartConfig",id:M,options:{y:{...P.y,grid:e.target.checked||void 0}},source:"customize"})}),(0,r.jsx)(u.X,{spacing:"pv0 ml3",font:"font-input",label:"Reverse",checked:null!==(T=null===(v=P.y)||void 0===v?void 0:v.reverse)&&void 0!==T&&T,onChange:e=>R({type:"setChartConfig",id:M,options:{y:{...P.y,reverse:e.target.checked||void 0}},source:"customize"})})]})}),(0,r.jsx)(Row,{label:"Color scheme",spacing:"mt3",children:(0,r.jsxs)(ListInput,{id:M,value:null===(y=P.color)||void 0===y?void 0:y.scheme,label:"Color scheme",channel:"color",option:"scheme",options:P,dispatch:R,children:[(0,r.jsxs)("div",{className:o().dynamic([["289a11491dc03ccc",[64]]]),children:[(0,r.jsx)("div",{className:o().dynamic([["289a11491dc03ccc",[64]]])+" bb b--light-gray ma0 mb1"}),(0,r.jsx)("div",{style:{marginTop:"11px",marginBottom:"8px"},className:o().dynamic([["289a11491dc03ccc",[64]]])+" gray f7 ph12",children:"Default color schemes"}),Object.entries(b).map(e=>{var t;let[n,i]=e;return(0,r.jsx)("div",{className:o().dynamic([["289a11491dc03ccc",[64]]]),children:(0,r.jsx)(ListOption,{label:n,option:i,value:null===(t=P.color)||void 0===t?void 0:t.scheme,children:(0,r.jsx)(ColorSwatch,{name:i})})},n)})]},"Default"),Object.entries(x).map(e=>{let[t,n]=e;return(0,r.jsxs)("div",{className:o().dynamic([["289a11491dc03ccc",[64]]]),children:[(0,r.jsx)("div",{className:o().dynamic([["289a11491dc03ccc",[64]]])+" bb b--light-gray ma0 mb1"}),(0,r.jsxs)("div",{style:{marginTop:"11px",marginBottom:"8px"},className:o().dynamic([["289a11491dc03ccc",[64]]])+" gray f7 ph12",children:[t," color schemes"]}),n.map(e=>{var t;return(0,r.jsx)("div",{className:o().dynamic([["289a11491dc03ccc",[64]]]),children:(0,r.jsx)(ListOption,{option:e,value:null===(t=P.color)||void 0===t?void 0:t.scheme,children:(0,r.jsx)(ColorSwatch,{name:e})})},e)})]},t)})]})}),(0,r.jsx)(Row,{label:"Color scale",children:(0,r.jsxs)(ListInput,{id:M,value:null===(w=P.color)||void 0===w?void 0:w.type,label:"Scale",channel:"color",option:"type",options:P,dispatch:R,children:[(0,r.jsx)("div",{className:o().dynamic([["289a11491dc03ccc",[64]]])+" bb b--light-gray ma0 mb1"}),[...l.m4].map(e=>{var t;return(0,r.jsx)(ListOption,{option:e,value:null===(t=P.color)||void 0===t?void 0:t.type},e)})]})}),(0,r.jsx)(Row,{label:"Color options",children:(0,r.jsx)("div",{style:{height:24},className:o().dynamic([["289a11491dc03ccc",[64]]])+" flex items-center",children:(0,r.jsx)(u.X,{spacing:"pv0",font:"font-input",label:"Reverse",checked:null!==(D=null===(C=P.color)||void 0===C?void 0:C.reverse)&&void 0!==D&&D,onChange:e=>R({type:"setChartConfig",id:M,options:{color:{...P.color,reverse:e.target.checked||void 0}},source:"customize"})})})})]}),(0,r.jsx)(o(),{id:"289a11491dc03ccc",dynamic:[64],children:".location.__jsx-style-dynamic-selector{display:grid;grid-template-columns:repeat(4,".concat(64,'px)}input.__jsx-style-dynamic-selector::-webkit-outer-spin-button,input.__jsx-style-dynamic-selector::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}input[type="number"].__jsx-style-dynamic-selector{-moz-appearance:textfield}')})]})},Customize=e=>{let{id:t,dispatch:n,data:i}=e;return(0,r.jsx)(y.YI,{className:"bg-white ba b--silver br2 shadow-4 outline-0 pa12",children:(0,r.jsxs)(y.sd,{children:[(0,r.jsxs)("div",{className:"flex justify-between pb12",children:[(0,r.jsx)("div",{className:"gray f7",children:"Customize"}),(0,r.jsx)("button",{className:"bg-transparent bn blue fw6 f7 pa0 pointer",onClick:()=>n({type:"setChartConfig",id:t,options:null,source:"customize"}),children:"Clear"})]}),(0,r.jsx)(CustomizePopoverContents,{id:t,options:i.config.options,dispatch:n})]})})}},91929:function(e,t,n){"use strict";n.d(t,{s:function(){return Comment}});var r=n(85893),i=n(94184),o=n.n(i),l=n(42751),s=n(71261),a=n(27554),d=n(14255),c=n(26713),u=n(42565),p=n(47489),h=n(93327),m=n(88903),f=n(13604),g=n(7595),v=n(79998),y=n(32980),x=n(29020),b=n(17616),w=n(60147);let Comment=e=>{let{dispatch:t,comment:n,first:i,repeated:C}=e,{showDelete:j,showReportAbuse:S,showUpdate:k}=(0,w.v9)(e=>{let{notebook:t,currentUser:r}=e;return{showDelete:(0,y.Ss)(n,r,t),showReportAbuse:r&&!(0,x.ws)(t),showUpdate:(0,y.O4)(n,r)}}),{create_time:E,update_time:_,content:N,user:L}=n,I=(0,x.tO)(n)?"comment-local-".concat(n.nonce):"comment-".concat(n.id),T=j||k||S&&!(0,x.tO)(n);return(0,r.jsxs)("div",{id:I,"data-cy":"comment",className:o()("pv2 hide-child",i||C?"":"bt b--light-gray"),children:[(0,r.jsxs)("div",{className:"flex pb1 items-center justify-between lh-title",children:[(0,r.jsxs)("div",{className:"flex items-center min-w-0",children:[C?null:(0,r.jsx)(h.Z,{href:(0,b.GN)(L),children:(0,r.jsxs)("a",{className:"inline-flex truncate no-underline dark-gray hover-blue items-center mr2",children:[(0,r.jsx)(l.q,{user:{...L,type:"individual"},size:24,className:"mr2 br-100"}),(0,r.jsx)("span",{className:"truncate fw5",children:(0,v.KY)(L)})]})}),(0,x.tO)(n)?null:(0,r.jsxs)("a",{className:"mid-gray no-underline nowrap",href:"#".concat(I),children:[(0,r.jsx)(d.q,{time:E}),_&&" (edited)"]})]}),(0,r.jsxs)(m.v2,{children:[(0,r.jsx)(c.hU,{title:"Comment actions",className:T?"":"o-0",colorless:!0,disabled:!T,icon:u.v,asMenuButton:!0}),(0,r.jsxs)(m.qy,{"data-testid":"comment-actions",style:{minWidth:105},children:[k&&(0,r.jsxs)(m.sN,{"data-cy":"update-comment","aria-label":"Update comment",onSelect:()=>{(0,x.tO)(n)||t({type:"updateCommentStatus",nodeId:n.node_id,status:"updateInitiated",commentId:n.id})},children:[(0,r.jsx)(s.Z,{className:"w1 mr2"}),"Edit"]}),j&&(0,r.jsxs)(m.sN,{"data-cy":"delete-comment","aria-label":"Delete comment",className:"hover-dark-red hover-bg-washed-red",disabled:!(0,g.id)(n),onSelect:()=>{t({type:"showModal",modal:"deleteComment",modalProps:{comment:n}})},children:[(0,r.jsx)(a.Z,{className:"w1 mr2"}),"Delete"]}),S&&!(0,x.tO)(n)&&(0,r.jsxs)(m.sN,{"data-cy":"report-comment","aria-label":"Report comment",style:{width:210},onSelect:()=>{t({type:"showModal",modal:"reportAbuse",modalProps:{comment:n}})},children:[(0,r.jsx)(p.Z,{className:"w1 mr2"}),"Report spam or abuse"]})]})]})]}),(0,r.jsx)("div",{className:"overflow-x-hidden break-word pre-wrap",children:(0,r.jsx)(f.R,{content:N})})]})}},95381:function(e,t,n){"use strict";n.d(t,{S:function(){return CommentEditor}});var r=n(85893),i=n(5379),o=n.n(i),l=n(94184),s=n.n(l),a=n(67294);let HelpDot=e=>{let{children:t}=e;return(0,r.jsxs)("span",{className:"relative-ns v-mid disappear-child",style:{lineHeight:0},children:[(0,r.jsx)("span",{className:"dib ml2 f7 fw6 tc mid-gray hover-dark-gray bg-white ba b--silver br-pill hover-b--light-silver pointer",style:{width:"1.1rem",height:"1.1rem",lineHeight:"1.15rem"},children:"?"}),(0,r.jsx)("nav",{className:"db absolute tl lh-solid z-3 child",style:{right:"-11px",width:"16rem"},"aria-label":"submenu","aria-hidden":!open,children:(0,r.jsx)("div",{className:"f7 white bg-black br2 overflow-hidden",style:{marginTop:"7px"},children:(0,r.jsx)("div",{className:"ph2 pv1 lh-copy",children:t})})})]})};var d=n(26713),c=n(20736),u=n(29020),p=n(60147);let CommentBoxHelpMessage=e=>{let{notebookAccessText:t,isUpdatingComment:n=!1}=e,i="You are ".concat(n?"editing comments":"commenting"," on a ").concat(t.toLowerCase()," notebook.");return(0,r.jsxs)("div",{className:"inline-flex items-center",children:[(0,r.jsx)("div",{className:"db-ns dn mr2 f7 mid-gray",children:i}),(0,r.jsxs)(HelpDot,{children:[(0,r.jsxs)("span",{className:"dn-ns di",children:[i," "]}),"Your comment will be visible to anyone who can read this notebook."]})]})};function autoHeight(e){e.style.height="auto",e.style.height="".concat(e.scrollHeight,"px")}let CommentEditor=e=>{let{nodeId:t,dispatch:n,comment:i,isUpdatingComment:l,first:h,numUnresolved:m,closePopover:f=()=>{}}=e,{currentUser:g,subscriptionState:v,notebookAccess:y,docAllowsLayout:x,present:b}=(0,p.v9)(e=>{let{notebook:t,currentUser:n}=e;return{currentUser:n,subscriptionState:t.subscriptionState,notebookAccess:(0,u.wF)(t),docAllowsLayout:(0,u.XT)(t),present:t.present}}),[w,C]=(0,a.useState)((null==i?void 0:i.content)||""),j=(0,a.useRef)(null),S=(0,c.GS)(c.ro),k=x&&(!S||!b),E=(0,a.useCallback)(e=>{autoHeight(j.current),C(e.target.value)},[j]);(0,a.useEffect)(()=>{let{current:e}=j;if(w&&e){let t=w.length;e.setSelectionRange(t,t),autoHeight(e)}},[]);let _=(0,a.useCallback)(e=>{if(i){n({type:"updateCommentStatus",status:"unresolved",nodeId:i.node_id,commentId:i.id});return}n({type:"commentComposeCancel",nodeId:t,trigger:e,content:w.trim(),source:"commentCompose"})},[t,n,w,i]),N=(0,a.useCallback)((e,r)=>{e.preventDefault();let i=w.trim();i&&g&&(n({type:"commentCreated",nodeId:t,content:i,trigger:r,currentUser:g,source:"commentCompose"}),"default"===v&&n({type:"updateSubscription",status:"comments"}),C(""))},[t,w,g,C,n,v]),L=(0,a.useCallback)((e,r)=>{e.preventDefault();let o=w.trim();o&&i&&n({type:"updateComment",nodeId:t,content:o,trigger:r,source:"commentCompose",commentId:i.id})},[t,w,n,i]),I=(0,a.useCallback)(e=>{"Enter"===e.key&&(e.metaKey||e.ctrlKey)?l?L(e,"keypress"):N(e,"keypress"):"Escape"===e.key&&(!w.trim()||l)&&_("keypress")},[_,N,L,l,w]),T=(0,u.OA)(g)?"true":"false";return(0,r.jsxs)("form",{onSubmit:e=>l?L(e,"click"):N(e,"click"),style:{borderColor:"#e6e2d4"},className:"jsx-1815c2d8dd4ca4e0 "+(s()(k?"ph2 pt2":"flex relative flex-column items-stretch mt",{bt:!h})||""),children:[(0,r.jsx)("textarea",{style:{resize:"none"},onKeyDown:I,autoFocus:!0,rows:1,ref:j,value:w,name:"comment_description",placeholder:k?"Add a comment...":"",maxLength:65536,onChange:E,spellCheck:T,className:"jsx-1815c2d8dd4ca4e0 "+(s()("w-100 sans-serif f6 dark-gray br2 lh-f6 bg-transparent",k?"ph2 pv1 ba b--light-gray overflow-hidden":"ph0 pv3 bn")||"")}),k?0===m||w?(0,r.jsxs)("div",{className:"jsx-1815c2d8dd4ca4e0 flex justify-between pv2",children:[(0,r.jsx)(d.kq,{className:"bn",text:"Cancel",onClick:()=>{C(""),_("click"),f()}}),(0,r.jsx)(d.KM,{type:"submit",text:"Comment",disabled:!w.trim()||l&&w===(null==i?void 0:i.content),onClick:()=>{j.current&&(j.current.style.height="")}})]}):(0,r.jsx)("div",{className:"jsx-1815c2d8dd4ca4e0 mb2"}):(0,r.jsxs)("div",{className:"jsx-1815c2d8dd4ca4e0 flex pv2 justify-between",children:[(0,r.jsx)(CommentBoxHelpMessage,{notebookAccessText:y,isUpdatingComment:!!l}),(0,r.jsxs)(d.CQ,{children:[(0,r.jsx)(d.kq,{text:"Cancel",onClick:()=>_("click")}),(0,r.jsx)(d.KM,{type:"submit",text:l?"Save":"Comment",disabled:!w.trim()||l&&w===(null==i?void 0:i.content)})]})]}),(0,r.jsx)(o(),{id:"1815c2d8dd4ca4e0",children:"textarea.jsx-1815c2d8dd4ca4e0::-webkit-input-placeholder{color:var(--moon-gray)}textarea.jsx-1815c2d8dd4ca4e0:-moz-placeholder{color:var(--moon-gray)}textarea.jsx-1815c2d8dd4ca4e0::-moz-placeholder{color:var(--moon-gray)}textarea.jsx-1815c2d8dd4ca4e0:-ms-input-placeholder{color:var(--moon-gray)}textarea.jsx-1815c2d8dd4ca4e0::-ms-input-placeholder{color:var(--moon-gray)}textarea.jsx-1815c2d8dd4ca4e0::placeholder{color:var(--moon-gray)}"})]})}},78964:function(e,t,n){"use strict";n.d(t,{y:function(){return PopoverCommentList}});var r=n(85893),i=n(94184),o=n.n(i),l=n(67294),s=n(17),a=n(91929),d=n(95381),c=n(7595),u=n(56770),p=n(32980),h=n(29020),m=n(60147);let PopoverCommentList=e=>{let{nodeId:t,resolvedComments:n,unresolvedComments:i,linkedCommentId:f,linkedCommentShown:g,setLinkedCommentShown:v,close:y,dispatch:x}=e,{canResolve:b}=(0,m.v9)(e=>{let{notebook:t}=e;return{canResolve:(0,p.f$)(t)&&i.length>0}}),[w,C]=(0,l.useState)(!1),j=(0,l.useRef)(null);return(0,l.useEffect)(()=>{if(f&&!g){let e=n.some(e=>"id"in e&&e.id===f);e&&C(!0);let t=document.getElementById("comment-".concat(f));t&&(0,u.zT)(t),setTimeout(()=>{v(!0)},1e3)}},[f,g,v,n]),(0,r.jsxs)(r.Fragment,{children:[(i.length>0||n.length>0)&&(0,r.jsxs)("div",{className:"flex items-center justify-between bb b--silver pa2",children:[i.length>0?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"mid-gray",children:"".concat(i.length," open comment").concat(i.length>1?"s":"")}),b&&i.length>0?(0,r.jsxs)("button",{className:"bg-inherit bn pointer flex blue b",onClick:()=>x({type:"resolveComments",nodeId:t,trigger:"click",source:"commentBox"}),disabled:!i.every(e=>(0,c.Lj)(e)),children:[(0,r.jsx)(s.Z,{className:"pr1"})," Resolve all"]}):(0,r.jsx)("div",{className:"w-30"})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"w-30"}),(0,r.jsx)("div",{className:"w-30"})]}),n.length>0?(0,r.jsxs)("button",{className:"bg-inherit bn pointer blue b",onClick:()=>{if(C(!w),!w){var e;null===(e=j.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})}},disabled:!i.every(e=>(0,c.Lj)(e)),children:[w?"Hide":"Show"," ",n.length," ","resolved"]}):(0,r.jsx)("div",{className:"w-30"})]}),(0,r.jsx)("div",{className:"flex items-center",children:(0,r.jsxs)("div",{className:"dark-gray w-100 overflow-y-auto",style:{maxHeight:400},children:[(0,r.jsx)("div",{ref:j,children:w&&displayComments(n,!0)}),displayComments(i),(0,r.jsx)(d.S,{nodeId:t,dispatch:x,first:!0,numUnresolved:i.length,closePopover:y})]})})]});function displayComments(e,t){return e.map(e=>"updateInitiated"===e.status?(0,r.jsx)(d.S,{nodeId:e.node_id,comment:e,isUpdatingComment:!0,dispatch:x,first:!0},"remote-".concat(e.id)):(0,r.jsx)("div",{className:o()("pv1 pl3 pr2 bb b--light-gray f6 lh-f6",t&&"bg-near-white"),children:(0,r.jsx)(a.s,{dispatch:x,comment:e,first:!0,repeated:!1})},(0,h.tO)(e)?"local-".concat(e.nonce):"remote-".concat(e.id)))}}},69649:function(e,t,n){"use strict";n.d(t,{q:function(){return FuzzyHighlight}});var r=n(85893);let FuzzyHighlight=e=>{let{text:t,matcher:n,highlightClass:i="underline"}=e,o=[],l=0;for(let[e,s]of n.matches(t).sort((e,t)=>{let[n]=e,[r]=t;return n-r}))e=Math.max(l,e),(s=Math.max(l,s))>e&&(e>l&&o.push((0,r.jsx)(r.Fragment,{children:t.slice(l,e)})),o.push((0,r.jsx)("span",{className:i,children:t.slice(e,s)},e)),l=s);return o.push((0,r.jsx)(r.Fragment,{children:t.slice(l)})),(0,r.jsx)(r.Fragment,{children:o})}},10998:function(e,t,n){"use strict";var r=n(85893);t.Z=e=>(0,r.jsx)("svg",{width:"8",height:"16",viewBox:"0 0 8 16",fill:"none",...e,children:(0,r.jsx)("path",{d:"M4.74329 10.1741C4.34605 10.6155 3.65395 10.6155 3.25671 10.1741L1.00207 7.66897C0.4229 7.02544 0.879592 6 1.74536 6L6.25464 6C7.12041 6 7.5771 7.02544 6.99793 7.66897L4.74329 10.1741Z",fill:"currentColor"})})},55288:function(e,t,n){"use strict";var r=n(85893);t.Z=e=>(0,r.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",...e,children:(0,r.jsx)("path",{d:"M13 6.5L8 12L3 6.5",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})},94988:function(e,t,n){"use strict";var r=n(85893);t.Z=e=>(0,r.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",...e,children:[(0,r.jsx)("path",{d:"M2 6C2 5.44772 2.44772 5 3 5H10C10.5523 5 11 5.44772 11 6V13C11 13.5523 10.5523 14 10 14H3C2.44772 14 2 13.5523 2 13V6Z",stroke:"currentColor",strokeWidth:"2"}),(0,r.jsx)("path",{d:"M4 2.00004L12 2.00001C13.1046 2 14 2.89544 14 4.00001V12",stroke:"currentColor",strokeWidth:"2"}),e.children]})},49724:function(e,t,n){"use strict";var r=n(85893);t.Z=e=>(0,r.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor",...e,children:(0,r.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8 2.15771L3.98463 4.50001L5 5.0923L9.01537 2.75001L8 2.15771ZM11 3.90771L6.98463 6.25001L8 6.8423L12.0154 4.50001L11 3.90771ZM13 6.24104L9 8.57438V13.259L13 10.9256V6.24104ZM7 13.259V8.57438L3 6.24104V10.9256L7 13.259ZM7.24419 0.283189C7.71124 0.0107464 8.28876 0.0107473 8.75581 0.283189L14.5039 3.63623C14.8111 3.81544 15 4.14434 15 4.50001V11.2128C15 11.7463 14.7166 12.2397 14.2558 12.5085L8.50387 15.8638C8.19251 16.0454 7.80749 16.0454 7.49613 15.8638L1.74419 12.5085C1.28337 12.2397 1 11.7463 1 11.2128V4.50001C1 4.14434 1.18891 3.81544 1.49613 3.63623L7.24419 0.283189Z"})})},33078:function(e,t,n){"use strict";var r=n(85893);t.Z=e=>(0,r.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd",...e,children:[(0,r.jsx)("path",{d:"M2 3C2 1.89543 2.89543 1 4 1H10L14 5V8H12V6H9V3H4V13H6V15H4C2.89543 15 2 14.1046 2 13V3Z"}),(0,r.jsx)("path",{d:"M7.3598 12.7682L8.64017 11.2318L11 13.1983L13.3598 11.2318L14.6402 12.7682L11 15.8017L7.3598 12.7682Z"}),(0,r.jsx)("path",{d:"M10 15L10 9L12 9L12 15L10 15Z"})]})},94937:function(e,t,n){"use strict";var r=n(85893);t.Z=e=>(0,r.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",...e,children:(0,r.jsx)("path",{d:"M3.06752 3H12.9325C13.3564 3 13.588 3.49443 13.3166 3.82009L9 9V11.7929C9 11.9255 8.94732 12.0527 8.85355 12.1464L7.85355 13.1464C7.53857 13.4614 7 13.2383 7 12.7929V9L2.68341 3.82009C2.41202 3.49443 2.6436 3 3.06752 3Z",fill:"currentColor"})})},42565:function(e,t,n){"use strict";n.d(t,{v:function(){return HDots}});var r=n(85893);let HDots=e=>(0,r.jsxs)("svg",{viewBox:"0 0 16 16",width:"16",height:"16",fill:"currentColor",...e,children:[(0,r.jsx)("circle",{r:"1.5",cy:"8",cx:"2.5"}),(0,r.jsx)("circle",{r:"1.5",cy:"8",cx:"7.5"}),(0,r.jsx)("circle",{r:"1.5",cy:"8",cx:"12.5"})]})},62420:function(e,t,n){"use strict";var r=n(85893);t.Z=e=>(0,r.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinejoin:"round",...e,children:[(0,r.jsx)("path",{d:"M2 9V5.89453C2 5.34225 2.44772 4.89453 3 4.89453H10C10.5523 4.89453 11 5.34225 11 5.89453V13.8945C11 14.4468 10.5523 14.8945 10 14.8945H8"}),(0,r.jsx)("line",{x1:"4",y1:"10",x2:"4",y2:"16"}),(0,r.jsx)("path",{d:"M5 3L5 2.00001L12 2C13.1046 2 14 2.89543 14 4V12H13"}),(0,r.jsx)("line",{x1:"7",y1:"13",x2:"1",y2:"13"}),e.children]})},31881:function(e,t,n){"use strict";var r=n(85893);t.Z=e=>(0,r.jsxs)("svg",{width:"16",height:"16",fill:"currentColor",viewBox:"0 0 16 16",...e,children:[(0,r.jsx)("path",{d:"M8 1h3v1l-1 1v4l2 .875V9H9v5.125L8 15l-1-.875V9H4V7.875L6 7V3L5 2V1z"}),e.children]})},51337:function(e,t,n){"use strict";n.d(t,{GL:function(){return PlusSmall}});var r=n(85893);t.ZP=e=>(0,r.jsx)("svg",{viewBox:"0 0 16 16",width:"16",height:"16",stroke:"currentColor",strokeWidth:"2",...e,children:(0,r.jsx)("path",{d:"M3 8h10M8 3v10"})});let PlusSmall=e=>(0,r.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",stroke:"currentColor",strokeWidth:"2",...e,children:(0,r.jsx)("path",{d:"M8 12V4M4 8H12"})})},21756:function(e,t,n){"use strict";var r=n(85893);t.Z=e=>(0,r.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",stroke:"currentColor",strokeWidth:"2",...e,children:[(0,r.jsx)("path",{d:"M4 9L4 3C4 2.44771 4.44772 2 5 2L11.0001 2C11.5523 2 12 2.44768 12 2.99992V2.99992"}),(0,r.jsx)("path",{d:"M12 7L12 13C12 13.5523 11.5523 14 11 14L5 14C4.44771 14 4 13.5523 4 13V13"}),(0,r.jsx)("path",{d:"M1 6L4 9L7 6"}),(0,r.jsx)("path",{d:"M15 10L12 7L9 10"})]})},61107:function(e,t,n){"use strict";var r=n(85893);t.Z=e=>(0,r.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",...e,children:[(0,r.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M1 5C1 2.79086 2.79086 1 5 1H11C13.2091 1 15 2.79086 15 5V11C15 13.2091 13.2091 15 11 15H5C2.79086 15 1 13.2091 1 11V5ZM5 3C3.89543 3 3 3.89543 3 5V11C3 12.1046 3.89543 13 5 13H11C12.1046 13 13 12.1046 13 11V5C13 3.89543 12.1046 3 11 3H5Z",fill:"currentColor"}),(0,r.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M11.7071 6.70711L7.00001 11.4142L4.29291 8.70711L5.70712 7.29289L7.00001 8.58579L10.2929 5.29289L11.7071 6.70711Z",fill:"currentColor"})]})},28545:function(e,t,n){"use strict";var r=n(85893);t.Z=e=>(0,r.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",...e,children:[(0,r.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M13 4.75C13.6904 4.75 14.25 5.30964 14.25 6C14.25 6.69036 13.6904 7.25 13 7.25C12.3096 7.25 11.75 6.69036 11.75 6C11.75 5.30964 12.3096 4.75 13 4.75ZM15.75 6C15.75 4.48122 14.5188 3.25 13 3.25C11.4812 3.25 10.25 4.48122 10.25 6C10.25 7.51878 11.4812 8.75 13 8.75C14.5188 8.75 15.75 7.51878 15.75 6Z",fill:"currentColor"}),(0,r.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M1.5 8L11.5 8V6L1.5 6C0.947715 6 0.5 6.44772 0.5 7C0.5 7.55228 0.947715 8 1.5 8Z",fill:"currentColor"}),(0,r.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M3.17594 2.56653L8.67594 10.5665L10.324 9.43347L4.82403 1.43347C4.51114 0.978369 3.88856 0.863076 3.43345 1.17596C2.97835 1.48885 2.86306 2.11143 3.17594 2.56653Z",fill:"currentColor"}),(0,r.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M10 10.75C10.6904 10.75 11.25 11.3096 11.25 12C11.25 12.6904 10.6904 13.25 10 13.25C9.30964 13.25 8.75 12.6904 8.75 12C8.75 11.3096 9.30964 10.75 10 10.75ZM12.75 12C12.75 10.4812 11.5188 9.25 10 9.25C8.48122 9.25 7.25 10.4812 7.25 12C7.25 13.5188 8.48122 14.75 10 14.75C11.5188 14.75 12.75 13.5188 12.75 12Z",fill:"currentColor"})]})},18992:function(e,t,n){"use strict";var r=n(85893);t.Z=e=>(0,r.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",...e,children:[(0,r.jsx)("rect",{x:"2",y:"3",width:"3",height:"2",rx:"1",fill:"currentColor"}),(0,r.jsx)("rect",{x:"2",y:"12",width:"12",height:"2",rx:"1",fill:"currentColor"}),(0,r.jsx)("rect",{x:"2",y:"9",width:"9",height:"2",rx:"1",fill:"currentColor"}),(0,r.jsx)("rect",{x:"2",y:"6",width:"6",height:"2",rx:"1",fill:"currentColor"})]})},34372:function(e,t,n){"use strict";n.d(t,{Kr:function(){return SparklesTwo},P$:function(){return Sparkles},fI:function(){return SparklesTwoAlt}});var r=n(85893);let SparklesTwo=e=>(0,r.jsxs)("svg",{width:"90",height:"88",viewBox:"0 0 90 88",fill:"currentColor",...e,children:[(0,r.jsx)("path",{d:"M38.4229 37.4613C27.2517 37.4613 19.2115 45.538 19.2115 56.7596C19.2115 45.538 11.1712 37.4613 0 37.4613C11.1712 37.4613 19.2115 29.3847 19.2115 18.1631C19.2115 29.3847 27.2517 37.4613 38.4229 37.4613Z"}),(0,r.jsx)("path",{d:"M54.7641 63.8318C48.0401 63.8318 43.2034 68.6904 43.2034 75.4448C43.2034 68.6904 38.3666 63.8318 31.6426 63.8318C38.3666 63.8318 43.2034 58.9731 43.2034 52.2188C43.2034 58.9731 48.0401 63.8318 54.7641 63.8318Z"})]}),SparklesTwoAlt=e=>(0,r.jsxs)("svg",{width:"68",height:"74",viewBox:"0 0 68 74",fill:"currentColor",...e,children:[(0,r.jsx)("path",{d:"M25.6735 60.8377C18.2079 60.8377 12.8377 66.2079 12.8377 73.6735C12.8377 66.2079 7.46553 60.8377 0 60.8377C7.46553 60.8377 12.8377 55.4655 12.8377 48C12.8377 55.4655 18.2079 60.8377 25.6735 60.8377Z"}),(0,r.jsx)("path",{d:"M67.8163 27.4103C51.8764 27.4103 40.4103 38.8764 40.4103 54.8163C40.4103 38.8764 28.9399 27.4103 13 27.4103C28.9399 27.4103 40.4103 15.9399 40.4103 0C40.4103 15.9399 51.8764 27.4103 67.8163 27.4103Z"})]}),Sparkles=e=>(0,r.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",...e,children:[(0,r.jsx)("path",{d:"M6 2L7.59099 5.40901L11 7L7.59099 8.59099L6 12L4.40901 8.59099L1 7L4.40901 5.40901L6 2Z",fill:"currentColor"}),(0,r.jsx)("path",{d:"M12.5 2L13.2955 3.7045L15 4.5L13.2955 5.2955L12.5 7L11.7045 5.2955L10 4.5L11.7045 3.7045L12.5 2Z",fill:"currentColor"}),(0,r.jsx)("path",{d:"M11.5 8L12.6137 10.3863L15 11.5L12.6137 12.6137L11.5 15L10.3863 12.6137L8 11.5L10.3863 10.3863L11.5 8Z",fill:"currentColor"})]})},47213:function(e,t,n){"use strict";var r=n(85893);t.Z=e=>(0,r.jsxs)("svg",{viewBox:"0 0 16 16",width:"16",height:"16",fill:"currentColor",...e,children:[(0,r.jsx)("circle",{r:"1.5",cx:"8",cy:"2.5"}),(0,r.jsx)("circle",{r:"1.5",cx:"8",cy:"7.5"}),(0,r.jsx)("circle",{r:"1.5",cx:"8",cy:"12.5"})]})},47489:function(e,t,n){"use strict";var r=n(85893);t.Z=e=>(0,r.jsx)("svg",{viewBox:"0 0 16 16",width:"16",height:"16",fill:"none",strokeWidth:"1.5",strokeLinecap:"round",stroke:"currentColor",...e,children:(0,r.jsx)("path",{d:"M6.983 2.57l-5.021 8.25a1.19 1.19 0 0 0 1.017 1.785h10.013a1.19 1.19 0 0 0 1.017-1.784L9.017 2.57a1.19 1.19 0 0 0-2.034 0zM8 5.45V8M8 10v.1"})})},74364:function(e,t,n){"use strict";n.d(t,{Y4:function(){return u},jI:function(){return m},r9:function(){return f},uf:function(){return h},vz:function(){return c},wt:function(){return p}});var r=n(85893),i=n(5379),o=n.n(i),l=n(27522),s=n(94184),a=n.n(s),d=n(67294);let c=(0,d.forwardRef)(function(e,t){let{className:n,...i}=e;return(0,r.jsx)(l.vz,{...i,className:a()("f6 fw5 dark-gray br2 lh-copy truncate",n),ref:t})}),u=(0,d.forwardRef)(function(e,t){let{className:n,...i}=e;return(0,r.jsx)(l.Y4,{...i,className:a()("pointer mh2 mv1 w-100 dib outline-0",n),ref:t,onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),e.currentTarget.dispatchEvent(new Event("mousedown",{bubbles:!0})))}})}),p=(0,d.forwardRef)(function(e,t){let{className:n,...i}=e;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(l.wt,{...i,ref:t,className:a()("pointer hover-bg-near-white f6 fw5 dark-gray lh-copy mb1",n)}),(0,r.jsx)(o(),{id:"5b1276abdde02cf",children:"[data-reach-listbox-option][data-current-nav]{background-color:var(--near-white)}"})]})}),h=(0,d.forwardRef)(function(e,t){let{className:n,...i}=e;return(0,r.jsx)(l.uf,{...i,ref:t,className:a()("list outline-0 ph1 pv2 ma1",n)})}),m=(0,d.forwardRef)(function(e,t){let{className:n,...i}=e;return(0,r.jsx)(l.jI,{...i,ref:t,className:a()("bg-white ba b--silver br2 shadow-4 overflow-auto",n)})}),f=(0,d.forwardRef)(function(e,t){let{className:n,...i}=e;return(0,r.jsx)(l.r9,{className:n,...i,ref:t})})},10245:function(e,t,n){"use strict";n.d(t,{z:function(){return maybeFormatAndCommit},p:function(){return nodeEditorKeymap}});var r=n(34790),i=n(45383),o=n(14456),l=n(68092),s=n(31432),a=n(13961),d=n(23939),c=n(51265),u=n(85623);function selectionAtStart(e){return 1===e.selection.ranges.length&&e.selection.ranges[0].empty&&0===e.selection.ranges[0].from}function selectionAtEnd(e){return 1===e.selection.ranges.length&&e.selection.ranges[0].empty&&e.selection.ranges[0].to===e.doc.length}var p=n(25993),h=n(56564),m=n(39273),f=n(67642),g=n(44911),v=n(14997);function action(e){return t=>{if(t.state.readOnly)return!1;let n=t.state.field(l.l);return!!n&&(n({type:e,id:t.state.field(d.X)}),!0)}}function escapeKey(e,t){if((0,p.t2)(e,"Escape")||(0,i.g3)(e)||m.R.loaded&&m.R.getCM(e)&&"Escape"===t)return!0;let n=e.state.field(l.l);return!!n&&(n({type:"selectionBlur"}),!0)}function nodeEditorKeymap(){return o.$f.of([{key:"Shift-Enter",run:maybeFormatAndCommit("keypress","nodeEditor")},{key:"Mod-s",run:maybeFormatAndCommit("keypress","nodeEditor")},{key:"Shift-Alt-f",run:e=>((0,r.Rn)(e),(0,v.Y)(e,!1),!0)},{key:"Mod-j",run(e){let t;let n=e.state.field(l.l);if(!n)return!1;let r=e.plugin(u.YV);if(!r)return!1;let i=e.state.selection.main;return r.decorations.between(i.from,i.to+1,(n,r)=>(t=e.state.doc.slice(n,r).toString(),!1)),!!t&&(n({type:"focusDefinition",name:t,id:e.state.field(d.X),trigger:"keypress",source:"Mod-j"}),!0)}},{key:"Shift-Mod-j",run(e){let t=e.state.field(l.l);return!!t&&(t({type:"focusUndo"}),!0)}},{key:"Backspace",run:e=>((0,s.Z)(e.state)&&e.dispatch({effects:[c.vT]}),!1)},{key:"Mod-Enter",run(e){if(e.state.readOnly)return!1;let t=e.state.field(l.l);if(!t)return!1;let{defaultCellMode:n}=e.state.field(h.i);return t(n?{type:"insertAfter",id:e.state.field(d.X),node:{mode:n},trigger:"keypress",source:"nodeEditor"}:{type:"openInsertMenu",id:e.state.field(d.X),before:!1,trigger:"keypress",source:"nodeEditor"}),!0}},{key:"Shift-Mod-Enter",run(e){if(e.state.readOnly)return!1;let t=e.state.field(l.l);if(!t)return!1;let{defaultCellMode:n}=e.state.field(h.i);return t(n?{type:"insertBefore",id:e.state.field(d.X),node:{mode:n},trigger:"keypress",source:"nodeEditor"}:{type:"openInsertMenu",id:e.state.field(d.X),before:!0,trigger:"keypress",source:"nodeEditor"}),!0}},{key:"Shift-Alt-Mod-Enter",run(e){if(e.state.readOnly)return!1;let t=e.state.field(l.l);if(!t)return!1;let{defaultCellMode:n}=e.state.field(h.i);return t(n?{type:"openInsertMenu",id:e.state.field(d.X),before:!0,trigger:"keypress",source:"nodeEditor"}:{type:"insertBefore",id:e.state.field(d.X),trigger:"keypress",source:"nodeEditor"}),!0}},{key:"Alt-Mod-Enter",run(e){if(e.state.readOnly)return!1;let t=e.state.field(l.l);if(!t)return!1;let{defaultCellMode:n}=e.state.field(h.i);return t(n?{type:"openInsertMenu",id:e.state.field(d.X),before:!1,trigger:"keypress",source:"nodeEditor"}:{type:"insertAfter",id:e.state.field(d.X),trigger:"keypress",source:"nodeEditor"}),!0}},{key:"Shift-Alt-Enter",run(e){if(e.state.readOnly)return!1;let t=e.state.field(l.l);return!!t&&(t({type:"splitBefore",id:e.state.field(d.X),trigger:"keypress"}),!0)}},{key:"Alt-Enter",run(e){if(e.state.readOnly)return!1;let t=e.state.field(l.l);return!!t&&(t({type:"splitAfter",id:e.state.field(d.X),trigger:"keypress"}),!0)}},{key:"Alt-Backspace",run(e){if(e.state.readOnly)return!1;let t=e.state.field(l.l);return!!(t&&selectionAtStart(e.state))&&(t({type:"mergeBefore",id:e.state.field(d.X)}),!0)}},{key:"Ctrl-Alt-d",run(e){if(e.state.readOnly)return!1;let t=e.state.field(l.l);return!!(t&&selectionAtEnd(e.state))&&(t({type:"mergeAfter",id:e.state.field(d.X)}),!0)}},{key:"Mod-.",run:action("togglePin")},{key:"Mod-,",run:action("toggleDisplay")},{key:"Ctrl-Shift-p",run:action("togglePin")},{key:"Ctrl-Shift-ArrowDown",run:action("moveDown")},{key:"Ctrl-Shift-ArrowUp",run:action("moveUp")},{mac:"Cmd-Alt-ArrowDown",run:action("moveDown")},{mac:"Cmd-Alt-ArrowUp",run:action("moveUp")},{key:"Mod-Shift-Alt-ArrowDown",run(e){if(e.state.readOnly)return!1;let t=e.state.field(l.l);return!!t&&(t({type:"duplicate",id:e.state.field(d.X),before:!1}),!0)}},{key:"Mod-Shift-Alt-ArrowUp",run(e){if(e.state.readOnly)return!1;let t=e.state.field(l.l);return!!t&&(t({type:"duplicate",id:e.state.field(d.X),before:!0}),!0)}},{key:"Shift-Mod-u",run(e){if(e.state.readOnly)return!1;let t=e.state.field(l.l);if(!t)return!1;let{fileUploadsOn:n,loginToUpload:r}=e.state.field(h.i);if(!n)return r&&t({type:"showModal",modal:"login",modalProps:{loginReason:"files"},trigger:"keypress",source:"fileUploadKeyboardShortcut"}),!0;let i={nodeId:e.state.field(d.X),nodeMode:e.state.field(a.C),trigger:"keypress"};return t({type:"notebookFilePickerOpened",source:"nodeEditor",...i}),(0,f.Z)().then(e=>{t({type:"attachLocalFiles",files:e,source:"nodeEditor",...i})}),!0}},{key:"Mod-Escape",run:e=>escapeKey(e,"Mod-Escape")},{key:"Escape",run:e=>escapeKey(e,"Escape")},{key:"Shift-Alt-ArrowDown",mac:"Alt-Tab",run(e){let t=e.state.field(l.l);return!!t&&(t({type:"focusAfter",id:e.state.field(d.X)}),!0)}},{key:"Shift-Alt-ArrowUp",mac:"Shift-Alt-Tab",run(e){let t=e.state.field(l.l);return!!t&&(t({type:"focusBefore",id:e.state.field(d.X)}),!0)}},{key:"Mod-ArrowDown",run(e){let t=e.state.field(l.l);return!!(t&&selectionAtEnd(e.state))&&(t({type:"focusAfter",id:e.state.field(d.X),selectStart:!0}),!0)}},{key:"Mod-ArrowUp",run(e){let t=e.state.field(l.l);return!!(t&&selectionAtStart(e.state))&&(t({type:"focusBefore",id:e.state.field(d.X),selectEnd:!0}),!0)}},{key:"ArrowDown",run:e=>!e.state.readOnly&&(0,s.Z)(e.state)&&g.qz[e.state.field(a.C)].convertible&&setMode(e,(e,t)=>Math.min(e+1,t-1))},{key:"ArrowUp",run:e=>!e.state.readOnly&&(0,s.Z)(e.state)&&g.qz[e.state.field(a.C)].convertible&&setMode(e,e=>Math.max(e-1,0))}])}function maybeFormatAndCommit(e,t){return n=>((0,r.Rn)(n),(0,r._B)(n),(0,p.t2)(n),n.state.field(h.i).prettierOn)?((0,v.Y)(n).then(()=>commit(n,e,t)),!0):commit(n,e,t)}function commit(e,t,n){let r=e.state.field(l.l);return!!r&&(r({type:"commit",id:e.state.field(d.X),trigger:t,source:n}),!0)}function setMode(e,t){let n=Object.entries(g.qz).filter(e=>{let[,{convertible:t}]=e;return t}).map(e=>{let[t]=e;return t}),r=e.state.field(a.C),i=n.findIndex(e=>e===r),o=n[t(i,n.length)],s=e.state.field(l.l);return!!s&&(s({type:"setMode",id:e.state.field(d.X),source:"cellMenu",trigger:"keypress",mode:o}),!0)}},74232:function(e,t,n){"use strict";n.d(t,{i:function(){return ModeMenuItems}});var r=n(85893),i=n(5379),o=n.n(i),l=n(94184),s=n.n(l),a=n(17),d=n(88903),c=n(20736),u=n(44911),p=n(60147);let ModeMenuItems=e=>{let{dispatch:t,mode:n,id:i,disabled:o}=e,l={...u.qz,md:{...u.qz.md,label:"Text"}};return(0,r.jsx)(r.Fragment,{children:Object.entries(l).filter(e=>{let[,{convertible:t}]=e;return t}).map(e=>{let[l,{label:s,icon:c}]=e,u=n===l;return(0,r.jsxs)(d.sN,{disabled:o,"aria-label":"editor-menu-".concat(s),className:u?"blue":"dark-gray hover-black",onSelect:()=>{t({type:"setMode",id:i,source:"gutterMenu",trigger:"click",mode:l})},children:[(0,r.jsx)("span",{className:"w1 h1 mr1",children:(0,r.jsx)(c,{})}),s,u&&(0,r.jsx)(a.Z,{className:"ml1"})]},l)})})};t.Z=(0,p.$j)(()=>({}),e=>({dispatch:e}))(e=>{let{dispatch:t,node:n,mode:i,focused:l,selected:a,hovered:p,className:h="",readOnly:m,children:f,allowsLayout:g=!1,...v}=e,{id:y}=n,{convertible:x}=u.qz[i],b="".concat(u.qz[i].label).concat(x?"\nClick to set language":""),{className:w,styles:C}={styles:(0,r.jsx)(o(),{id:"b5651deb920f0506",dynamic:[c.pp],children:"@media ".concat(c.pp,"{*.__jsx-style-dynamic-selector{-webkit-border-bottom-left-radius:var(--border-radius-2);-moz-border-radius-bottomleft:var(--border-radius-2);border-bottom-left-radius:var(--border-radius-2)}}")}),className:o().dynamic([["b5651deb920f0506",[c.pp]]])};return(0,r.jsx)(d.v2,{children:e=>{let{isExpanded:n}=e;return(0,r.jsxs)(r.Fragment,{children:[g?(0,r.jsxs)(d.j2,{title:b,className:s()(l||a&&p?"observable-focus-dark-blue":a?"washed-blue":n?"dark-gray":"mid-gray",x?l||a?"pointer hover-blue":p?"pointer hover-mid-gray":"pointer":"","bg-transparent",w,h,"bn pa0"),disabled:!x,...v,children:[f,C]}):(0,r.jsxs)(d.j2,{title:b,className:s()(l||a&&p?"observable-focus-dark-blue":a?"washed-blue":n?"dark-gray":p?"dark-gray":"moon-gray",x?l||a?"pointer hover-blue":p?"pointer hover-mid-gray":"pointer":"",l||a&&p?"bg-observable-focus-light-blue":p?"bg-light-silver":"bg-transparent",w,h,"bn pa0"),disabled:!x,...v,children:[f,C]}),(0,r.jsx)(d.qy,{position:d.Ly.right,children:(0,r.jsx)(ModeMenuItems,{dispatch:t,id:y,mode:i,disabled:m})})]})}})})},35329:function(e,t,n){"use strict";n.d(t,{Z:function(){return NodeEditors},f:function(){return runWhenSafe}});var r=n(14456),i=n(68092),o=n(41888),l=n(96265),s=n(23939),a=n(25227),d=n(25993),c=n(83687),u=n(56770),p=n(29020);let h=new Set,m=[];function runWhenSafe(e,t){h.has(e)?m.push(t):t()}let NodeEditors=class NodeEditors{setState(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(this._isSettingState)throw this._isSettingState=!1,Error("Reentrant editor setState call");try{for(let[,e]of(this._isSettingState=!0,this._views))h.add(e);for(let[e,n]of function(e){let t=new Map;for(let n of e){let e=n.state.field(l.A);t.has(e)?t.get(e).push(n):t.set(e,[n])}return t}(t)){let t=this._views.get(e);t&&t.update(n)}for(let[,t]of(this._states=e.editorStates,this._views)){let e=t.state.field(s.X,!1);void 0!==e&&this._states.has(e)||this._disable(t)}if(this._focusId!==e.focusId){if(this._focusId=e.focusId,null!==this._focusId){let e=findViewById(this._states,this._views,this._focusId);e&&e.focus()}else if(document.activeElement instanceof HTMLElement){var n;document.activeElement.blur(),null===(n=window.getSelection())||void 0===n||n.removeAllRanges()}}else if(null!==this._focusId){for(let e of t)if(e.scrollIntoView&&e.state.field(s.X)===this._focusId){let t=this._views.get(e.state.field(l.A));t&&!t.hasFocus&&t.focus()}}if(this._selectedSearchResult!==e.selectedSearchResult){if(e.selectedSearchResult){let t=findViewById(this._states,this._views,e.selectedSearchResult.nodeId);if(t){let{nodeId:n,nodeResultIndex:r}=e.selectedSearchResult,{node:i}=t.domAtPos(e.searchResults.get(n)[r].pos);i instanceof HTMLElement&&(0,u.zT)(i),this._selectedSearchResult=e.selectedSearchResult}}else this._selectedSearchResult=void 0}let r=(0,p.cE)(e)?e.owner:null;if(this._privateOwner!==r){this._privateOwner=r;let e={effects:a.N.of(r)};for(let t of this._views.values())t.dispatch(e)}this._spotlight(e)}finally{for(let[,e]of(this._isSettingState=!1,this._views))h.delete(e);let e=m;for(let t of(m=[],e))t()}}attach(e,t,n){if(this._views.has(e))throw Error("Duplicate EditorView");let a=function(e,t){let n=f.get(e);if(!n){for(let[,t]of(n=new Map,e))n.set(t.field(l.A),t);f.set(e,n)}return n.get(t)}(this._states,e),p=new r.tk({state:a});if(p.viewState.printing=!0,t.insertBefore(p.dom,t.firstChild),this._views.set(e,p),a){var h;let e=a.field(s.X),t=e===this._focusId,r=e===(null===(h=this._spotlightPos)||void 0===h?void 0:h.node);if(p.dispatch({effects:[i.a.of(this.dispatch),c.P.of(this.tsClient),d.dF.of(n),o.d.of(this.documentType)],scrollIntoView:t}),t&&p.focus(),r){let{node:e}=p.domAtPos(this._spotlightPos.pos);e instanceof HTMLElement&&(0,u.zT)(e)}}}detach(e){var t;let n=this._views.get(e),r=null==n?void 0:n.state.field(s.X,!1);if(r&&(null===(t=this.tsClient)||void 0===t||t.deleteFile(r)),!n)throw Error("EditorView not found");this._disable(n),n.destroy(),this._views.delete(e)}_disable(e){e.dispatch({effects:[i.a.of(null)]})}refocus(){if(null===this._focusId)return!1;let e=findViewById(this._states,this._views,this._focusId);return!!e&&(e.hasFocus||e.focus(),e.inView||e.dispatch({scrollIntoView:!0}),!0)}scrollIntoView(e){let t=findViewById(this._states,this._views,e);return!!t&&(t.dispatch({scrollIntoView:!0}),!0)}repositionTooltips(e){let t=findViewById(this._states,this._views,e);t&&(0,r.E2)(t)}_spotlight(e){if(!e.spotlightParticipant){this._spotlightPos&&(this._spotlightPos=null);return}let t=e.participants.find(t=>t.id===e.spotlightParticipant);for(let e=0;e<t.node_ids.length;e++)if(null!==t.node_ids[e]){let n=t.node_ids[e],r=t.selections[e]?t.selections[e].ranges[t.selections[e].main].head:0;if(!this._spotlightPos||this._spotlightPos.node!==n||this._spotlightPos.pos!==r){this._spotlightPos={node:n,pos:r};let e=findViewById(this._states,this._views,n);if(e){let{node:t}=e.domAtPos(this._spotlightPos.pos);t instanceof HTMLElement&&(0,u.zT)(t)}}}}applyCommand(e,t){let n=this._views.get(e);if(!n)throw Error("EditorView not found");return!n.state.readOnly&&t(n)}constructor(e,t,n){this.dispatch=e,this.tsClient=t,this.documentType=n,this._views=new Map,this._states=new Map,this._focusId=null,this._privateOwner=null,this._isSettingState=!1,this._spotlightPos=null}};function findViewById(e,t,n){let r=e.get(n);return r&&t.get(r.field(l.A))}let f=new WeakMap},83749:function(e,t,n){"use strict";n.d(t,{Z:function(){return nodeInserter}});var r=n(85893),i=n(5379),o=n.n(i),l=n(94184),s=n.n(l),a=n(67294),d=n(34864),c=n(26713),u=n(69649),p=n(28857),h=n(86381),m=n(34372),f=n(96765),g=n(20736),v=n(88182),y=n(44911),x=n(32980),b=n(60147);let w=[{label:"JavaScript",mode:"js",description:{long:"Code in the language of the web (".concat((0,v.Z)("Mod-Alt-Enter"),")"),short:"Code in the language of the web"}},{label:"Text",mode:"md",description:{long:"Text formatted using Markdown"}},{label:"SQL",mode:"sql",keywords:["query"],description:{long:"Write and refine queries in SQL"},fullWidth:!0},{label:"Data",mode:"table",description:{long:"See and clean data without code"},fullWidth:!0},{label:"Chart",mode:"chart",description:{long:"Charting without code"}}],C=w.filter(e=>{let{hidden:t}=e;return!0!==t}).map(e=>{let{label:t,mode:n,keywords:r,description:{long:i},fullWidth:o}=e;return"ai"===n?{label:t,category:"Basic Cells",description:i,keywords:r,icon:m.P$,type:"large",fullWidth:o,action:e=>{e({type:"togglePane",pane:"aiassist"})}}:{label:t,category:"Basic Cells",description:i,keywords:r,icon:y.qz[n].icon,type:"large",fullWidth:o,action:(e,t)=>{let{nextId:r,trigger:i,combine:o,display:l}=t;return e({type:"insertBefore",id:r,node:{mode:n,combine:o,display:l},trigger:i,source:"nodeInserterMenu"})}}}),j={title:"Basic Cells",items:w.map(e=>{let{label:t,mode:n,keywords:r,description:{long:i,short:o},fullWidth:l}=e;return{label:t,category:"Basic Cells",description:o||i,keywords:r,type:"large",fullWidth:l,action:(e,t)=>{let{nextId:r,trigger:i,combine:o,display:l}=t;"ai"!==n&&e({type:"insertBefore",id:r,node:{mode:n,combine:o,display:l},trigger:i,source:"nodeInserterMenu"})}}})},NodeInserterBarItem=e=>{let{className:t="",item:n,onClick:i,showLabel:o}=e,{description:l,icon:a,label:c}=n;return(0,r.jsxs)(d.O2,{className:s()(d.zk,"flex items-center h-100 fw4 bg-white bn pointer theme-faint-blue",t),style:{padding:o?"12px":"8px"},onClick:e=>i(e,c),title:l,suppressHydrationWarning:!0,value:c,children:[a?(0,r.jsx)(a,{style:{paddingRight:"2px"}}):null,o&&(0,r.jsx)("span",{className:"ml1",children:c})]})},NodeInserterBar=e=>{let{className:t="",items:n=[],onClick:i,showBarLabels:o=!0,standalone:l=!1}=e,a=(0,g.GS)(g.ro),c=(0,b.v9)(e=>{let{notebook:t}=e;return t}),u=[...C,...n].filter(e=>e.label!==f.u7||(0,x.F3)(c)&&l&&!a);return(0,r.jsx)(d.Gk,{className:s()("inline-flex items-center mid-gray bg-white",l&&"ba b--light-gray br2",t),style:{height:32},children:u.map((e,t)=>(0,r.jsx)(NodeInserterBarItem,{className:s()({"br2 br--left":l&&0===t,"br2 br--right":l&&t===u.length-1,"hover-bg-faint-blue":l}),item:e,onClick:i,showLabel:o},t))})};var S=n(51169),k=n(53693),E=n(8266),_=n(53903),N=n(91804),L=n(7595),I=n(82730),T=n(99368),D=n(40591),M=n(36869),P=n(90271),R=n(50809),A=n(41312),O=n(18818),F=n(29020),B=n(43697);let NodeInsertOptionPreview=()=>null,NodeInsertOption=e=>{let{item:t,onClick:n,onHover:i,labelMatcher:o,descriptionMatcher:l,isSuggestion:a,fuzzyMatch:c=!1}=e,{label:p,type:m,newUntil:f,icon:g}=t;return(0,r.jsx)(d.O2,{value:p,className:s()(d.zk,"ph3 flex items-center",a&&"gold"),style:{height:"32px"},onClick:e=>n(e,p),onMouseEnter:e=>null==i?void 0:i(e,p),"data-label":p,children:"small"===m?(0,r.jsx)("div",{className:"flex justify-between items-center h2 br2",children:(0,r.jsx)("div",{className:"truncate flex",children:(0,r.jsxs)("div",{className:"flex items-center",children:[a?(0,r.jsx)(E.v,{className:"mr1"}):null,o&&c?(0,r.jsx)(u.q,{highlightClass:"b",text:p,matcher:o}):p]})})}):(0,r.jsxs)("div",{className:"flex items-center w-100 pv1 br2",children:[g&&(0,r.jsx)(g,{className:"thumbnail moon-gray br2 flex-shrink-0 mr2",style:{width:32,height:24}}),(0,r.jsxs)("div",{className:"fw4 flex",style:{minWidth:"160px"},children:[(0,r.jsx)("div",{children:o&&c?(0,r.jsx)(u.q,{highlightClass:"b",text:p,matcher:o}):p}),f&&f>new Date&&(0,r.jsx)(h.g,{newUntil:f})]}),!g&&(0,r.jsx)("div",{style:{width:32},className:"mr2"}),(0,r.jsx)("div",{className:"mid-gray",children:!!t.description&&(l&&c?(0,r.jsx)(u.q,{highlightClass:"b",text:t.description,matcher:l}):t.description)})]})})};var nodeInserter=e=>{let{previousId:t,nextId:n,focusId:i,hoverId:l,selectionFocusId:h,insertingId:m,betweenRows:f=!1,positionInRow:w=null,nextRowNodeId:E=null,prevRowNodeId:$=null,inHiddenSection:V=!1,alwaysShowBar:Z=!1,dispatch:H,showMenu:U=!1,setMenuHasBeenDismissed:q}=e,Y=null!==i&&(i===t||i===n),z=null!==l&&(l===t||l===n),W=null!==t&&null!==n,[G,K]=(0,a.useState)(!1),{allowFileAttachments:J,allowPrivateData:X,allowAIAssist:Q,allowSchedules:ee,canEdit:et,defaultCellMode:en,hasUserSettingDefaultOpenAddCellMenu:er,inVersionView:ei,allowsLayout:eo,user:el,focusNode:es}=(0,b.v9)(e=>{let{currentUser:t,notebook:n}=e;return{allowFileAttachments:(0,x.Yb)(t)&&(0,L.j5)(t,n),allowPrivateData:(0,F.cE)(n),allowAIAssist:(0,x.F3)(n),allowSchedules:(0,x.eD)(t,n),user:t,canEdit:(0,x.mG)(n),defaultCellMode:(0,F.Sx)(t),hasUserSettingDefaultOpenAddCellMenu:(0,F.VO)(t),hasSingleNode:1===n.model.nodes.length,inVersionView:(0,F.mN)(n),allowsLayout:(0,F.XT)(n),focusNode:n.focusId?(0,D.DY)(n.model,n.focusId):null}}),ea=(0,N.O)(),{open:ed,openMenu:ec,closeMenu:eu,uiRef:ep}=ea,eh=(0,a.useRef)(null),em=(0,a.useRef)(null),ef=(0,a.useRef)(ed),eg=(0,a.useRef)(),[ev,ey]=(0,a.useState)(""),[ex,eb]=(0,a.useState)(!1),ew=(0,g.GS)(g.hs),eC=null===t,ej=null===n,eS=!eC&&t===i,ek=ej&&et&&!ei&&null===h&&null===i,eE=Z||!eo&&(ek||eS),e_=!!(w&&"empty"!==w),eN=eo&&f&&!Z,eL="first"===w?"next":e_?"previous":null,eI=V?{presentation:{hidden:!0}}:void 0,[eT,eD]=(0,a.useState)(""),[eM,eP]=(0,a.useState)(null),{previousNode:eR,previousMode:eA,previousName:eO,chartSpec:eF}=(0,b.v9)(e=>{var n;let{notebook:r}=e;if(null===t)return{};let i=(0,D.DY)(r.model,t);return i?{chartSpec:null===(n=r.workerStatus.get(t))||void 0===n?void 0:n.chartSpec,previousMode:i.mode,previousNode:i,previousName:(0,A.u2)(i)||"cell ".concat(t)}:{}}),eB=(0,a.useMemo)(()=>ev.length?(0,M.v)(ev,{allowAcronyms:!0}):null,[ev]),e$=(0,a.useMemo)(()=>ev.length?(0,M.v)(ev,{allowAcronyms:!1}):null,[ev]),eV=(0,a.useMemo)(()=>{let e={allowFileAttachments:J,allowPrivateData:X,allowSchedules:ee,suggestions:[],previousMode:eA},searchFilter=e=>{var t;return!eB||!e$||eB.test(e.label)||e$.test(null===(t=e.keywords)||void 0===t?void 0:t.join(" "))||e$.test(e.description)||e$.test(e.category)},allowedFilter=t=>!t.filter||t.filter(e),categoryFilter=e=>searchFilter(e)&&allowedFilter(e),t={...j,items:j.items.filter(searchFilter)};return[...ev?[t]:[],...R.bd].map(e=>{let{items:t,...n}=e;return{...n,items:t.filter(categoryFilter)}}).filter(e=>e.items.length>0)},[J,X,ee,eA,eB,e$,ev]),eZ=(0,a.useMemo)(()=>eV.flatMap(e=>{let{items:t}=e;return t}),[eV]),eH=eZ.find(e=>{let{label:t}=e;return t===eT}),eU=(0,_.a)(em);function selectFirst(e){let t=0,n=!1;requestAnimationFrame(function searchForHighlight(){if(!em.current)return;let r=em.current.querySelector("[data-highlighted]");if(r){if(n)return;n=!0}else!function(e){e.dispatchEvent(new KeyboardEvent("keydown",{key:"ArrowDown",bubbles:!0}))}(e);t++<5&&requestAnimationFrame(searchForHighlight)})}function onSelect(e){var r;let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"keypress";if(e===R.mD){H({type:"showModal",modal:"search",modalProps:{query:ev}});return}if(e===R.C9){if(!el||!Q)return;H({type:"showPane",pane:"aiassist"});let e=(0,O.Z)(8),t=!!es&&!(0,y.hN)(es);H({type:"chatCreateDraft",message:{complete:!1,id:e,node_id:i,sender:el,local:!0,status:"draft",content:(0,I.dk)(ev,{includeCode:t})}}),H({type:"chatSendDraft",id:e,cellIncluded:t,scope:"cell"}),eq();return}let l=[...eV.length?eZ:R.KH,...C],s=l.find(t=>t.label===e);if(!s)return;eq({trigger:o,selectedItem:e});let a=n,d=t;e_&&s.fullWidth&&(s.positionByPreviousRow?d=$:a=E),null===(r=s.action)||void 0===r||r.call(s,H,{nextId:a,previousId:d,trigger:o,filter:ev,previousNode:eR,chartSpec:eF,combine:s.fullWidth?null:eL,display:eI})}function onClick(e,t){e.preventDefault(),onSelect(t,"click")}function onHover(e,t){e.preventDefault(),eD(t)}let eq=(0,a.useCallback)(e=>{null==q||q(!0),e?H({type:"closeInsertMenu",filter:ev,...e}):eu()},[eu,H,ev,q]);(0,a.useEffect)(()=>{let e=m===n;if(void 0!==m&&ef.current!==e){if(ef.current=e,e){if("first"===w)i===m&&E!==n&&ec();else if("last"===w)i!==m&&ec();else if(f){var t,r;V&&(null==es?void 0:null===(r=es.display)||void 0===r?void 0:null===(t=r.presentation)||void 0===t?void 0:t.hidden)&&ec()}else ec()}else ey(""),eq()}},[ec,eq,m,i,es,n,E,w,f,V]),(0,a.useEffect)(()=>{ef.current===ed||(ef.current=ed,ed||(ey(""),eq({trigger:"Implicit"})))},[eq,ed]),(0,a.useEffect)(()=>{ej&&U&&!eo&&er&&H({type:"openInsertMenu",id:n,before:!0,trigger:"click",source:"nodeInserter"})},[]),(0,a.useEffect)(()=>{if(!W)return;let key=e=>K(e.shiftKey),blur=()=>K(!1);return addEventListener("keydown",key),addEventListener("keyup",key),addEventListener("blur",blur),()=>{removeEventListener("keydown",key),removeEventListener("keyup",key),removeEventListener("blur",blur)}},[W]);let eY=(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex items-center relative mh3 mt3 mb2",children:[(0,r.jsx)(d.wl,{ref:eh,placeholder:"Search for data, templates, cells, …",autocomplete:!1,spellCheck:!1,onChange:function(e){ey(e.target.value),selectFirst(e.target)},onKeyDown:e=>{if(ev||("ArrowRight"===e.key&&(e.key="ArrowDown"),"ArrowLeft"!==e.key||(e.key="ArrowUp")),"Enter"===e.key&&"pointer"===eM){var t;let n=null===(t=em.current)||void 0===t?void 0:t.querySelector(".last-interaction-pointer [data-reach-combobox-option]:hover"),r=null==n?void 0:n.getAttribute("data-label");if(r){e.preventDefault(),onSelect(r);return}}eU(e)},onPaste:function(e){e.preventDefault();let n=e.clipboardData.getData("text");H({type:"insertSnippet",apply:(0,R.$T)(ev+n),label:"Insert",mode:"js",afterId:t,combine:eL,display:eI})},onFocus:function(e){selectFirst(e.target)},className:"w-100 border-box",type:"search",value:ev,autoFocus:!0}),ev&&(0,r.jsx)(c.hU,{icon:p.Z,onClick:()=>ey(""),style:{position:"absolute",width:28,height:28,right:2},colorless:!0})]}),(0,r.jsx)(B.u,{ref:null,position:k.Kp,label:(0,r.jsx)(NodeInsertOptionPreview,{item:eH}),children:(0,r.jsxs)(d.Gk,{ref:em,className:"relative last-interaction-".concat(eM),style:{maxHeight:"26rem",overflowY:"scroll"},children:[!ev&&(0,r.jsxs)("li",{className:"mh3",children:[(0,r.jsx)("div",{className:"flex items-center gray f7 pv2 ttu",children:"Basic Cells"}),(0,r.jsx)(NodeInserterBar,{onClick:onClick})]}),eV.length?eV.map((e,t)=>{let{title:n,items:i,icon:o}=e;return(0,r.jsxs)("li",{className:"mt2",children:[n&&(0,r.jsxs)("div",{className:s()("flex items-center mid-gray f7 mh3 ttu",ev?t?"pv2":"pb2":"pv2"),children:[o&&(0,r.jsx)(o,{className:"mr1"}),"Suggestions"===n?(0,r.jsxs)(r.Fragment,{children:["Suggestions for",(0,r.jsx)("span",{className:"fw5 pl1",children:eO})]}):e$?(0,r.jsx)("span",{children:(0,r.jsx)(u.q,{text:n,matcher:e$,highlightClass:"b"})}):n]}),(0,r.jsx)(d.Gk,{children:i.map((e,t)=>(0,r.jsx)(NodeInsertOption,{item:e,labelMatcher:eB,descriptionMatcher:e$,onClick:onClick,onHover:onHover,isSuggestion:"Suggestions"===e.category,fuzzyMatch:!0},t))})]},t)}):(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:s()("flex items-center mid-gray f7 mh3 ttu pv2"),children:"Basic Cells"}),R.KH.map((e,t)=>(0,r.jsx)(NodeInsertOption,{item:e,labelMatcher:eB,descriptionMatcher:e$,isSuggestion:!1,onClick:onClick,onHover:onHover},t)),(0,r.jsx)("div",{className:s()("flex items-center mid-gray f7 mh3 ttu pv2"),children:"More"}),(0,r.jsx)(NodeInsertOption,{item:R.Zn,labelMatcher:eB,descriptionMatcher:e$,isSuggestion:!1,onHover:onHover,onClick:onClick}),(0,r.jsx)(NodeInsertOption,{item:R._t,labelMatcher:eB,descriptionMatcher:e$,isSuggestion:!1,onHover:onHover,onClick:onClick})]})]},ev)})]}),ez=e_||eN?0:P.KI+P.re/2+5,eW=P.KI,eG=P.KI;return(0,r.jsxs)("div",{className:s()("absolute dn-print",eN&&"absolute left-0 right-0 tc",e_&&"h-100","empty"===w&&"h-inherit"),style:{marginTop:e_||"empty"===w?0:eC||eo?-P.KI:void 0,marginLeft:"empty"===w?-P.KI+2:eN?-P.Mv:void 0,marginRight:eN?-P.Mv:void 0,left:"empty"===w?"":-ez,height:e_||"empty"===w?"":P.KI,width:eo||eE?void 0:"calc(100% + ".concat(ez,"px + 14px)")},onPointerMove:()=>eP("pointer"),onKeyDown:()=>eP("keyboard"),children:[(0,r.jsxs)("button",{"data-testid":"node-inserter-button",onBlur:()=>eb(!1),onClick:function(e){if(e.preventDefault(),window.matchMedia(g.ro).matches){if(eg.current){if(clearTimeout(eg.current),eg.current=void 0,ex)eb(!1),H({type:"insertBefore",id:n,node:{mode:en,combine:eL,display:eI},trigger:"click",source:"nodeInserter"});else{var r;eb(!0),null===(r=ea.triggerRef.current)||void 0===r||r.focus()}}return}W&&e.shiftKey?H({type:"merge",beforeId:t,afterId:n}):ed?eq({trigger:"click"}):e_||"empty"===w||f?ec():H({type:"openInsertMenu",id:n,before:!0,trigger:"click",source:"nodeInserter"})},onDoubleClick:function(e){e.shiftKey||(e.preventDefault(),eq({trigger:"click"}),H({type:"insertBefore",id:n,node:{mode:en,combine:eL,display:eI},trigger:"click",source:"nodeInserter"}))},onMouseDown:T.PF,onPointerCancel:function(){eg.current&&(clearTimeout(eg.current),eg.current=void 0)},onPointerDown:function(){!ef.current&&window.matchMedia(g.ro).matches&&(eg.current=setTimeout(()=>{H({type:"openInsertMenu",id:n,before:!0,trigger:"click",source:"nodeInserter"}),eg.current=void 0},500))},ref:ea.triggerRef,style:{width:e_||"empty"===w?P.KI:""},className:o().dynamic([["e54dcc7482e42f92",[ew?"left: -".concat(eW/2,"px;"):"",eE?eS?"top: -33px;":"margin-top: 3px;":"top: -8.5px;",V?"white":"var(--theme-backgroundColor)"]]])+" "+(s()("bg-transparent bn pa0","node_bar pea","absolute flex items-center pointer",eN&&"justify-center",(e_||"empty"===w)&&"h-100 justify-center",ed||eE?eo?"node-bar-open-dashboard":"node_bar_open":"node_bar_closed_hover",!ed&&!eE&&"w-100",eN&&"w-100")||""),children:[eo&&!ed&&!eE&&(eN?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{style:{height:2},className:o().dynamic([["e54dcc7482e42f92",[ew?"left: -".concat(eW/2,"px;"):"",eE?eS?"top: -33px;":"margin-top: 3px;":"top: -8.5px;",V?"white":"var(--theme-backgroundColor)"]]])+" between-cells-indicator absolute w-100"}),(0,r.jsx)("div",{style:{height:12,width:17},className:o().dynamic([["e54dcc7482e42f92",[ew?"left: -".concat(eW/2,"px;"):"",eE?eS?"top: -33px;":"margin-top: 3px;":"top: -8.5px;",V?"white":"var(--theme-backgroundColor)"]]])+" absolute node-indicator-bg"})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:o().dynamic([["e54dcc7482e42f92",[ew?"left: -".concat(eW/2,"px;"):"",eE?eS?"top: -33px;":"margin-top: 3px;":"top: -8.5px;",V?"white":"var(--theme-backgroundColor)"]]])+" inner-row-indicator absolute h-100 ba b--transparent"}),(0,r.jsx)("div",{style:{height:17,width:11},className:o().dynamic([["e54dcc7482e42f92",[ew?"left: -".concat(eW/2,"px;"):"",eE?eS?"top: -33px;":"margin-top: 3px;":"top: -8.5px;",V?"white":"var(--theme-backgroundColor)"]]])+" absolute node-indicator-bg"})]})),(0,r.jsx)("svg",{width:eW,height:eG,viewBox:"-".concat(eW/2," -").concat(eG/2," ").concat(eW," ").concat(eG),style:{overflow:"visible"},"aria-label":"Click to insert or merge cells",stroke:"currentColor",strokeWidth:"2",fill:"none",transform:e_?"rotate(90)":"",className:o().dynamic([["e54dcc7482e42f92",[ew?"left: -".concat(eW/2,"px;"):"",eE?eS?"top: -33px;":"margin-top: 3px;":"top: -8.5px;",V?"white":"var(--theme-backgroundColor)"]]])+" "+(s()("relative z-1",ed?s()("bg-lightest-blue white open_pv ba b--lightest-blue",ew&&"open_ph br2 br--left"):s()("br2",eE?s()("bg-white mid-gray open_pv",ew?"hover-bg-faint-blue open_ph ba b--light-gray":"hover-washed-blue bt bb b--white",eo&&"open_ph"):"hover-mid-gray"),(!ed&&!eE||eE&&!ew&&!ed&&!eo)&&(Y||z?"moon-gray":"transparent"),ed&&e_&&"dn")||""),children:G?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("title",{className:o().dynamic([["e54dcc7482e42f92",[ew?"left: -".concat(eW/2,"px;"):"",eE?eS?"top: -33px;":"margin-top: 3px;":"top: -8.5px;",V?"white":"var(--theme-backgroundColor)"]]]),children:"Merge cells"}),(0,r.jsx)("path",{d:"M-3,4L0,1.5L3,4M0,1.5V6.5",className:o().dynamic([["e54dcc7482e42f92",[ew?"left: -".concat(eW/2,"px;"):"",eE?eS?"top: -33px;":"margin-top: 3px;":"top: -8.5px;",V?"white":"var(--theme-backgroundColor)"]]])}),(0,r.jsx)("path",{d:"M-3,4L0,1.5L3,4M0,1.5V6.5",transform:"rotate(180)",className:o().dynamic([["e54dcc7482e42f92",[ew?"left: -".concat(eW/2,"px;"):"",eE?eS?"top: -33px;":"margin-top: 3px;":"top: -8.5px;",V?"white":"var(--theme-backgroundColor)"]]])})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("title",{suppressHydrationWarning:!0,className:o().dynamic([["e54dcc7482e42f92",[ew?"left: -".concat(eW/2,"px;"):"",eE?eS?"top: -33px;":"margin-top: 3px;":"top: -8.5px;",V?"white":"var(--theme-backgroundColor)"]]]),children:null!==i&&i===n?"Insert cell before (".concat((0,v.Z)("Shift-Mod-Enter"),")"):null!==i&&i===t?"Insert cell after (".concat((0,v.Z)("Mod-Enter"),")"):"Insert cell"}),(0,r.jsx)("path",{d:"M0,-5V5M-5,0H5",className:o().dynamic([["e54dcc7482e42f92",[ew?"left: -".concat(eW/2,"px;"):"",eE?eS?"top: -33px;":"margin-top: 3px;":"top: -8.5px;",V?"white":"var(--theme-backgroundColor)"]]])})]})}),!eo&&!eE&&(0,r.jsx)("div",{style:{height:2},className:o().dynamic([["e54dcc7482e42f92",[ew?"left: -".concat(eW/2,"px;"):"",eE?eS?"top: -33px;":"margin-top: 3px;":"top: -8.5px;",V?"white":"var(--theme-backgroundColor)"]]])+" between-cells-indicator w-100 ml2"}),(0,r.jsx)(o(),{id:"e54dcc7482e42f92",dynamic:[ew?"left: -".concat(eW/2,"px;"):"",eE?eS?"top: -33px;":"margin-top: 3px;":"top: -8.5px;",V?"white":"var(--theme-backgroundColor)"],children:"svg.__jsx-style-dynamic-selector{overflow:visible;will-change:transform}.open_ph.__jsx-style-dynamic-selector{padding-left:6.5px;padding-right:6.5px}.open_pv.__jsx-style-dynamic-selector{padding-top:6.5px;padding-bottom:6.5px}.node_bar_open.__jsx-style-dynamic-selector{".concat(ew?"left: -".concat(eW/2,"px;"):"","\n            ").concat(eE?eS?"top: -33px;":"margin-top: 3px;":"top: -8.5px;","\n          }.node-bar-open-dashboard.__jsx-style-dynamic-selector{margin-top:16px;left:18px}.node_bar.__jsx-style-dynamic-selector:hover>.between-cells-indicator.__jsx-style-dynamic-selector,.node_bar.__jsx-style-dynamic-selector:focus>.between-cells-indicator.__jsx-style-dynamic-selector{background-color:var(--washed-blue);-webkit-transition:background-color.15s ease-in-out;-moz-transition:background-color.15s ease-in-out;-o-transition:background-color.15s ease-in-out;transition:background-color.15s ease-in-out}.node_bar.__jsx-style-dynamic-selector:hover>.node-indicator-bg.__jsx-style-dynamic-selector{background-color:").concat(V?"white":"var(--theme-backgroundColor)","}.node_bar.__jsx-style-dynamic-selector:hover>.inner-row-indicator.__jsx-style-dynamic-selector{border:1px solid var(--washed-blue)}.node_bar_closed_hover.__jsx-style-dynamic-selector:hover>svg.__jsx-style-dynamic-selector,.node_bar_closed_hover.__jsx-style-dynamic-selector:focus>svg.__jsx-style-dynamic-selector{color:var(--washed-blue)}")})]}),ed&&(0,r.jsx)(S.J,{extraStyle:{right:"auto",left:"last"===w?-440:ew&&eN?-40:ew&&(e_||"empty"===w)?-23.5:ew?23.5:eW,top:eE?-78:e_?"calc(50% - 40px)":eN||"empty"===w?0:-89.5,width:"30rem",marginTop:"0.5rem",position:eN&&"relative",margin:eN&&"-1rem auto 0 50%"},ref:ep,children:(0,r.jsx)(d.hQ,{"aria-label":"Search for data, templates, and cells",role:"dialog",onSelect:onSelect,onBlur:function(e){e.currentTarget.contains(e.relatedTarget)||eq()},openOnFocus:!0,className:"mb2 pea",children:eY})}),eE&&!ed&&(0,r.jsx)(d.hQ,{className:"relative pea",role:"toolbar",onSelect:onSelect,style:{top:eS&&!eo?-33:void 0,left:eo?"calc(".concat(47,"px + var(--spacing-medium))"):ew?"calc(23.5px + var(--spacing-medium))":eW,marginTop:eo?16:ej&&!eS?3:void 0},children:(0,r.jsx)(NodeInserterBar,{onClick:onClick,showBarLabels:ew,standalone:!0})})]})}},1673:function(e,t,n){"use strict";n.d(t,{G:function(){return NodeWorkerMenu}});var r=n(85893),i=n(5379),o=n.n(i),l=n(80583),s=n(46350),a=n(94184),d=n.n(a),c=n(67294),u=n(15100),p=n(93718),h=n(94988),m=n(49724),f=n(33078),g=n(71261),v=n(26279),y=n(62420),x=n(31881),b=n(27554),w=n(28857),C=n(88903),j=n(74232),S=n(4640);let DownloadTypeTask=class DownloadTypeTask extends S.i{async process(e){let t=await e({type:"request_download_type",node_id:this._id});return{type:asValueType(t.type),typeAsView:asValueType(t.typeAsView)}}constructor(e){super(),this._id=e}};function asValueType(e){return e?"blob"===e.type?{type:"blob",mime:"".concat(e.mime)}:{type:"".concat(e.type)}:void 0}let DownloadTask=class DownloadTask extends S.i{async process(e){return await e({type:"request_download",node_id:this._id,as_view:this._asView,download_type:this._type,format:this._format})}constructor(e,t,n,r){super(),this._id=e,this._asView=t,this._type=n,this._format=r}};var k=n(63343),E=n(20736),_=n(87480),N=n(68404),L=n(44911),I=n(41312),T=n(32980),D=n(29020),M=n(60147);let NodeWorkerMenu=e=>{let t,{commentCount:n,editorOpen:i,editable:l,focused:a,readOnly:f,selected:b,hovered:S,commentable:P,node:R,rowId:A=0,allowsLayout:O=!1,className:F="",children:B,...$}=e,{id:V,pinned:Z,mode:H}=R,U=(0,I.u2)(R),q=(0,M.I0)(),Y=O?A:V,{hasOutput:z,isNodeUnsaved:W,isCommentingLocked:G,isCommentsOpen:K,isComposeOpen:J,canComment:X,notebookSpecifier:Q,deletable:ee,documentType:et}=(0,M.v9)(e=>{let{notebook:t}=e;return{hasOutput:(0,N.Gv)(t.heights.get(Y))>0,isNodeUnsaved:V>t.saveVersion,isCommentingLocked:(0,D.fC)(t),isCommentsOpen:t.openComments.has(R.id),isComposeOpen:t.composingComments.has(R.id),canComment:(0,T.RF)(t),notebookSpecifier:(0,D.J6)(t),deletable:t.model.nodes.length>1,documentType:t.type}}),en=(0,c.useRef)(null),er=(0,c.useRef)(!1),[ei]=(0,k._)(V,en,er,l,f,q,"node","notebook");async function onDownload(e,t,n){let r;try{r=await new DownloadTask(V,e,t,n).run(q)}catch(e){q({type:"showErrorToast",message:"Unable to download.",key:"download"});return}(0,_.L)(r,"".concat(U||"untitled").concat(n?".".concat(n):""))}function toggleCode(){q({type:a?"blur":"focus",id:V})}let eo="";function commentAction(){q(t)}n?K?(eo="Hide ".concat((0,D.xC)(n,"comment")),t={type:"hideComments",nodeId:V,trigger:"click",source:"nodeGutterMenu"}):(eo="Show ".concat((0,D.YY)(n,"comment")),t={type:"showComments",nodeId:V,trigger:"click",source:"nodeGutterMenu"}):J?(eo="Cancel comment",t={type:"commentComposeCancel",nodeId:V,content:"",trigger:"click",source:"nodeGutterMenu"}):X?(eo="Add comment",t={type:"commentComposeOpen",nodeId:V,trigger:"click",source:"nodeGutterMenu"}):(eo="Add comment",t={type:"showModal",modal:"login",modalProps:{loginReason:"comment"},trigger:"click",source:"comment"});let el=l?"Click for cell actions\nDrag to move cell":"Click to comment",{className:es,styles:ea}={styles:(0,r.jsx)(o(),{id:"6fc69390748be3c3",dynamic:[O?"pointer":"grab",E.pp,i&&z?0:"var(--border-radius-2)"],children:"*.__jsx-style-dynamic-selector{will-change:transform;cursor:".concat(O?"pointer":"grab","}@media ").concat(E.pp,"{*.__jsx-style-dynamic-selector{-webkit-border-top-left-radius:var(--border-radius-2);-moz-border-radius-topleft:var(--border-radius-2);border-top-left-radius:var(--border-radius-2);-webkit-border-bottom-left-radius:").concat(i&&z?0:"var(--border-radius-2)",";-moz-border-radius-bottomleft:").concat(i&&z?0:"var(--border-radius-2)",";border-bottom-left-radius:").concat(i&&z?0:"var(--border-radius-2)","}}")}),className:o().dynamic([["6fc69390748be3c3",[O?"pointer":"grab",E.pp,i&&z?0:"var(--border-radius-2)"]]])},ed=l&&!!U,ec=l&&!i&&!Z,eu=l&&!Z&&z,ep=l&&z&&!f&&!O,eh=l&&!f&&!O,em=!f,ef=l&&ee&&!f,eg=P&&(n>0||X||!G)&&!O&&!f,ev=l&&(0,I.q8)(R),ey=!z&&L.qz[R.mode].convertible&&!f;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(C.v2,{children:e=>{let{isExpanded:t}=e;return er.current=t,(0,r.jsxs)(r.Fragment,{children:[O?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(C.j2,{title:el,"aria-label":el,className:d()(a||b&&S?"observable-focus-dark-blue":b?"washed-blue":t?"dark-gray":"mid-gray",a||b?"hover-blue":S?"hover-mid-gray":"","bg-transparent",es,F,"bn pa0"),...$,children:[B,ea]}),(0,r.jsx)("span",{ref:en})]}):(0,r.jsxs)(C.j2,{ref:en,title:el,"aria-label":el,className:d()(a||b&&S?"observable-focus-dark-blue":b?"washed-blue":t?"dark-gray":S?"gray":"moon-gray",a||b?"hover-blue":S?"hover-mid-gray":"",a||b&&S?"bg-observable-focus-light-blue":S?"bg-light-silver":"bg-transparent",!(a||S||!z||t)&&"dn",es,F,"bn pa0"),...$,children:[B,ea]}),(0,r.jsxs)(C.qy,{position:C.Ly.right,children:[ed?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(C.Uk,{href:"#".concat(U),children:(0,r.jsx)("div",{className:"mw5 code f7 fw5 hover-blue",children:U})}),(0,r.jsx)(C.R,{})]}):null,ec?(0,r.jsxs)(C.sN,{onSelect:toggleCode,children:[(0,r.jsx)(g.Z,{className:"w1 h1 mr1"}),"Edit"]}):eu?(0,r.jsxs)(C.sN,{onSelect:toggleCode,children:[(0,r.jsx)(w.Z,{className:"w1 h1 mr1"}),"Close"]}):null,ep&&(0,r.jsxs)(C.sN,{onSelect:()=>q({type:"togglePin",id:V}),children:[(0,r.jsx)(x.Z,{className:"w1 h1 mr1","aria-label":Z?"Unpin":"Pin"}),Z?"Unpin":"Pin"]}),eg&&(0,r.jsxs)(C.sN,{onSelect:commentAction,"aria-label":eo,disabled:W,title:W?"Fork this ".concat(et," to comment on this cell"):void 0,children:[(0,r.jsx)(p.Z,{className:"w1 h1 mr1"}),eo]}),ev&&(0,r.jsxs)(C.sN,{title:"Copy the code to import this cell",onSelect:async()=>{await navigator.clipboard.writeText(function(e,t){let{body:n}=(0,I.Qc)(e);if((null==n?void 0:n.type)==="ImportDeclaration"){let{specifiers:e,injections:t,source:r}=n;if(!t)return"import {".concat(e.map(e=>{let{imported:{name:t},local:{name:n},view:r,mutable:i}=e;return"".concat(r?"viewof ".concat(t):i?"mutable ".concat(t):t).concat(t===n?"":" as ".concat(n))}).join(", "),'} from "').concat(r.value,'"')}let r=(0,I.Ad)(e);return"import {".concat(r.join(", "),'} from "').concat(t,'"')}(R,Q)),q({type:"showSuccessToast",message:"Copied import code to clipboard"})},children:[(0,r.jsx)(m.Z,{className:"w1 h1 mr1"}),"Copy import"]}),em&&(0,r.jsxs)(C.sN,{onSelect:()=>q({type:"selectionToggle",id:V}),children:[(0,r.jsx)(u.Z,{className:"w1 h1 mr1"}),b?"Deselect":"Select"]}),eh&&(0,r.jsxs)(C.sN,{onSelect:()=>q({type:"duplicate",id:V,before:!1}),children:[(0,r.jsx)(y.Z,{className:"w1 h1 mr1"}),"Duplicate"]}),l&&(0,r.jsxs)(C.sN,{title:"Copy a link to this cell",onSelect:async()=>{let e=new URL("#".concat(U||"cell-".concat(V)),window.location.href);await navigator.clipboard.writeText(e.href),q({type:"showSuccessToast",message:"Copied link to clipboard"})},children:[(0,r.jsx)(v.ZP,{className:"w1 h1 mr1"}),"Copy link"]}),l&&(0,r.jsxs)(C.sN,{disabled:!U,title:U?"Embed this cell in a web page":"Name this cell to embed",onSelect:()=>q({type:"showModal",modal:"embed",modalProps:{selectedNode:R},source:"nodeGutterMenu"}),children:[(0,r.jsx)(h.Z,{className:"w1 h1 mr1"}),"Embed"]}),l&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(DownloadButtons,{onDownload:onDownload,id:V,dispatch:q}),(0,r.jsx)(DownloadButtons,{asView:!0,onDownload:onDownload,id:V,dispatch:q})]}),ef&&(0,r.jsx)(DeleteMenuItem,{dispatch:q,id:V}),ey?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(C.R,{}),(0,r.jsx)(j.i,{dispatch:q,id:V,mode:H,disabled:f})]}):null]})]})}}),ei&&(0,r.jsx)(s.h,{children:(0,r.jsx)("div",{style:{position:"fixed",top:0,right:0,bottom:0,left:0,cursor:"grabbing",zIndex:1}})})]})},DeleteMenuItem=e=>{let{dispatch:t,id:n}=e,[i,o]=(0,c.useState)(!1),{isExpanded:s}=(0,l.uF)();return(0,c.useEffect)(()=>{s||o(!1)},[s]),i?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(C.ti,{children:"Are you sure?"}),(0,r.jsxs)(C.sN,{onSelect:()=>t({type:"remove",id:n}),className:"hover-dark-red hover-bg-washed-red",children:[(0,r.jsx)(b.Z,{"aria-label":"Delete confirmation",className:"w1 h1 mr1"}),"Delete"]})]}):(0,r.jsxs)(C.sN,{onMouseUp:function(e){e.preventDefault(),o(!0)},onSelect:()=>t({type:"remove",id:n}),className:"hover-dark-red hover-bg-washed-red",children:[(0,r.jsx)(b.Z,{"aria-label":"Delete",className:"w1 h1 mr1"}),"Delete"]})},P=new Set(["csv","map","set","typedarray","array","object"]),DownloadButtons=e=>{let{asView:t=!1,id:n,dispatch:i,onDownload:o}=e,[s,a]=(0,c.useState)(),{isExpanded:d}=(0,l.uF)();if((0,c.useEffect)(()=>{d?new DownloadTypeTask(n).run(i).then(a,()=>{}):a(void 0)},[i,n,d]),void 0===s)return null;let u=t?s.typeAsView:s.type;return void 0===u?null:(0,r.jsxs)(r.Fragment,{children:["svg"===u.type&&(0,r.jsxs)(C.sN,{onSelect:()=>o(t,u.type,"svg"),children:[(0,r.jsx)(f.Z,{className:"w1 h1 mr1"}),"Download SVG"]}),("svg"===u.type||"canvas"===u.type||"html"===u.type)&&(0,r.jsxs)(C.sN,{onSelect:()=>o(t,u.type,"png"),children:[(0,r.jsx)(f.Z,{className:"w1 h1 mr1"}),"Download PNG"]}),"css"===u.type&&(0,r.jsxs)(C.sN,{onSelect:()=>o(t,u.type,"css"),children:[(0,r.jsx)(f.Z,{className:"w1 h1 mr1"}),"Download CSS"]}),"blob"===u.type&&(0,r.jsxs)(C.sN,{onSelect:()=>o(t,u.type,function(e){switch(e){case"image/png":return"png";case"image/jpeg":return"jpg";case"image/gif":return"gif";case"image/bmp":return"bmp";case"application/json":return"json";case"application/x-sqlite3":return"db";case"application/zip":return"zip";case"text/css":return"css";case"text/csv":return"csv";case"text/plain":return"txt";case"text/html":return"html";case"text/javascript":return"js";case"audio/mpeg":return"mp3";case"video/mp4":return"mp4";case"text/tab-separated-values":return"tsv"}return""}(u.mime)),children:[(0,r.jsx)(f.Z,{className:"w1 h1 mr1"}),"Download file"]}),"csv"===u.type&&(0,r.jsxs)(C.sN,{onSelect:()=>o(t,u.type,"csv"),children:[(0,r.jsx)(f.Z,{className:"w1 h1 mr1"}),"Download CSV"]}),"string"===u.type&&(0,r.jsxs)(C.sN,{onSelect:()=>o(t,u.type,"txt"),children:[(0,r.jsx)(f.Z,{className:"w1 h1 mr1"}),"Download text"]}),P.has(u.type)&&(0,r.jsxs)(C.sN,{onSelect:()=>o(t,u.type,"json"),children:[(0,r.jsx)(f.Z,{className:"w1 h1 mr1"}),"Download JSON"]})]})}},22481:function(e,t,n){"use strict";n.d(t,{S:function(){return DashboardEditor},G:function(){return isEditorDisplay}});var r=n(85893),i=n(5379),o=n.n(i),l=n(94184),s=n.n(l),a=n(67294),d=n(78964),c=n(55288),u=n(93718),p=n(51337),h=n(74232),m=n(51169),f=n(6325),g=n(32341),dragHandle=e=>(0,r.jsxs)("svg",{viewBox:"0 0 16 16",width:"16",height:"16",fill:"currentColor",stroke:"none",...e,children:[(0,r.jsx)("rect",{x:"2",y:"4",width:"16",height:"2",rx:"2"}),(0,r.jsx)("rect",{x:"2",y:"9",width:"16",height:"2",rx:"2"})]}),v=n(47213),y=n(83749),x=n(1673),b=n(56770),w=n(68404),C=n(90271),j=n(44911),S=n(41312),k=n(32980),E=n(29020),_=n(60147);function isEditorDisplay(e){return"table"===e.mode||"sql"===e.mode}let DashboardEditor=e=>{var t,n,i,l;let{isReadOnly:N,showComment:L,setDragStarted:I,dispatch:T,isEditorAlwaysOpen:D=()=>!1,isNodeCommentable:M=()=>!1}=e,{allowedToComment:P,comments:R,dragId:A,dropId:O,editorStates:F,focusId:B,heights:$,hoverId:V,insertingId:Z,layout:H,nodes:U,safe:q,searchable:Y,searchResults:z,selection:W,selectionFocusId:G,workerStatus:K}=(0,_.v9)(e=>{let{notebook:t}=e;return{allowedToComment:(0,k.RF)(t),comments:t.comments,dragId:t.dragId,dropId:t.dropId,editorStates:t.editorStates,focusId:t.focusId,heights:t.heights,hoverId:t.hoverId,insertingId:t.insertingId,layout:t.layout,nodes:t.model.nodes,safe:t.safe,searchable:t.searchResultsVisible&&!!t.searchResults,searchResults:t.searchResults,selection:t.selection,selectionFocusId:t.selectionFocusId,workerStatus:t.workerStatus}}),J=(A||0===A)&&A>-1,[X,Q]=(0,a.useState)(),[ee,et]=(0,a.useState)(),[en,er]=(0,a.useState)(!0),[ei,eo]=(0,a.useState)(),[el,es]=(0,a.useState)(!1),ea=(0,a.useRef)(null),ed=(0,a.useRef)(null);function closePopover(){eo(null)}(0,a.useEffect)(()=>{L.nodeId&&ei!==L.nodeId&&!el&&eo(L.nodeId)},[L,ei,el]);let ec=(0,a.useRef)({});(0,a.useEffect)(()=>{ec.current.selected&&(0,b.zT)(ec.current.selected)},[G]),(0,a.useEffect)(()=>{function onClick(e){var t;!ei||!ea.current||ea.current.contains(e.target)||(null===(t=window.getSelection())||void 0===t?void 0:t.toString())||closePopover()}function onKeyDown(e){ei&&"Escape"===e.key&&closePopover()}return ei&&(addEventListener("click",onClick),addEventListener("keydown",onKeyDown,!0)),()=>{removeEventListener("click",onClick),removeEventListener("keydown",onKeyDown,!0)}},[ei,ea,eo]);let eu=(0,a.useCallback)(()=>{T({type:"dragged",id:-1}),T({type:"dragStarted",id:-1}),I(!1)},[T,I]),ep=(0,a.useCallback)(()=>{eu()},[eu]);(0,a.useEffect)(()=>(window.addEventListener("mouseup",ep),()=>window.removeEventListener("mouseup",ep)),[ep]);let[eh,em]=(0,a.useState)(0);(0,a.useEffect)(()=>{let e=0;for(let t of H){let n=$.get(t.id);n&&(e+=n.total,isEditorDisplay(t.slots[0])&&(e-=C.dL))}em(e+=C.xe)},[H,$]);let ef=eh+C.dL*H.length+C.KI*(H.length+1);function handleDrop(e){var t;let n=+e.event.dataTransfer.getData("fromRow"),r=e.intoId;if(A===O&&n===r){eu();return}let i=e.at,o=r?H.find(e=>e.id===r):null;if(n!==r&&(null==o?void 0:o.slots.length)===C.j$){eu();return}let l=H.find(e=>e.id===n),s=null!==(t=null==l?void 0:l.slots.findIndex(e=>e.nodeId===A))&&void 0!==t?t:-1;if(n===r&&i===s+1&&!e.previous){eu();return}let a=(null==l?void 0:l.slots[s])?isEditorDisplay(l.slots[s]):null;if(e.inRow&&a){eu();return}let d=null!=o&&!!o.slots[i]&&isEditorDisplay(o.slots[i]),c="hidden"===ee,u=e.previous?"previous":a||d||!o||c?null:0===i?"next":"previous";T({type:"dragEnded",dragCombine:u,dragDisplay:c?{presentation:{hidden:!0}}:void 0}),T({type:"blur"}),eu()}function draggingWithinRow(e){let t=H.find(t=>t.id===e);return!!t&&t.slots.findIndex(e=>e.nodeId===A)>-1}let eg=[],ev=[];for(let e of H){let t=U.find(t=>t.id===e.slots[0].nodeId);(null==t?void 0:null===(l=t.display)||void 0===l?void 0:null===(i=l.presentation)||void 0===i?void 0:i.hidden)?eg.push(e):ev.push(e)}let ey=0===ev.length,ex=ey&&0===eg.length,eb=ev.at(-1),ew=eb?eb.slots.at(-1):null,eC=eg.at(-1),ej=eC?eC.slots.at(-1):null,eS=en&&H.some(e=>!$.get(e.id));function displayRow(e,t,n){var i,l,a;let b=$.get(e.id),k=((0,w.Gv)(b)||0)+C.dL,_=n?eg:ev,en=_.length>t+1?_[t+1]:!n&&eg[0]?eg[0]:null,er=t>0?_[t-1]:n&&ev.at(-1)?ev.at(-1):null,eu=b&&isEditorDisplay(e.slots[0])?b.editor-C.dL:b?b.editor:0,ep=e.slots.length===C.j$,em=!isEditorDisplay(e.slots[0])&&!n&&(!ep||draggingWithinRow(e.id));return(0,r.jsxs)("div",{className:s()("dashboard-row relative tc",J?"pea":"pen"),style:{marginTop:(!n||ey)&&0===t?"-".concat(eh+C.dL*H.length+C.KI*(H.length+1),"px"):0,marginBottom:"".concat(eu,"px"),lineHeight:0},children:[(0,r.jsx)("div",{className:"w-100",style:{height:"".concat(C.KI,"px")},children:J?(0,r.jsx)("div",{className:"w-100 h-100 relative flex items-center",onDrop:e=>{handleDrop({event:e,intoId:null,at:0}),e.preventDefault()},onDragOver:t=>{Q(null),et(n?"hidden":"presentation"),T({type:"dragged",id:e.slots[0].nodeId}),t.preventDefault()},children:(0,r.jsx)("div",{className:s()("w-100",O!==e.slots[0].nodeId||X||ee!==(n?"hidden":"presentation")?"bg-moon-gray":"bg-blue"),style:{height:2}})}):(0,r.jsx)("div",{className:"absolute",style:{paddingTop:"".concat(C.KI-1,"px"),width:"calc(100% - 28px)",marginLeft:14},children:(0,r.jsx)(y.Z,{previousId:ex?-1:er?er.slots[er.slots.length-1].nodeId:null,nextId:e.slots[0].nodeId,focusId:B,hoverId:V,insertingId:Z,betweenRows:!0,nextRowNodeId:en?en.slots[0].nodeId:null,prevRowNodeId:er?null===(i=er.slots.at(-1))||void 0===i?void 0:i.nodeId:null,inHiddenSection:n,dispatch:T})})}),!isEditorDisplay(e.slots[0])&&!n&&(0,r.jsx)("div",{className:"absolute flex items-center",style:{height:"".concat(k,"px"),marginLeft:-C.KI-1},children:verticalInserter({slot:e.slots[0],index:0,position:"first",row:e,nextRow:en,previousId:er?er.slots[er.slots.length-1].nodeId:null,nextId:e.slots[0].nodeId,prevRowNodeId:er?null===(l=er.slots.at(-1))||void 0===l?void 0:l.nodeId:null,canInsertInRow:em})}),e.slots.map((i,l)=>{var a,y,b,w;let _=U.find(e=>e.id===i.nodeId);if(!_)return"";let O=j.qz[_.mode].icon,{id:$,pinned:Z}=_,H=B===$,X=W.has($),ee=G===$,er=F.get($).field(g.JN),eu=(null===(a=K.get($))||void 0===a?void 0:a.status)==="pending",ep=D($)||q||Z||H||(0,S.cS)(_)||(null===(b=_.data)||void 0===b?void 0:null===(y=b.display)||void 0===y?void 0:y.mode)==="none"||!!er.length||!(0,S.QF)(_)||Y&&!!z&&z.has($),eh=R.has(i.nodeId)?R.get(i.nodeId).filter(E.Wg):[],ef=R.has(i.nodeId)?R.get(i.nodeId).filter(e=>!(0,E.sH)(e)&&!(0,E.Wg)(e)):[],eg=eh.length+ef.length,ev=ei===i.nodeId,ey=0===l?0:8,ex=l===e.slots.length-1?0:8;return(0,r.jsxs)("div",{className:"slot-container relative inline-flex items-center",style:{width:"calc(".concat(i.width,"%)")},children:[0!==l&&!n&&(0,r.jsx)("div",{className:"absolute flex items-center",style:{height:"".concat(k,"px"),marginLeft:-8},children:verticalInserter({slot:i,index:l,position:l.toString(),row:e,nextRow:en,previousId:e.slots[l-1].nodeId,nextId:i.nodeId,prevRowNodeId:null===(w=e.slots.at(-1))||void 0===w?void 0:w.nodeId,canInsertInRow:em})}),(0,r.jsxs)("div",{className:s()("dashboard-slot w-100 relative z-0 br2 ba",eS?"b--transparent":H?"b--washed-blue":"b--light-gray"),ref:e=>{ee&&e&&(ec.current.selected=e)},style:{height:"".concat(k,"px"),marginLeft:"".concat(ey,"px"),marginRight:"".concat(ex,"px"),boxShadow:eS?"none":ee?"0px 0px 0px 2px var(--lightest-blue), 0px 0px 0px 4px var(--faint-blue)":X?"0px 0px 0px 2px var(--washed-blue)":"0 1px 4px 0 rgba(0, 0, 0, 0.07)"},onDrop:t=>{handleDrop({event:t,intoId:e.id,at:l,inRow:!0}),t.preventDefault()},onDragOver:em?t=>{Q(e.id),T({type:"dragged",id:i.nodeId}),t.preventDefault()}:void 0,children:[eu&&(0,r.jsx)(f.c,{}),(0,r.jsxs)("div",{draggable:!0,onMouseDown:()=>{I(!0)},onDragStart:t=>{T({type:"dragStarted",id:i.nodeId}),t.dataTransfer.setData("fromRow","".concat(e.id));let n=document.getElementById("drag-image");n&&t.dataTransfer.setDragImage(n,0,0)},style:{height:"".concat(C.dL-2,"px"),backgroundColor:H?"var(--observable-focus-lightest-blue)":"var(--near-white)"},className:"jsx-b6e633dfbcdbd97 "+(s()("slot-footer w-100 pea absolute bottom-0 justify-center z-1 br2 br--bottom",H?"observable-focus-dark-blue":"mid-gray",eS?"dn":"flex")||""),children:[(0,r.jsx)("button",{style:{left:4,visibility:H?"visible":void 0},className:"jsx-b6e633dfbcdbd97 slot-control square-button absolute top-0 pointer bg-transparent br2 bn pa0 mt1",children:(0,r.jsx)(x.G,{node:_,focused:H,selected:X||ee,editorOpen:ep,editable:!0,hovered:V===_.id,readOnly:N,commentCount:0,commentable:M(_.id),rowId:e.id,allowsLayout:!0,children:(0,r.jsx)("div",{className:"jsx-b6e633dfbcdbd97 mt1",children:(0,r.jsx)(v.Z,{})})})}),(0,r.jsx)("button",{style:{visibility:H?"visible":void 0},className:"jsx-b6e633dfbcdbd97 slot-control square-button absolute left-2 top-0 pointer bg-transparent br2 bn pa0 mt1",children:(0,r.jsx)(h.Z,{node:_,mode:_.mode,focused:H,hovered:V===_.id,selected:X||ee,readOnly:N,allowsLayout:!0,children:(0,r.jsx)("div",{style:{marginTop:3},className:"jsx-b6e633dfbcdbd97",children:(0,r.jsx)(O,{className:"jsx-b6e633dfbcdbd97"})})})}),(0,r.jsxs)("button",{onClick:()=>{T({type:H?"blur":"focus",id:i.nodeId})},style:{flex:1,cursor:"grab"},className:"jsx-b6e633dfbcdbd97 br2 bn bg-inherit",children:[(0,r.jsx)("div",{style:{left:60,background:H?"var(--blue)":"inherit",visibility:H?"visible":void 0},className:"jsx-b6e633dfbcdbd97 slot-control square-button pointer absolute top-0 br2 mt1",children:(0,r.jsx)(c.Z,{color:H?"white":"",style:{marginTop:4,transform:H?"":"rotate(-90deg)",transition:"transform 150ms ease"}})}),(0,r.jsx)("div",{className:"jsx-b6e633dfbcdbd97",children:"\xa0"})]}),(0,r.jsx)("button",{style:{height:24,marginTop:6,cursor:"grab"},className:"jsx-b6e633dfbcdbd97 handle moon-gray bg-inherit bn",children:(0,r.jsx)(dragHandle,{})}),(0,r.jsx)("button",{onClick:()=>{T({type:H?"blur":"focus",id:i.nodeId})},style:{flex:1,cursor:"grab"},className:"jsx-b6e633dfbcdbd97 br2 bn bg-inherit",children:(0,r.jsx)("div",{className:"jsx-b6e633dfbcdbd97",children:"\xa0"})}),(0,r.jsx)("button",{style:{height:24,marginTop:4,visibility:H?"visible":void 0},ref:ed,onClick:e=>{e.preventDefault(),e.stopPropagation(),P&&(ei===i.nodeId?closePopover():eo(i.nodeId))},className:"jsx-b6e633dfbcdbd97 "+(s()(0===eg&&!ev&&"slot-control","absolute right-0 pointer squishy bg-inherit bn")||""),children:(0,r.jsxs)("div",{className:"jsx-b6e633dfbcdbd97 "+(s()("flex items-center br2 b pa1",ev?"bg-blue white":"bg-inherit dark-gray")||""),children:[eg>0?(0,r.jsx)("div",{className:"jsx-b6e633dfbcdbd97 mr1",children:eg}):(0,r.jsx)(p.GL,{}),(0,r.jsx)(u.Z,{})]})}),(0,r.jsx)(o(),{id:"b6e633dfbcdbd97",children:".slot-control.jsx-b6e633dfbcdbd97{visibility:hidden}.slot-footer.jsx-b6e633dfbcdbd97:hover .slot-control.jsx-b6e633dfbcdbd97{visibility:visible}.slot-footer.jsx-b6e633dfbcdbd97:hover .handle.jsx-b6e633dfbcdbd97{color:inherit}.square-button.jsx-b6e633dfbcdbd97{width:24px;height:24px}"})]})]}),em&&l===e.slots.length-1&&(0,r.jsx)("div",{className:s()("absolute right-0 w-50 h-100",J?"z-1":"z-0",A===i.nodeId&&"pen"),onDrop:t=>{handleDrop({event:t,intoId:e.id,at:l,previous:!0,inRow:!0}),t.preventDefault()},onDragOver:t=>{Q(e.id),et("presentation"),T({type:"dragged",id:en?en.slots[0].nodeId:null}),t.preventDefault()}}),ev&&(0,r.jsx)("div",{className:"pea",ref:ea,children:(0,r.jsx)(m.J,{extraStyle:{width:400},children:(0,r.jsx)(d.y,{nodeId:$,resolvedComments:eh,unresolvedComments:ef,linkedCommentId:L.commentId,linkedCommentShown:el,setLinkedCommentShown:es,close:closePopover,dispatch:T})})})]},"".concat(t,".").concat(l,".").concat(i.nodeId))}),!isEditorDisplay(e.slots[0])&&!n&&(0,r.jsx)("div",{className:"absolute inline-flex items-center",style:{height:"".concat(k,"px")},children:verticalInserter({slot:en?en.slots[0]:null,index:e.slots.length-1,position:"last",row:e,nextRow:en,previousId:e.slots[e.slots.length-1].nodeId,nextId:en?en.slots[0].nodeId:null,prevRowNodeId:null===(a=e.slots.at(-1))||void 0===a?void 0:a.nodeId,canInsertInRow:em,forcePrevious:!0})})]},e.id)}return en&&$.size>0&&!eS&&er(!1),(0,r.jsxs)("div",{className:"dashboard-container",style:{height:ef,marginLeft:-C.Mv,marginRight:-C.Mv},children:[ev.map((e,t)=>displayRow(e,t,!1)),(0,r.jsx)("div",{className:"absolute left-0 right-0",style:{height:C.xe/2+C.KI,marginLeft:-C.Mv,marginRight:-C.Mv},onDrop:e=>{handleDrop({event:e,intoId:null,at:0}),e.preventDefault()},onDragOver:e=>{Q(null),et("presentation"),T({type:"dragged",id:eg[0]?eg[0].slots[0].nodeId:null}),e.preventDefault()}}),(0,r.jsx)("div",{className:"w-100 relative",style:{height:"".concat(C.KI,"px"),marginTop:ey?-ef:void 0,marginBottom:ey?ef:void 0},children:J?(0,r.jsx)("div",{className:"w-100 h-100 relative flex items-center",onDrop:e=>{handleDrop({event:e,intoId:null,at:0}),e.preventDefault()},onDragOver:e=>{Q(null),et("presentation"),T({type:"dragged",id:eg[0]?eg[0].slots[0].nodeId:null}),e.preventDefault()},children:(0,r.jsx)("div",{className:s()("w-100",O!==(null===(n=eg[0])||void 0===n?void 0:null===(t=n.slots[0])||void 0===t?void 0:t.nodeId)||X||"presentation"!==ee?"bg-moon-gray":"bg-blue"),style:{height:2}})}):(0,r.jsx)("div",{className:"absolute",style:{paddingTop:"".concat(C.KI-1,"px"),width:"calc(100% - 28px)",marginLeft:14},children:(0,r.jsx)(y.Z,{previousId:ex?-1:ew?ew.nodeId:null,nextId:eg[0]?eg[0].slots[0].nodeId:null,focusId:B,hoverId:V,insertingId:Z,betweenRows:!0,alwaysShowBar:!0,dispatch:T})})}),(ev.length>0||eg.length>0)&&(0,r.jsx)("div",{style:{height:C.xe-C.KI}}),(0,r.jsx)("div",{className:s()("absolute left-0 right-0",J?"pea":"pen"),style:{height:C.xe/2,marginLeft:-C.Mv,marginRight:-C.Mv,marginTop:0===ev.length?-ef-C.xe/2+C.KI:-(C.xe/2)+C.KI},onDrop:e=>{handleDrop({event:e,intoId:null,at:0}),e.preventDefault()},onDragOver:e=>{Q(null),et("hidden"),T({type:"dragged",id:eg[0]?eg[0].slots[0].nodeId:null}),e.preventDefault()}}),eg.map((e,t)=>displayRow(e,t,!0)),(0,r.jsx)("div",{className:"w-100 relative",style:{height:"".concat(C.KI,"px")},children:J?(0,r.jsx)("div",{className:"w-100 h-100 relative flex items-center",onDrop:e=>{handleDrop({event:e,intoId:null,at:0}),e.preventDefault()},onDragOver:e=>{Q(null),et("hidden"),T({type:"dragged",id:null}),e.preventDefault()},children:(0,r.jsx)("div",{className:s()("w-100",null!==O||X||"hidden"!==ee?"bg-moon-gray":"bg-blue"),style:{height:2}})}):(0,r.jsx)("div",{className:"absolute",style:{paddingTop:"".concat(C.KI-1,"px"),width:"calc(100% - 28px)",marginLeft:14},children:(0,r.jsx)(y.Z,{previousId:ex?-1:ej?ej.nodeId:ew?ew.nodeId:null,nextId:null,focusId:B,hoverId:V,insertingId:Z,alwaysShowBar:!0,betweenRows:!0,inHiddenSection:!0,dispatch:T})})}),(0,r.jsx)("div",{className:s()("absolute left-0 right-0",J?"pea":"pen"),style:{height:"var(--height-5)",marginLeft:-C.Mv,marginRight:-C.Mv},onDrop:e=>{handleDrop({event:e,intoId:null,at:0}),e.preventDefault()},onDragOver:e=>{Q(null),et("hidden"),T({type:"dragged",id:null}),e.preventDefault()}}),(0,r.jsx)("div",{id:"drag-image",className:"bg-transparent",style:{height:1,width:1}})]});function verticalInserter(e){let{slot:t,index:n,position:i,row:o,nextRow:l,previousId:a,nextId:d,prevRowNodeId:c,canInsertInRow:u,forcePrevious:p}=e,h=!!t&&isEditorDisplay(t);return(0,r.jsx)(r.Fragment,{children:J?(0,r.jsx)("div",{className:"h-100",style:{width:16},onDrop:e=>{handleDrop({event:e,intoId:o.id,at:n,previous:p,inRow:!0}),e.preventDefault()},onDragOver:u?e=>{Q(o.id),h||T({type:"dragged",id:t?t.nodeId:null}),e.preventDefault()}:void 0,children:(0,r.jsx)("div",{className:s()("h-100",O===(t?t.nodeId:null)&&(draggingWithinRow(o.id)||o.slots.length<C.j$)&&X===o.id?"bg-blue":"bg-moon-gray"),style:{width:2,marginLeft:8}})}):u&&(0,r.jsx)(y.Z,{previousId:a,nextId:d,focusId:B,hoverId:V,insertingId:Z,positionInRow:i,nextRowNodeId:l?l.slots[0].nodeId:null,prevRowNodeId:c,dispatch:T})})}}},6325:function(e,t,n){"use strict";n.d(t,{_:function(){return DashboardPresenter},c:function(){return CellLoading}});var r=n(85893),i=n(5379),o=n.n(i),l=n(94184),s=n.n(l),a=n(67294),d=n(78964),c=n(93718),u=n(51337),p=n(51169),h=n(68404),m=n(90271),f=n(32980),g=n(29020),v=n(60147);let CellLoading=()=>(0,r.jsxs)("div",{style:{overflow:"hidden",height:2,width:"calc(100% - 1px)"},className:"jsx-8f9e3339f3365684 absolute",children:[(0,r.jsx)("div",{style:{height:2,background:"linear-gradient(90deg, rgba(99, 132, 221, 0.0) 0%,           rgba(99, 132, 221, 1.0) 50%,           rgba(99, 132, 221, 0.0) 100%)"},className:"jsx-8f9e3339f3365684 absolute w-50 loading-bar"}),(0,r.jsx)(o(),{id:"8f9e3339f3365684",children:".loading-bar.jsx-8f9e3339f3365684{-webkit-animation:linear infinite;-webkit-animation-name:loading-bar;-webkit-animation-duration:2s}@-webkit-keyframes loading-bar{0%{left:-50%}100%{left:-webkit-calc(100% + 50%);left:calc(100% + 50%)}}@-moz-keyframes loading-bar{0%{left:-50%}100%{left:-moz-calc(100% + 50%);left:calc(100% + 50%)}}@-o-keyframes loading-bar{0%{left:-50%}100%{left:calc(100% + 50%)}}@keyframes loading-bar{0%{left:-50%}100%{left:-webkit-calc(100% + 50%);left:-moz-calc(100% + 50%);left:calc(100% + 50%)}}"})]}),DashboardPresenter=e=>{let{showComment:t,dispatch:n,isNodeCommentable:i=()=>!1}=e,{allowedToComment:o,comments:l,heights:y,layout:x,nodes:b,hoverId:w,workerStatus:C}=(0,v.v9)(e=>{let{notebook:t}=e;return{allowedToComment:(0,f.RF)(t),comments:t.comments,heights:t.heights,layout:t.layout,nodes:t.model.nodes,hoverId:t.hoverId,workerStatus:t.workerStatus}}),[j,S]=(0,a.useState)(),[k,E]=(0,a.useState)(!1),_=(0,a.useRef)(null),N=(0,a.useRef)(null);function closePopover(){S(null)}(0,a.useEffect)(()=>{t.nodeId&&j!==t.nodeId&&!k&&S(t.nodeId)},[t,j,k]),(0,a.useEffect)(()=>{function onClick(e){j&&_.current&&!_.current.contains(e.target)&&closePopover()}function onKeyDown(e){j&&"Escape"===e.key&&closePopover()}return j&&(addEventListener("click",onClick),addEventListener("keydown",onKeyDown,!0)),()=>{removeEventListener("click",onClick),removeEventListener("keydown",onKeyDown,!0)}},[j,_,S]);let[L,I]=(0,a.useState)(0);(0,a.useEffect)(()=>{let e=0;for(let r of x){var t,n;let i=b.find(e=>e.id===r.slots[0].nodeId);if(!(null==i?void 0:null===(n=i.display)||void 0===n?void 0:null===(t=n.presentation)||void 0===t?void 0:t.hidden)){let t=y.get(r.id);t&&(e+=t.total)}}I(e)},[x,y,b]);let T=[];for(let e of x){var D,M;let t=b.find(t=>t.id===e.slots[0].nodeId);(null==t?void 0:null===(M=t.display)||void 0===M?void 0:null===(D=M.presentation)||void 0===D?void 0:D.hidden)||T.push(e)}let P=L+m.KI*(T.length+1);return(0,r.jsx)("div",{className:"dashboard-container",style:{height:P},children:(0,r.jsx)("div",{style:{marginTop:-P+m.KI},children:T.map((e,a)=>(function(e,a){let f=y.get(e.id),v=(0,h.Gv)(f)||0;return(0,r.jsx)("div",{className:s()("dashboard-row w-100 inline-flex relative pen"),style:{marginBottom:m.KI,lineHeight:0},children:e.slots.map((h,m)=>{var f;let y=b.find(e=>e.id===h.nodeId);if(!y)return"";let{id:x}=y,L=(null===(f=C.get(x))||void 0===f?void 0:f.status)==="pending",I=l.has(h.nodeId)?l.get(h.nodeId).filter(g.Wg):[],T=l.has(h.nodeId)?l.get(h.nodeId).filter(e=>!(0,g.sH)(e)&&!(0,g.Wg)(e)):[],D=I.length+T.length,M=j===h.nodeId,P=0===m?0:8,R=m===e.slots.length-1?0:8;return(0,r.jsxs)("div",{className:"relative inline-block",style:{width:"calc(".concat(h.width,"%)"),height:v,marginRight:R,marginLeft:P},children:[L&&(0,r.jsx)(CellLoading,{}),(0,r.jsx)("button",{className:s()(0===D&&!M&&"slot-control","absolute right-0 bottom-0 pa0 pointer squishy bg-inherit pea bn"),style:{height:24,marginBottom:1,marginRight:1,visibility:i(h.nodeId)&&w===h.nodeId?"visible":"hidden"},ref:N,onClick:e=>{e.preventDefault(),e.stopPropagation(),o&&(j===h.nodeId?closePopover():S(h.nodeId))},children:(0,r.jsxs)("div",{className:s()("flex items-center br2 b pa1",M?"bg-blue white":"bg-near-white dark-gray"),children:[D>0?(0,r.jsx)("div",{className:"mr1",children:D}):(0,r.jsx)(u.GL,{}),(0,r.jsx)(c.Z,{})]})}),M&&(0,r.jsx)("div",{className:"pea",ref:_,children:(0,r.jsx)(p.J,{extraStyle:{width:400},children:(0,r.jsx)(d.y,{nodeId:x,resolvedComments:I,unresolvedComments:T,linkedCommentId:t.commentId,linkedCommentShown:k,setLinkedCommentShown:E,close:closePopover,dispatch:n})})})]},"".concat(a,".").concat(m,".").concat(h.nodeId))})},e.id)})(e,a))})})}},13604:function(e,t,n){"use strict";n.d(t,{R:function(){return Paragraphs}});var r=n(85893),i=n(68337),o=n.n(i),l=n(67294),s=n(93327),a=n(5146);let d=o()().add("@",{validate(e,t,n){let r=e.slice(t);n.re.mention||(n.re.mention=new RegExp("^([a-zA-Z0-9_-]){1,39}(?!_)(?=$|".concat(n.re.src_ZPCc,")")));let i=n.re.mention.exec(r);if(i){var o;return(!(t>=2)||null!==(o=e[t-2].match(/(\s|^)/g))&&void 0!==o&&!!o[0].length)&&i[0].length}return 0},normalize(e){e.url="/".concat(e.url)}}),Paragraphs=e=>{let{content:t}=e,n=[],i=0,o=0,c=t.split("\n"),u=d.match(t),p=new Map,h=u?u.filter(e=>"@"===e.schema):[],{data:m}=(0,a.h_)(h.length?"/users-exist?".concat(h.map(e=>"login=".concat(e.text.substring(1).toLowerCase())).sort().join("&")):null);if(m)for(let[e,t]of m)t&&"unavailable"!==t?p.set(e,!0):p.set(e,!1);for(let e of c){let t=d.match(e);if(t){let o=0;for(let{index:a,lastIndex:d,schema:c,text:u,url:h}of t)a>o&&n.push((0,r.jsx)(l.Fragment,{children:e.substring(o,a)},++i)),"@"===c?p.get(u.substring(1).toLowerCase())?n.push((0,r.jsx)(s.Z,{href:h.toLowerCase(),children:(0,r.jsx)("a",{rel:"noopener noreferrer ugc",className:"no-underline black hover-blue",children:u})},++i)):n.push((0,r.jsx)(l.Fragment,{children:u},++i)):n.push((0,r.jsx)(s.Z,{href:h,children:(0,r.jsx)("a",{rel:"nofollow noopener noreferrer ugc",className:"no-underline black hover-blue",children:u})},++i)),o=d;e.length>o&&n.push((0,r.jsx)(l.Fragment,{children:e.substring(o)},++i))}else n.push((0,r.jsx)(l.Fragment,{children:e},++i));c.length>1&&++o<c.length&&n.push((0,r.jsx)("br",{},++i))}return(0,r.jsx)(r.Fragment,{children:n})}},96765:function(e,t,n){"use strict";n.d(t,{DY:function(){return AssistBetaBadge},LP:function(){return b},o1:function(){return j},u7:function(){return w}});var r=n(85893),i=n(94184),o=n.n(i),l=n(41664),s=n.n(l),a=n(67294),d=n(66338),c=n(18841),u=n(26713),p=n(92862),h=n(51337),m=n(21756),f=n(27554),g=n(5146),v=n(20736),y=n(7595),x=n(85190);let b={GPT_3_5:"gpt-3.5-turbo-16k",GPT_4:"gpt-4"},w="AI Assist",C={enabled:!1,custom:!0},AssistBetaBadge=e=>{let{className:t,...n}=e;return(0,r.jsx)("span",{className:o()("br2 bg-near-white f6 fw6 mid-gray",t),...n,style:{padding:"2px 4px"},children:"Beta"})},j=(0,x.$j)(e=>{let{currentUser:t,context:n,customer:r}=e;return{currentUser:t,workspaceId:n.context?n.context.id:t.id,customer:r.customer}},e=>({dispatch:e}))(e=>{let{currentUser:t,customer:n,workspaceId:i,dispatch:o}=e,{data:l,mutate:x}=(0,g.h_)("/team/".concat(i,"/assist/provider")),[b,j]=(0,a.useState)(C),[S,k]=(0,a.useState)(!1),[E,_]=(0,a.useState)(!1),N=(0,y.th)(t,i,n);(0,a.useEffect)(()=>{j(l||{...C,custom:!N})},[l,N]),(0,a.useEffect)(()=>{let e=l||C;(0,d.wU)(e,b)?k(!1):k(e.enabled&&!b.enabled||b.enabled&&(b.custom&&!!b.credentials||!b.custom))},[l,b]);let L=(0,v.GS)(v.ro),I=(null==l?void 0:l.quota_allocated)||1e4;return(0,r.jsxs)("div",{id:"aiAssist",className:"pt4 mt5 bt b--light-silver",children:[(0,r.jsxs)("div",{className:"flex mb3 items-center",children:[(0,r.jsx)("div",{className:"f4 fw6 near-black mr2",children:w}),(0,r.jsx)(AssistBetaBadge,{})]}),(0,r.jsx)("div",{className:"mb3",children:(0,r.jsxs)("div",{className:"f6 lh-f6 mid-gray",children:["The"," ",(0,r.jsxs)(s(),{href:"/@observablehq/introduction-to-ai-assist",className:"pa0 fw5 blue bn bg-transparent pointer",children:[w," chat panel"]})," ","can help you generate and edit code through a chat interface. This is an experimental feature, and generated code may not always be correct. Feedback about this feature is welcome and can be sent to"," ",(0,r.jsx)(s(),{href:"mailto:support@observablehq.com",className:"pa0 fw5 blue bn bg-transparent pointer",children:"support@observablehq.com"}),"."]})}),(0,r.jsxs)("div",{style:(0,c.X)({isMobile:L,rightSize:"30rem"}),className:"dg",children:[(0,r.jsx)("label",{className:c.R,htmlFor:"enabled",children:"Access"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"flex items-center",children:(0,r.jsx)(p.X,{id:"setting_assist_enabled",onChange:e=>j({...b,enabled:e.target.checked}),checked:b.enabled,name:"enabled",label:"Enable ".concat(w),className:"fw5"})}),(0,r.jsxs)("div",{className:"f6 mid-gray lh-f6 mt2",children:["Allow members of this workspace to use the"," ",(0,r.jsxs)(s(),{href:"/@observablehq/introduction-to-ai-assist",className:"pa0 fw5 blue bn bg-transparent pointer",children:[w," chat panel"]})," ","to generate and edit code. By enabling this feature you agree to the"," ",(0,r.jsxs)(s(),{href:"/@observablehq/terms-of-service",className:"pa0 fw5 blue bn bg-transparent pointer",children:[w," terms of service"]}),"."]})]}),b.enabled&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{className:c.R,children:"OpenAI API Key"}),(0,r.jsx)("div",{className:"pv2",children:b.custom||!N&&(null==l?void 0:l.custom)?b.credentials?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"f6 mid-gray lh-f6 mb3",children:["This API key is used for all messages in this workspace and is configured to use the ",b.engine," model."]}),(0,r.jsxs)("div",{className:"flex items-center mt2",style:{gap:"8px"},children:[(0,r.jsx)(u.aX,{icon:m.Z,text:"Replace Key",onClick:()=>o({type:"showModal",modal:"addAiServiceKeyModal",modalProps:{settings:b,updateAiServiceKey:(e,t)=>j({...b,credentials:e,engine:t,custom:!0})}})}),(0,r.jsx)(u.aX,{icon:f.Z,text:"Remove Key",destructive:!0,onClick:()=>{j({...b,credentials:"",enabled:!1,custom:!N})}})]})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"fw5 mb2",children:"No OpenAI API Key configured."}),(0,r.jsxs)("div",{className:"f6 mid-gray lh-f6 mb3",children:["An"," ",(0,r.jsx)(s(),{href:"https://help.openai.com/en/articles/4936850-where-do-i-find-my-secret-api-key",target:"_blank",className:"fw5 blue",children:"OpenAI API key"})," ","is required to make a connection to the language model."]})]}),(0,r.jsx)("div",{className:"flex items-center",children:(0,r.jsx)(u.aX,{icon:h.ZP,text:"Add Key",onClick:()=>o({type:"showModal",modal:"addAiServiceKeyModal",modalProps:{settings:b,updateAiServiceKey:(e,t)=>{j({...b,credentials:e,enabled:!0,engine:t,custom:!0})}}})})})]}):(0,r.jsxs)(r.Fragment,{children:[l&&(0,r.jsxs)("div",{className:"mb2 fw6 observable-dark-gold lh-f6",children:[l.quota_used," /"," ",l.quota_allocated," free tokens used"]}),(0,r.jsxs)("div",{className:"mb3 f6 mid-gray lh-f6",children:["This workspace has ",I," tokens (about"," ",1e3*Math.floor(3*I/4/1e3)," words) as a trial to use in"," ",w," conversations. To continue chatting beyond that limit, you will need to add an OpenAI key to your workspace."]}),(0,r.jsx)("div",{className:"flex items-center",children:(0,r.jsx)(u.aX,{icon:h.ZP,text:"Add OpenAI API Key",onClick:()=>o({type:"showModal",modal:"addAiServiceKeyModal",modalProps:{settings:b,updateAiServiceKey:(e,t)=>{j({...b,credentials:e,enabled:!0,engine:t,custom:!0})}}})})})]})})]})]}),(0,r.jsx)("div",{className:"mt4",style:{gridColumn:"1/3"},children:(0,r.jsx)("div",{className:"flex mt1-ns mt3 mb3 justify-start items-center",children:(0,r.jsx)(u.KM,{id:"assist-settings-save-button",text:"Save changes",className:"ph3",disabled:!S,loading:E,onClick:function(){_(!0),o({type:"saveAssistSettings",settings:b,onComplete:()=>{_(!1),j(b.credentials?{...b,credentials:"".concat(b.credentials.substring(0,3),"...")}:C),x()}})},type:"submit"})})})]})})},18841:function(e,t,n){"use strict";function gridLayout(){let{isMobile:e=!1,gap:t=24,rightSize:n="24rem",leftSize:r="160px"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e?{gridTemplateColumns:"auto auto",gridGap:"".concat(t,"px 5px")}:{gridTemplateColumns:"".concat(r," minmax(auto, ").concat(n,")"),placeItems:"top stretch",gridGap:"".concat(t,"px 0")}}n.d(t,{R:function(){return r},X:function(){return gridLayout}});let r="pv2 f6 gray fw5"},28141:function(e,t,n){"use strict";n.d(t,{J:function(){return ColumnsPopoverContents},o:function(){return g}});var r=n(85893),i=n(94184),o=n.n(i),l=n(67294),s=n(56065),a=n(61107),d=n(27554),c=n(88903),u=n(45285),p=n(20736),h=n(71256),m=n(40591),f=n(60147);let ColumnsPopover=e=>{let{id:t,data:n,dispatch:i}=e,o=(0,h.vM)(t,n,i),{operations:{select:{columns:l}}}=n;return(0,r.jsx)(c.YI,{className:"bg-white ba b--silver br2 shadow-4 outline-0 pa12 overflow-auto",style:{minWidth:"150px",maxWidth:"".concat(300,"px"),maxHeight:"400px"},"data-cy":"columns-popover",children:(0,r.jsxs)(c.sd,{children:[(0,r.jsxs)("div",{className:"flex justify-between pb12",children:[(0,r.jsx)("div",{className:"gray f7",children:"Columns"}),o&&null!==l&&l.length<o.size&&(0,r.jsx)("button",{className:"bg-transparent bn blue fw6 f7 pa0 pointer",onClick:()=>{i({type:"setDataOperations",id:t,operations:{select:{columns:Array.from(o.keys())}}})},children:"Show all"})]}),(0,r.jsx)(ColumnsPopoverContents,{data:n,dispatch:i,id:t,schema:o,maxWidth:300})]})})},ColumnsPopoverContents=e=>{let{data:t,dispatch:n,id:i,schema:a,maxWidth:c}=e,{operations:{select:{columns:u},derive:h}}=t,m=a&&Array.from(a.entries()).map(e=>{let[t,{name:n}]=e;return{column:t,name:n}}),f=(0,p.GS)(p.pp),[g,v]=(0,l.useState)();return(0,r.jsx)(r.Fragment,{children:m?m.length?m.map(e=>{let{name:t,column:l}=e,s=null==h?void 0:h.some(e=>e.name===l);return(0,r.jsxs)("div",{className:"flex justify-between mb1",onMouseEnter:()=>v(l),onMouseLeave:()=>v(void 0),children:[(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsxs)("label",{className:o()("flex fg1 items-start mr2 f6 fw5 lh-copy pointer",(null==u?void 0:u.includes(l))||null===u?"dark-gray":"gray"),style:{flexGrow:1},children:[(0,r.jsx)("input",{className:"pointer mr2 mt1",type:"checkbox",checked:null===u||u.includes(l),onChange:()=>{let e=null===u?m.map(e=>e.column).filter(e=>e!==l):u.includes(l)?u.filter(e=>e!==l):u.concat(l);n({type:"setDataOperations",id:i,operations:{select:{columns:e}}})}}),(0,r.jsxs)("div",{title:t,style:{maxWidth:c?"".concat(c-40,"px"):void 0,overflowX:"hidden",textOverflow:"ellipsis"},children:[t,l!==t?(0,r.jsx)("div",{className:"gray f7 truncate","aria-label":"Original column name for ".concat(t),children:l}):null]})]}),s&&(0,r.jsx)("button",{className:"pointer pa0 bn bg-transparent mr1 gray flex items-center",onClick:()=>{n({type:"setDataOperations",id:i,operations:{select:{columns:(null===u?m.map(e=>e.column):u).filter(e=>e!==l)},derive:null==h?void 0:h.filter(e=>e.name!==l)}})},children:(0,r.jsx)(d.Z,{})})]}),f&&(0,r.jsx)("div",{className:"flex items-center",style:{visibility:g===l?"visible":"hidden"},children:(0,r.jsx)("button",{className:"pointer pa0 bn bg-transparent",onClick:()=>n({type:"setDataOperations",id:i,operations:{select:{columns:[l]}}}),children:"only"})})]},JSON.stringify(e))}):(0,r.jsx)("div",{className:"gray","data-cy":"no-columns",children:"No columns found"}):(0,r.jsx)("div",{className:"w-100 dark-gray",children:(0,r.jsx)(s.Z,{})})})},g=(0,f.$j)((e,t)=>{let{notebook:n}=e,{id:r}=t;return{data:(0,m.DY)(n.model,r).data}},e=>({dispatch:e}))(e=>{let{id:t,data:n,dispatch:i,mobile:o,flash:l,setFlash:s}=e,{operations:{select:{columns:d}}}=n,c=(null==d?void 0:d.length)||0,p=c>0;return(0,r.jsx)(u.Q,{nodeId:t,label:"Columns",active:p,countLabel:String(c),icon:a.Z,flash:l,setFlash:s,mobile:o,operation:"columns",children:o?(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(a.Z,{}),p&&(0,r.jsx)("span",{className:"fw4 ml1",children:c})]}):(0,r.jsx)(ColumnsPopover,{id:t,data:n,dispatch:i})})})},47199:function(e,t,n){"use strict";n.d(t,{c:function(){return FilterPopoverContents},w:function(){return w}});var r=n(85893),i=n(5379),o=n.n(i),l=n(94184),s=n.n(l),a=n(67294),d=n(45285),c=n(10998),u=n(17),p=n(94937),h=n(56065),m=n(28857),f=n(74364),g=n(88903),v=n(71256),y=n(40591),x=n(42962),b=n(60147);let FilterPopover=e=>{let{id:t,dispatch:n,data:i}=e,o=(0,v.vM)(t,i,n);return(0,r.jsx)(g.YI,{className:"bg-white ba b--silver br2 shadow-4 outline-0 pa12","data-cy":"filter-popover",children:(0,r.jsxs)(g.sd,{children:[(0,r.jsx)("div",{className:"gray f7 pb12",children:"Filter"}),(0,r.jsx)(FilterPopoverContents,{id:t,data:i,dispatch:n,schema:o})]})})},FilterPopoverContents=e=>{let{data:t,id:n,dispatch:i,schema:o}=e,{operations:{filter:l}}=t;return(0,r.jsxs)(r.Fragment,{children:[l.map((e,l)=>{var s,a;let d=e.operands[0].value,c={column:d,name:null!==(a=null==o?void 0:null===(s=o.get(d))||void 0===s?void 0:s.name)&&void 0!==a?a:d};return(0,r.jsx)(FilterRow,{id:n,data:t,dispatch:i,schema:o,index:l,filter:e,savedColumn:c},"".concat(JSON.stringify(c)).concat(e.type).concat(JSON.stringify(e.operands)))}),(0,r.jsx)(FilterRow,{id:n,data:t,dispatch:i,schema:o})]})},FilterRow=e=>{let{id:t,data:n,dispatch:i,schema:o,index:l,filter:s,savedColumn:d}=e,[c,u]=(0,a.useState)(d),[p,h]=(0,a.useState)(null==s?void 0:s.type),[f,g]=(0,a.useState)((null==s?void 0:s.operands.length)===2?s.operands[1].value:null==s?void 0:s.operands.slice(1).map(e=>{let{value:t}=e;return t}).join(",")),v=c&&o?o.get(c.column):void 0;function saveFilter(e){let r=[...n.operations.filter];void 0!==l?r[l]=e:(r=[...r,e],u(void 0),h(void 0),g(void 0)),i({type:"setDataOperations",id:t,operations:{filter:r}})}function applyFilter(e,t,n){void 0!==e&&void 0!==t&&((0,x.Ec)(t)?saveFilter({type:t,operands:[{type:"column",value:e}]}):void 0!==n&&((0,x.nq)(t)&&"string"==typeof n?saveFilter({type:t,operands:[{type:"column",value:e},...(0,x.$d)(n,v)]}):saveFilter({type:t,operands:[{type:"column",value:e},(null==v?void 0:v.type)==="date"&&"string"==typeof n?{type:"date",value:n}:{type:"primitive",value:n}]})))}function updateValue(e){g(e),applyFilter(null==c?void 0:c.column,p,e)}return(0,a.useEffect)(()=>{void 0===s&&c&&!v&&(u(void 0),h(void 0),g(void 0))},[s,u,h,g,o,v,c]),(0,r.jsxs)("div",{className:"flex mb2","data-cy":"filter-row",children:[(0,r.jsx)(FilterColumnSelector,{setColumn:e=>{u(e),h((0,x.xm)(null==o?void 0:o.get(e.column))[0]),g(void 0)},selectedColumn:c,schema:o}),(0,r.jsx)(FilterTypeSelector,{type:p,setType:function(e){h(e);let t="nv"===e||"v"===e?null==v?void 0:v.type:f;applyFilter(null==c?void 0:c.column,e,t)},columnSchema:v}),p&&!(0,x.Ec)(p)&&"v"!==p&&"nv"!==p&&v&&("boolean"===v.type?(0,r.jsx)(FilterBooleanSelector,{value:f,setValue:updateValue}):(0,r.jsx)(FilterInput,{inputType:(0,x.nq)(p)?"string":v.type,value:f,setValue:updateValue})),void 0!==l&&(0,r.jsx)("button",{className:"bg-transparent bn light-gray pointer",title:"Remove filter",onClick:()=>{let e=[...n.operations.filter];e.splice(l,1),i({type:"setDataOperations",id:t,operations:{filter:e}})},children:(0,r.jsx)(m.Z,{})})]})},FilterInput=e=>{let{setValue:t,value:n,inputType:i}=e,l="date"===i&&"number"==typeof n?new Date(n).toISOString().split(".")[0]:n,[d,c]=(0,a.useState)(l);function update(e){e!==n&&e.length>0&&t("number"===i||"integer"===i||"bigint"===i?+e:e)}return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("input",{type:"date"===i?"datetime-local":"number"===i||"integer"===i||"bigint"===i?"number":"string",value:null!=d?d:"",onChange:e=>c(e.target.value),onBlur:e=>update(e.target.value),onKeyDown:e=>{"Enter"===e.key&&update(e.currentTarget.value)},className:"jsx-5b87146e697cf4d4 "+(s()("monospace fw6 b--solid ba br2 b--light-gray dark-gray ml2 w-100 flex items-center","date"!==i&&"mw5")||"")}),(0,r.jsx)(o(),{id:"5b87146e697cf4d4",children:"input.jsx-5b87146e697cf4d4::-webkit-calendar-picker-indicator{display:none}"})]})},FilterBooleanSelector=e=>{let{value:t,setValue:n}=e;return(0,r.jsxs)(f.vz,{onChange:e=>n("true"===e),value:void 0!==t?"".concat(t):"",className:"b--solid ba br2 b--light-gray ml2",children:[(0,r.jsxs)(f.Y4,{className:"flex items-center justify-between f6 fw6 dark-gray",children:[(0,r.jsx)("div",{children:!0===t?"True":!1===t?"False":(0,r.jsx)("span",{className:"light-gray",children:"Value"})}),(0,r.jsx)(f.r9,{className:"inline-flex items-center",style:{marginRight:"16px"},children:(0,r.jsx)(c.Z,{})})]}),(0,r.jsx)(f.jI,{className:"absolute",style:{minWidth:"100px"},portal:!1,children:(0,r.jsx)(f.uf,{style:{padding:"12px 0",margin:0},children:["true","false"].map(e=>(0,r.jsxs)(f.wt,{value:e,className:"flex items-center justify-between ph12",children:["true"===e?"True":"False",e==="".concat(t)&&(0,r.jsx)(u.Z,{className:"ml2"})]},"".concat(e)))})})]})},FilterColumnSelector=e=>{var t;let{setColumn:n,selectedColumn:i,schema:o}=e,l=o&&Array.from(o.entries()).map(e=>{let[t,{name:n}]=e;return{column:t,name:n}});return(0,r.jsxs)(f.vz,{onChange:e=>n(JSON.parse(e)),value:JSON.stringify(i)||"",className:"b--solid ba br2 b--light-gray",style:{flexShrink:"0"},children:[(0,r.jsxs)(f.Y4,{className:"flex items-center justify-between f6 fw6 dark-gray",children:[(0,r.jsx)("div",{style:{maxWidth:"150px",overflow:"hidden",textOverflow:"ellipsis"},children:null!==(t=null==i?void 0:i.name)&&void 0!==t?t:(0,r.jsx)("span",{className:"light-gray",children:"Column"})}),(0,r.jsx)(f.r9,{className:"inline-flex items-center",style:{marginRight:"16px"},children:(0,r.jsx)(c.Z,{})})]}),(0,r.jsx)(f.jI,{className:"absolute",style:{minWidth:"100px",maxHeight:"300px"},portal:!1,children:(0,r.jsx)(f.uf,{style:{padding:"12px 0",margin:0},children:l?l.length?l.map(e=>{let{name:t,column:n}=e;return(0,r.jsxs)(f.wt,{value:JSON.stringify(e),className:"flex items-center justify-between ph12",children:[t,(null==i?void 0:i.column)===n&&(0,r.jsx)(u.Z,{className:"ml2"})]},JSON.stringify(e))}):(0,r.jsx)("div",{className:"ph12 gray",children:"No columns found"}):(0,r.jsx)("div",{className:"ph12 dark-gray",children:(0,r.jsx)(h.Z,{})})})})]})},FilterTypeSelector=e=>{var t;let{type:n,setType:i,columnSchema:o}=e,l=(0,x.xm)(o);return(0,r.jsxs)(f.vz,{onChange:e=>i(e),value:null!=n?n:"",disabled:0===l.length,className:"b--solid ba br2 b--light-gray ml2",style:{flexShrink:"0"},children:[(0,r.jsxs)(f.Y4,{className:"flex items-center justify-between f6 fw6 dark-gray",children:[null!==(t=(0,x.a8)(n,null==o?void 0:o.type))&&void 0!==t?t:(0,r.jsx)("span",{className:"light-gray",children:o&&0===l.length?"No filters available":"Operator"}),(0,r.jsx)(f.r9,{className:"inline-flex items-center",style:{marginRight:"16px"},children:(0,r.jsx)(c.Z,{})})]}),(0,r.jsx)(f.jI,{portal:!1,className:"absolute",children:(0,r.jsx)(f.uf,{style:{padding:"12px 0",margin:0},children:l.map(e=>{var t;return(0,r.jsxs)(f.wt,{value:e,className:"flex items-center justify-between ph12",children:[null!==(t=(0,x.a8)(e,null==o?void 0:o.type))&&void 0!==t?t:(0,r.jsx)("span",{className:"light-gray",children:"Operator"}),n===e&&(0,r.jsx)(u.Z,{className:"ml2"})]},e)})})})]})},w=(0,b.$j)((e,t)=>{let{notebook:n}=e,{id:r}=t;return{data:(0,y.DY)(n.model,r).data}},e=>({dispatch:e}))(e=>{let{id:t,data:n,dispatch:i,mobile:o,flash:l,setFlash:s}=e,a=n.operations.filter.length,c=a>0;return(0,r.jsx)(d.Q,{nodeId:t,label:"Filter",active:c,countLabel:String(a),icon:p.Z,flash:l,setFlash:s,mobile:o,operation:"filter",children:o?(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(p.Z,{}),c&&(0,r.jsx)("span",{className:"fw4 ml1",children:a})]}):(0,r.jsx)(FilterPopover,{id:t,data:n,dispatch:i})})})},45285:function(e,t,n){"use strict";n.d(t,{Q:function(){return u}});var r=n(85893),i=n(94184),o=n.n(i),l=n(67294),s=n(88903),a=n(90271),d=n(29020),c=n(60147);let u=(0,c.$j)(e=>{let{notebook:t}=e;return{disabled:t.safe||(0,d.os)(t)}})(e=>{let{nodeId:t,disabled:n,children:i,label:d,active:u,countLabel:p,icon:h,flash:m,setFlash:f,mobile:g,operation:v,...y}=e,x=o()(n?"moon-gray":"dark-gray hover-black",u?"bg-white":"bg-transparent","mr-tiny bn ph2 f6 fw5 pa0 br2 lh-copy pointer flex items-center focus-black-05"),b=(0,c.I0)(),w=(0,l.useRef)(null);return(0,l.useEffect)(()=>{m&&w.current&&(w.current.classList.add("yellow-flash"),setTimeout(()=>{var e;null===(e=w.current)||void 0===e||e.classList.remove("yellow-flash"),null==f||f(!1)},700))},[m,f]),g?(0,r.jsx)("button",{className:x,"data-cy":"".concat(d.toLowerCase(),"-button"),onClick:()=>b({type:"showModal",modal:"tableOperation",modalProps:{id:t,operation:v}}),children:i}):(0,r.jsxs)(s.v2,{children:[(0,r.jsxs)(s.j2,{className:x,style:{minHeight:a.T6-4},disabled:n,"data-cy":"".concat(d.toLowerCase(),"-button"),ref:w,...y,children:[(0,r.jsx)(h,{className:"mr1"}),d,u&&(0,r.jsx)("span",{className:"fw4 ml1 nowrap",children:p})]}),i]})})},46774:function(e,t,n){"use strict";n.d(t,{ck:function(){return SlicePopoverContents},p2:function(){return h}});var r=n(85893),i=n(94184),o=n.n(i),l=n(67294),s=n(73507),a=n(28545),d=n(88903),c=n(45285),u=n(40591),p=n(60147);let SlicePopoverContents=e=>{var t,n;let{data:i,dispatch:o,id:s}=e,{operations:{slice:a}}=i,[d,c]=(0,l.useState)(null!==(t=a.from)&&void 0!==t?t:0),[u,p]=(0,l.useState)(null!==(n=a.to)&&void 0!==n?n:100);function setNodeData(e){o({type:"setDataOperations",id:s,operations:{slice:{...a,...e}}})}return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(SliceInput,{type:"from",nodeDataValue:a.from,normalize:e=>null!==e?e:d,setNodeData:e=>{e.from&&c(e.from),setNodeData(e)},className:"mb3"},"from-".concat(a.from)),(0,r.jsx)(SliceInput,{type:"to",nodeDataValue:a.to,normalize:e=>null!==e?e:u,setNodeData:e=>{e.to&&p(e.to),setNodeData(e)}},"to-".concat(a.to))]})},SliceInput=e=>{let{type:t,nodeDataValue:n,normalize:i,setNodeData:a,className:d}=e,[c,u]=(0,l.useState)(i(n));function update(e){0===e.length?u(i(n)):a({[t]:parseInt(e)})}return(0,r.jsxs)("div",{className:o()("fw6 near-black",d),style:{display:"grid",gridTemplateColumns:"1.25fr 2fr 1fr"},children:[(0,r.jsx)("div",{className:"flex items-center lh-copy",children:"to"===t?"To":"From"}),(0,r.jsxs)("div",{className:"flex items-center pr2",children:[(0,r.jsx)(s.E,{className:"flex items-center",checked:null!==n,onChange:()=>a({[t]:c})}),(0,r.jsx)("input",{type:"number",min:0,className:o()("monospace fw6 b--solid ba br2 b--light-gray",null===n?"gray":"dark-gray"),style:{width:"6rem"},value:c,disabled:null===n,onChange:e=>u(e.target.value),onBlur:e=>update(e.target.value),onKeyDown:e=>{"Enter"===e.key&&update(e.currentTarget.value)}})]}),(0,r.jsx)(s.E,{label:"to"===t?"End":"Start",className:"flex items-center",checked:null===n,onChange:()=>a({[t]:null})})]})},h=(0,p.$j)((e,t)=>{let{notebook:n}=e,{id:r}=t;return{data:(0,u.DY)(n.model,r).data}},e=>({dispatch:e}))(e=>{var t,n,i,o;let{id:l,data:s,dispatch:u,mobile:p}=e,{operations:{slice:h}}=s,m=null!==h.from||null!==h.to;return(0,r.jsx)(c.Q,{nodeId:l,label:"Slice",active:m,countLabel:"".concat(null!==(t=h.from)&&void 0!==t?t:0,"–").concat(null!==(n=h.to)&&void 0!==n?n:"End"),icon:a.Z,mobile:p,operation:"slice",children:p?(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(a.Z,{}),m&&(0,r.jsxs)("span",{className:"fw4 ml1 nowrap",children:["[",null!==(i=h.from)&&void 0!==i?i:0,", ",null!==(o=h.to)&&void 0!==o?o:"End","]"]})]}):(0,r.jsx)(d.YI,{className:"bg-white ba b--silver br2 shadow-4 outline-0 pa12 overflow-auto","data-cy":"slice-popover",children:(0,r.jsxs)(d.sd,{children:[(0,r.jsx)("div",{className:"gray f7 pb12",children:"Slice"}),(0,r.jsx)(SlicePopoverContents,{data:s,dispatch:u,id:l})]})})})})},1925:function(e,t,n){"use strict";n.d(t,{PE:function(){return y},dE:function(){return SortPopoverContents}});var r=n(85893),i=n(94184),o=n.n(i),l=n(67294),s=n(10998),a=n(17),d=n(56065),c=n(18992),sortDescending=e=>(0,r.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",...e,children:[(0,r.jsx)("rect",{x:"2",y:"11",width:"3",height:"2",rx:"1",fill:"currentColor"}),(0,r.jsx)("rect",{x:"2",y:"2",width:"12",height:"2",rx:"1",fill:"currentColor"}),(0,r.jsx)("rect",{x:"2",y:"5",width:"9",height:"2",rx:"1",fill:"currentColor"}),(0,r.jsx)("rect",{x:"2",y:"8",width:"6",height:"2",rx:"1",fill:"currentColor"})]}),u=n(28857),p=n(74364),h=n(88903),m=n(45285),f=n(71256),g=n(40591),v=n(60147);let SortPopover=e=>{let{id:t,dispatch:n,data:i}=e,o=(0,f.vM)(t,i,n);return(0,r.jsx)(h.YI,{className:"bg-white ba b--silver br2 shadow-4 outline-0 pa12","data-cy":"sort-popover",children:(0,r.jsxs)(h.sd,{children:[(0,r.jsx)("div",{className:"gray f7 pb12",children:"Sort"}),(0,r.jsx)(SortPopoverContents,{id:t,data:i,dispatch:n,schema:o})]})})},SortPopoverContents=e=>{let{id:t,data:n,dispatch:i,schema:o}=e,{operations:{sort:l}}=n;return(0,r.jsxs)(r.Fragment,{children:[l.map((e,l)=>{var s,a;let{column:d,direction:c}=e,u={column:d,name:null!==(a=null==o?void 0:null===(s=o.get(d))||void 0===s?void 0:s.name)&&void 0!==a?a:d};return(0,r.jsx)(SortRow,{index:l,id:t,data:n,dispatch:i,schema:o,savedColumn:u,savedDirection:c},"".concat(JSON.stringify(u),".").concat(c))}),(0,r.jsx)("div",{className:"flex",children:(0,r.jsx)(SortRow,{id:t,data:n,dispatch:i,schema:o})})]})},SortRow=e=>{let{id:t,data:n,dispatch:i,index:o,schema:d,savedColumn:h,savedDirection:m}=e,[f,g]=(0,l.useState)(h),[v,y]=(0,l.useState)(m);function updateSort(e,r){let l={column:e,direction:r};if(void 0!==o){let e=[...n.operations.sort];e[o]=l,i({type:"setDataOperations",id:t,operations:{sort:e}})}else i({type:"setDataOperations",id:t,operations:{sort:[...n.operations.sort,l]}}),g(void 0),y(void 0)}return(0,r.jsxs)("div",{className:"flex mb2","data-cy":"sort-row",children:[(0,r.jsxs)(p.vz,{onChange:e=>{let t=JSON.parse(e),{column:n}=t;g(t),void 0!==v&&updateSort(n,v)},value:JSON.stringify(f)||"",className:"b--solid ba br2 b--light-gray",children:[(0,r.jsxs)(p.Y4,{className:"flex items-center justify-between f6 fw6 dark-gray",children:[(0,r.jsx)("div",{style:{maxWidth:"150px",overflow:"hidden",textOverflow:"ellipsis"},children:void 0===f?(0,r.jsx)("span",{className:"light-gray",children:"Column"}):f.name}),(0,r.jsx)(p.r9,{className:"inline-flex items-center",style:{marginRight:"16px"},children:(0,r.jsx)(s.Z,{})})]}),(0,r.jsx)(SortColumnPopover,{data:n,schema:d,selectedColumn:f})]}),(0,r.jsxs)(p.vz,{onChange:e=>{if(y(e),void 0!==f){let{column:t}=f;updateSort(t,e)}},value:v||"",className:"b--solid ba br2 b--light-gray ml2",children:[(0,r.jsxs)(p.Y4,{className:"flex items-center justify-between f6 fw6 dark-gray",children:[void 0===v?(0,r.jsx)("span",{className:"light-gray",children:"Direction"}):"asc"===v?(0,r.jsxs)("div",{className:"inline-flex items-center",children:[(0,r.jsx)(c.Z,{className:"mr1"}),"Ascending"]}):(0,r.jsxs)("div",{className:"inline-flex items-center",children:[(0,r.jsx)(sortDescending,{className:"mr1"}),"Descending"]}),(0,r.jsx)(p.r9,{className:"inline-flex items-center",style:{marginRight:"16px"},children:(0,r.jsx)(s.Z,{})})]}),(0,r.jsx)(p.jI,{portal:!1,className:"absolute",children:(0,r.jsx)(p.uf,{style:{padding:"12px 0",margin:0},children:["desc","asc"].map((e,t)=>(0,r.jsxs)(p.wt,{value:e,className:"flex items-center justify-between ph12",style:1===t?{marginBottom:0}:{},children:["asc"===e?(0,r.jsxs)("div",{className:"inline-flex items-center",children:[(0,r.jsx)(c.Z,{className:"mr1"}),"Ascending"]}):(0,r.jsxs)("div",{className:"inline-flex items-center",children:[(0,r.jsx)(sortDescending,{className:"mr1"}),"Descending"]}),v===e&&(0,r.jsx)(a.Z,{className:"ml2"})]},e))})})]}),void 0!==o&&(0,r.jsx)("button",{disabled:void 0===f,className:"bg-transparent bn light-gray pointer",onClick:()=>{let e=[...n.operations.sort];e.splice(o,1),i({type:"setDataOperations",id:t,operations:{sort:e}})},children:(0,r.jsx)(u.Z,{})})]},JSON.stringify(f))},SortColumnPopover=e=>{let{data:t,schema:n,selectedColumn:i}=e,s=n&&Array.from(n.entries()).map(e=>{let[t,{name:n}]=e;return{column:t,name:n}}),c=(0,l.useCallback)(e=>t.operations.sort.some(t=>{let{column:n}=t;return n===e}),[t.operations.sort]);return(0,r.jsx)(p.jI,{className:"absolute",style:{minWidth:"100px",maxHeight:"300px"},portal:!1,children:(0,r.jsx)(p.uf,{style:{padding:"12px 0",margin:0},children:s?s.length?s.map(e=>{let{column:t,name:n}=e;return(0,r.jsxs)(p.wt,{value:JSON.stringify(e),disabled:c(t),className:o()("flex items-center justify-between ph12",c(t)&&(null==i?void 0:i.column)!==t?"light-gray":""),children:[n,(null==i?void 0:i.column)===t&&(0,r.jsx)(a.Z,{className:"ml2"})]},JSON.stringify(e))}):(0,r.jsx)("div",{className:"ph12 gray",children:"No columns found"}):(0,r.jsx)("div",{className:"ph12 dark-gray",children:(0,r.jsx)(d.Z,{})})})})},y=(0,v.$j)((e,t)=>{let{notebook:n}=e,{id:r}=t;return{data:(0,g.DY)(n.model,r).data}},e=>({dispatch:e}))(e=>{let{id:t,data:n,dispatch:i,mobile:o,flash:l,setFlash:s}=e,a=n.operations.sort.length,d=a>0;return(0,r.jsx)(m.Q,{nodeId:t,label:"Sort",active:d,countLabel:String(a),icon:c.Z,flash:l,setFlash:s,mobile:o,operation:"sort",children:o?(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(c.Z,{}),d&&(0,r.jsx)("span",{className:"fw4 ml1",children:a})]}):(0,r.jsx)(SortPopover,{id:t,data:n,dispatch:i})})})},14255:function(e,t,n){"use strict";n.d(t,{q:function(){return Time}});var r=n(85893),i=n(67294),o=n(76284),l=n(17596),s=n(4293);let Time=e=>{let{time:t,absolute:n,numeric:a,precision:d,...c}=e,u=(0,l.L)(t),p=(0,o.d)((0,i.useCallback)(()=>t.toLocaleString("en"),[t]));return(0,r.jsx)("span",{title:p,...c,suppressHydrationWarning:!0,children:n?a?(0,s.WB)(t):(0,s.p6)(t):d?(0,s.aP)(t,u,d):(0,s.lY)(t,u)})}},6359:function(e,t,n){"use strict";n.d(t,{FJ:function(){return DataSourceInfoTask},Y2:function(){return DatabaseSchemaTask},YG:function(){return DatabaseInfoTask},n4:function(){return TableSchemaTask},zL:function(){return QueryTemplateTask}});var r=n(4640),i=n(42962);let DatabaseSchemaTask=class DatabaseSchemaTask extends r.i{async process(e){let t=await e({type:"request_database_tables",source:this._source,schema:this._schema});return t.map(e=>({database:null!=e.database?String(e.database):void 0,schema:null!=e.schema?String(e.schema):void 0,table:String(e.name)}))}constructor(e,t){super(),this._source=e,this._schema=t}};let TableSchemaTask=class TableSchemaTask extends r.i{async process(e){let t=await e({type:"request_table_schema",source:this._source,table:(0,i.me)(this._table),mode:this._mode,node_id:this._id,derive:this._derive});return new Map(t.map(e=>{var t,n,r,i;let o=null===(t=this._names)||void 0===t?void 0:t.find(t=>{let{name:n}=t;return n===e.name}),l=null===(n=this._types)||void 0===n?void 0:n.find(t=>{let{name:n}=t;return n===e.name});return[null!==(r=null==o?void 0:o.column)&&void 0!==r?r:e.name,{type:null!==(i=null==l?void 0:l.type)&&void 0!==i?i:e.type,databaseType:e.databaseType,nullable:!1!==e.nullable,name:e.name}]}))}constructor(e,t,n,r,i,o,l){super(),this._source=e,this._table=t,this._mode=n,this._names=r,this._types=i,this._id=o,this._derive=l}};let QueryTemplateTask=class QueryTemplateTask extends r.i{async process(e){let t=await e({type:"request_database_query",source:this._source,operations:this._operations});return t}constructor(e,t){super(),this._source=e,this._operations=t}};let DatabaseInfoTask=class DatabaseInfoTask extends r.i{async process(e){let t=await e({type:"request_database_info",source:this._source});return t}constructor(e){super(),this._source=e}};let DataSourceInfoTask=class DataSourceInfoTask extends r.i{async process(e){let t=await e({type:"request_data_source_info",source:this._source});return t}constructor(e){super(),this._source=e}}},4640:function(e,t,n){"use strict";n.d(t,{S:function(){return WorkerChannelTask},i:function(){return WorkerTask}});let WorkerTask=class WorkerTask{run(e){return this._promise||(this._promise=new Promise((e,t)=>{this.resolve=e,this.reject=t}),e({type:"workerTask",task:this})),this._promise}};let WorkerChannelTask=class WorkerChannelTask extends WorkerTask{process(e){let t;let n=[];function fulfilled(e){n.push({message:e}),t&&(t(),t=void 0)}function rejected(e){n.push({error:e}),t&&(t(),t=void 0)}return this.open(t=>e(t,fulfilled,rejected),()=>({[Symbol.asyncIterator](){return this},async next(){n.length||await new Promise(e=>t=e);let e=n.shift();if("error"in e)throw Error(e.error);return e.message}}))}constructor(e){super(),this.open=e}}},63343:function(e,t,n){"use strict";n.d(t,{_:function(){return useDragCells}});var r=n(67294);let i=0,o=null;function autoscroll_scroll(){o=requestAnimationFrame(autoscroll_scroll),scrollBy(0,i)}function autoscroll(e){(i=Math.min(0,e-20)||Math.max(0,e-innerHeight+20))&&!o?o=requestAnimationFrame(autoscroll_scroll):o&&!i&&(cancelAnimationFrame(o),o=null)}var l=n(99368);function useDragCells(e,t,n,i,o,s,a,d){let[c,u]=(0,r.useState)(!1);return(0,r.useEffect)(()=>{let r;let c=t.current,p=navigator.maxTouchPoints||"ontouchstart"in c,h=!1,m=!1,f=NaN,g=NaN;function pointerdown(e){e.ctrlKey||e.button||!e.isPrimary||!i||o||((r=e.target).setPointerCapture(e.pointerId),c.style.cursor="grabbing",m=void 0,h=!0,f=e.clientX,g=e.clientY)}function pointermove(i){let o;if(!h||!i.isPrimary)return;let{clientX:l,clientY:p}=i;if(void 0===m){if(l-f>20){c.style.cursor="",r.releasePointerCapture(i.pointerId),r=void 0,m=!1;return}Math.abs(p-g)>20&&(m=!0,s({type:"dragStarted",id:e}),u(!0),(null==n?void 0:n.current)&&t.current&&t.current.dispatchEvent(new MouseEvent("mousedown",{bubbles:!0})))}if(!m)return;let v=c.closest(".".concat(d));for(;o=function(e,t,n){for(n=n?n.nextElementSibling:t.firstElementChild;n&&!n.classList.contains(e);)n=n.nextElementSibling;return n||null}(a,v,o);){let e=o.getBoundingClientRect();if((e.top+e.bottom)/2>p)break}s({type:"dragged",id:o?+o.dataset.nodeId:null}),autoscroll(p)}function pointerup(e){e.isPrimary&&(r&&(r.releasePointerCapture(e.pointerId),r=void 0,c.style.cursor=""),m&&(s({type:"dragEnded"}),u(!1)),autoscroll(NaN),m=!1,h=!1)}return p&&c.addEventListener("touchmove",l.PF),c.addEventListener("pointerdown",pointerdown),c.addEventListener("pointermove",pointermove),c.addEventListener("pointerup",pointerup),c.addEventListener("pointercancel",pointerup),c.addEventListener("lostpointercapture",pointerup),()=>{p&&c.removeEventListener("touchmove",l.PF),c.removeEventListener("pointerdown",pointerdown),c.removeEventListener("pointermove",pointermove),c.removeEventListener("pointerup",pointerup),c.removeEventListener("pointercancel",pointerup),c.removeEventListener("lostpointercapture",pointerup)}},[s,i,o,t,u,n,d,a,e]),[c,u]}},71256:function(e,t,n){"use strict";n.d(t,{Nq:function(){return useChartSchemaTask},pN:function(){return useSchemaTask},vM:function(){return useTableSchemaTask}});var r=n(27522),i=n(80583),o=n(67294),l=n(6359),s=n(32007);function useTableSchemaTask(e,t,n){let{isExpanded:r}=(0,i.uF)();return useSchemaTask(t,n,"table",r,e)}function useChartSchemaTask(e,t){let{isExpanded:n}=(0,r.kR)();return useSchemaTask(e,t,"chart",n)}function useSchemaTask(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"table",r=!(arguments.length>3)||void 0===arguments[3]||arguments[3],i=arguments.length>4?arguments[4]:void 0,[a,d]=(0,o.useState)(),c=(0,o.useRef)(),u=(0,s.VQ)(e),p="operations"in e?e.operations.from.table:"",h="operations"in e?e.operations.names:void 0,m="operations"in e?e.operations.types:void 0,f="operations"in e?e.operations.derive:void 0;return(0,o.useEffect)(()=>d(void 0),[u,p]),(0,o.useEffect)(()=>{if(!r)return;if(!u||"sql"===n)return d(new Map);let e=new l.n4(u,p,n,h,m,i,f);return c.current=e,e.run(t).then(t=>{e===c.current&&d(t)},t=>{e===c.current&&(console.error("Error fetching table schema: ",t),d(new Map))}),()=>{c.current=void 0}},[u,p,t,n,r,h,m,i,f]),a}},64580:function(e,t,n){"use strict";n.d(t,{Ob:function(){return d},Up:function(){return s},eu:function(){return namedSnippet},gT:function(){return l},mH:function(){return a}});var r=n(34790),i=n(61091),o=n(85623);let l={PLOT_BAR:'Plot.plot({\n	marks: [\n		Plot.barY(${alphabet}, {x: "${letter}", y: "${frequency}", sort: {x: "y", reverse: true}}),\n		Plot.ruleY([0])\n	]\n})',PLOT_BAR_HORIZONTAL:'Plot.plot({\n	marks: [\n		Plot.barX(${alphabet}, {x: "${frequency}", y: "${letter}", sort: {y: "x", reverse: true}}),\n		Plot.ruleX([0])\n	]\n})',PLOT_BAR_TEMPORAL:'Plot.plot({\n	marks: [\n		Plot.rectY(${weather.slice(-42)}, {x: "${date}", y: "${wind}", interval: ${d3.utcDay}}),\n		Plot.ruleY([0])\n	]\n})',PLOT_LINE:'Plot.plot({\n	marks: [\n		Plot.ruleY([0]),\n		Plot.lineY(${aapl}, {x: "${Date}", y: "${Close}"})\n	]\n})',PLOT_LINE_SCATTER:'Plot.plot({\n	marks: [\n		Plot.dot(${cars}, {x: "${power (hp)}", y: "${economy (mpg)}"})\n	]\n})',PLOT_MOVING_AVERAGE:'Plot.plot({\n	marks: [\n		Plot.ruleY([0]),\n		Plot.lineY(${1:aapl}, Plot.windowY({x: "${2:Date}", y: "${3:Close}", k: ${4:10}, reduce: "mean"}))\n	]\n})',PLOT_MULTI_SERIES_LINE:'Plot.plot({\n	marks: [\n		Plot.ruleY([0]),\n		Plot.lineY(${industries}, {x: "${date}", y: "${unemployed}", z: "${industry}"})\n	]\n})',PLOT_HISTOGRAM:'Plot.plot({\n	marks: [\n		Plot.rectY(${olympians}, Plot.binX({y: "count"}, {x: "${weight}"})),\n		Plot.ruleY([0])\n	]\n})',PLOT_FACETED:'Plot.plot({\n	facet: {\n		data: ${penguins},\n		x: "${species}"\n	},\n	marks: [\n		Plot.frame(),\n		Plot.dot(${penguins}, {x: "${culmen_length_mm}", y: "${culmen_depth_mm}"})\n	]\n})',PLOT_CELL:'Plot.plot({\n	marks: [\n		Plot.cell(${weather.slice(-365)}, {\n			x: ${d => d.date.getUTCDate()},\n			y: ${d => d.date.getUTCMonth()},\n			fill: "${temp_max}"\n		})\n	]\n})',PLOT_BOX:'Plot.plot({\n	marks: [\n		Plot.boxX(${olympians}, {x: "${weight}", y: "${sport}", sort: {y: "x"}})\n	]\n})',PLOT_ARROW:'Plot.plot({\n	x: {\n		type: "log"\n	},\n	marks: [\n		Plot.arrow(${citywages}, {\n			x1: "${POP_1980}",\n			y1: "${R90_10_1980}",\n			x2: "${POP_2015}",\n			y2: "${R90_10_2015}",\n			bend: true\n		})\n	]\n})',PLOT_TOP10_BAR_WEIGHTED:'Plot.plot({\n	marks: [\n		Plot.barX(${olympians}, Plot.groupY({x: "sum"}, {x: "${gold}", y: "${nationality}", sort: {y: "x", reverse: true, limit: 10}})),\n		Plot.ruleX([0])\n	]\n})',PLOT_AREA:'Plot.plot({\n	marks: [\n		Plot.areaY(${aapl}, {x: "${Date}", y: "${Close}"}),\n		Plot.ruleY([0])\n	]\n})',PLOT_AREA_BAND:'Plot.plot({\n	marks: [\n		Plot.areaY(${weather.slice(-365)}, {x: "${date}", y1: "${temp_min}", y2: "${temp_max}", curve: "step"})\n	]\n})',PLOT_AREA_STACKED:'Plot.plot({\n	y: {\n		tickFormat: "s"\n	},\n	marks: [\n		Plot.areaY(${industries}, {x: "${date}", y: "${unemployed}", fill: "${industry}"}),\n		Plot.ruleY([0])\n	]\n})',PLOT_TICK:'Plot.plot({\n	marks: [\n		Plot.tickX(${cars}, {x: "${economy (mpg)}", y: "${year}"})\n	]\n})',PLOT_TOP10_BAR:'Plot.plot({\n	marks: [\n		Plot.barX(${olympians}, Plot.groupY({x: "count"}, {y: "${nationality}", sort: {y: "x", reverse: true, limit: 10}})),\n		Plot.ruleX([0])\n	]\n})',PLOT_LINEAR_REGRESSION:'Plot.plot({\n	marks: [\n		Plot.linearRegressionY(${penguins}, {x: "${culmen_length_mm}", y: "${culmen_depth_mm}", stroke: "${species}"})\n	]\n})',PLOT_HEXBIN:'Plot.plot({\n	color: {\n		scheme: "ylgnbu"\n	},\n	marks: [\n		Plot.hexagon(${olympians}, Plot.hexbin({fill: "sum"}, {x: "${weight}", y: "${height}"}))\n	]\n})',PLOT_BEESWARM:'Plot.plot({\n	height: 180,\n	marks: [\n		Plot.dot(${cars}, Plot.dodgeY({x: "${weight (lb)}"}))\n	]\n})',PLOT_VORONOI:'Plot.plot({\n	marks: [\n		Plot.voronoi(${penguins}, {x: "${culmen_depth_mm}", y: "${culmen_length_mm}", fill: "${species}", stroke: "white"})\n	]\n})',PLOT_DENSITY_CONTOUR:'Plot.plot({\n	marks: [\n		Plot.density(${cars}, { x: "${power (hp)}", y: "${economy (mpg)}" })\n	]\n})',IMPORT_NOTEBOOK_CELL:'import {${cell}} from "@${user}/${notebook}"',IMPORT_NOTEBOOK_LIBRARY:'${library} = import("https://cdn.skypack.dev/${library}@${version}")',IMPORT_REQUIRE_LIBRARY:'${library} = require("${library}@${version}")'},s={INPUT_BUTTON:namedSnippet(e=>"viewof #{".concat(e("button"),'} = Inputs.button("#{Click me}")')),INPUT_TOGGLE:namedSnippet(e=>"viewof #{".concat(e("toggle"),'} = Inputs.toggle({label: "#{Active}", value: #{true}})')),INPUT_RADIO:namedSnippet(e=>"viewof #{".concat(e("radios"),'} = Inputs.radio(#{["A", "B"]}, {label: "#{Select one}", value: "#{A}"})')),INPUT_SELECT:namedSnippet(e=>"viewof #{".concat(e("select"),'} = Inputs.select(#{["A", "B"]}, {label: "#{Select one}"})')),INPUT_RANGE:namedSnippet(e=>"viewof #{1:".concat(e("range"),'} = Inputs.range([#{2:0}, #{3:100}], {label: "#{Amount}", step: #{4:1}})')),INPUT_DATE:namedSnippet(e=>"viewof #{".concat(e("date"),'} = Inputs.date({label: "#{Date}", value: "#{').concat(new Date().toISOString().slice(0,10),'}"})')),INPUT_CHECKBOX:namedSnippet(e=>"viewof #{".concat(e("checkboxes"),'} = Inputs.checkbox(#{["A", "B"]}, {label: "#{Select some}", value: [#{"A"}]})')),INPUT_TABLE:namedSnippet(e=>"viewof #{".concat(e("table"),"} = Inputs.table(#{cars})")),INPUT_TEXT:namedSnippet(e=>"viewof #{".concat(e("text"),'} = Inputs.text({label: "#{Name}"})')),INPUT_TEXTAREA:namedSnippet(e=>"viewof #{".concat(e("textarea"),'} = Inputs.textarea({label: "#{Description}"})')),INPUT_COLOR:namedSnippet(e=>"viewof #{".concat(e("color"),'} = Inputs.color({label: "#{Favorite color}", value: "#{#4682b4}"})')),INPUT_FILE:namedSnippet(e=>"viewof #{".concat(e("file"),'} = Inputs.file({label: "Data"})')),INPUT_SEARCH:namedSnippet(e=>"viewof #{".concat(e("search"),"} = Inputs.search(#{cars})")),INPUT_FORM:namedSnippet(e=>"viewof #{".concat(e("form"),'} = Inputs.form({\n	#{option1}: Inputs.checkbox([#{"A", "B"}], {label: "#{Select some}"}),\n	#{option2}: Inputs.range([#{0, 100}], {label: "#{Amount}", step: 1}),\n	#{option3}: Inputs.radio([#{"A", "B"}], {label: "#{Select one}"}),\n	#{option4}: Inputs.select([#{"A", "B"}], {label: "#{Select one}"})\n})'))},a={TABLE:{label:"Table",text:"| name   | quantity |\n| ------ | -------- |\n| apples | 12       |\n| pears  | 34       |"}},d={apply:namedSnippet(e=>"#{".concat(e("data"),'} = fetch("#{https://api.weather.gov/gridpoints/OKX/33,37/forecast}").then((response) => response.json())'))};function namedSnippet(e){return(t,n,l,s)=>{let a=t.state.field(o.rr);(0,r.DB)(e(e=>(0,i.Q)(e,a)))(t,n,l,s)}}},32007:function(e,t,n){"use strict";n.d(t,{M7:function(){return requireSource},Ov:function(){return parseDialect},U_:function(){return isSameSource},VQ:function(){return optionalSource},VS:function(){return formatTableKey},h8:function(){return parseSqlDialect},hS:function(){return formatDataSourceTableKey},w4:function(){return formatDialect},x2:function(){return formatDataSourceKey},zO:function(){return compareSource}});var r=n(41269);function optionalSource(e){if(!("source"in e))throw Error("missing source");let{source:t}=e;return null===t.name?null:t}function requireSource(e){let t=optionalSource(e);if(null===t)throw Error("empty source");return t}function formatDialect(e){switch(e){case"sql":return"SQL";case"postgres":return"PostgreSQL";case"sqlite":return"SQLite";case"bigquery":return"BigQuery";case"snowflake":return"Snowflake";case"oracle":return"Oracle";case"mysql":return"MySQL";case"mssql":return"SQL Server";case"duckdb":return"DuckDB";case"csv":return"CSV";case"tsv":return"TSV";case"json":return"JSON";case"arrow":return"Arrow";case"parquet":return"Parquet";case"arquero":return"Arquero";case"databricks":return"Databricks";case"mongosql":return"MongoDB";default:return e}}function isSameSource(e,t){return e.name===t.name&&e.type===t.type}function compareSource(e,t){var n,r;return(n=e.name)<(r=t.name)?-1:n>r?1:0}function parseDialect(e){return(0,r.yD)(e)?e:parseSqlDialect(e)}function parseSqlDialect(e){return r.RN.includes(e)?e:"sql"}function formatDataSourceKey(e){return"".concat(e.type,":").concat(e.name)}function formatDataSourceTableKey(e,t){return JSON.stringify([formatDataSourceKey(e),formatTableKey(t)])}function formatTableKey(e){let{database:t,schema:n,table:r}=e;return t?"".concat(t,".").concat(n,".").concat(r):n?"".concat(n,".").concat(r):r}},79941:function(e,t,n){"use strict";n.d(t,{BY:function(){return getUpstreamMap},Do:function(){return getRelationship},E6:function(){return getConnections},_n:function(){return getDownstreamMap},mD:function(){return getDescendants}});var r=n(41312);function*getEdges(e){let t=new Map;for(let n of e)for(let e of(0,r.WN)(n))t.set(e,t.has(e)?null:n);for(let n of e)for(let e of(0,r.yL)(n)){let r=t.get(e);r&&(yield[n,r])}}let getUpstreamMap=e=>getMap(e,!1),getDownstreamMap=e=>getMap(e,!0),i=new WeakMap,o=new WeakMap;function getMap(e,t){let n=t?i:o,r=n.get(e);if(r)return r;let l=new Map;for(let t of e)l.set(t,[]);if(t)for(let[t,n]of getEdges(e))l.get(n).push(t);else for(let[t,n]of getEdges(e))l.get(t).push(n);return n.set(e,l),l}function getDescendants(e,t){let n=new Set().add(e);for(let e of n)for(let r of t.get(e))n.add(r);return n.delete(e),n}function getConnections(e){let t=getDownstreamMap(e),n=getUpstreamMap(e);return new Map(e.map(e=>{let i=n.get(e)||[],o=t.get(e)||[];return[e,{node:e,up:i,down:o,indirectUp:getDescendants(e,n),indirectDown:getDescendants(e,t),isIsland:!i.length&&!o.length&&!(0,r.q8)(e)}]}))}function getRelationship(e,t){return e.node===t.node?"same":t.indirectDown.has(e.node)&&t.indirectUp.has(e.node)?"circular":t.down.includes(e.node)?"direct downstream":t.up.includes(e.node)?"direct upstream":t.indirectDown.has(e.node)?"indirect downstream":t.indirectUp.has(e.node)?"indirect upstream":"none"}},78756:function(e,t,n){"use strict";n.d(t,{I:function(){return i},w:function(){return hasNonDisplayData}});var r=n(28174);function hasNonDisplayData(e){if(!e)return!1;for(let t in e)if("display"!==t)return!0;return!1}let i=(0,r.J)(()=>({type:"workerStatus",displayModes:new Map,statuses:new Map,suggestions:new Map,chartSpecs:new Map}))},87480:function(e,t,n){"use strict";function download(e,t){let n=URL.createObjectURL(e);downloadUrl(n,t),URL.revokeObjectURL(n)}function downloadUrl(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=document.createElement("a");n.style.display="none",n.href=e,n.download=t,document.body.appendChild(n),n.click(),n.remove()}n.d(t,{G:function(){return downloadUrl},L:function(){return download}})},40591:function(e,t,n){"use strict";n.d(t,{$g:function(){return findNodeIndex},DY:function(){return findNode},o4:function(){return findNextNodeId},t$:function(){return findPreviousNodeId}});let r=new WeakMap;function findNode(e,t){return e.nodes[findNodeIndex(e,t)]}function findNodeIndex(e,t){let n=r.get(e.nodes);void 0===n&&(n=new Map(e.nodes.map((e,t)=>[e.id,t])),r.set(e.nodes,n));let i=n.get(t);return void 0===i?-1:i}function findNextNodeId(e,t){let n=findNodeIndex(e,t);return n<e.nodes.length-1?e.nodes[n+1].id:null}function findPreviousNodeId(e,t){let n=findNodeIndex(e,t);return n>0?e.nodes[n-1].id:null}},36869:function(e,t,n){"use strict";n.d(t,{v:function(){return fuzzyMatcher}});let r={test:()=>!1,matches:()=>[]};let FuzzyMatcherImpl=class FuzzyMatcherImpl{test(e){if(!e)return!1;let t=0;for(let n of this.terms){if(n.lastIndex=t,!n.test(e))return this.fallback.test(e);t=n.lastIndex}return!0}matches(e){let t=this.fallback.matches(e);if(!e)return t;let n=0;for(let r of this.terms){r.lastIndex=n;let i=r.exec(e);if(!i)continue;let o=i.index+i[1].length,l=o+i[2].length;t.push([o,l]),n=r.lastIndex}return t}constructor({terms:e=[],strict:t=!1,fallback:n=r}){this.terms=e,this.strict=t,this.fallback=n}};function termRegExp(e,t){return new RegExp("(^|[^\\p{L}])(".concat(e.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),")"),t)}function fuzzyMatcher(e){let{allowAcronyms:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=String(e).split(/\s+/g).filter(e=>e).map(e=>termRegExp(e,"iu"));return new FuzzyMatcherImpl({terms:n,fallback:1===n.length&&t?new FuzzyMatcherImpl({terms:Array.from(String(e).replace(/\s+/g,""),e=>termRegExp(e,"iug")),strict:!0}):void 0})}},68404:function(e,t,n){"use strict";n.d(t,{Gv:function(){return outputHeight},hY:function(){return totalHeight},jn:function(){return heightObserver},qX:function(){return i}});var r=n(28174);function outputHeight(e){return e?e.worker+e.display:0}function totalHeight(e){let t=0;for(let{total:n}of e.values())t+=n;return t}function heightObserver(e,t,n,r){let o=0,l=new ResizeObserver(e=>{let[l]=e,s=l.contentRect.height;s!==o&&(o=s,i(r,e=>{let{heights:r}=e;return r.push({type:n,id:t,height:o})}))});return l.observe(e),{disconnect(){l.disconnect(),0!==o&&(o=0,i(r,e=>{let{heights:r}=e;return r.push({type:n,id:t,height:o})}))}}}let i=(0,r.J)(()=>({type:"cellHeight",heights:[]}))},90271:function(e,t,n){"use strict";n.d(t,{KI:function(){return a},Lv:function(){return r},MT:function(){return i},Mv:function(){return s},NQ:function(){return d},Sf:function(){return u},T6:function(){return c},dL:function(){return m},j:function(){return o},j$:function(){return h},l6:function(){return l},re:function(){return p},xe:function(){return f}});let r=64,i=52,o=386,l=280,s=14,a=17,d=25,c=29,u=41,p=20,h=4,m=36,f=100},50809:function(e,t,n){"use strict";n.d(t,{C9:function(){return V},mD:function(){return B},Zn:function(){return Z},_t:function(){return $},KH:function(){return F},bd:function(){return O},$T:function(){return insert}});var r=n(34790),i=n(78120),o=n(33083),l=n(64580),s=n(17492),a=n(41888),d=n(85893),c=n(35512);let u=[{...l.mH.TABLE,description:"Content in rows and columns",wrap:s.Y_}].map(e=>{let{text:t,label:n,description:i,wrap:o=e=>e}=e;return{apply:o((0,r.DB)(t)),label:(0,s.b2)(n),description:i,type:c.JY.Snippet,boost:c.UW.Snippet,detail:c.$d.Markdown,origin:"mdSnippets"}}),p=[{text:l.gT.PLOT_BAR,dashboardText:'Plot.plot({\n	width,\n	marks: [\n		Plot.barY(${alphabet}, {x: "${letter}", y: "${frequency}", sort: {x: "y", reverse: true}}),\n		Plot.ruleY([0])\n	]\n})',label:"Bar",description:"Values by height in categories",keywords:["chart","graph"],thumbnail:e=>(0,d.jsxs)("svg",{width:"28",height:"16",viewBox:"0 0 28 16",fill:"none",...e,children:[(0,d.jsx)("path",{d:"M10 6H4V15H10V6Z",fill:"#6E6E6E"}),(0,d.jsx)("path",{d:"M17 9H11V15H17V9Z",fill:"#6E6E6E"}),(0,d.jsx)("path",{d:"M24 1H18V15H24V1Z",fill:"#6E6E6E"})]})},{text:l.gT.PLOT_BAR_HORIZONTAL,dashboardText:'Plot.plot({\n	width,\n	marks: [\n		Plot.barX(${alphabet}, {x: "${frequency}", y: "${letter}", sort: {y: "x", reverse: true}}),\n		Plot.ruleX([0])\n	]\n})',label:"Bar (horizontal)",description:"Values by width in categories",keywords:["chart","graph"],thumbnail:e=>(0,d.jsxs)("svg",{width:"28",height:"16",viewBox:"0 0 28 16",fill:"none",...e,children:[(0,d.jsx)("path",{d:"M26 1H2V5H26V1Z",fill:"#6E6E6E"}),(0,d.jsx)("path",{d:"M13 6H2V10H13V6Z",fill:"#6E6E6E"}),(0,d.jsx)("path",{d:"M20 11H2V15H20V11Z",fill:"#6E6E6E"})]})},{text:l.gT.PLOT_LINE,dashboardText:'Plot.plot({\n	width,\n	marks: [\n		Plot.ruleY([0]),\n		Plot.lineY(${aapl}, {x: "${Date}", y: "${Close}"})\n	]\n})',label:"Line",description:"Values over time in connected lines",keywords:["chart","graph"],thumbnail:e=>(0,d.jsx)("svg",{width:"28",height:"16",viewBox:"0 0 28 16",fill:"none",...e,children:(0,d.jsx)("path",{d:"M15.0267 7.19363L22.324 10.0662L27.6584 2.63217L26.4397 1.75775L21.9566 8.00624L14.5347 5.15378L8.63658 12.7883L2.15002 9.3883L1.39431 10.7701L9.09155 14.8132L15.0267 7.19363Z",fill:"#6E6E6E"})})},{text:l.gT.PLOT_LINE_SCATTER,dashboardText:'Plot.plot({\n	width,\n	marks: [\n		Plot.dot(${cars}, {x: "${power (hp)}", y: "${economy (mpg)}"})\n	]\n})',label:"Scatter plot",description:"Correlation or distribution as dots",keywords:["chart","graph"],thumbnail:e=>(0,d.jsxs)("svg",{width:"28",height:"16",viewBox:"0 0 28 16",fill:"none",...e,children:[(0,d.jsx)("circle",{cx:"4.5",cy:"12.5",r:"2.5",fill:"#6E6E6E"}),(0,d.jsx)("circle",{cx:"10.5",cy:"7.5",r:"2.5",fill:"#6E6E6E"}),(0,d.jsx)("circle",{cx:"16.5",cy:"8.5",r:"2.5",fill:"#6E6E6E"}),(0,d.jsx)("circle",{cx:"23.5",cy:"3.5",r:"2.5",fill:"#6E6E6E"})]})},{text:l.gT.PLOT_AREA,dashboardText:'Plot.plot({\n	width,\n	marks: [\n		Plot.areaY(${aapl}, {x: "${Date}", y: "${Close}"}),\n		Plot.ruleY([0])\n	]\n})',label:"Area",description:"Values over time as filled areas",keywords:["chart","graph"],thumbnail:e=>(0,d.jsx)("svg",{width:"28",height:"16",viewBox:"0 0 28 16",fill:"none",...e,children:(0,d.jsx)("path",{d:"M5.5 10L0 15.5H27.5V0L22.5 6H15L9 12L5.5 10Z",fill:"#6E6E6E"})})},{text:l.gT.PLOT_AREA_BAND,dashboardText:'Plot.plot({\n	width,\n	marks: [\n		Plot.areaY(${weather.slice(-365)}, {x: "${date}", y1: "${temp_min}", y2: "${temp_max}", curve: "step"})\n	]\n})',label:"Band area",description:"Values over time as filled areas",keywords:["chart","graph"],thumbnail:e=>(0,d.jsx)("svg",{width:"28",height:"16",viewBox:"0 0 28 16",fill:"none",...e,children:(0,d.jsx)("path",{d:"M5.5 10L0 15.5L5.5 13.5L9 15.5L15.5 11.5H22.5L27.5 8.5V0L22.5 6H15L9 12L5.5 10Z",fill:"#6E6E6E"})})},{text:l.gT.PLOT_AREA_STACKED,dashboardText:'Plot.plot({\n	width,\n	y: {\n		tickFormat: "s"\n	},\n	marks: [\n		Plot.areaY(${industries}, {x: "${date}", y: "${unemployed}", fill: "${industry}"}),\n		Plot.ruleY([0])\n	]\n})',label:"Stacked area",description:"Values over time as filled areas",keywords:["chart","graph"],thumbnail:e=>(0,d.jsxs)("svg",{width:"28",height:"16",viewBox:"0 0 28 16",fill:"none",...e,children:[(0,d.jsx)("path",{d:"M5.5 10L0 15.5L5.5 13.5L9 15.5L15.5 11.5H22.5L27.5 8.5V0L22.5 6H15L9 12L5.5 10Z",fill:"#6E6E6E"}),(0,d.jsx)("path",{d:"M0 15.5L5.5 13.5L9 15.5L15.5 11.5H22.5L27.5 8.5V15.5H9H0Z",fill:"#C4C4C4"})]})},{text:l.gT.PLOT_BAR_TEMPORAL,dashboardText:'Plot.plot({\n	width,\n	marks: [\n		Plot.rectY(${weather.slice(-42)}, {x: "${date}", y: "${wind}", interval: ${d3.utcDay}}),\n		Plot.ruleY([0])\n	]\n})',label:"Temporal bar",description:"Values over time as rects",keywords:["chart","graph"],thumbnail:e=>(0,d.jsxs)("svg",{width:"28",height:"16",viewBox:"0 0 28 16",fill:"none",...e,children:[(0,d.jsx)("path",{d:"M10 6H4V15H10V6Z",fill:"#6E6E6E"}),(0,d.jsx)("path",{d:"M17 9H11V15H17V9Z",fill:"#6E6E6E"}),(0,d.jsx)("path",{d:"M24 1H18V15H24V1Z",fill:"#6E6E6E"})]})},{text:l.gT.PLOT_TOP10_BAR,dashboardText:'Plot.plot({\n	width,\n	marks: [\n		Plot.barX(${olympians}, Plot.groupY({x: "count"}, {y: "${nationality}", sort: {y: "x", reverse: true, limit: 10}})),\n		Plot.ruleX([0])\n	]\n})',label:"Top 10 bar",description:"Group and sort categories by count",keywords:["chart","graph"],thumbnail:e=>(0,d.jsxs)("svg",{width:"28",height:"16",viewBox:"0 0 28 16",fill:"none",...e,children:[(0,d.jsx)("path",{d:"M26 0.999999H2V5H26V0.999999Z",fill:"#6E6E6E"}),(0,d.jsx)("path",{d:"M17 5.99999H2V9.99999H17V5.99999Z",fill:"#6E6E6E"}),(0,d.jsx)("path",{d:"M9.99999 11H2V15H9.99999V11Z",fill:"#6E6E6E"})]})},{text:l.gT.PLOT_TOP10_BAR_WEIGHTED,dashboardText:'Plot.plot({\n	width,\n	marks: [\n		Plot.barX(${olympians}, Plot.groupY({x: "sum"}, {x: "${gold}", y: "${nationality}", sort: {y: "x", reverse: true, limit: 10}})),\n		Plot.ruleX([0])\n	]\n})',label:"Top 10 bar (weighted)",description:"Group and sort categories by value",keywords:["chart","graph"],thumbnail:e=>(0,d.jsxs)("svg",{width:"28",height:"16",viewBox:"0 0 28 16",fill:"none",...e,children:[(0,d.jsx)("path",{d:"M26 0.999999H2V5H26V0.999999Z",fill:"#6E6E6E"}),(0,d.jsx)("path",{d:"M17 5.99999H2V9.99999H17V5.99999Z",fill:"#6E6E6E"}),(0,d.jsx)("path",{d:"M9.99999 11H2V15H9.99999V11Z",fill:"#6E6E6E"})]})},{text:l.gT.PLOT_ARROW,dashboardText:'Plot.plot({\n	width,\n	x: {\n		type: "log"\n	},\n	marks: [\n		Plot.arrow(${citywages}, {\n			x1: "${POP_1980}",\n			y1: "${R90_10_1980}",\n			x2: "${POP_2015}",\n			y2: "${R90_10_2015}",\n			bend: true\n		})\n	]\n})',label:"Arrow",description:"Connected pairs of values",keywords:["chart","graph"],thumbnail:e=>(0,d.jsxs)("svg",{width:"28",height:"16",viewBox:"0 0 28 16",fill:"none",...e,children:[(0,d.jsxs)("g",{clipPath:"url(#clip0_3311_6448)",children:[(0,d.jsx)("path",{d:"M23.0462 0.198957L27.3068 3.37251L23.0462 6.16088L23.0462 4.0283C20.2989 3.73231 19.0906 3.91922 16.3196 6.16088L15.2544 4.82498C18.4552 1.97071 20.2017 1.94396 23.0462 2.17537L23.0462 0.198957Z",fill:"#6E6E6E"}),(0,d.jsx)("path",{d:"M17.0462 9.19896L21.3068 12.3725L17.0462 15.1609L17.0462 13.0283C14.2989 12.7323 13.0906 12.9192 10.3196 15.1609L9.2544 13.825C12.4552 10.9707 14.2017 10.944 17.0462 11.1754L17.0462 9.19896Z",fill:"#6E6E6E"}),(0,d.jsx)("path",{d:"M8.04617 4.19896L12.3068 7.37251L8.04622 10.1609L8.04621 8.0283C5.29892 7.73231 4.09061 7.91922 1.31957 10.1609L0.254397 8.82498C3.45522 5.97071 5.2017 5.94396 8.04621 6.17537L8.04617 4.19896Z",fill:"#6E6E6E"})]}),(0,d.jsx)("defs",{children:(0,d.jsx)("clipPath",{id:"clip0_3311_6448",children:(0,d.jsx)("rect",{width:"28",height:"16",fill:"white"})})})]})},{text:l.gT.PLOT_BOX,dashboardText:'Plot.plot({\n	width,\n	marks: [\n		Plot.boxX(${olympians}, {x: "${weight}", y: "${sport}", sort: {y: "x"}})\n	]\n})',label:"Box plot",description:"Quantitative distributions as boxes",keywords:["chart","graph"],thumbnail:e=>(0,d.jsxs)("svg",{width:"28",height:"16",viewBox:"0 0 28 16",fill:"none",...e,children:[(0,d.jsx)("path",{d:"M0 8H27.5",stroke:"#C4C4C4",strokeWidth:"2"}),(0,d.jsx)("rect",{x:"6.5",y:"4",width:"11",height:"8",fill:"#6E6E6E"})]})},{text:l.gT.PLOT_CELL,dashboardText:'Plot.plot({\n	width,\n	marks: [\n		Plot.cell(${weather.slice(-365)}, {\n			x: ${d => d.date.getUTCDate()},\n			y: ${d => d.date.getUTCMonth()},\n			fill: "${temp_max}"\n		})\n	]\n})',label:"Cell chart",description:"Values by category in a grid",keywords:["graph"],thumbnail:e=>(0,d.jsxs)("svg",{width:"28",height:"16",viewBox:"0 0 28 16",fill:"none",...e,children:[(0,d.jsx)("rect",{x:"3",y:"1",width:"6.58824",height:"6.58824",fill:"#6E6E6E"}),(0,d.jsx)("rect",{x:"3",y:"8.41174",width:"6.58824",height:"6.58824",fill:"#C4C4C4"}),(0,d.jsx)("rect",{x:"10.4116",y:"8.41174",width:"6.58824",height:"6.58824",fill:"#6E6E6E"}),(0,d.jsx)("rect",{x:"17.8237",y:"1",width:"6.58824",height:"6.58824",fill:"#6E6E6E"}),(0,d.jsx)("rect",{x:"17.8237",y:"8.41174",width:"6.58824",height:"6.58824",fill:"#6E6E6E"}),(0,d.jsx)("rect",{x:"10.4116",y:"1",width:"6.58824",height:"6.58824",fill:"#C4C4C4"})]})},{text:l.gT.PLOT_FACETED,dashboardText:'Plot.plot({\n	width,\n	facet: {\n		data: ${penguins},\n		x: "${species}"\n	},\n	marks: [\n		Plot.frame(),\n		Plot.dot(${penguins}, {x: "${culmen_length_mm}", y: "${culmen_depth_mm}"})\n	]\n})',label:"Faceted chart",description:"Small multiples",keywords:["graph","pane","window"],thumbnail:e=>(0,d.jsxs)("svg",{width:"28",height:"16",viewBox:"0 0 28 16",fill:"none",...e,children:[(0,d.jsx)("circle",{cx:"6",cy:"14",r:"2",fill:"#6E6E6E"}),(0,d.jsx)("circle",{cx:"9",cy:"9",r:"2",fill:"#6E6E6E"}),(0,d.jsx)("circle",{cx:"3",cy:"3",r:"2",fill:"#6E6E6E"}),(0,d.jsx)("circle",{cx:"22",cy:"13",r:"1.5",stroke:"#6E6E6E"}),(0,d.jsx)("circle",{cx:"19",cy:"10",r:"1.5",stroke:"#6E6E6E"}),(0,d.jsx)("circle",{cx:"24",cy:"4",r:"1.5",stroke:"#6E6E6E"}),(0,d.jsx)("rect",{x:"14",width:"1",height:"16",fill:"#C4C4C4"})]})},{text:l.gT.PLOT_HISTOGRAM,dashboardText:'Plot.plot({\n	width,\n	marks: [\n		Plot.rectY(${olympians}, Plot.binX({y: "count"}, {x: "${weight}"})),\n		Plot.ruleY([0])\n	]\n})',label:"Histogram",description:"Quantitative distribution as bars",keywords:["chart","graph"],thumbnail:e=>(0,d.jsx)("svg",{width:"28",height:"16",viewBox:"0 0 28 16",fill:"none",...e,children:(0,d.jsx)("path",{d:"M16 2H12V5H8V11H4V13H0V15H28V14H24V11H20V6H16V2Z",fill:"#6E6E6E"})})},{text:l.gT.PLOT_MOVING_AVERAGE,dashboardText:'Plot.plot({\n	width,\n	marks: [\n		Plot.ruleY([0]),\n		Plot.lineY(${1:aapl}, Plot.windowY({x: "${2:Date}", y: "${3:Close}", k: ${4:10}, reduce: "mean"}))\n	]\n})',label:"Moving average line",description:"Values over time as smoothed lines",keywords:["chart","graph"],thumbnail:e=>(0,d.jsx)("svg",{width:"28",height:"16",viewBox:"0 0 28 16",fill:"none",...e,children:(0,d.jsx)("path",{d:"M1.5 13C4 9.5 7.00023 7.5 9.5 7C12.6294 6.37406 16.3706 9.12588 19.5 8.5C22 8 24.5 4.5 25.5 2",stroke:"#6E6E6E",strokeWidth:"2",strokeLinecap:"square"})})},{text:l.gT.PLOT_MULTI_SERIES_LINE,dashboardText:'Plot.plot({\n	width,\n	marks: [\n		Plot.ruleY([0]),\n		Plot.lineY(${industries}, {x: "${date}", y: "${unemployed}", z: "${industry}"})\n	]\n})',label:"Multi-series line",description:"Multiple values over time as lines",keywords:["chart","graph"],thumbnail:e=>(0,d.jsxs)("svg",{width:"28",height:"16",viewBox:"0 0 28 16",fill:"none",...e,children:[(0,d.jsx)("path",{d:"M14.8059 5.99327L21.5023 7.49997L26.4624 3.10296L25.5598 1.6449L20.8652 5.5319L14.1682 3.94055L7.88537 10.8838L2.25668 10.2994L1.81457 12.254L8.57398 12.9533L14.8059 5.99327Z",fill:"#6E6E6E"}),(0,d.jsx)("path",{d:"M13.672 10.1263L22.4871 12.8857L27.9506 7.10765L26.6421 5.8955L22.099 10.9017L14.5908 8.41407L9.10579 1.40155L1.67676 6.2617L2.70623 7.98754L8.71288 4.07417L13.672 10.1263Z",fill:"#C4C4C4"})]})},{text:l.gT.PLOT_LINEAR_REGRESSION,dashboardText:'Plot.plot({\n	width,\n	marks: [\n		Plot.linearRegressionY(${penguins}, {x: "${culmen_length_mm}", y: "${culmen_depth_mm}", stroke: "${species}"})\n	]\n})',label:"Linear regression",description:"Best-fit line with confidence band",keywords:["chart","graph"],thumbnail:e=>(0,d.jsxs)("svg",{width:"28",height:"16",viewBox:"0 0 28 16",fill:"none",...e,children:[(0,d.jsx)("path",{d:"M28 0C18 5.5 10.5 7 0 6.5V14C10 11 16.5 11 28 12V0Z",fill:"#E2E2E2"}),(0,d.jsx)("path",{d:"M0 10L28 4V6L0 12V10Z",fill:"#6E6E6E"})]})},{text:l.gT.PLOT_TICK,dashboardText:'Plot.plot({\n	width,\n	marks: [\n		Plot.tickX(${cars}, {x: "${economy (mpg)}", y: "${year}"})\n	]\n})',label:"Tick chart",description:"Quantitative distributions as lines",keywords:["chart","graph"],thumbnail:e=>(0,d.jsxs)("svg",{width:"28",height:"16",viewBox:"0 0 28 16",fill:"none",...e,children:[(0,d.jsx)("rect",{x:"3",y:"1",width:"2",height:"14",fill:"#6E6E6E"}),(0,d.jsx)("rect",{x:"9",y:"1",width:"2",height:"14",fill:"#6E6E6E"}),(0,d.jsx)("rect",{x:"12",y:"1",width:"2",height:"14",fill:"#6E6E6E"}),(0,d.jsx)("rect",{x:"23",y:"1",width:"2",height:"14",fill:"#6E6E6E"})]})},{text:l.gT.PLOT_HEXBIN,dashboardText:'Plot.plot({\n	width,\n	color: {\n		scheme: "ylgnbu"\n	},\n	marks: [\n		Plot.hexagon(${olympians}, Plot.hexbin({fill: "sum"}, {x: "${weight}", y: "${height}"}))\n	]\n})',label:"Hexbin chart",description:"Distribution as tiled hexagonal bins",keywords:["chart","graph"],thumbnail:e=>(0,d.jsxs)("svg",{width:"28",height:"16",viewBox:"0 0 28 16",fill:"none",...e,children:[(0,d.jsx)("path",{d:"M13 9.03109L9.5 7L6 9.03109V13.2176L9.5 15L13 13.2176V9.03109Z",fill:"#6E6E6E"}),(0,d.jsx)("path",{d:"M21 9.03109L17.5 7L14 9.03109V13.2176L17.5 15L21 13.2176V9.03109Z",fill:"#C4C4C4"}),(0,d.jsx)("path",{d:"M17 2.03109L13.5 0L10 2.03109V6.21762L13.5 8L17 6.21762V2.03109Z",fill:"#6E6E6E"})]})},{text:l.gT.PLOT_BEESWARM,dashboardText:'Plot.plot({\n	width,\n	height: 180,\n	marks: [\n		Plot.dot(${cars}, Plot.dodgeY({x: "${weight (lb)}"}))\n	]\n})',label:"Beeswarm chart",description:"Distribution as columns of dots",keywords:["chart","graph"],thumbnail:e=>(0,d.jsxs)("svg",{width:"28",height:"16",viewBox:"0 0 28 16",fill:"none",...e,children:[(0,d.jsx)("circle",{cx:"3",cy:"13",r:"2",fill:"#6E6E6E"}),(0,d.jsx)("circle",{cx:"24",cy:"13",r:"2",fill:"#6E6E6E"}),(0,d.jsx)("circle",{cx:"16",cy:"13",r:"2",fill:"#6E6E6E"}),(0,d.jsx)("circle",{cx:"3",cy:"8",r:"2",fill:"#6E6E6E"}),(0,d.jsx)("circle",{cx:"24",cy:"8",r:"2",fill:"#6E6E6E"}),(0,d.jsx)("circle",{cx:"3",cy:"3",r:"2",fill:"#6E6E6E"}),(0,d.jsx)("circle",{cx:"7",cy:"10.5",r:"2",fill:"#6E6E6E"})]})},{text:l.gT.PLOT_VORONOI,dashboardText:'Plot.plot({\n	width,\n	marks: [\n		Plot.voronoi(${penguins}, {x: "${culmen_depth_mm}", y: "${culmen_length_mm}", fill: "${species}", stroke: "white"})\n	]\n})',label:"Voronoi diagram",description:"Delaunay partition by closest point",keywords:["chart","graph"],thumbnail:e=>(0,d.jsxs)("svg",{width:"28",height:"16",viewBox:"0 0 28 16",fill:"none",...e,children:[(0,d.jsx)("path",{d:"M10.9473 1H1V13.0638L8.33381 9.36524L10.9473 1Z",fill:"#6E6E6E"}),(0,d.jsx)("path",{d:"M27.002 1.02478H14.1211L23.1618 5.66667H27.002V1.02478Z",fill:"#6E6E6E"}),(0,d.jsx)("path",{d:"M27.002 7.52835H22.1216L19.9614 10.1596L21.1083 15H27.002V7.52835Z",fill:"#6E6E6E"}),(0,d.jsx)("path",{d:"M20.5214 6.48579L12.6273 2.41492L10.3872 9.34043L18.5213 8.96809L20.5214 6.48579Z",fill:"#6E6E6E"}),(0,d.jsx)("path",{d:"M18.0416 10.8546L8.84038 11.2518L1.05322 14.9752H19.1081L18.0416 10.8546Z",fill:"#6E6E6E"})]})},{text:l.gT.PLOT_DENSITY_CONTOUR,dashboardText:'Plot.plot({\n	width,\n	marks: [\n		Plot.density(${cars}, { x: "${power (hp)}", y: "${economy (mpg)}" })\n	]\n})',label:"Density contours",description:"Density estimates for point clouds",keywords:["chart","graph"],thumbnail:e=>(0,d.jsxs)("svg",{width:"29",height:"16",viewBox:"0 0 29 16",fill:"none",...e,children:[(0,d.jsx)("path",{d:"M1.38675 7.57143C4.17246 9.42857 10.6725 11.2857 12.5296 8.96428C14.3867 6.64286 10.6725 3.39286 8.35103 2",stroke:"#6E6E6E",strokeWidth:"2",strokeLinecap:"square"}),(0,d.jsx)("path",{d:"M1.38675 12.0778C4.97052 13.8697 12.138 16.1095 16.1698 12.5257C20.2015 8.94197 16.1698 4.01429 13.9299 2.22241",stroke:"#6E6E6E",strokeWidth:"2",strokeLinecap:"square"}),(0,d.jsx)("path",{d:"M20.7549 2.4436C20.8111 4.15586 21.3868 7.5 22.3868 9C23.3868 10.5 25.1464 11.7001 26.8868 12.5",stroke:"#6E6E6E",strokeWidth:"2",strokeLinecap:"square"})]})},{text:'Plot.plot({\n	axis: null,\n	margin: 20,\n	marginRight: 120,\n	marks: [\n		Plot.tree(flare.slice(0, 50), {path: "name", delimiter: "."})\n	]\n})',dashboardText:'Plot.plot({\n	width,\n	axis: null,\n	margin: 20,\n	marginRight: 120,\n	marks: [\n		Plot.tree(flare.slice(0, 50), {path: "name", delimiter: "."})\n	]\n})',label:"Tree diagram",description:"Hierarchical relationships",keywords:["chart","graph"],thumbnail:e=>(0,d.jsxs)("svg",{width:"28",height:"16",viewBox:"0 0 28 16",fill:"none",...e,children:[(0,d.jsx)("path",{d:"M6.5 7.5L20.5 3.5",stroke:"#D9D9D9",strokeWidth:"2"}),(0,d.jsx)("path",{d:"M6.5001 7.50003L20.547 11.6667",stroke:"#D9D9D9",strokeWidth:"2"}),(0,d.jsx)("path",{d:"M20.5002 14C21.8809 14 23.0002 12.8807 23.0002 11.5C23.0002 10.1193 21.8809 9 20.5002 9C19.1195 9 18.0002 10.1193 18.0002 11.5C18.0002 12.8807 19.1195 14 20.5002 14Z",fill:"#6E6E6E"}),(0,d.jsx)("path",{d:"M20.5002 6C21.8809 6 23.0002 4.88071 23.0002 3.5C23.0002 2.11929 21.8809 1 20.5002 1C19.1195 1 18.0002 2.11929 18.0002 3.5C18.0002 4.88071 19.1195 6 20.5002 6Z",fill:"#6E6E6E"}),(0,d.jsx)("path",{d:"M6.5 10C7.88071 10 9 8.88071 9 7.5C9 6.11929 7.88071 5 6.5 5C5.11929 5 4 6.11929 4 7.5C4 8.88071 5.11929 10 6.5 10Z",fill:"#6E6E6E"})]})}].map(e=>{let{text:t,dashboardText:n,label:i,description:o,keywords:l,thumbnail:d}=e;return{thumbnail:d,description:o,keywords:l,apply:(e,i,o,l)=>{(0,r.DB)("dashboard"===e.state.field(a.Y)?n:t)(e,i,o,l)},label:(0,s.b2)(i),type:c.JY.Snippet,boost:c.UW.Snippet,detail:c.$d.Snippet,origin:"plotSnippets"}}),h=[{apply:l.Ob.apply,label:"Fetch from a URL",description:"Request a file or API via an HTTP",keywords:["xml","http","hook","webhook"]}],m=[{text:l.gT.IMPORT_NOTEBOOK_CELL,label:"Cell",description:"Reuse any code on Observable"},{text:l.gT.IMPORT_NOTEBOOK_LIBRARY,label:"Import library",description:"Load modern JS libraries from npm"},{text:l.gT.IMPORT_REQUIRE_LIBRARY,label:"Require library",description:"Load legacy JS libraries from npm"}].map(e=>{let{text:t,label:n,description:i}=e;return{description:i,apply:(0,r.DB)(t),label:(0,s.b2)(n)}}),f=[{apply:l.Up.INPUT_BUTTON,label:"Button input",description:"Click or tap to start an action",thumbnail:e=>(0,d.jsx)("svg",{width:"28",height:"16",viewBox:"0 0 28 16",fill:"none",...e,children:(0,d.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M27 0H0V15H1V16H28V1H27V0ZM26 1H1V14H26V1Z",fill:"#6E6E6E"})})},{apply:l.Up.INPUT_TOGGLE,label:"Toggle input",description:"Choose on or off",keywords:["switch","checkbox"],thumbnail:e=>(0,d.jsxs)("svg",{width:"28",height:"16",viewBox:"0 0 28 16",fill:"none",...e,children:[(0,d.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M0 8C0 12.4183 3.58172 16 8 16H21V15.9381C24.9463 15.446 28 12.0796 28 8C28 3.92038 24.9463 0.553986 21 0.0618896V0H8C3.58172 0 0 3.58173 0 8ZM2 8C2 11.3137 4.68629 14 8 14H20C23.3137 14 26 11.3137 26 8C26 4.68629 23.3137 2 20 2H8C4.68629 2 2 4.68629 2 8Z",fill:"#6E6E6E"}),(0,d.jsx)("circle",{cx:"8",cy:"8",r:"4",fill:"#6E6E6E"})]})},{apply:l.Up.INPUT_RADIO,label:"Radio input",description:"Choose one from a horizontal list",keywords:["picker"],thumbnail:e=>(0,d.jsxs)("svg",{width:"28",height:"16",viewBox:"0 0 28 16",fill:"none",...e,children:[(0,d.jsx)("circle",{cx:"6.5",cy:"7.5",r:"5.5",stroke:"#6E6E6E",strokeWidth:"2"}),(0,d.jsx)("circle",{cx:"21.5",cy:"7.5",r:"5.5",stroke:"#6E6E6E",strokeWidth:"2"}),(0,d.jsx)("circle",{cx:"6.5",cy:"7.5",r:"2.5",fill:"#6E6E6E"})]})},{apply:l.Up.INPUT_SELECT,label:"Dropdown menu",description:"Choose one from a popup list",keywords:["select","picker"],thumbnail:e=>(0,d.jsx)("svg",{width:"28",height:"16",viewBox:"0 0 28 16",fill:"none",...e,children:(0,d.jsx)("path",{d:"M5 4L13.5 12.5C16.5 9.66667 22.4 4 22 4",stroke:"#6E6E6E",strokeWidth:"2",strokeLinecap:"round"})})},{apply:l.Up.INPUT_RANGE,label:"Slider",description:"Type or drag to choose a number",thumbnail:e=>(0,d.jsx)("svg",{width:"28",height:"16",viewBox:"0 0 28 16",fill:"none",...e,children:(0,d.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M15.9 9C15.4367 11.2822 13.419 13 11 13C8.58104 13 6.56329 11.2822 6.10002 9H1V7H6.10002C6.56329 4.71776 8.58104 3 11 3C13.419 3 15.4367 4.71776 15.9 7H27V9H15.9ZM14 8C14 9.65685 12.6569 11 11 11C9.34315 11 8 9.65685 8 8C8 6.34315 9.34315 5 11 5C12.6569 5 14 6.34315 14 8Z",fill:"#6E6E6E"})})},{apply:l.Up.INPUT_DATE,label:"Date picker",description:"Choose a date from a calendar",thumbnail:e=>(0,d.jsx)("svg",{width:"28",height:"16",viewBox:"0 0 28 16",fill:"none",...e,children:(0,d.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M10 0C10.5523 0 11 0.447715 11 1V2H16V1C16 0.447715 16.4477 0 17 0C17.5523 0 18 0.447715 18 1V2H21V16H6V2H9V1C9 0.447715 9.44772 0 10 0ZM19 6H8V14H19V6Z",fill:"#6E6E6E"})})},{apply:l.Up.INPUT_CHECKBOX,label:"Checkbox input",description:"Choose one or many from a list",thumbnail:e=>(0,d.jsxs)("svg",{width:"28",height:"16",viewBox:"0 0 28 16",fill:"none",...e,children:[(0,d.jsx)("path",{d:"M4.85364 11.2174L4.82843 11.2426L2 8.41422L3.41422 7L5.38916 8.97495L10.3641 4L11.7783 5.41422L5.41437 11.7782L4.85364 11.2174Z",fill:"#6E6E6E"}),(0,d.jsx)("path",{d:"M17.8536 11.2174L17.8284 11.2426L15 8.41422L16.4142 7L18.3892 8.97495L23.3641 4L24.7783 5.41422L18.4144 11.7782L17.8536 11.2174Z",fill:"#6E6E6E"})]})},{apply:l.Up.INPUT_TABLE,label:"Checkbox table",description:"Choose one or many table rows",keywords:["javascript"],thumbnail:e=>(0,d.jsxs)("svg",{width:"28",height:"16",viewBox:"0 0 28 16",fill:"none",...e,children:[(0,d.jsx)("path",{d:"M2.85364 7.21744L2.82843 7.24265L0 4.41422L1.41422 3L3.38916 4.97495L8.36411 0L9.77833 1.41422L3.41437 7.77817L2.85364 7.21744Z",fill:"#6E6E6E"}),(0,d.jsx)("path",{d:"M2.85364 15.2174L2.82843 15.2426L0 12.4142L1.41422 11L3.38916 12.9749L8.36411 8L9.77833 9.41422L3.41437 15.7782L2.85364 15.2174Z",fill:"#6E6E6E"}),(0,d.jsx)("rect",{x:"12",y:"4",width:"6",height:"2",fill:"#6E6E6E"}),(0,d.jsx)("rect",{x:"12",y:"12",width:"6",height:"2",fill:"#6E6E6E"}),(0,d.jsx)("rect",{x:"21",y:"12",width:"7",height:"2",fill:"#6E6E6E"}),(0,d.jsx)("rect",{x:"21",y:"4",width:"7",height:"2",fill:"#6E6E6E"})]})},{apply:l.Up.INPUT_TEXT,label:"Text box",description:"Single line text input",thumbnail:e=>(0,d.jsxs)("svg",{width:"28",height:"16",viewBox:"0 0 28 16",fill:"none",...e,children:[(0,d.jsx)("rect",{x:"0.5",y:"0.5",width:"27",height:"15",stroke:"#6E6E6E"}),(0,d.jsx)("path",{d:"M5.86537 8.9217H7.94417L6.93286 5.97767H6.91039L5.86537 8.9217ZM6.03392 4H7.84304L10.8433 12.023H9.01166L8.40488 10.2364H5.40466L4.7754 12.023H3L6.03392 4ZM15.6253 9.12396C15.6253 8.87675 15.5991 8.64078 15.5467 8.41604C15.4942 8.19131 15.4118 7.9928 15.2995 7.8205C15.1871 7.64821 15.0447 7.51337 14.8725 7.41597C14.7076 7.3111 14.5053 7.25866 14.2657 7.25866C14.0334 7.25866 13.8311 7.3111 13.6589 7.41597C13.4866 7.51337 13.3443 7.64821 13.2319 7.8205C13.1195 7.9928 13.0371 8.19131 12.9847 8.41604C12.9322 8.64078 12.906 8.87675 12.906 9.12396C12.906 9.36368 12.9322 9.5959 12.9847 9.82064C13.0371 10.0454 13.1195 10.2439 13.2319 10.4162C13.3443 10.5885 13.4866 10.7271 13.6589 10.8319C13.8311 10.9293 14.0334 10.978 14.2657 10.978C14.5053 10.978 14.7076 10.9293 14.8725 10.8319C15.0447 10.7271 15.1871 10.5885 15.2995 10.4162C15.4118 10.2439 15.4942 10.0454 15.5467 9.82064C15.5991 9.5959 15.6253 9.36368 15.6253 9.12396ZM11.3665 4H12.9622V6.92156H12.9847C13.1794 6.62191 13.4416 6.40467 13.7713 6.26983C14.1084 6.1275 14.4567 6.05633 14.8163 6.05633C15.1084 6.05633 15.3968 6.11626 15.6815 6.23611C15.9661 6.35598 16.2209 6.53951 16.4456 6.78672C16.6778 7.03392 16.8651 7.3523 17.0075 7.74184C17.1498 8.12389 17.221 8.58086 17.221 9.11272C17.221 9.6446 17.1498 10.1053 17.0075 10.4948C16.8651 10.8769 16.6778 11.1915 16.4456 11.4387C16.283 11.6119 16.0503 11.7203 15.7657 11.8401C15.481 11.96 15.1084 12 14.8163 12C14.3893 12 13.996 11.975 13.6589 11.8401C13.3868 11.7313 13.0783 11.6035 12.906 11.2814H12.8836V12.023H11.3665V4Z",fill:"#6E6E6E"})]})},{apply:l.Up.INPUT_TEXTAREA,label:"Text area",description:"Multi-line text input",keywords:["textarea"],thumbnail:e=>(0,d.jsxs)("svg",{width:"28",height:"16",viewBox:"0 0 28 16",fill:"none",...e,children:[(0,d.jsx)("rect",{x:"24",width:"4",height:"2",fill:"#6E6E6E"}),(0,d.jsx)("rect",{width:"4",height:"2",transform:"matrix(1 0 0 -1 24 15)",fill:"#6E6E6E"}),(0,d.jsx)("rect",{width:"4",height:"2",fill:"#6E6E6E"}),(0,d.jsx)("rect",{width:"4",height:"2",transform:"matrix(1 0 0 -1 0 15)",fill:"#6E6E6E"}),(0,d.jsx)("rect",{x:"10",width:"8",height:"2",fill:"#6E6E6E"}),(0,d.jsx)("rect",{width:"8",height:"2",transform:"matrix(1 0 0 -1 10 15)",fill:"#6E6E6E"}),(0,d.jsx)("rect",{width:"2",height:"4",fill:"#6E6E6E"}),(0,d.jsx)("rect",{width:"2",height:"4",transform:"matrix(1 0 0 -1 0 15)",fill:"#6E6E6E"}),(0,d.jsx)("rect",{x:"26",width:"2",height:"4",fill:"#6E6E6E"}),(0,d.jsx)("rect",{width:"2",height:"4",transform:"matrix(1 0 0 -1 26 15)",fill:"#6E6E6E"})]})},{apply:l.Up.INPUT_COLOR,label:"Color",description:"Choose a color",thumbnail:e=>(0,d.jsxs)("svg",{width:"28",height:"16",viewBox:"0 0 28 16",fill:"none",...e,children:[(0,d.jsx)("circle",{cx:"9",cy:"8",r:"7",fill:"#6E6E6E"}),(0,d.jsx)("circle",{cx:"19",cy:"8",r:"7",fill:"#C4C4C4"})]})},{apply:l.Up.INPUT_FILE,label:"File selector",description:"Choose a file to upload",thumbnail:e=>(0,d.jsxs)("svg",{width:"28",height:"16",viewBox:"0 0 28 16",fill:"none",...e,children:[(0,d.jsx)("path",{d:"M21.175 12.7137L18.2694 5.89259C18.0943 5.48139 18.5054 5.06451 18.919 5.23398L25.7224 8.02197C26.189 8.21318 26.1113 8.89654 25.6137 8.97806L22.9677 9.41148C22.7541 9.44647 22.5873 9.61495 22.5544 9.8289L22.1292 12.5937C22.0527 13.0911 21.3722 13.1766 21.175 12.7137Z",fill:"#6E6E6E"}),(0,d.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2 0H9L15 6V16H2V0ZM13 7V14H4V2H8V7H13Z",fill:"#6E6E6E"})]})},{apply:l.Up.INPUT_SEARCH,label:"Search table",description:"Full-text search of tabular data",thumbnail:e=>(0,d.jsx)("svg",{width:"28",height:"16",viewBox:"0 0 28 16",fill:"none",...e,children:(0,d.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M22 6C22 9.31371 19.3137 12 16 12C14.7537 12 13.5962 11.62 12.637 10.9696L8.70711 14.8995C8.31658 15.29 7.68342 15.29 7.29289 14.8995C6.90237 14.509 6.90237 13.8758 7.29289 13.4853L11.1904 9.58779C10.4427 8.58709 9.99998 7.34525 9.99998 6C9.99998 2.68629 12.6863 0 16 0C19.3137 0 22 2.68629 22 6ZM20 6C20 8.20914 18.2091 10 16 10C13.7908 10 12 8.20914 12 6C12 3.79086 13.7908 2 16 2C18.2091 2 20 3.79086 20 6Z",fill:"#6E6E6E"})})},{apply:l.Up.INPUT_FORM,label:"Form",description:"Combine multiple inputs",thumbnail:e=>(0,d.jsxs)("svg",{width:"28",height:"16",viewBox:"0 0 28 16",fill:"none",...e,children:[(0,d.jsx)("circle",{cx:"5.5",cy:"3.5",r:"2.5",fill:"#6E6E6E"}),(0,d.jsx)("circle",{cx:"5.5",cy:"11.5",r:"2.5",fill:"#6E6E6E"}),(0,d.jsx)("path",{d:"M11.5 3.5H25",stroke:"#6E6E6E",strokeWidth:"2",strokeLinecap:"round"}),(0,d.jsx)("path",{d:"M11.5 11.5H25",stroke:"#6E6E6E",strokeWidth:"2",strokeLinecap:"round"})]})}].map(e=>{let{apply:t,label:n,keywords:r,description:i,thumbnail:o}=e;return{description:i,thumbnail:o,apply:t,label:(0,s.b2)(n),type:c.JY.Snippet,boost:c.UW.Snippet,detail:c.$d.Snippet,origin:"inputSnippets",...r?{keywords:r}:{}}});var arrowRightBendy=e=>(0,d.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",...e,children:[(0,d.jsx)("path",{d:"M9.68457 9.76671L13.4927 8.90167L13.3285 5",stroke:"currentColor",strokeWidth:"1.6"}),(0,d.jsx)("path",{d:"M1 8.57188C4.2091 5.26919 9.5576 4.85634 13.3016 8.98472",stroke:"currentColor",strokeWidth:"1.6"})]}),g=n(87989),map=e=>(0,d.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",...e,children:[(0,d.jsx)("path",{d:"M13 6C13 6.87768 13 7.5 12.3301 8.5L8 14L3.66987 8.5C3 7.5 3 6.87768 3 6C3 5.12232 3.23103 4.2601 3.66987 3.5C4.10871 2.7399 4.7399 2.10872 5.5 1.66987C6.2601 1.23103 7.12232 1 8 1C8.87768 1 9.7399 1.23103 10.5 1.66987C11.2601 2.10871 11.8913 2.7399 12.3301 3.5C12.769 4.2601 13 5.12232 13 6Z",stroke:"currentColor",strokeWidth:"2"}),(0,d.jsx)("circle",{cx:"8",cy:"6",r:"2",fill:"currentColor"})]}),v=n(71820),y=n(34372),x=n(36983),b=n(96765),w=n(6359),C=n(67642),j=n(32007),S=n(44911),k=n(14997),E=n(42962),_=n(77097);let N={title:"Suggestions",description:"Suggestions based on your code",items:[{type:"small",label:"Create\xa0table",category:"Suggestions",icon:x.i,fullWidth:!0,filter:e=>{let{suggestions:t}=e;return t.includes("table")},action:(e,t)=>{let{previousId:n,nextId:r,combine:i,display:o}=t;null!==n&&e({type:"insertSuggestion",id:n,suggestion:e=>({id:r,before:!0,node:{mode:"table",combine:i,display:o,data:{source:{type:"cell",name:e},operations:{...S.Zu.defaultNode.data.operations,from:{table:(0,_.Z)({type:"cell",name:e,dialect:"array"})}}}},type:"insert"})})}},{type:"small",label:"Create\xa0chart",category:"Suggestions",icon:g.k,filter:e=>{let{suggestions:t}=e;return t.includes("chart")},action:(e,t)=>{let{previousId:n,combine:r,display:i}=t;null!==n&&e({type:"insertSuggestion",id:n,suggestion:e=>({id:n,before:!1,node:{mode:"chart",combine:r,display:i,data:{...S.mc.defaultNode.data,source:{type:"cell",name:e}}},type:"insert"})})}},{type:"small",label:"Create\xa0Plot\xa0map",category:"Suggestions",icon:map,filter:e=>{let{suggestions:t}=e;return t.includes("map")},action:(e,t)=>{let{previousId:n,combine:r,display:i}=t;null!==n&&e({type:"insertSuggestion",id:n,suggestion:e=>({id:n,before:!1,node:{mode:"js",combine:r,display:i,value:'Plot.plot({ projection: "equal-earth", marks: [Plot.geo('.concat(e,")] })")},type:"insert"})})}},{type:"small",label:"Create\xa0Leaflet\xa0map",category:"Suggestions",icon:map,filter:e=>{let{suggestions:t}=e;return t.includes("map")},action:(e,t)=>{let{previousId:n,combine:r,display:i}=t;null!==n&&e({type:"insertSuggestion",id:n,suggestion:e=>({id:n,before:!1,node:{mode:"js",combine:r,display:i,value:'{\nconst container = yield htl.html`<div style="height: 500px;">`;\nconst map = L.map(container);\nconst layer = L.geoJSON('.concat(e,').addTo(map);\nmap.fitBounds(layer.getBounds(), {maxZoom: 9});\nL.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {\n  attribution: "\xa9 <a href=https://www.openstreetmap.org/copyright>OpenStreetMap</a> contributors"\n}).addTo(map);\n}')},type:"insert"})})}},{type:"small",label:"Convert\xa0to\xa0JavaScript",category:"Suggestions",icon:arrowRightBendy,filter:e=>{let{previousMode:t}=e;return"chart"===t},action:async(e,t)=>{let{previousId:n,previousNode:r,chartSpec:i,combine:l,display:s}=t;if(null===n||!r)return;let a=await (0,k.F)(function(e,t){if(!e||"chart"!==e.mode||!t)return"";let n=Object.keys(e.data.config.options).length?(0,o.db)(e.data.config.options):null,{fx:r,fy:i,x:{zero:l},y:{zero:s},color:{value:a,color:d},markImpl:c,markOptions:u,transformImpl:p,transformOptions:h,colorMode:m}=t,f="{".concat(Object.entries(u).map(e=>{let[t,n]=e;if(void 0!==n)return t===m?"".concat(t,": ").concat("string"==typeof d?JSON.stringify(d):"string"==typeof a?(0,o.D5)(a)?"(d) => d[".concat(JSON.stringify(a),"]"):JSON.stringify(a):void 0):"".concat(t,": ").concat(JSON.stringify(n))}).filter(e=>e).join(", "),"}"),g=p?"Plot.".concat(p,"(").concat(JSON.stringify(h),", ").concat(f,")"):f,v=null!=r||null!=i?"Plot.frame({strokeOpacity: 0.1})":null,y=[l?"Plot.ruleX([0])":null,s?"Plot.ruleY([0])":null],x="Plot.".concat(c,"(").concat((0,o.TG)(e.data.source),", ").concat(g,")"),b="Plot.plot({".concat(n?"\n    ".concat(n.slice(1,n.length-1),","):"","\n    marks: [\n      ").concat(("stroke"===m?[v,...y,x]:[v,x,...y]).filter(e=>e).join(",\n    "),"\n    ]\n  })");return b}(r,i));if(a.length>65536)throw Error("generated Plot code is too long");e({type:"insertAfter",id:n,node:{mode:"js",value:a,combine:l,display:s},trigger:"click",source:"nodeInserterMenu"})}},{type:"small",label:"Convert\xa0to\xa0SQL",category:"Suggestions",icon:arrowRightBendy,filter:e=>{let{previousMode:t}=e;return"table"===t},action:(e,t)=>{let n,{previousId:r,previousNode:i,display:o}=t;if(null!==r&&(null==i?void 0:i.mode)==="table"){try{n=(0,j.M7)(i.data)}catch(e){n={name:"",type:"cell"}}new w.zL(n,i.data.operations).run(e).then(E.Je,e=>(console.error("Error fetching query: ",e),"")).then(t=>{e({type:"insertAfter",id:r,node:{mode:"sql",display:o,data:{source:n},value:t},trigger:"click",source:"nodeInserterMenu"})})}}}]},L={title:"Connect to data",description:"Import data from a URL, file, or database",items:[{type:"large",label:"Upload file…",category:"Data",description:"Excel, JSON, CSV, …",fullWidth:!0,keywords:["parquet","csv","json","excel","xls","xlsx","tsv","txt"],filter:e=>{let{allowFileAttachments:t}=e;return t},action:(e,t)=>{let{nextId:n,combine:r,display:i}=t;(0,C.Z)().then(t=>{e({type:"attachLocalFiles",files:t,beforeId:n,source:"filesPane",trigger:"click",combine:r,display:i})})}},{type:"large",label:"Cloud file…",category:"Data",description:"Microsoft 365, Google Sheets, …",fullWidth:!0,keywords:["parquet","csv","json","excel","xls","xlsx","tsv","txt"],filter:e=>{let{allowPrivateData:t}=e;return t},action:e=>e({type:"showModal",modal:"addCloudFile"})},{type:"large",label:"Connect to database…",category:"Data",description:"PostgreSQL, RedShift, BigQuery, …",fullWidth:!0,keywords:["databricks","mongodb","mysql","server","snowflake","microsoft","db"],filter:e=>{let{allowPrivateData:t}=e;return t},action:(e,t)=>{let{previousId:n}=t;e({type:"showModal",modal:"addDatabase",modalProps:{nodeId:n}})}},...h.map(e=>snippetToItem(e,"js","Data")),{type:"large",label:"Pizza Paradise sample",description:"Retail sales transactions",category:"Data",keywords:[],fullWidth:!0,positionByPreviousRow:!0,action:(e,t)=>{e({type:"insertAfter",id:t.previousId,node:{mode:"table",combine:null,display:t.display,data:{source:{type:"cell",name:"pizza"},operations:{...S.Zu.defaultNode.data.operations,from:{table:(0,_.Z)({type:"cell",name:"ordersByProductDay",dialect:"array"})}}}},trigger:"Implicit",source:"nodeInserterMenu"})}}]},I={title:"Observable Plot Charts",description:"Concise code, interactive charts",items:[...p.map(e=>snippetToItem(e,"js","Plot"))]},T={description:"Hierarchical and relational data",title:"D3 and Other Charts",items:[{label:"Circle packing",description:"Nested hierarchy with D3",keywords:["chart","graph"],thumbnail:e=>(0,d.jsxs)("svg",{width:"27",height:"16",viewBox:"0 0 27 16",fill:"none",...e,children:[(0,d.jsx)("circle",{cx:"22",cy:"6",r:"4.5",stroke:"#C4C4C4"}),(0,d.jsx)("circle",{cx:"20.5",cy:"5.5",r:"1.5",fill:"#C4C4C4"}),(0,d.jsx)("circle",{cx:"20.5",cy:"5.5",r:"1.5",stroke:"#6E6E6E"}),(0,d.jsx)("circle",{cx:"23",cy:"8",r:"1",fill:"#C4C4C4"}),(0,d.jsx)("circle",{cx:"23",cy:"8",r:"1",stroke:"#6E6E6E"}),(0,d.jsx)("circle",{cx:"24",cy:"5",r:"1",fill:"#C4C4C4"}),(0,d.jsx)("circle",{cx:"24",cy:"5",r:"1",stroke:"#6E6E6E"}),(0,d.jsx)("path",{d:"M14.5017 7.50005C14.5017 11.367 11.3669 14.5017 7.50005 14.5017C3.63316 14.5017 0.49841 11.367 0.498397 7.50005C0.498383 3.63313 3.63311 0.498371 7.5 0.498371C11.3669 0.498371 14.5016 3.63313 14.5017 7.50005Z",stroke:"#6E6E6E",strokeWidth:"0.996741"}),(0,d.jsx)("path",{d:"M9.00002 9.99999C9.00003 11.6568 7.6569 13 6.00004 13C4.34319 13 3.00003 11.6568 3.00002 9.99999C3.00001 8.34314 4.34315 7 6 7C7.65685 7 9.00001 8.34314 9.00002 9.99999Z",fill:"#6E6E6E"}),(0,d.jsx)("path",{d:"M9.00002 9.99999C9.00003 11.6568 7.6569 13 6.00004 13C4.34319 13 3.00003 11.6568 3.00002 9.99999C3.00001 8.34314 4.34315 7 6 7C7.65685 7 9.00001 8.34314 9.00002 9.99999Z",stroke:"#6E6E6E"}),(0,d.jsx)("path",{d:"M13 7.5C13 8.32842 12.3284 8.99999 11.5 8.99999C10.6716 8.99999 10 8.32842 10 7.5C10 6.67157 10.6716 6 11.5 6C12.3284 6 13 6.67157 13 7.5Z",fill:"#6E6E6E"}),(0,d.jsx)("path",{d:"M13 7.5C13 8.32842 12.3284 8.99999 11.5 8.99999C10.6716 8.99999 10 8.32842 10 7.5C10 6.67157 10.6716 6 11.5 6C12.3284 6 13 6.67157 13 7.5Z",stroke:"#6E6E6E"}),(0,d.jsx)("path",{d:"M8.00001 4C8.00002 5.10456 7.1046 5.99999 6.00003 5.99999C4.89546 5.99999 4.00002 5.10456 4.00001 4C4.00001 2.89543 4.89543 2 6 2C7.10457 2 8.00001 2.89543 8.00001 4Z",fill:"#6E6E6E"}),(0,d.jsx)("path",{d:"M8.00001 4C8.00002 5.10456 7.1046 5.99999 6.00003 5.99999C4.89546 5.99999 4.00002 5.10456 4.00001 4C4.00001 2.89543 4.89543 2 6 2C7.10457 2 8.00001 2.89543 8.00001 4Z",stroke:"#6E6E6E"})]}),mode:"js",type:"snippet",apply:(0,r.DB)('Pack(flare, {\n  path: (d) => d.name.replaceAll(".", "/"), // e.g. flare/animate/Easing\n  label: (d) => d.name.split(".").pop(), // display text\n  value: (d) => d?.size, // area of each circle\n  title: (d, n) => [n.id, n.value.toLocaleString()].join("\\n"), // hover text\n  width,\n  height: 720\n})'),imports:[["Pack","@d3/pack-component"]]},{label:"Icicle partition",description:"Left-to-right hierarchy with D3",keywords:["chart","graph"],thumbnail:e=>(0,d.jsxs)("svg",{width:"28",height:"16",viewBox:"0 0 28 16",fill:"none",...e,children:[(0,d.jsx)("rect",{width:"8",height:"5",fill:"#6E6E6E"}),(0,d.jsx)("rect",{y:"6",width:"8",height:"5",fill:"#C4C4C4"}),(0,d.jsx)("rect",{y:"12",width:"8",height:"4",fill:"#C4C4C4"}),(0,d.jsx)("rect",{x:"10",y:"2",width:"8",height:"3",fill:"#6E6E6E"}),(0,d.jsx)("rect",{x:"20",y:"2",width:"8",height:"1",fill:"#C4C4C4"}),(0,d.jsx)("rect",{x:"20",y:"4",width:"8",height:"1",fill:"#6E6E6E"}),(0,d.jsx)("rect",{x:"20",y:"15",width:"8",height:"1",fill:"#C4C4C4"}),(0,d.jsx)("rect",{x:"20",y:"12",width:"8",height:"2",fill:"#C4C4C4"}),(0,d.jsx)("rect",{x:"10",y:"12",width:"8",height:"4",fill:"#C4C4C4"}),(0,d.jsx)("rect",{x:"10",y:"8",width:"8",height:"3",fill:"#C4C4C4"}),(0,d.jsx)("rect",{x:"10",y:"6",width:"8",height:"1",fill:"#C4C4C4"})]}),mode:"js",type:"snippet",apply:(0,r.DB)('Icicle(flare, {\n  path: (d) => d.name.replaceAll(".", "/"), // e.g. flare/animate/Easing\n  label: (d) => d.name.split(".").pop(), // display text\n  value: (d) => d?.size, // height of each rect\n  title: (d, n) => [n.id, n.value.toLocaleString()].join("\\n"), // hover text\n  width,\n  height: 500\n})'),imports:[["Icicle","@d3/icicle-component"]]},{label:"Sunburst partition",description:"Radial hierarchy with D3",keywords:["chart","graph"],thumbnail:e=>(0,d.jsxs)("svg",{width:"28",height:"17",viewBox:"0 0 28 17",fill:"none",...e,children:[(0,d.jsx)("path",{d:"M13.4632 6.19505L12.1531 3.8762C12.677 3.62757 13.2423 3.47892 13.82 3.43753V6.10116C13.6985 6.1215 13.5791 6.15292 13.4632 6.19505Z",fill:"#C4C4C4"}),(0,d.jsx)("path",{d:"M13.82 2.76847C13.1273 2.81186 12.4492 2.99015 11.8241 3.29374L10.5105 0.968736C10.8271 0.80675 11.1532 0.666499 11.4867 0.548554C12.2362 0.283461 13.0225 0.131047 13.82 0.0977783V2.76847Z",fill:"#C4C4C4"}),(0,d.jsx)("path",{d:"M17.5783 12.1852L19.4169 14.1215C18.868 14.6012 18.2569 15.003 17.6011 15.3164C17.2386 15.4896 16.8625 15.6357 16.4756 15.7532C15.2167 16.1352 13.883 16.2008 12.5926 15.944C11.3023 15.6872 10.0952 15.116 9.07819 14.2811C8.96154 14.1853 8.84781 14.0864 8.73709 13.9845L10.6247 12.096C10.6722 12.1379 10.7205 12.179 10.7695 12.2193C11.4476 12.776 12.2524 13.1568 13.1128 13.328C13.9161 13.4879 14.7446 13.4604 15.5342 13.2486C15.5651 13.2404 15.5958 13.2318 15.6266 13.223C15.6517 13.2158 15.6767 13.2084 15.7017 13.2008C16.3908 12.9917 17.0288 12.6457 17.5783 12.1852Z",fill:"#C4C4C4"}),(0,d.jsx)("path",{d:"M15.2839 9.76902L17.1177 11.7001C16.6442 12.0897 16.0975 12.3831 15.508 12.562C15.3328 12.6151 15.155 12.6578 14.9758 12.6899C14.4038 12.7924 13.816 12.7873 13.2429 12.6733C12.4902 12.5235 11.7861 12.1903 11.1928 11.7033C11.1607 11.6769 11.129 11.6501 11.0976 11.6229L12.9803 9.73948C13.2128 9.90537 13.4782 10.0204 13.7593 10.0763C14.0851 10.1412 14.4218 10.1246 14.7397 10.0281C14.9337 9.96926 15.1171 9.88172 15.2839 9.76902Z",fill:"#C4C4C4"}),(0,d.jsx)("path",{d:"M12.1485 7.84781C12.1465 7.86392 12.1447 7.88005 12.1431 7.89622C12.1105 8.22696 12.16 8.56062 12.2871 8.86765C12.3459 9.00956 12.4204 9.14375 12.5089 9.26787L10.6262 11.1513C10.2995 10.774 10.0342 10.3453 9.8419 9.88093C9.54822 9.17161 9.43392 8.40077 9.50914 7.63669C9.52725 7.45277 9.5562 7.27061 9.59568 7.09111L12.1485 7.84781Z",fill:"#C4C4C4"}),(0,d.jsx)("path",{d:"M12.3379 7.20834C12.3777 7.12669 12.4231 7.04757 12.4738 6.97158C12.5872 6.80177 12.7253 6.65077 12.8829 6.52323L11.5728 4.20438C11.5438 4.22359 11.5151 4.2431 11.4867 4.26293C11.0098 4.59513 10.5978 5.01448 10.2732 5.50052C10.0738 5.79893 9.91036 6.11819 9.78507 6.45163L12.3379 7.20834Z",fill:"#C4C4C4"}),(0,d.jsx)("path",{d:"M9.14385 6.26156C9.28909 5.86421 9.4816 5.48407 9.71832 5.12963C10.1204 4.52763 10.6398 4.01514 11.2437 3.62192L9.93011 1.29692C8.96422 1.89754 8.13563 2.69847 7.50157 3.64781C7.1154 4.22601 6.80768 4.84983 6.5843 5.50285L9.14385 6.26156Z",fill:"#C4C4C4"}),(0,d.jsx)("path",{d:"M6.3949 6.14232C6.29877 6.52472 6.23072 6.91491 6.19184 7.30982C6.06289 8.61967 6.25883 9.94111 6.76229 11.1571C7.12253 12.0272 7.63227 12.824 8.26569 13.5129L10.1533 11.6244C9.7654 11.1845 9.45132 10.682 9.22541 10.1364C8.88973 9.32565 8.75909 8.44459 8.84507 7.57126C8.86734 7.34509 8.90395 7.12125 8.95445 6.90103L6.3949 6.14232Z",fill:"#C4C4C4"}),(0,d.jsx)("path",{d:"M14.4868 0.0977783V2.76847C15.2766 2.81793 16.0452 3.04262 16.7368 3.42561C16.7647 3.44108 16.7925 3.4568 16.8202 3.47278C16.9208 3.53092 17.0198 3.59247 17.1169 3.65736C17.9772 4.23245 18.6514 5.04518 19.0578 5.99613L21.5928 5.15077C21.5771 5.11091 21.561 5.07116 21.5446 5.03151C20.939 3.56906 19.9137 2.31909 18.5981 1.43966C18.0418 1.06783 17.4443 0.769298 16.8202 0.548555C16.072 0.283938 15.2857 0.131103 14.4868 0.0977783Z",fill:"#6E6E6E"}),(0,d.jsx)("path",{d:"M21.812 5.78072L19.2812 6.62468C19.4836 7.33155 19.5381 8.07374 19.44 8.80442L22.0707 9.24306C22.239 8.08247 22.15 6.90048 21.812 5.78072Z",fill:"#6E6E6E"}),(0,d.jsx)("path",{d:"M21.9476 9.89868L19.3101 9.45891C19.3086 9.46454 19.3071 9.47016 19.3056 9.47578C19.2973 9.50665 19.2888 9.53744 19.28 9.56813C19.0491 10.3719 18.6322 11.1114 18.0617 11.7259L19.9004 13.6621C20.5052 13.0373 21.0013 12.3211 21.3725 11.5435C21.6224 11.02 21.8157 10.4687 21.9476 9.89868Z",fill:"#6E6E6E"}),(0,d.jsx)("path",{d:"M14.4868 3.43753V6.10116C14.7677 6.14818 15.0368 6.25433 15.2757 6.41403C15.6079 6.63608 15.8668 6.9517 16.0197 7.32096C16.1726 7.69022 16.2126 8.09655 16.1347 8.48855C16.0752 8.78756 15.9492 9.068 15.7673 9.30965L17.6011 11.2408C18.1732 10.6134 18.5644 9.84066 18.7305 9.00512C18.7363 8.9758 18.7419 8.94644 18.7471 8.91706C18.9043 8.03879 18.8067 7.13314 18.4649 6.30767C18.1232 5.4822 17.5521 4.77278 16.8202 4.26293C16.7957 4.24587 16.771 4.22904 16.7462 4.21243C16.0714 3.76139 15.2925 3.49524 14.4868 3.43753Z",fill:"#6E6E6E"})]}),mode:"js",type:"snippet",apply:(0,r.DB)('Sunburst(flare, {\n  path: (d) => d.name.replaceAll(".", "/"), // e.g. flare/animate/Easing\n  label: (d) => d.name.split(".").pop(), // display text\n  value: (d) => d?.size, // angle of each arc\n  title: (d, n) => [n.id, n.value.toLocaleString()].join("\\n"), // hover text\n  width,\n  height: 720\n})'),imports:[["Sunburst","@d3/sunburst-component"]]},{label:"Treemap",description:"Nested hierarchy with D3",keywords:["chart","graph"],thumbnail:e=>(0,d.jsxs)("svg",{width:"28",height:"16",viewBox:"0 0 28 16",fill:"none",...e,children:[(0,d.jsx)("rect",{x:"1.52979",y:"1.25",width:"12",height:"8",fill:"#6E6E6E"}),(0,d.jsx)("rect",{x:"14.5298",y:"1.25",width:"12",height:"7",fill:"#C4C4C4"}),(0,d.jsx)("rect",{x:"14.5298",y:"9.25",width:"6",height:"5",fill:"#C4C4C4"}),(0,d.jsx)("rect",{x:"21.5298",y:"9.25",width:"5",height:"3",fill:"#C4C4C4"}),(0,d.jsx)("rect",{x:"21.5298",y:"13.25",width:"5",height:"1",fill:"#C4C4C4"}),(0,d.jsx)("rect",{x:"1.52979",y:"10.25",width:"12",height:"4",fill:"#C4C4C4"})]}),mode:"js",type:"snippet",apply:(0,r.DB)('Treemap(flare, {\n  path: (d) => d.name.replaceAll(".", "/"), // e.g. flare/animate/Easing\n  label: (d) => d.name.split(".").pop(), // display text\n  group: (d) => d.name.split(".")[1], // for color; e.g. animate\n  value: (d) => d?.size, // area of each rect\n  title: (d, n) => [n.id, n.value.toLocaleString()].join("\\n"), // hover text\n  width,\n  height: 500\n})'),imports:[["Treemap","@d3/treemap-component"]]},{label:"Force-directed graph",description:"Node-link diagram with D3",keywords:["chart","graph"],thumbnail:e=>(0,d.jsxs)("svg",{width:"28",height:"16",viewBox:"0 0 28 16",fill:"none",...e,children:[(0,d.jsx)("rect",{x:"9.29736",y:"4.06012",width:"9.33906",height:"2",transform:"rotate(122.01 9.29736 4.06012)",fill:"#D9D9D9"}),(0,d.jsx)("rect",{x:"9.3042",y:"3.01831",width:"13.1183",height:"2",transform:"rotate(45 9.3042 3.01831)",fill:"#D9D9D9"}),(0,d.jsx)("rect",{x:"16.6357",y:"11.8877",width:"8.91597",height:"2",transform:"rotate(-40.6 16.6357 11.8877)",fill:"#D9D9D9"}),(0,d.jsx)("rect",{x:"10.2227",y:"2.72424",width:"12.998",height:"2",transform:"rotate(11.1371 10.2227 2.72424)",fill:"#D9D9D9"}),(0,d.jsx)("path",{d:"M8.5 6C9.88071 6 11 4.88071 11 3.5C11 2.11929 9.88071 1 8.5 1C7.11929 1 6 2.11929 6 3.5C6 4.88071 7.11929 6 8.5 6Z",fill:"#6E6E6E"}),(0,d.jsx)("path",{d:"M17.5 15C18.8807 15 20 13.8807 20 12.5C20 11.1193 18.8807 10 17.5 10C16.1193 10 15 11.1193 15 12.5C15 13.8807 16.1193 15 17.5 15Z",fill:"#6E6E6E"}),(0,d.jsx)("path",{d:"M24.5 9C25.8807 9 27 7.88071 27 6.5C27 5.11929 25.8807 4 24.5 4C23.1193 4 22 5.11929 22 6.5C22 7.88071 23.1193 9 24.5 9Z",fill:"#6E6E6E"}),(0,d.jsx)("path",{d:"M3.5 14C4.88071 14 6 12.8807 6 11.5C6 10.1193 4.88071 9 3.5 9C2.11929 9 1 10.1193 1 11.5C1 12.8807 2.11929 14 3.5 14Z",fill:"#6E6E6E"})]}),mode:"js",type:"snippet",apply:(0,r.DB)("ForceGraph(miserables, {\n  nodeId: (d) => d.id, // node identifier, to match links\n  nodeGroup: (d) => d.group, // group identifier, for color\n  nodeTitle: (d) => d.id, // hover text\n  width,\n  height: 520,\n  invalidation // stop when the cell is re-run\n})"),imports:[["ForceGraph","@d3/force-directed-graph-component"]]},{label:"Graphviz graph",description:"Node-link diagram with DOT",keywords:["chart","graph"],thumbnail:e=>(0,d.jsxs)("svg",{width:"28",height:"16",viewBox:"0 0 28 16",fill:"none",...e,children:[(0,d.jsx)("rect",{x:"6",y:"6.1825",width:"15.7193",height:"2",transform:"rotate(-14.04 6 6.1825)",fill:"#D9D9D9"}),(0,d.jsx)("rect",{width:"15.7193",height:"2",transform:"matrix(0.970127 0.242599 0.242599 -0.970127 6 8.94025)",fill:"#D9D9D9"}),(0,d.jsx)("circle",{cx:"21.5",cy:"3.5",r:"2.5",fill:"#6E6E6E"}),(0,d.jsx)("circle",{cx:"21.5",cy:"11.5",r:"2.5",fill:"#6E6E6E"}),(0,d.jsx)("circle",{cx:"5.5",cy:"7.5",r:"2.5",fill:"#6E6E6E"})]}),apply:insertAndSelect("dot`digraph g {\n	rankdir = LR;\n	a -> b -> c;\n}`",4,1)},{label:"Mermaid graph",description:"Node-link diagram with Mermaid",keywords:["chart","graph"],thumbnail:e=>(0,d.jsxs)("svg",{width:"28",height:"16",viewBox:"0 0 28 16",fill:"none",...e,children:[(0,d.jsx)("rect",{x:"6",y:"6.1825",width:"15.7193",height:"2",transform:"rotate(-14.04 6 6.1825)",fill:"#D9D9D9"}),(0,d.jsx)("rect",{width:"15.7193",height:"2",transform:"matrix(0.970127 0.242599 0.242599 -0.970127 6 8.94025)",fill:"#D9D9D9"}),(0,d.jsx)("rect",{x:"19",y:"1",width:"5",height:"5",fill:"#6E6E6E"}),(0,d.jsx)("rect",{x:"19",y:"9",width:"5",height:"5",fill:"#6E6E6E"}),(0,d.jsx)("rect",{x:"3",y:"5",width:"5",height:"5",fill:"#6E6E6E"})]}),apply:insertAndSelect("mermaid`graph LR\na-->b\nb-->c`",8,1)},{label:"Interactive map",description:"Zoomable map with Leaflet",keywords:["chart","graph"],thumbnail:e=>(0,d.jsxs)("svg",{width:"28",height:"16",viewBox:"0 0 28 16",fill:"none",...e,children:[(0,d.jsx)("ellipse",{cx:"25.4585",cy:"7.46379",rx:"0.258013",ry:"0.566483",transform:"rotate(30.0385 25.4585 7.46379)",fill:"#6E6E6E"}),(0,d.jsx)("ellipse",{cx:"26.0462",cy:"11.7369",rx:"1.84775",ry:"1.42429",fill:"#6E6E6E"}),(0,d.jsx)("path",{d:"M15.6592 6.6757C15.6592 7.64639 14.7727 8.43328 13.6791 8.43328C12.5856 8.43328 11.699 7.64639 11.699 6.6757C11.699 5.70502 12.5856 4.91812 13.6791 4.91812C14.7727 4.91812 15.6592 5.70502 15.6592 6.6757Z",fill:"#6E6E6E"}),(0,d.jsx)("path",{d:"M16.6127 10.2063C16.6127 11.5394 16.1142 12.6201 15.4994 12.6201C14.8845 12.6201 14.3861 11.5394 14.3861 10.2063C14.3861 8.87324 14.8845 7.79257 15.4994 7.79257C16.1142 7.79257 16.6127 8.87324 16.6127 10.2063Z",fill:"#6E6E6E"}),(0,d.jsx)("path",{d:"M17.3387 7.61682C17.3387 8.91754 16.5623 9.97198 15.6047 9.97198C14.647 9.97198 13.8707 8.91754 13.8707 7.61682C13.8707 6.31609 14.647 5.26165 15.6047 5.26165C16.5623 5.26165 17.3387 6.31609 17.3387 7.61682Z",fill:"#6E6E6E"}),(0,d.jsx)("path",{d:"M18.6356 6.54681C18.6356 7.09687 18.1163 7.54278 17.4757 7.54278C16.8351 7.54278 16.3158 7.09687 16.3158 6.54681C16.3158 5.99676 16.8351 5.55085 17.4757 5.55085C18.1163 5.55085 18.6356 5.99676 18.6356 6.54681Z",fill:"#6E6E6E"}),(0,d.jsx)("path",{d:"M18.0793 7.72407C18.3127 7.95741 18.1792 8.46933 17.7812 8.86749C17.3831 9.26565 16.8712 9.39927 16.6378 9.16594C16.4044 8.93261 16.5379 8.42068 16.9359 8.02252C17.334 7.62436 17.8459 7.49074 18.0793 7.72407Z",fill:"#6E6E6E"}),(0,d.jsx)("path",{d:"M16.7052 9.19542C17.0033 9.26191 17.1518 9.73382 17.0368 10.2495C16.9218 10.7651 16.5869 11.1292 16.2888 11.0627C15.9906 10.9962 15.8421 10.5243 15.9571 10.0087C16.0721 9.49303 16.407 9.12893 16.7052 9.19542Z",fill:"#6E6E6E"}),(0,d.jsx)("ellipse",{cx:"17.6077",cy:"10.9061",rx:"0.724569",ry:"0.318663",transform:"rotate(-77.4285 17.6077 10.9061)",fill:"#6E6E6E"}),(0,d.jsx)("ellipse",{cx:"6.4348",cy:"9.17572",rx:"1.11083",ry:"1.60184",fill:"#6E6E6E"}),(0,d.jsx)("ellipse",{cx:"7.46807",cy:"11.501",rx:"1.11083",ry:"1.60184",fill:"#6E6E6E"}),(0,d.jsx)("ellipse",{cx:"8.40917",cy:"9.97388",rx:"1.17553",ry:"1.8408",transform:"rotate(-19.3859 8.40917 9.97388)",fill:"#6E6E6E"}),(0,d.jsx)("ellipse",{cx:"7.31122",cy:"13.7718",rx:"0.624042",ry:"1.34545",transform:"rotate(-19.3859 7.31122 13.7718)",fill:"#6E6E6E"}),(0,d.jsx)("path",{d:"M7.08052 1.7995C7.08052 2.10628 5.66939 2.35498 3.92866 2.35498C2.18794 2.35498 0.776805 2.10628 0.776805 1.7995C0.776805 1.49272 2.18794 1.24402 3.92866 1.24402C5.66939 1.24402 7.08052 1.49272 7.08052 1.7995Z",fill:"#6E6E6E"}),(0,d.jsx)("path",{d:"M2.48208 1.9416H6.02148V5.0936H2.48208V1.9416Z",fill:"#6E6E6E"}),(0,d.jsx)("path",{d:"M7.48666 4.08784C6.72705 4.72446 5.85123 4.93029 5.53047 4.54757C5.20972 4.16485 5.56548 3.3385 6.32509 2.70187C7.0847 2.06524 7.96051 1.85941 8.28127 2.24214C8.60203 2.62486 8.24627 3.45121 7.48666 4.08784Z",fill:"#6E6E6E"}),(0,d.jsx)("path",{d:"M11.0795 1.33904C10.2023 1.41405 9.46573 1.17822 9.43444 0.812298C9.40315 0.446374 10.089 0.0889244 10.9662 0.013912C11.8435 -0.0611004 12.58 0.17473 12.6113 0.540654C12.6426 0.906578 11.9568 1.26403 11.0795 1.33904Z",fill:"#6E6E6E"}),(0,d.jsx)("path",{d:"M11.0201 1.91208C10.2393 2.31899 9.46875 2.38484 9.29902 2.05915C9.12929 1.73347 9.62466 1.13958 10.4055 0.732673C11.1863 0.325763 11.9568 0.259918 12.1265 0.585604C12.2963 0.911289 11.8009 1.50517 11.0201 1.91208Z",fill:"#6E6E6E"}),(0,d.jsx)("path",{d:"M4.77225 5.73417C3.63726 6.32566 2.41419 6.22379 2.04045 5.50663C1.6667 4.78946 2.28381 3.72859 3.41879 3.13709C4.55378 2.5456 5.77685 2.64748 6.1506 3.36464C6.52434 4.0818 5.90724 5.14268 4.77225 5.73417Z",fill:"#6E6E6E"}),(0,d.jsx)("path",{d:"M9.09603 0.998586C9.09603 1.37671 8.50617 1.68324 7.77854 1.68324C7.05091 1.68324 6.46105 1.37671 6.46105 0.998586C6.46105 0.620463 7.05091 0.313933 7.77854 0.313933C8.50617 0.313933 9.09603 0.620463 9.09603 0.998586Z",fill:"#6E6E6E"}),(0,d.jsx)("path",{d:"M3.95493 6.51459C3.95493 6.87131 3.69467 7.16049 3.37362 7.16049C3.05257 7.16049 2.79231 6.87131 2.79231 6.51459C2.79231 6.15787 3.05257 5.8687 3.37362 5.8687C3.69467 5.8687 3.95493 6.15787 3.95493 6.51459Z",fill:"#6E6E6E"}),(0,d.jsx)("path",{d:"M5.04151 7.19305C5.61751 7.76782 5.94143 8.37708 5.76502 8.55386C5.58861 8.73065 4.97866 8.40802 4.40267 7.83325C3.82668 7.25848 3.50275 6.64923 3.67917 6.47244C3.85558 6.29565 4.46552 6.61828 5.04151 7.19305Z",fill:"#6E6E6E"}),(0,d.jsx)("path",{d:"M6.14613 6.55623C6.5077 6.73897 6.76059 6.96668 6.71099 7.06483C6.66139 7.16297 6.32806 7.0944 5.96649 6.91166C5.60492 6.72892 5.35203 6.50121 5.40163 6.40306C5.45124 6.30492 5.78456 6.37349 6.14613 6.55623Z",fill:"#6E6E6E"}),(0,d.jsx)("path",{d:"M6.10864 5.37979C5.91898 5.85996 5.58719 6.1789 5.36758 6.09215C5.14796 6.0054 5.12367 5.54583 5.31333 5.06566C5.50299 4.58549 5.83477 4.26656 6.05439 4.3533C6.27401 4.44005 6.29829 4.89962 6.10864 5.37979Z",fill:"#6E6E6E"}),(0,d.jsx)("path",{d:"M8.79832 3.44371C8.68158 3.73928 8.4089 3.90857 8.18928 3.82182C7.96966 3.73508 7.88627 3.42515 8.00301 3.12958C8.11976 2.83401 8.39244 2.66472 8.61205 2.75146C8.83167 2.83821 8.91506 3.14814 8.79832 3.44371Z",fill:"#6E6E6E"}),(0,d.jsx)("path",{d:"M1.08731 2.63002C0.556957 2.85516 0.0735116 2.91164 0.00750903 2.75616C-0.0584936 2.60068 0.31794 2.29213 0.848297 2.06698C1.37865 1.84184 1.8621 1.78537 1.9281 1.94084C1.9941 2.09632 1.61767 2.40488 1.08731 2.63002Z",fill:"#6E6E6E"}),(0,d.jsx)("path",{d:"M24.7106 0.839536H18.448V1.22147C18.337 1.18901 18.2106 1.1706 18.0758 1.1706C17.6843 1.1706 17.3597 1.32611 17.2993 1.52972L17.2482 1.52924C17.1258 1.52924 17.0064 1.53741 16.8909 1.55302C16.8443 1.55934 16.7982 1.56687 16.7526 1.57557C16.5455 1.32252 16.0242 1.14301 15.4136 1.14301C14.6212 1.14301 13.9789 1.44562 13.9789 1.81892C13.9789 1.91373 14.0205 2.00398 14.0954 2.08588C13.9779 2.11731 13.859 2.15467 13.7405 2.19809C12.4808 2.6589 11.6775 3.62761 11.9461 4.36176C12.2147 5.09591 13.4536 5.31749 14.7129 4.85668C15.1876 4.68294 15.598 4.43704 15.9102 4.15871V5.88813H18.448V6.19159H19.9377C19.9303 6.24318 19.9243 6.29576 19.9199 6.34919C19.9169 6.38413 19.9144 6.41942 19.9129 6.45504C19.9114 6.49557 19.9105 6.53652 19.9105 6.57783C19.9105 7.46155 20.3243 8.17794 20.8347 8.17794C21.3451 8.17794 21.759 7.46155 21.759 6.57783L21.7575 6.49244C21.7565 6.45679 21.755 6.42145 21.7525 6.38645C21.7476 6.32017 21.7406 6.25514 21.7317 6.19159H22.0875C22.0528 6.30429 22.0345 6.42489 22.0345 6.55024C22.0345 7.17494 22.4979 7.68136 23.0693 7.68136C23.1129 7.68136 23.156 7.6784 23.1981 7.67267C23.1827 7.74834 23.1699 7.82774 23.1609 7.90982C23.1352 8.14325 23.1401 8.36156 23.1708 8.53861C22.8111 8.27445 22.478 8.1557 22.3784 8.27094C22.2615 8.40671 22.5127 8.81582 22.9399 9.18473C23.3671 9.55364 23.8087 9.74262 23.9256 9.60685C24.0208 9.4967 23.8736 9.20652 23.5861 8.90393C23.7398 8.7645 23.8756 8.41458 23.9221 7.99445C23.9544 7.70454 23.938 7.43795 23.8855 7.24477C24.0222 7.05307 24.1035 6.81205 24.1035 6.55024C24.1035 6.42489 24.0847 6.30429 24.0505 6.19159H24.7106V5.00423C25.2017 4.97788 25.5937 4.48205 25.5937 3.87422C25.5937 3.26638 25.2017 2.77055 24.7106 2.7442V2.68264C24.9534 2.72142 25.2245 2.7431 25.511 2.7431C25.6899 2.7431 25.8628 2.73465 26.0264 2.71885C26.3247 3.11842 26.6503 3.36096 26.7821 3.27087C26.8887 3.19816 26.8391 2.92918 26.677 2.60556C27.1092 2.48932 27.3867 2.30991 27.3867 2.10858C27.3867 1.75815 26.5467 1.47406 25.511 1.47406C25.2245 1.47406 24.9534 1.49574 24.7106 1.53452V0.839536Z",fill:"#6E6E6E"}),(0,d.jsx)("path",{d:"M24.1784 9.40864C24.385 9.53883 24.7359 9.35316 24.9624 8.99392C25.1888 8.63469 25.2052 8.23792 24.9985 8.10772C24.7924 7.97752 24.4415 8.16319 24.2145 8.52244C23.9881 8.88167 23.9722 9.27844 24.1784 9.40864Z",fill:"#6E6E6E"}),(0,d.jsx)("path",{d:"M27.5225 9.03166C27.9497 9.40055 28.1221 9.90062 27.9081 10.1486C27.694 10.3966 27.1741 10.2985 26.7469 9.92961C26.3197 9.5607 26.1468 9.06064 26.3609 8.81268C26.575 8.5647 27.0948 8.66275 27.5225 9.03166Z",fill:"#6E6E6E"}),(0,d.jsx)("path",{d:"M25.1254 9.59457C25.6641 9.76356 26.0571 10.0393 26.0036 10.2105C25.9495 10.3816 25.4693 10.3834 24.9311 10.2144C24.3924 10.0454 23.9994 9.76965 24.053 9.59849C24.107 9.42735 24.5867 9.4256 25.1254 9.59457Z",fill:"#6E6E6E"}),(0,d.jsx)("path",{d:"M26.3267 4.55867C26.2642 5.11967 26.0734 5.55882 25.9 5.53956C25.7265 5.52029 25.6368 5.0499 25.6993 4.48891C25.7617 3.92791 25.9525 3.48877 26.126 3.50804C26.2989 3.5273 26.3891 3.99768 26.3267 4.55867Z",fill:"#6E6E6E"})]}),apply:(0,l.eu)(e=>"#{1:".concat(e("map"),'} = {\n  const container = yield htl.html`<div style="height: 500px;">`;\n  const map = L.map(container).setView([#{2:37.774}, #{3:-122.423}], #{4:13});\n  L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {\n    attribution: "\xa9 <a href=https://www.openstreetmap.org/copyright>OpenStreetMap</a> contributors"\n  }).addTo(map);\n  }'))},{label:"D3 starter",thumbnail:e=>(0,d.jsx)("svg",{width:"50",height:"30",viewBox:"0 0 50 30",fill:"none",...e,children:(0,d.jsx)("path",{d:"M15 5H16.776C19.5414 5 22.1935 6.00089 24.149 7.78249C26.1044 9.56408 27.203 11.9804 27.203 14.5C27.203 17.0196 26.1044 19.4359 24.149 21.2175C22.1935 22.9991 19.5414 24 16.776 24H15V19.8242H16.776C18.3259 19.8242 19.8122 19.2632 20.9081 18.2648C22.004 17.2663 22.6197 15.9121 22.6197 14.5C22.6197 13.0879 22.004 11.7337 20.9081 10.7352C19.8122 9.73676 18.3259 9.17582 16.776 9.17582H15V5ZM23.3074 5H30.6406C31.849 4.99999 33.0323 5.31362 34.052 5.90417C35.0718 6.49472 35.8857 7.33774 36.3986 8.33453C36.9115 9.33132 37.1021 10.4406 36.9481 11.5325C36.7941 12.6244 36.3018 13.6538 35.5289 14.5C36.3018 15.3462 36.7941 16.3756 36.9481 17.4675C37.1021 18.5594 36.9115 19.6687 36.3986 20.6655C35.8857 21.6623 35.0718 22.5053 34.052 23.0958C33.0323 23.6864 31.849 24 30.6406 24H23.3074C25.1119 22.9702 26.5921 21.5313 27.6034 19.8242H30.6404C30.8736 19.8242 31.1046 19.7823 31.3201 19.701C31.5355 19.6197 31.7313 19.5005 31.8962 19.3502C32.0612 19.2 32.192 19.0216 32.2812 18.8253C32.3705 18.629 32.4164 18.4185 32.4164 18.206C32.4164 17.9935 32.3705 17.7831 32.2812 17.5868C32.192 17.3905 32.0612 17.2121 31.8962 17.0619C31.7313 16.9116 31.5355 16.7924 31.3201 16.7111C31.1046 16.6298 30.8736 16.5879 30.6404 16.5879H28.8644C29.1515 15.2083 29.1515 13.7917 28.8644 12.4121H30.6404C30.8736 12.4121 31.1046 12.3702 31.3201 12.2889C31.5355 12.2076 31.7313 12.0884 31.8962 11.9381C32.0612 11.7879 32.192 11.6095 32.2812 11.4132C32.3705 11.2169 32.4164 11.0065 32.4164 10.794C32.4164 10.5815 32.3705 10.371 32.2812 10.1747C32.192 9.9784 32.0612 9.80002 31.8962 9.64976C31.7313 9.49951 31.5355 9.38032 31.3201 9.299C31.1046 9.21768 30.8736 9.17582 30.6404 9.17582H27.6034C26.5921 7.46865 25.1119 6.02981 23.3074 5V5Z",fill:"currentColor"})}),description:"Scales, axes, margins, and a line",apply:(0,l.eu)(e=>"".concat(e("chart"),' = {\n  const width = 640;\n  const height = 400;\n  const marginTop = 20;\n  const marginRight = 30;\n  const marginBottom = 30;\n  const marginLeft = 40;\n\n  const x = d3.scaleUtc()\n      .domain(d3.extent(aapl, d => d.Date))\n      .range([marginLeft, width - marginRight]);\n\n  const y = d3.scaleLinear()\n      .domain([0, d3.max(aapl, d => d.Close)])\n      .range([height - marginBottom, marginTop]);\n\n  const svg = d3.create("svg")\n      .attr("viewBox", [0, 0, width, height])\n      .attr("width", width)\n      .attr("height", height)\n      .attr("style", "max-width: 100%; height: auto;");\n\n  svg.append("g")\n      .attr("transform", `translate(0,$\\{height - marginBottom})`)\n      .call(d3.axisBottom(x));\n\n  svg.append("g")\n      .attr("transform", `translate($\\{marginLeft},0)`)\n      .call(d3.axisLeft(y));\n\n  svg.append("path")\n      .attr("fill", "none")\n      .attr("stroke", "steelblue")\n      .attr("stroke-width", 1.5)\n      .attr("d", d3.line()\n        .x(d => x(d.Date))\n        .y(d => y(d.Close))\n        (aapl));\n\n  return svg.node();\n}'))}].map(e=>snippetToItem(e,"js","Trees and Networks"))},D={title:"Notifications",description:"Send messages from notebooks",items:[{label:"Email notification",description:"Email a workspace member",newUntil:new Date(2023,11,15),apply:(0,l.eu)(e=>"".concat(e("notify"),' = (await NotificationClient("email:#{you@example.com}")).send(#{"Hello"})'))},{label:"Slack notification",description:"Message a Slack channel or user",newUntil:new Date(2023,11,15),apply:(0,l.eu)(e=>"".concat(e("notify"),' = (await NotificationClient("slack:#{#random}")).send(#{"Hello"})'))},{label:"Scheduler-only code",description:"Run when you set a schedule",newUntil:new Date(2023,11,15),apply:(0,l.eu)(e=>"".concat(e("run"),' = {\n  if (currentUser.login === "scheduler") {\n    #{// This will run only when the notebook is run on a schedule}\n  }\n}'))}].map(e=>({...snippetToItem(e,"js","Notifications"),filter:e=>{let{allowSchedules:t,allowPrivateData:n}=e;return t&&n}}))},M={title:"Inputs",description:"Buttons, sliders, and text inputs",items:f.filter(e=>{let{label:t}=e;return"Table\xa0input"!==t}).map(e=>snippetToItem(e,"js","Inputs"))},P={title:"Text",description:"Format text and display HTML",items:[{label:S.ru.label,description:"Rich text and custom presentation",type:"large",action:(e,t)=>{let{nextId:n,trigger:r,combine:i,display:o}=t;return e({type:"insertBefore",id:n,node:{mode:"html",combine:i,display:o},trigger:r,source:"nodeInserterMenu"})}},...u.map(e=>{let{label:t,description:n,apply:r}=e;return{label:t,description:n,apply:r}}).map(e=>snippetToItem(e,"md","Text")),snippetToItem({label:"Mathematical formula",description:"Typeset math with TeX",keywords:["LaTex"],apply:insertAndSelect("c = \\pm\\sqrt{a^2 + b^2}")},"tex","Text"),{...snippetToItem(u.find(e=>{let{label:t}=e;return"Table"===t}),"md","Tables"),label:"Markdown table",description:"Rows and columns in Markdown"},{label:"Data-driven table",category:"Tables",description:"Dynamic HTML table from data",type:"large",action:(e,t)=>{let{previousId:n,combine:r,display:i}=t;return e({type:"insertSnippet",apply:insert('<table>\n  <thead>\n    <tr>\n      <th>Name</th>\n      <th>Fuel economy</th>\n      <th>Year</th>\n    </tr>\n  </thead>\n  <tbody>\n    ${cars.slice(0, 5).map(car => htl.html`<tr>\n      <td>${car["name"]}</td>\n      <td>${car["economy (mpg)"]} mpg</td>\n      <td>’${car["year"]}</td>\n    </tr>`)}\n  </tbody>\n  </table>'),label:"Insert",mode:"html",afterId:n,combine:r,display:i})}}]},R={title:"Imports",description:"Import libraries and modules",items:m.map(e=>snippetToItem(e,"js","Imports"))},A={title:"Sample Data",description:"Built-in sample data",items:[...[{label:"cars",description:"1983 ASA Data Exposition"},{label:"diamonds",description:"50,000 diamond prices"},{label:"olympians",description:"2016 Olympic Games"},{label:"penguins",description:"Palmer Station, Antarctica"}].map(e=>{let t={type:"large",label:e.label,category:"Datasets",keywords:[],fullWidth:!0,positionByPreviousRow:!0,description:e.description,action:(t,n)=>{t({type:"insertAfter",id:n.previousId,trigger:"Implicit",source:"nodeInserterMenu",node:{mode:"table",combine:null,display:n.display,data:{source:{type:"cell",name:e.label},operations:{...S.Zu.defaultNode.data.operations,from:{table:{table:e.label}}}}}})}};return t})].sort((e,t)=>e.label.localeCompare(t.label))},O=[N,L,I,M,T,P,{title:"Graphics",description:"SVG and Canvas",items:[{type:"large",label:"Upload image…",category:"Graphics",description:"PNG, JPEG, GIF, SVG, …",keywords:["jpg"],filter:e=>{let{allowFileAttachments:t}=e;return t},action:(e,t)=>{let{nextId:n,combine:r,display:i}=t;(0,C.Z)().then(t=>{e({type:"attachLocalFiles",files:t,beforeId:n,source:"filesPane",trigger:"click",combine:r,display:i})})}},{label:"SVG",category:"Graphics",description:"Expressive declarative graphics",type:"large",action:(e,t)=>{let{previousId:n,combine:r,display:i}=t;return e({type:"insertSnippet",apply:insert('<svg width=${width} height="200" viewBox="0 0 ${width} 200">\n  <rect width="100%" height="100%" fill="hsl(216deg 100% 13%)" />\n</svg>'),label:"SVG",mode:"html",afterId:n,combine:r,display:i})}},{label:"Canvas",category:"Graphics",description:"Low-level, high-performance",type:"large",action:(e,t)=>{let{previousId:n,combine:r,display:i}=t;return e({type:"insertSnippet",apply:(0,l.eu)(e=>"".concat(e("canvas"),' = {\n  const context = DOM.context2d(width, 200);\n  context.fillStyle = "hsl(216deg 100% 13%)";\n  context.fillRect(0, 0, width, 200);\n  return context.canvas;\n}')),label:"Canvas",mode:"js",afterId:n,combine:r,display:i})}}]},D,R,A].map(e=>({...e,items:e.items.map(t=>{var n;return{...t,keywords:[...t.keywords||[],...t.label.split(" "),...(null===(n=e.title)||void 0===n?void 0:n.split(" "))||[]]}})})),F=[...["js","md","html"].map(e=>{let{label:t,icon:n}=S.qz[e];return{label:"Insert as ".concat(t),type:"small",icon:n,action:(t,n)=>{let{previousId:r,filter:i,combine:o,display:l}=n;return t({type:"insertSnippet",apply:insert(i),label:"Insert",mode:e,afterId:r,combine:o,display:l})}}})],B="Search Observable…",$={label:B,description:"Search Observable for notebooks, users, and collections",type:"small",icon:v.Z},V="Ask ".concat(b.u7,"…"),Z={label:V,description:"Ask ".concat(b.u7," for suggestions"),type:"small",icon:y.P$};function snippetToItem(e,t,n){var r;return{type:"large",label:e.label,category:n,keywords:null!==(r=e.keywords)&&void 0!==r?r:[],description:e.description,icon:e.thumbnail,newUntil:e.newUntil,action:(n,r)=>{let{previousId:i,combine:o,display:l}=r;return n({type:"insertSnippet",apply:e.apply,label:e.label,mode:t,afterId:i,imports:e.imports,combine:o,display:l})}}}function insert(e){return(t,n,r,o)=>{t.dispatch(t.state.update({changes:{from:r,to:o,insert:e},selection:i.jT.cursor(r+e.length)}))}}function insertAndSelect(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return(r,o,l,s)=>{r.dispatch(r.state.update({changes:{from:l,to:s,insert:e},selection:i.jT.range(t,e.length-n)}))}}for(let e of O)for(let t of e.items)t.category=e.title;{let e=new Set;for(let t of O)for(let n of t.items){for(;e.has(n.label);)n.label+=" ";e.add(n.label)}}},14997:function(e,t,n){"use strict";n.d(t,{F:function(){return maybeFormatJavaScript},Y:function(){return maybeFormat}});var r=n(78120),i=n(61539),o=n(63230),l=n(13961);function parseCellForPrettier(e){let t=[],n=function visitNode(e,t){let n;if(Array.isArray(e))n=e.entries();else{if(!e||"object"!=typeof e||"string"!=typeof e.type)return e;n=Object.entries(e)}for(let[r,i]of n)e[r]=visitNode(i,t);return Array.isArray(e)?e:t(e)||e}(i.b3.parse(e,{onComment:t,onToken:[],ranges:!0}),e=>{if("ChainExpression"===e.type)return function transformChainExpression(e){return"CallExpression"===e.type?(e.type="OptionalCallExpression",e.callee=transformChainExpression(e.callee)):"MemberExpression"===e.type?(e.type="OptionalMemberExpression",e.object=transformChainExpression(e.object)):"TSNonNullExpression"===e.type&&(e.expression=transformChainExpression(e.expression)),e}(e.expression)}),{body:r,id:o}=n,l=r&&null!==r.id&&("FunctionExpression"===r.type||"ClassExpression"===r.type)&&r.id;return{type:"Program",body:[o&&o!==l?n:n.body],start:0,end:e.length,comments:t}}async function maybeFormat(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];try{let i=await n.e(3502).then(n.t.bind(n,98645,23)),s=await n.e(8592).then(n.t.bind(n,43341,23)),{state:a}=e,d=a.field(l.C),c=a.doc.toString(),u=a.selection.main,p=u.from!==u.to;if("js"===d){if(p){let{formatted:t,cursorOffset:n}=i.formatWithCursor(c,{trailingComma:"none",parser:"typescript",plugins:[{parsers:{typescript:{astFormat:"estree",locStart:e=>e.start,locEnd:e=>e.end,parse:e=>{let t=[];if(e!==c){let n=o._b.parse(e,{ecmaVersion:13,onComment:t,onToken:[],ranges:!0,allowAwaitOutsideFunction:!0,allowReturnOutsideFunction:!0,allowImportExportEverywhere:!0});return{...n,comments:t}}return parseCellForPrettier(e)}}}}],cursorOffset:u.to,rangeStart:u.from,rangeEnd:u.to}),l=r.jT.single(Math.min(u.from,t.length),Math.min(n,t.length));e.dispatch(a.update({changes:{from:0,to:c.length,insert:t},selection:l}))}else{let t=parseCellForPrettier(c),n=!t.body[0]||"ImportDeclaration"!==t.body[0].type,{formatted:o,cursorOffset:l}=i.formatWithCursor(c,{trailingComma:"none",semi:n,parser:()=>t,cursorOffset:u.to});o=o.trim();let s=r.jT.single(Math.max(0,Math.min(l,o.length)));e.dispatch(a.update({changes:{from:0,to:c.length,insert:o},selection:s}))}}else if("md"===d&&!t){let t=p?u.from:0,n=p?u.to:c.length,{formatted:o,cursorOffset:l}=i.formatWithCursor(c.slice(t,n),{parser:"markdown",cursorOffset:p?u.to-u.from:u.from,proseWrap:"always",plugins:[s]});e.dispatch(a.update({changes:{from:t,to:n,insert:o},selection:p?r.jT.single(u.from,u.from+l):r.jT.single(l)}));return}}catch(e){e instanceof SyntaxError||console.error("prettier failed",e)}}async function maybeFormatJavaScript(e){try{let t=await n.e(3502).then(n.t.bind(n,98645,23)),r=parseCellForPrettier(e);return t.format(e,{trailingComma:"none",parser:()=>r}).trim()}catch(t){return console.error("prettier failed to format text",t),e}}},49817:function(e,t,n){"use strict";function getNumResults(e){if(!e)return 0;let t=0;for(let[,n]of e)t+=n.length;return t}function getAbsoluteIndex(e,t){if(!e||!t)return;let{nodeId:n,nodeResultIndex:r}=t,i=r;for(let[t,r]of e){if(n===t)break;i+=r.length}return i}n.d(t,{_:function(){return getAbsoluteIndex},n:function(){return getNumResults}})},64709:function(e,t,n){"use strict";function nonempty(e){return e.length>0}function sluggify(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.normalize("NFD").replace(/[\u0300-\u036f'‘’]/g,"").toLowerCase().split(t?/[^a-z0-9_.]+/g:/\W+/g).filter(nonempty),r=n.length,i=0,o=-1;for(;++o<r;)if((i+=n[o].length)>50){n[o]=n[o].substring(0,50-i+n[o].length);break}return n.slice(0,o+1).filter(Boolean).join("-")||"untitled"}n.d(t,{O:function(){return sluggify}})},61091:function(e,t,n){"use strict";function unusedName(e,t){let n=e,r=0;for(;t.has(n);)n=e+String(++r);return n}n.d(t,{Q:function(){return unusedName}})},42962:function(e,t,n){"use strict";n.d(t,{$d:function(){return parseListOperands},Ec:function(){return isUnary},Je:function(){return makeQuery},O$:function(){return getValueFilterOperators},QI:function(){return formatOf},Tf:function(){return sortTables},V8:function(){return s},Vi:function(){return formatTableOption},YY:function(){return isSameTable},a8:function(){return operatorLabel},me:function(){return asTableSpecifier},nq:function(){return isList},t2:function(){return isFilteredColumn},xm:function(){return getFilterOperators}});var r=n(7138),i=n(76348),o=n(1438),l=n(32007);let s=Symbol("unhovered");function isFilteredColumn(e,t){var n;let r=null==t?void 0:null===(n=t.filter)||void 0===n?void 0:n.map(e=>e.operands.filter(e=>"column"===e.type)[0]);return null==r?void 0:r.find(t=>{let{value:n}=t;return n===e})}function formatOf(e){switch(e){case"number":case"integer":case"bigint":return formatNumber;case"date":return formatDate;case"object":return formatObject;case"boolean":return formatBoolean;case"buffer":return formatBuffer;default:return formatAuto}}function formatAuto(e){return"number"==typeof e?formatNumber(e):e instanceof Date?formatDate(e):""===e?"<empty string>":"".concat(e)}function formatNumber(e){return 0===e?"0":e.toLocaleString("en-US")}function formatDate(e){return(0,o.Z)(e,"Invalid Date")}function formatObject(e){return JSON.stringify(e)}function formatBoolean(e){return e?"TRUE":"FALSE"}function formatBuffer(e){return"0x..."}let a=["n","nn"],d=["in","nin"];function isUnary(e){return a.includes(e)}function isList(e){return d.includes(e)}function operatorLabel(e,t){if(void 0!==e&&void 0!==t)switch(e){case"eq":if("string"===t)return"is";return"=";case"ne":if("string"===t)return"is not";return"≠";case"c":return"contains";case"nc":return"does not contain";case"in":return"is in";case"nin":return"is not in";case"lt":if("date"===t)return"is before";return"<";case"gt":if("date"===t)return"is after";return">";case"lte":if("date"===t)return"is on or before";return"≤";case"gte":if("date"===t)return"is on or after";return"≥";case"n":return"is null";case"nn":return"is not null";case"v":return"is valid ".concat(t);case"nv":return"is not valid ".concat(t)}}function getFilterOperators(e){let t;if(!e)return[];let{type:n,nullable:r}=e;switch(n){case"boolean":t=["eq","ne"];break;case"string":t=["eq","ne","c","nc","in","nin"];break;case"number":case"integer":t=["eq","ne","lt","gt","lte","gte","in","nin"];break;case"date":t=["lt","gt","lte","gte"];break;default:return[]}return r?[...t,"n","nn","v","nv"]:t}function getValueFilterOperators(e,t){let n=(0,r.getTypeValidator)(e),i=n(t);if(!i)return["v","nv"];switch(e){case"boolean":case"string":return["eq","ne"];case"number":case"integer":case"date":return["lt","lte","gte","gt"];default:return[]}}function parseListOperands(e,t){let n=(0,i.Bj)(e)[0].map(e=>e.trim());return n.map(e=>({type:"primitive",value:(null==t?void 0:t.type)==="number"?+e:e}))}function asTableSpecifier(e){return"string"==typeof e?{table:e}:e}function isSameTable(e,t){let n=asTableSpecifier(e),r=asTableSpecifier(t);return(null==n?void 0:n.database)===(null==r?void 0:r.database)&&(null==n?void 0:n.schema)===(null==r?void 0:r.schema)&&(null==n?void 0:n.table)===(null==r?void 0:r.table)}function formatTableOption(e){return"object"==typeof e?(0,l.VS)(e):e}function sortTables(e,t){return ascending(e.database,t.database)||ascending(e.schema,t.schema)||ascending(e.table,t.table)}function ascending(e,t){let n=void 0===e,r=void 0===t;return n||r?+r-+n:e<t?-1:e>t?1:0}function makeQuery(e){let[t,...n]=e,r="";for(let e of t)r+=e,n.length>0&&(r+="${".concat(JSON.stringify(n.shift()),"}"));return r}},32219:function(e,t,n){"use strict";n.d(t,{Z:function(){return transpile}});var r=n(33083),i=n(44911),o=n(41312);function transpile(e){let t;try{t=(0,o.Hj)(e)}catch(n){if(!(n instanceof SyntaxError))throw n;let{message:e}=n;t=(0,o.Hj)({mode:"js",value:"{throw new SyntaxError(".concat(JSON.stringify(e),");}"),name:null,data:null})}if(null===t.body){let t=new Set,n=new Set,r=new Set,o=new Set;if((0,i.sO)(e)){let{name:r,type:i}=e.data.source;if(r)switch(i){case"database":case"DatabaseClient":t.add(r);break;case"FileAttachment":n.add(r)}}return{type:"empty",databaseClients:t,fileAttachments:n,secrets:r,notificationClients:o}}if("ImportDeclaration"===t.body.type){let{source:e,specifiers:n,injections:r}=t.body,{value:i}=e;return{type:"import",specifier:i,specifiers:n.map(importSpecifier),injections:null==r?void 0:r.map(importSpecifier)}}return{...(0,r.hp)(t),type:function(e){let{id:t}=e;switch(null==t?void 0:t.type){case"MutableExpression":return"mutable";case"ViewExpression":return"viewof"}return"normal"}(t),name:(0,o.u2)(e),databaseClients:new Set([...t.databaseClients.keys(),...t.tag?t.tag.databaseClients.keys():[]]),fileAttachments:new Set([...t.fileAttachments.keys(),...t.tag?t.tag.fileAttachments.keys():[]]),secrets:new Set([...t.secrets.keys(),...t.tag?t.tag.secrets.keys():[]]),notificationClients:new Set([...t.notificationClients.keys(),...t.tag?t.tag.notificationClients.keys():[]])}}function importSpecifier(e){return{imported:e.imported.name,local:e.local.name,mutable:e.mutable,view:e.view}}},28174:function(e,t,n){"use strict";function actionQueue(e){let t=new Map;return(n,r)=>{let i=t.get(n);i||(i=e(),t.set(n,i),requestAnimationFrame(()=>{t.delete(n),n(i)})),r(i)}}n.d(t,{J:function(){return actionQueue}})},46047:function(e,t,n){"use strict";n.d(t,{C2:function(){return setAuthors},KV:function(){return setAuthorAcceptance},Yx:function(){return setAuthorsListener},jp:function(){return setAuthorAcceptanceListener}});var r=n(5146),i=n(4530);let setAuthorsListener=async(e,t,n)=>{let{notebook:{id:o,authors:l},currentUser:s}=e,{authors:a}=t,d=l.map(e=>e.id),c=a.map(e=>e.id);try{await (0,r.Fv)("/document/".concat(o,"/authors"),{authors:a.map(e=>{let{id:t,description:n}=e;return{id:t,description:n}}),removedAuthors:d.filter(e=>!c.includes(e))}),(0,i.MR)((0,i.a$)({type:"notebook:manage:setAuthors",data:{authors:a.length,approved:a.filter(e=>e.approved).length,withDescription:a.filter(e=>e.description).length},eventVersion:1,currentUser:s}))}catch(e){n({type:"showErrorToast",message:"Oops, failed to set authors. Refresh and try again?",key:"setAuthors"})}},setAuthors=(e,t)=>{let{authors:n}=t;return{authors:n}},setAuthorAcceptanceListener=async(e,t,n)=>{let{notebook:{id:o,authors:l},currentUser:s}=e,{value:a}=t;try{await (0,r.Fv)("/document/".concat(o,"/author/").concat(a?"accept":"reject")),(0,i.MR)((0,i.a$)({type:"notebook:manage:setAuthorAcceptance",data:{value:a,prevValue:null!==s&&l.some(e=>{let{id:t,approved:n}=e;return t===s.id&&!n})},eventVersion:1,currentUser:s}))}catch(e){n({type:"showErrorToast",message:"Oops, failed to ".concat(a?"accept":"remove"," authorship. Refresh and try again?"),key:"setAuthorAcceptance"})}},setAuthorAcceptance=(e,t)=>{let{authors:n}=e,{currentUser:r,value:i}=t;return i?{authors:n.map(e=>e.id===r.id?{...e,approved:i}:e)}:{authors:n.filter(e=>e.id!==r.id)}}},36891:function(e,t,n){"use strict";n.d(t,{C:function(){return disableAutosave},Q:function(){return exitVersionedMode}});var r=n(11163),i=n.n(r);let exitVersionedMode=e=>{let{notebook:{id:t}}=e;i().replace({pathname:"/[at]/[...specifiers]",query:{...i().query,at:"d",specifiers:[t]}})},disableAutosave=()=>({autosave:!1})},82317:function(e,t,n){"use strict";n.d(t,{N5:function(){return collectionsRequested},Yd:function(){return collectionsUpdated},_O:function(){return openCollectionsSidebar}});var r=n(5146),i=n(4530);let collectionsRequested=async(e,t,n)=>{let{notebook:o,currentUser:l}=e,{addTo:s,removeFrom:a,onDismiss:d}=t,{id:c}=o,u=await (0,r.Fv)("/collection/bulk",{actions:[...s.map(e=>({type:"add",collection_id:e.id,document_listing_id:c})),...a.map(e=>({type:"remove",collection_id:e.id,document_listing_id:c}))]}),p=Object.fromEntries([...s,...a].map(e=>[e.id,e])),h=!1;for(let e of u)e.ok?"add"===e.type?(0,i.MR)((0,i.y6)({type:"collection:manage:addNotebookListing",data:{addedListingId:c},collection:p[e.collection_id],currentUser:l,eventVersion:1})):(0,i.MR)((0,i.y6)({type:"collection:manage:removeNotebookListing",data:{removedListingId:c},collection:p[e.collection_id],currentUser:l,eventVersion:1})):h=!0;n({type:"collectionsUpdated",addedTo:s.filter(e=>u.some(t=>t.ok&&t.collection_id===e.id)),removedFrom:a.filter(e=>u.some(t=>t.ok&&t.collection_id===e.id)),orphaned:"collections"in o&&o.collections.length+s.length<=a.length}),h&&n({type:"showErrorToast",message:"Oops, collections update failed. Try again?",key:"collections"}),d(),n({type:"updatedNotebook"})},openCollectionsSidebar=(e,t)=>{let{collection:n}=t;return{initialCollection:n}},collectionsUpdated=(e,t)=>{let{addedTo:n,removedFrom:r}=t;return{collections:[...e.collections.filter(e=>!r.some(t=>t.id===e.id)),...n.filter(t=>!e.collections.some(e=>e.id===t.id))]}}},843:function(e,t,n){"use strict";n.d(t,{h:function(){return updateCommentingLock},q:function(){return commentingLockSaved}});var r=n(5146);let updateCommentingLock=async(e,t,n)=>{let{notebook:{id:i}}=e,{locked:o}=t;try{await (0,r.Fv)("/document/".concat(i,"/commenting-lock"),{locked:o}),n({type:"showSuccessToast",message:"Commenting ".concat(o?"locked":"unlocked","."),key:"commentingLock"})}catch(e){n({type:"showErrorToast",message:"Locking comments failed. Try again?",key:"commentingLock"})}},commentingLockSaved=(e,t)=>{let{commentingLock:n}=t;return{commentingLock:n}}},43318:function(e,t,n){"use strict";n.d(t,{A9:function(){return commentsUpdated},E:function(){return commentCreated},Fq:function(){return resolveComments},I5:function(){return resolveCommentsConfirmed},Mb:function(){return commentComposeCancel},Q8:function(){return showComments},Sh:function(){return initialComments},Ty:function(){return updateCommentStatus},UE:function(){return setInitialOpenComments},V5:function(){return commentSaveConfirmed},dV:function(){return commentDeleted},e5:function(){return reportAbuse},hx:function(){return commentsDeleteConfirmed},hz:function(){return commentComposeOpen},m1:function(){return toggleResolvedComments},u0:function(){return hideComments},uA:function(){return updateComment}});var r=n(5146),i=n(63302),o=n(29020),l=n(17616);function initialComments(e){let t=new Map;for(let n of coerceComments(e)){if(isWireCommentDeleted(n))continue;let e=t.get(n.node_id);e?e.push(n):t.set(n.node_id,[n])}return t}function setInitialOpenComments(e,t,n){let r=(0,l.Hw)(e),i=n&&(0,l.Hw)(n),s=t&&e.forkOf&&t.id===e.forkOf.owner.id;for(let[n,l]of e.comments){let a=l.filter(t=>t.node_id<=e.saveVersion),d=a.some(e=>!(0,o.Wg)(e))&&(r||i||s||t&&a.some(e=>e.user.id===t.id));d&&e.openComments.add(n)}}let commentsUpdated=(e,t)=>{let{comments:n,composingComments:r,openComments:i}=e,{comments:l}=t;for(let e of(n=new Map(n),coerceComments(l))){if(isWireCommentDeleted(e)){for(let[t,l]of n){l=[...l];let s=l.findIndex(t=>!(0,o.tO)(t)&&t.id===e.id);-1!==s&&(l.splice(s,1),n.set(t,l),0===l.length&&i.has(t)&&!r.has(t)&&(i=new Set(i)).delete(t))}continue}if(isWireCommentUpdated(e)){for(let t of n.values()){t=[...t];let r=t.findIndex(t=>!(0,o.tO)(t)&&t.id===e.id);if(-1!==r){let i=t[r];t[r]={...i,update_time:e.update_time,status:e.status},n.set(e.node_id,t)}}continue}let t=[...n.get(e.node_id)||[]],l=t.findIndex(t=>!(0,o.tO)(t)&&t.id===e.id);-1!==l||(t.push(e),t.sort(ascendingCreateTime),n.set(e.node_id,t),i.has(e.node_id)||(i=new Set(i).add(e.node_id))),(0,o.Wg)(e)&&(t[l]=e,n.set(e.node_id,t))}return{comments:n,openComments:i}},commentComposeCancel=(e,t)=>{var n;let{composingComments:r,openComments:i,comments:o}=e,{nodeId:l}=t;return(r=new Set(r)).delete(l),o.has(l)&&(null===(n=o.get(l))||void 0===n?void 0:n.length)!==0||(i=new Set(i)).delete(l),{composingComments:r,openComments:i}},commentComposeOpen=(e,t)=>{let{composingComments:n,openComments:r}=e,{nodeId:i}=t;return{composingComments:new Set(n).add(i),openComments:new Set(r).add(i),selectionFocusId:null,selection:new Set}},hideComments=(e,t)=>{let{openComments:n}=e,{nodeId:r}=t;return(n=new Set(n)).delete(r),{openComments:n}},showComments=(e,t)=>{let{nodeId:n}=t,{expandedResolvedComments:r,openComments:o}=e,l=(0,i.HS)(e,n).length;return r=new Set(r),0===l?r.add(n):r.delete(n),{openComments:new Set(o).add(n),expandedResolvedComments:r}},updateCommentStatus=(e,t)=>{let{comments:n}=e,{nodeId:r,status:i,commentId:o}=t;n=new Map(n);let l=[...n.get(r)||[]],s=l.findIndex(e=>e.id===o);if(-1!==s){let e=l[s];l[s]={...e,status:i},n.set(r,l)}return{comments:n}},s=0,updateComment=(e,t)=>{let{comments:n}=e,{nodeId:r,content:i,commentId:o}=t;n=new Map(n);let l=[...n.get(r)||[]],s=l.findIndex(e=>e.id===o),a=l[s];return l[s]={...a,id:o,status:"updatePending",content:i},n.set(r,l),{comments:n}},commentCreated=(e,t)=>{var n;let{comments:r,composingComments:i,openComments:o}=e,{nodeId:l,content:a,currentUser:d}=t;r=new Map(r);let c=[...r.get(l)||[]];return c.push({status:"local",create_time:new Date,update_time:null,content:a,node_id:l,nonce:++s,user:d}),r.set(l,c),(i=new Set(i)).delete(l),r.has(l)&&(null===(n=r.get(l))||void 0===n?void 0:n.length)!==0||(o=new Set(o)).delete(l),{composingComments:i,openComments:o,comments:r}},commentSaveConfirmed=(e,t)=>{let{comments:n}=e,{nonce:r,id:i,createTime:l,updateTime:s}=t;for(let[e,t]of n=new Map(n))for(let a=t.length-1;a>=0;a--){let d=t[a];if((0,o.tO)(d)&&d.nonce===r)return(t=[...t])[a]={status:"unresolved",id:i,content:d.content,node_id:d.node_id,create_time:l,update_time:s,user:d.user,resolved:!1},n.set(e,t),{comments:n}}},commentDeleted=(e,t)=>{let{comments:n}=e,{comment:r}=t,i=[...(n=new Map(n)).get(r.node_id)];if((0,o.tO)(r))i=i.filter(e=>(0,o.tO)(e)&&e.nonce!==r.nonce);else for(let e=0;e<i.length;e++){let t=i[e];(0,o.tO)(t)||t.id!==r.id||(i[e]={...t,status:"deletePending"})}return n.set(r.node_id,i),{comments:n}},commentsDeleteConfirmed=(e,t)=>{let{comments:n,composingComments:r,openComments:i}=e,{ids:l}=t;for(let[e,t]of n=new Map(n)){for(let e of(t=[...t],l)){let n=t.findIndex(t=>!(0,o.tO)(t)&&t.id===e);-1!==n&&t.splice(n,1)}n.set(e,t),0===t.length&&i.has(e)&&!r.has(e)&&(i=new Set(i)).delete(e)}return{comments:n,openComments:i}};function ascendingCreateTime(e,t){return+e.create_time-+t.create_time}function isWireCommentDeleted(e){return e.deleted}function isWireCommentUpdated(e){return!!e.update_time&&!e.resolved}function coerceComments(e){return e.map(e=>{let t=isWireCommentDeleted(e)?e:isWireCommentUpdated(e)?{...e,status:"unresolved"}:{...e,status:e.resolved?"resolved":"unresolved"};return t})}let reportAbuse=async(e,t,n)=>{let{comment:{id:i,content:o},anonymous:l,reason:s}=t;try{await (0,r.Fv)("/report",{anonymous:l,reason:s,subject:{type:"document_comment",id:i,content:o}}),n({type:"showSuccessToast",message:"Comment reported."})}catch(e){n({type:"showErrorToast",message:"Comment report failed.",key:"reportAbuse"})}},resolveComments=(e,t)=>{let{comments:n,openComments:r}=e,{nodeId:i}=t;n=new Map(n);let l=[...n.get(i)||[]].map(e=>(0,o.sH)(e)||(0,o.tO)(e)||(0,o.Wg)(e)?e:{...e,status:"resolvePending"});return n.set(i,l),(r=new Set(r)).delete(i),{comments:n,openComments:r}},resolveCommentsConfirmed=(e,t)=>{let{comments:n}=e,{ids:r}=t;for(let[e,t]of n=new Map(n)){for(let e of(t=[...t],r)){let n=t.findIndex(t=>!(0,o.tO)(t)&&t.id===e);-1!==n&&(t[n]={...t[n],status:"resolved",resolved:!0})}n.set(e,t)}return{comments:n}},toggleResolvedComments=(e,t)=>{let{expandedResolvedComments:n}=e,{nodeId:r}=t;return(n=new Set(n)).has(r)?n.delete(r):n.add(r),{expandedResolvedComments:n}}},78546:function(e,t,n){"use strict";n.d(t,{AK:function(){return cloudFileSnippet},GH:function(){return insertCloudFile},Qf:function(){return insertSuggestion},Tv:function(){return downloadCloudFileAnalytic},Xm:function(){return insertCloudFileListener},ZG:function(){return copyDatabaseCode},_E:function(){return insertDatabaseListener},kc:function(){return removeCloudFileAnalytic},nD:function(){return removeCloudFile},q5:function(){return insertDatabase},zX:function(){return cloudFileSnippetAnalytic}});var r=n(42866),i=n(49122),o=n(9039),l=n(22971),s=n(42612),a=n(4530),d=n(40591),c=n(41312),u=n(90580),p=n(61091);let insertDatabase=(e,t)=>{var n;let{source:r}=t,{focusId:i,model:{nodes:o},type:s}=e,a=null!==i&&"dashboard"!==s?i:null===(n=o[o.length-1])||void 0===n?void 0:n.id;return(0,l.$T)(e,{id:a,before:!1,node:{mode:"sql",data:{source:r}},type:"insert"})},copyDatabaseCode=async(e,t,n)=>{let{db:r}=t;await navigator.clipboard.writeText(function(e){switch(e.type){case"cell":return e.name;case"database":case"DatabaseClient":return"DatabaseClient(".concat(JSON.stringify(e.name),")");case"FileAttachment":if("sqlite"===e.dialect)return"FileAttachment(".concat(JSON.stringify(e.name),").sqlite()");return"FileAttachment(".concat(JSON.stringify(e.name),")")}}(r)),n({type:"showSuccessToast",message:"Copied to clipboard"})},insertDatabaseListener=(e,t)=>{let{notebook:n,currentUser:r}=e,{source:i}=t;(0,a.MR)((0,a.ym)({type:"notebook:manage:insertDatabase",data:{name:i.name},eventVersion:1,notebook:n,currentUser:r}))},insertSuggestion=(e,t)=>{let{suggestion:n,id:o}=t,a=(0,d.DY)(e.model,o);if(!a)return;let u={},h=a.value,m=e.editorStates.get(o).doc.toString();if(h!==m){h=m;let t=(0,r.v)(e,[{type:"modify_node",node_id:o,new_node_value:m}]);u={...u,...t},e={...e,...t},a=(0,d.DY)(e.model,o)}let f=(0,c.u2)(a);if(!f){f=(0,p.Q)("data",(0,i.e)(e.model.nodes));let t=(0,s.q)(e,{id:o,name:f});u={...u,...t},e={...e,...t}}let g=(0,l.$T)(e,n(f));return u={...u,...g},e={...e,...g},u},cloudFileSnippet=(e,t)=>{let{provider:n,name:r,mimeType:i}=t;return(0,o.pB)(e,{type:"insertFile",file:{name:"".concat(u.c[n].shorthand,"://").concat(r),mimeType:i,status:"private"}})},cloudFileSnippetAnalytic=(e,t)=>{let{notebook:n,currentUser:r}=e,{provider:i,size:o,mimeType:l}=t;(0,a.MR)((0,a.ym)({type:"notebook:manage:cloudFileSnippet",data:{provider:i,size:o,mimeType:l},notebook:n,currentUser:r,eventVersion:1}))},insertCloudFile=(e,t)=>{let{provider:n,path:i,name:l,mimeType:s}=t,{model:a}=e,d=new Set(a.resolutions.filter(e=>"cloud_file"===e.type).map(e=>e.specifier)),c=(0,o.Tw)(d,(0,o.Nw)(l||"".concat(u.c[n].shorthand,"File"))),p=cloudFileSnippet(e,{type:"cloudFileSnippet",provider:n,mimeType:s,name:c}),h={type:"resolve_dependency",specifier_type:"cloud_file",specifier:"".concat(u.c[n].shorthand,"://").concat(c),new_resolution:i};return{...p,...(0,r.v)({...e,...p},[h])}},insertCloudFileListener=(e,t)=>{let{notebook:n,currentUser:r}=e,{provider:i,mimeType:o,size:l}=t;(0,a.MR)((0,a.ym)({type:"notebook:manage:insertCloudFile",data:{provider:i,mimeType:o,size:l},eventVersion:1,notebook:n,currentUser:r}))},removeCloudFile=(e,t)=>{let{provider:n,name:i}=t,o="".concat(u.c[n].shorthand,"://").concat(i);if(e.model.resolve("cloud_file",o))return(0,r.v)(e,[{type:"resolve_dependency",specifier_type:"cloud_file",specifier:o,new_resolution:null}])},removeCloudFileAnalytic=(e,t)=>{let{notebook:n,currentUser:r}=e,{provider:i,size:o,mimeType:l}=t;(0,a.MR)((0,a.ym)({type:"notebook:manage:removeCloudFile",data:{provider:i,size:o,mimeType:l},eventVersion:1,notebook:n,currentUser:r}))},downloadCloudFileAnalytic=(e,t)=>{let{notebook:n,currentUser:r}=e,{provider:i,size:o,mimeType:l}=t;(0,a.MR)((0,a.ym)({type:"notebook:manage:downloadCloudFile",data:{provider:i,size:o,mimeType:l},eventVersion:1,notebook:n,currentUser:r}))}},54588:function(e,t,n){"use strict";n.d(t,{y:function(){return descriptionUpdate},z:function(){return descriptionUpdated}});var r=n(5146);let descriptionUpdate=async(e,t,n)=>{let{notebook:{id:i}}=e,{description:o,onDismiss:l}=t;try{let e=await (0,r.Fv)("/document/".concat(i,"/description"),{description:o});n({type:"descriptionUpdated",description:e.description})}catch(e){n({type:"showErrorToast",message:"Oops, setting notebook description failed. Try again?",key:"description"})}l()},descriptionUpdated=(e,t)=>{let{description:n}=t;return{description:n}}},45495:function(e,t,n){"use strict";n.d(t,{H:function(){return createDocumentKeyListener},d:function(){return createDocumentKeySucceeded}});var r=n(5146),i=n(27507),o=n(4293);let createDocumentKeySucceeded=(e,t)=>{let{documentKey:n}=t;return{...e,documentKey:n}},createDocumentKeyListener=async(e,t,n)=>{let{context:{context:l}}=e,{documentId:s,expirationDate:a,firstVersion:d,lastVersion:c}=t;n({type:"showProcessingToast",key:"createDocumentKey",message:'Creating notebook key "'.concat(s,'"…')});let u="".concat(s," ").concat((0,o.mr)(new Date));try{let e=await (0,r.Fv)("/document/".concat(s,"/api-key"),{description:u,expire_time:a,first_version:d,last_version:c});n({type:"showSuccessToast",key:"createDocumentKey",message:"Notebook key created."}),n({type:"createDocumentKeySucceeded",documentId:s,documentKey:e})}catch(e){n({type:"showErrorToast",key:"createDocumentKey",message:e instanceof i.ZP&&400===e.status?"Can't create notebook key with user: ".concat(null==l?void 0:l.name,"}"):"Oops, API key creation failed. Try again?"})}}},44526:function(e,t,n){"use strict";n.d(t,{N:function(){return duplicateNode},O:function(){return duplicate}});var r=n(42866),i=n(67064),o=n(49122),l=n(93105),s=n(26271),a=n(22481),d=n(40591),c=n(90271),u=n(61091),p=n(29020);function duplicateNode(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:(0,o.e)(e.model.nodes),{editorStates:i,model:l,layout:h}=e,m=null,f=null;if((0,p.XT)(e)){let e=h.findIndex(e=>e.slots.find(e=>e.nodeId===t)),r=h[e],i=h[e+1]?h[e+1]:null;(0,a.G)(r.slots[0])||1===r.slots.length||r.slots.length===c.j$?(f=!1,m=n?r.slots[0].nodeId:i?i.slots[0].nodeId:null):f=!0}let g=i.get(t),{pinned:v,mode:y,data:x,name:b,display:w}=(0,d.DY)(l,t);if("js"===y){let e=(0,s.G)(g,!1);e&&(b=g.sliceDoc(e.from,e.to),r.add(b),b=(0,u.Q)(b.replace(/\d+$/g,""),r),g=g.update({changes:{from:e.from,to:e.to,insert:b}}).state)}else b&&(b=(0,u.Q)(b.replace(/\d+$/g,""),r));b&&r.add(b);let C=!1===f?m:n?t:(0,d.o4)(l,t);return{editorState:g,insertEvent:{type:"insert_node",new_next_node_id:null!=C?C:null,new_node_value:"",new_node_pinned:v,new_node_mode:y,new_node_data:x,new_node_name:"js"===y?null:b,new_combine:f?"previous":null,new_node_display:w}}}let duplicate=(e,t)=>{let{id:n,before:o=!1}=t,{editorState:s,insertEvent:a}=duplicateNode(e,n,o),d=e.model.events.length,c=[a],u=(0,l.cn)(e);u&&c.push(u);let p=(0,r.v)(e,c),h={...e,...p},m=(0,i.N)(h,{changes:[{from:0,to:0,insert:s.doc}],selection:s.selection},d),f={...h,...m},g=(0,l.Aq)(f,d);return{...p,...m,...g}}},72776:function(e,t,n){"use strict";n.d(t,{AV:function(){return initialEditorStates},F2:function(){return toUpdate},GD:function(){return byNode},Hp:function(){return setInitialEditorStates},R9:function(){return receiveEdits},Sf:function(){return maybeScrollIntoView},l8:function(){return createEditorState},qk:function(){return updateReadOnly}});var r=n(78120),i=n(14456),o=n(67064),l=n(49122),s=n(93156),a=n(32986),d=n(12720),c=n(13961),u=n(23939),p=n(25227),h=n(56564),m=n(39273),f=n(7595),g=n(44911),v=n(63302),y=n(32980),x=n(29020);function toUpdate(e){return{changes:r.as.of(e.changes,e.length)}}function createEditorState(e,t,n,o,l){let{id:s,value:f,mode:v,data:y}=e,b=g.qz[v];return r.yy.create({extensions:[c.C.init(()=>v),a.Hk.vimKeys.of(t.vimKeys&&m.R.loaded?r.Wl.highest(m.R.vim()):[]),...a.Xl,u.X.init(()=>s),h.i.init(()=>t),a.Hk.modeExtensions.of(b.extensions({settings:t,data:y})),d._.init(()=>(0,x.Pu)(n).map(e=>e.name)),p.Z.init(()=>o),a.Hk.keymap.of(i.$f.of([...b.keymap,...a.Bt])),a.Hk.closeBrackets.of(t.closeBracketsOn?a._g:[]),a.Hk.readOnly.of(r.yy.readOnly.of(l)),a.Hk.sql.of([])],doc:f})}function setInitialEditorStates(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];e.editorStates=initialEditorStates(e,t),n.length>0&&function(e,t){let{editorStates:n}=receiveEdits(e,t);if(e.saveVersion<=v.Lr&&(0,y.mG)(e)){let t=e.model.nodes.at(0);if(t){let e=n.get(t.id).doc,i="md"===t.mode&&"# Untitled"===e.toString()?r.jT.single(2,10):"js"===t.mode&&"md`# Untitled`"===e.toString()?r.jT.single(5,13):null;i&&({editorStates:n}=(0,o.N)({editorStates:n},{selection:i},t.id))}}e.editorStates=n}(e,n)}function receiveEdits(e,t){let{editorStates:n,transactions:r}=e;for(let e=0;e<t.length;e++){let{node_id:i,value:l}=t[e];if(n.has(i)){let a=(0,s.cK)(n.get(i),[l]);if(a.changes.empty){t.splice(e--,1);continue}({transactions:r,editorStates:n}=(0,o.N)({transactions:r,editorStates:n},a,i))}}return{editorStates:n,transactions:r}}function initialEditorStates(e,t){let n;let{model:{nodes:r},owner:i,files:o}=e,s=(0,x.cE)(e)?i:null,a={prettierOn:(0,x.wW)(t,i),closeBracketsOn:(0,x.CD)(t),fileUploadsOn:(0,y.Yb)(t)&&(0,f.j5)(t,e),loginToUpload:!t,spellcheckOn:(0,x.OA)(t),defaultCellMode:(0,x.Sx)(t),vimKeys:(0,x.S1)(t),defaultOpenAddCellMenu:(0,x.VO)(t)},d=new Map(r.map(t=>[t.id,createEditorState(t,a,o,s,(0,x.os)(e))]));return{editorStates:d,transactions:n}=(0,l.C)({editorStates:d,transactions:n},r),d}function byNode(e){let t=new Map;for(let{node_id:n,...r}of e)t.has(n)?t.get(n).push(r):t.set(n,[r]);return t}function maybeScrollIntoView(e,t,n){return null===n?t:{...t,...(0,o.N)(e,{scrollIntoView:!0},n)}}function updateReadOnly(e,t){let n={effects:[a.Hk.readOnly.reconfigure(r.yy.readOnly.of(t))]},{editorStates:i,transactions:l}=e;for(let[t]of e.editorStates)({editorStates:i,transactions:l}=(0,o.N)({editorStates:i,transactions:l},n,t));return{editorStates:i,transactions:l}}},9039:function(e,t,n){"use strict";n.d(t,{Mq:function(){return attachLocalFilesListener},Nz:function(){return copyFileCode},R$:function(){return fileDeleteSucceeded},GC:function(){return fileMarkedForDeletion},YJ:function(){return fileReplaced},uu:function(){return initialFiles},pB:function(){return insertFile},b1:function(){return localFileUploadSucceeded},QT:function(){return localFilesAttached},zJ:function(){return remoteFileUpdated},bC:function(){return replaceFileListener},Nw:function(){return sanitize},Tw:function(){return unique}});var r=n(78120),i=n(42866),o=n(67064),l=n(49122),s=n(22971),a=n(77097),d=n(74374),c=n(12720),u=n(40591),p=n(79998),h=n(64709),m=n(61091);let f=new Set("do if in for let new try var case else enum eval null this true void with await \n  break catch class const false super throw while yield delete export import public \n  return static switch typeof default extends finally package private continue \n  debugger function arguments interface protected implements instanceof\n  undefined NaN Infinity\n  ".split(/\s+/));function identifierify(e,t){if(t){let t=e.split(".");e=t.slice(0,t.length-1).join("-")}return(0,m.Q)((0,h.O)(e).replace(/^[0-9-]+/g,"").replace(/-([_a-z0-9])/g,(e,t)=>t.toUpperCase())||"untitled",f)}var g=n(44911),v=n(63302),y=n(41312),x=n(29020);function fileOf(e){let{status:t,name:n,create_time:r,url:i,download_url:o,size:l,mime_type:s,private_bucket_id:a}=e,d=new Date(r);switch(t){case"pending":return{status:"pending",name:n,createTime:d,mimeType:s,privateBucketId:a};case"deleted":return{status:"deleted",name:n,createTime:d,mimeType:s,privateBucketId:a};case"private":return{status:"private",name:n,createTime:d,url:i,downloadUrl:o,size:l,mimeType:s,privateBucketId:a};case"public":return{status:"public",name:n,createTime:d,url:i,downloadUrl:o,size:l,mimeType:s,privateBucketId:a}}}function initialFiles(e){return new Map(e.map(e=>[e.name,fileOf(e)]))}let remoteFileUpdated=(e,t)=>{let{editorStates:n,files:r}=e,{file:i,ownUpload:o}=t;r=new Map(r);let l=fileOf(i),{name:s}=l,a=r.get(s);if((null==a?void 0:a.status)!=="local"||o)(null==a?void 0:a.blob)!==void 0&&(l.blob=a.blob);else{let e=unique(r,s);r.set(e,a),console.warn("renamed ".concat(s," ↦ ").concat(e))}r.set(s,l);let{editorStates:d,transactions:c}=updateFilesStateField(n,[],r);return{files:r,editorStates:d,transactions:c}};function updateFilesStateField(e,t,n){let r=e,i=(0,x.Pu)(n).map(e=>e.name);for(let[n]of e)({editorStates:r,transactions:t}=(0,o.N)({editorStates:r,transactions:t},{effects:c.C.of(i)},n));return{editorStates:r,transactions:t}}let localFilesAttached=(e,t)=>{let{files:n}=t;if(!n.length)return;let i=new Map(e.files),a=[];for(let e of n){let t=unique(i,sanitize(e.name)),n={name:t,createTime:new Date,mimeType:e.type,status:"local",blob:e,size:e.size};i.set(t,n),a.push(n)}let{beforeId:c,combine:u,display:p}=t;if(void 0!==c)return{files:i,...updateFilesStateField(e.editorStates,[],i),...(0,s.cZ)(e,{id:c,before:!0,nodes:a.flatMap(t=>assignedFileNodes(t.name,t.mimeType,e.model.nodes,u,p)),type:"insertAll"})};let{nodeId:h}=t;if(void 0===h)return{files:i,...updateFilesStateField(e.editorStates,[],i)};let f=e.editorStates.get(h),g=f.changeByRange(t=>{var n;let i=f.doc.length||"js"!==(0,d.yq)(f,t)?a.map(e=>fileSnippet(e.name,e.mimeType,(0,d.yq)(f,t))).join(", "):a.length>1?(n=e.model.nodes,"".concat((0,m.Q)("data",(0,l.e)(n))," = Promise.all([\n  ").concat(a.map(e=>fileSnippet(e.name,e.mimeType)).join(",\n  "),"\n])")):assignedFileSnippet(a[0].name,a[0].mimeType,e.model.nodes);return{changes:{from:t.from,to:t.to,insert:i},range:r.jT.cursor(t.from+i.length)}}),{editorStates:v}=e,y=[];return{editorStates:v,transactions:y}=(0,o.N)(e,g,h),{editorStates:v,transactions:y}=updateFilesStateField(v,y,i),{files:i,editorStates:v,transactions:y}},attachLocalFilesListener=async(e,t,n)=>{let r=t.files.filter(e=>e.size>v.D_?(n({type:"showErrorToast",message:"Could not upload ".concat(e.name,": file exceeds the ").concat((0,p.BU)(v.D_)," limit."),key:"upload:".concat(e.name)}),!1):0!==e.size||(n({type:"showErrorToast",message:"Could not upload ".concat(e.name,": empty file.")}),!1));n({...t,type:"localFilesAttached",files:await Promise.all(r.map(resolveFile))})};async function resolveFile(e){if(!e.type){let t=await new Promise((t,n)=>{let r=new FileReader;r.onload=()=>t(r.result),r.onerror=n,r.readAsText(e.slice(0,16))});if("SQLite format 3\x00"===t)return new File([e],e.name,{type:"application/x-sqlite3"})}return e}let replaceFileListener=async(e,t,n)=>{let{fileToAttach:r,fileToReplace:i}=t;n({type:"fileReplaced",fileToAttach:await resolveFile(r),fileToReplace:i})},fileReplaced=(e,t)=>{let{fileToAttach:n,fileToReplace:r}=t,l=new Map(e.files),s=unique(l,sanitize(n.name));l.set(s,{name:s,createTime:new Date,mimeType:n.type,status:"local",blob:n,size:n.size});let{editorStates:a}=e,d=[];({editorStates:a,transactions:d}=updateFilesStateField(a,d,l));let c=new Map;for(let[t,n]of e.editorStates){let i=(0,u.DY)(e.model,t);if(i.value){let e=(0,y.Qc)({...i,value:n.doc.toString()}),o=r.name;e.fileAttachments.has(o)&&c.set(t,e.fileAttachments.get(o))}}let p=[];for(let[e,t]of c)({editorStates:a,transactions:d}=(0,o.N)({editorStates:a,transactions:d},{changes:t.map(e=>{let{start:t,end:n}=e;return{from:t,to:n,insert:'"'.concat(s,'"')}})},e)),p.push({type:"modify_node",node_id:e,new_node_value:a.get(e).doc.toString()});for(let t of e.model.nodes)if((0,g.sO)(t)){let e=t.data.source;"FileAttachment"===e.type&&e.name===r.name&&p.push({type:"modify_data",node_id:t.id,new_node_data:{...t.data,source:{...e,name:s}}})}return{files:l,...(0,i.v)({...e,files:l,editorStates:a,transactions:d},p)}},localFileUploadSucceeded=(e,t)=>{let{files:n}=e,{name:r}=t,i=n.get(r);if("local"===i.status)return(n=new Map(n)).set(r,{...i,status:"pending"}),{files:n}},fileMarkedForDeletion=(e,t)=>{let{files:n,editorStates:r}=e,{name:i}=t,o=n.get(i);(n=new Map(n)).set(i,{...o,status:"local"===o.status?"deleted":"deletepending"});let{editorStates:l,transactions:s}=updateFilesStateField(r,[],n);return{files:n,editorStates:l,transactions:s}},fileDeleteSucceeded=(e,t)=>{let{files:n}=e,{name:r}=t,i=n.get(r);if("deletepending"===i.status)return(n=new Map(n)).set(r,{...i,status:"deleted"}),{files:n}},insertFile=(e,t)=>{var n;let{file:r}=t,{focusId:i,model:o,type:l}=e,a=null!==i&&"dashboard"!==l?i:null===(n=o.nodes[o.nodes.length-1])||void 0===n?void 0:n.id;return(0,s.cZ)(e,{id:a,before:!1,nodes:assignedFileNodes(r.name,r.mimeType,e.model.nodes),type:"insertAll"})},copyFileCode=async(e,t,n)=>{let{file:r}=t;await navigator.clipboard.writeText(fileSnippet(r.name,r.mimeType)),n({type:"showSuccessToast",message:"Copied to clipboard"})};function unique(e,t){for(;e.has(t);)t=t.replace(/(?:@(\d+))?(?=\.|$)/,function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return"@".concat(+t+1)});return t}function sanitize(e){return e.replace(/[\\"'`${}@\x00-\x09\x0b-\x19]+/g,"-")}function assignedFileNodes(e,t,n,r,i){switch(t){case"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":{let r=[];r.push({mode:"js",value:'FileAttachment("'.concat(e,'")').concat(fileAccessor(t))});let i=(0,m.Q)("workbook",(0,l.e)(n)),o=(0,m.Q)("data",(0,l.e)(n));return r[0]={mode:"js",value:"".concat(i," = ").concat(r[0].value)},r.push({mode:"js",value:"".concat(i,".sheetNames")},{mode:"js",value:"".concat(o," = ").concat(i,'.sheet(0, {\n    headers: false,\n    // range: "A1:J10"\n  })')},{mode:"table",data:{source:{type:"cell",name:o},operations:{...g.Zu.defaultNode.data.operations,from:{table:(0,a.Z)({type:"cell",name:o,dialect:"array"})}}}}),r}case"text/csv":case"text/tab-separated-values":return[{mode:"table",name:(0,m.Q)(identifierify(e,!0),(0,l.e)(n)),data:{source:{type:"FileAttachment",name:e},operations:{...g.Zu.defaultNode.data.operations,from:{table:(0,a.Z)({type:"FileAttachment",name:e,dialect:"csv"})}}},combine:null,display:i}];case"application/x-sqlite3":return[{mode:"sql",name:"",data:{source:{type:"FileAttachment",name:e}},combine:null,display:i}];default:return[{mode:"js",value:assignedFileSnippet(e,t,n),combine:r,display:i}]}}function assignedFileSnippet(e,t,n){return"".concat((0,m.Q)(identifierify(e,!0),(0,l.e)(n))," = ").concat(fileSnippet(e,t))}function fileSnippet(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"js",r="FileAttachment(".concat(JSON.stringify(e),")");return"md"===n?"".concat(isImage(t)?"!":"","[").concat(e,"](${await ").concat(r,".url()})"):"html"===n?isImage(t)?'<img alt="'.concat(e,'" src="${await ').concat(r,'.url()}">'):'<a href="${await '.concat(r,'.url()}">').concat(e,"</a>"):"".concat(r).concat(fileAccessor(t))}function isImage(e){return null==e?void 0:e.startsWith("image/")}function fileAccessor(e){if(isImage(e))return".image()";switch(e){case"application/json":case"application/geo+json":return".json()";case"application/x-sqlite3":return".sqlite()";case"application/zip":return".zip()";case"text/csv":return".csv()";case"text/plain":return".text()";case"text/tab-separated-values":return".tsv()";case"application/xml":return".xml()";case"text/html":return".html()";case"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":return".xlsx()";default:return""}}},93105:function(e,t,n){"use strict";n.d(t,{yv:function(){return focus_blur},SS:function(){return closeInsertMenu},T_:function(){return focus_focus},ib:function(){return focusAfter},ug:function(){return focusBefore},I$:function(){return focusDefinition},z1:function(){return focusError},s0:function(){return focusFirst},vG:function(){return focusLast},zq:function(){return focusUndo},N5:function(){return maybeBlur},cn:function(){return maybeImplicitCommit},L4:function(){return openInsertMenu},VH:function(){return refocus},Aq:function(){return updateFocus},$c:function(){return updateFocusAndSelection},mX:function(){return updateFocusStack}});var r=n(78120),i=n(42866),o=n(67064),l=n(16755),s=n(54687),a=n(78756),d=n(40591),c=n(41312);function maybeImplicitCommit(e){let{focusId:t,model:n,participants:r,editorStates:i}=e;if(null===t||r.some(e=>e.node_ids.includes(t)))return;let o=i.get(t);if(!o)return;let l=o.doc.toString(),{data:s,value:c}=(0,d.DY)(n,t);return!(0,a.w)(s)&&/^\s*$/.test(l)&&n.nodes.length>1?{type:"remove_node",node_id:t}:l!==c?{type:"modify_node",new_node_value:l,node_id:t}:void 0}function updateFocusStack(e,t){if(null!==t){let n=e.length;e[n-1]!==t&&(e=(n<100?e:e.slice(100-n+1)).concat(t))}return e}function updateFocus(e,t,n){if(e.focusId!==t)return updateFocusAndSelection(e,t,n)}function updateFocusAndSelection(e,t,n){let r=(0,o.N)(e,{scrollIntoView:!0,selection:n},t),i=(0,l.Hr)({...e,...r},e.focusId);return{...e.assistFocusId?{assistFocusId:t}:void 0,focusId:t,focusStack:updateFocusStack(e.focusStack,t),selectionFocusId:null,selection:new Set,insertingId:void 0,...r,...i}}function updateFocusAndCommit(e,t,n){if(e.focusId===t)return;let r=maybeImplicitCommit(e),o=r&&(0,i.v)(e,[r]);return{...o,...updateFocus({...e,...o},t,n)}}function refocus(e){return null!==e.focusId?(0,o.N)(e,{scrollIntoView:!0},e.focusId):void 0}let focus_focus=(e,t)=>{let{id:n}=t;return updateFocusAndCommit(e,n)},focus_blur=(e,t)=>{let{id:n=e.focusId}=t;if(e.focusId===n)return maybeBlur(e)};function maybeBlur(e){if(null===e.focusId)return;let t=maybeImplicitCommit(e),n=(0,l.Hr)(e,e.focusId);return{...t&&(0,i.v)({...e,...n},[t]),...n,focusId:null,assistFocusId:null}}let focusAfter=(e,t)=>{let{id:n,selectStart:i}=t,{model:o,model:{nodes:l}}=e,s=(0,d.$g)(o,n);if(s>l.length-2)return;let a=l[s+1].id;return updateFocusAndCommit(e,a,i?r.jT.single(0):void 0)},focusBefore=(e,t)=>{let{id:n,selectEnd:i}=t,{editorStates:o,model:l,model:{nodes:s}}=e,a=(0,d.$g)(l,n);if(a<1)return;let c=s[a-1].id;return updateFocusAndCommit(e,c,i?r.jT.single(o.get(c).doc.length):void 0)},focusFirst=e=>{let{model:{nodes:t},focusId:n,focusStack:r}=e;if(!t.length)return;let i=null!==n?n:r.length?r[r.length-1]:t[0].id;return updateFocusAndCommit(e,i)},focusLast=e=>{let{model:{nodes:t},focusId:n,focusStack:r}=e,i=null!==n?n:r.length?r[r.length-1]:t[t.length-1].id;return updateFocusAndCommit(e,i)},focusUndo=e=>{let{focusStack:t}=e,n=t.length;if(n>1)return{...updateFocusAndCommit(e,t[n-2]),focusStack:t.slice(0,-1)}},focusDefinition=(e,t)=>{let{name:n}=t;n=n.trim().replace(/\s+/g," ");let r=e.model.nodes.find(e=>(0,c.WN)(e).includes(n));if(void 0!==r)return updateFocusAndCommit(e,r.id)},focusError=(e,t)=>{let{id:n}=t,{editorStates:i}=e,o=i.get(n),{jumpToError:l}=o.field(s.ei).find(e=>{let{jumpToError:t}=e;return t})||{};if(!l||!i.has(l.id))return;let a=r.jT.single(Math.min(l.position,i.get(l.id).doc.length-1));return e.focusId===l.id?updateFocusAndSelection(e,l.id,a):updateFocusAndCommit(e,l.id,a)},openInsertMenu=(e,t)=>{let{id:n,before:r}=t,{model:o}=e;if(!o.nodes.length)return;let s=r?n:null===n?o.nodes[0].id:(0,d.o4)(o,n),a=maybeImplicitCommit(e),c=(0,l.Hr)(e,e.focusId),u={...a&&(0,i.v)({...e,...c},[a]),...c};return r&&u.model&&null!==n&&null!==s&&!(0,d.DY)(u.model,s)&&(s=(0,d.o4)(o,n)),{selectionFocusId:null,selection:new Set,insertingId:s,...u}},closeInsertMenu=(e,t)=>{let{selectedItem:n}=t;return{insertingId:void 0,...n?{}:refocus(e)}}},80833:function(e,t,n){"use strict";n.d(t,{X:function(){return loadedVersion},n:function(){return loadVersion}});var r=n(89008),i=n(5146),o=n(13348);let loadVersion=async(e,t,n)=>{let{notebook:r,currentUser:l}=e,{version:s,autosave:a}=t;try{let{edit_unpublished:e,latest_version:t,...o}=await (0,i.a8)("/document/".concat(r.id,"@").concat(s));n({type:"loadedVersion",body:o,editUnpublished:e,initialLatestVersion:t,currentUser:l,autosave:a})}catch(e){(0,o.S)({error:e,key:"load_".concat(r.id),message:"Unable to load the notebook at the specified version",dispatch:n})}},loadedVersion=(e,t)=>{let{initialLatestVersion:n}=t;return{...(0,r.R)(e,t),initialLatestVersion:n,autosave:!!t.autosave&&t.body.version>=n,isPausedLoad:!1,documentKey:void 0}}},66652:function(e,t,n){"use strict";n.d(t,{l:function(){return liked},v:function(){return like}});var r=n(5146);let like=async(e,t,n)=>{let{notebook:{like:i,id:o},currentUser:l}=e,{trigger:s,source:a}=t;if(!l){n({type:"showModal",modal:"login",modalProps:{loginReason:"like"},trigger:s,source:a});return}n({type:"liked",liked:!i});try{await (0,r.Fv)("/document/".concat(o,"/like"),{like:!i})}catch(e){n({type:"liked",liked:i}),n({type:"showErrorToast",message:i?"Oops, un-liking this notebook failed. Try again?":"Oops, liking this notebook failed. Try again?",key:"like"})}},liked=(e,t)=>{let{likes:n}=e,{liked:r}=t;return{like:r,likes:Math.max(n+(r?1:-1),0)}}},22971:function(e,t,n){"use strict";n.d(t,{$T:function(){return insert},A1:function(){return moveUp},BE:function(){return insertAfter},Od:function(){return remove},TN:function(){return title},Vt:function(){return insertBefore},XM:function(){return relicense},aB:function(){return togglePin},cZ:function(){return insertAll},kT:function(){return initialModel},th:function(){return commit},vi:function(){return moveDown}});var r=n(78120),i=n(63999),o=n(42866),l=n(67064),s=n(72776),a=n(93105),d=n(22481),c=n(40591),u=n(90271),p=n(44911);function initialModel(e){let t=i.Z.of(e);return t.history=[],t}let title=(e,t)=>{let{value:n}=t;return(0,o.v)(e,[{type:"modify_title",new_node_value:n}])},commit=(e,t)=>{let{id:n}=t,r={type:"modify_node",node_id:n,new_node_value:e.editorStates.get(n).doc.toString()},{model:l,...s}=(0,o.v)(e,[r]);return l===e.model&&((l=new i.Z(e.model)).history=e.model.history.concat({...r,version:e.model.version})),{...s,model:l,...void 0===e.notificationMode&&{notificationMode:"allow"}}},insertAll=(e,t)=>{let n,{id:i,before:l,nodes:s}=t;if(!(s.length>0))throw Error("must insert at least one node");let{model:d,type:u}=e,h=l?i:null===i?d.nodes[0].id:(0,c.o4)(d,i);if("dashboard"===u&&!h){var m,f,g;(null===(g=d.nodes[d.nodes.length-1])||void 0===g?void 0:null===(f=g.display)||void 0===f?void 0:null===(m=f.presentation)||void 0===m?void 0:m.hidden)&&(n={presentation:{hidden:!0}})}let v=s[s.length-1],y=s.map(e=>{let{mode:t="js",value:r=p.qz[t].defaultNode.value,name:i=p.qz[t].defaultNode.name,pinned:o="dashboard"!==u&&p.qz[t].defaultNode.pinned,data:l="chart"===t?(0,p.IS)(u):p.qz[t].defaultNode.data,combine:s,display:a}=e;return{type:"insert_node",new_next_node_id:h,new_node_name:i,new_node_pinned:o,new_node_value:r,new_node_mode:t,new_node_data:l,new_combine:s,new_node_display:null!=n?n:a}}),x=(0,a.cn)(e);x&&y.push(x);let b=(0,o.v)(e,y),w=d.events.length+s.length-1;return{...b,...(0,a.Aq)({...e,...b},w,v.value?r.jT.single(v.value.length):void 0)}},insert=(e,t)=>{let{id:n,before:r,node:i={}}=t;return insertAll(e,{type:"insertAll",id:n,before:r,nodes:[i]})},insertAfter=(e,t)=>{let{id:n,node:r}=t;if("dashboard"===e.type){let{layout:t,model:l}=e,s=n?(0,c.DY)(l,n):null;if(s){var i,o;if(null===(o=s.display)||void 0===o?void 0:null===(i=o.presentation)||void 0===i?void 0:i.hidden)r={...r,display:{presentation:{hidden:!0}},combine:null};else{let i=n,o=null,l=t.find(e=>e.slots.find(e=>e.nodeId===n));return l&&((0,d.G)(l.slots[0])||l.slots.length===u.j$)?i=l.slots[l.slots.length-1].nodeId:o=r&&"combine"in r?r.combine:"previous",insert(e,{id:i,before:!1,node:r={...r,combine:o},type:"insert"})}}}return insert(e,{id:n,before:!1,node:r,type:"insert"})},insertBefore=(e,t)=>{let{id:n,node:r}=t;if("dashboard"===e.type){var i,o,l,s,a,p,h,m;let{layout:t,model:f}=e,g=n?(0,c.DY)(f,n):null;if(g){let p=t.find(e=>e.slots.find(e=>e.nodeId===n)),h=null==p?void 0:p.slots.findIndex(e=>e.nodeId===n);if(!(r&&"display"in r)&&(null===(o=g.display)||void 0===o?void 0:null===(i=o.presentation)||void 0===i?void 0:i.hidden))r={...r,display:{presentation:{hidden:!0}},combine:null};else if(!(r&&"combine"in r&&!r.combine&&0===h)){let i=n,o=null,p=n?(0,c.t$)(f,n):null,h=t.findIndex(e=>e.slots.find(e=>e.nodeId===((null==r?void 0:r.combine)==="previous"?p:n))),m=t[h];if((0,d.G)(m.slots[0])||m.slots.length===u.j$)i=null!==(a=null===(s=t[h+1])||void 0===s?void 0:null===(l=s.slots[0])||void 0===l?void 0:l.nodeId)&&void 0!==a?a:null;else{let e=m.slots.findIndex(e=>e.nodeId===n);o=r&&"combine"in r?r.combine:0===e?"next":"previous"}return insert(e,{id:i,before:!0,node:r={...r,combine:o},type:"insert"})}}else{let e=f.nodes[f.nodes.length-1];if(e){r={...r,display:null!==(m=null==r?void 0:r.display)&&void 0!==m?m:e.display,combine:(null===(h=e.display)||void 0===h?void 0:null===(p=h.presentation)||void 0===p?void 0:p.hidden)?null:null==r?void 0:r.combine};let n=t.find(t=>t.slots.find(t=>t.nodeId===e.id));n&&((0,d.G)(n.slots[0])||n.slots.length===u.j$)&&(r.combine=null)}}}return insert(e,{id:n,before:!0,node:r,type:"insert"})},remove=(e,t)=>{let{id:n,focusAfter:r,focusBefore:i}=t,{nodes:s}=e.model;if(s.length>1){let t=(0,o.v)(e,[{type:"remove_node",node_id:n}]);if(r||i){let i=(0,c.$g)(e.model,n)+(r?1:-1);t={...t,focusId:s[Math.max(0,Math.min(s.length,i))].id}}return e.assistFocusId===n&&(t={...t,assistFocusId:null}),t}{let t={changes:{from:0,to:e.editorStates.get(n).doc.length,insert:""}},{transactions:r,editorStates:i}=(0,l.N)(e,t,n),s=i.get(n);return(0,o.v)({...e,transactions:r,editorStates:i},[{type:"modify_node",node_id:n,new_node_value:s.doc.toString()}])}},togglePin=(e,t)=>{let{id:n}=t,r=(0,c.DY)(e.model,n).pinned;return(0,o.v)(e,[{type:r?"unpin_node":"pin_node",node_id:n}])},moveDown=(e,t)=>{let n,{id:r}=t,{nodes:i}=e.model,{type:l}=e,a=(0,c.$g)(e.model,r);if(a===i.length-1)return;let d=a<i.length-2?i[a+2].id:null;if("dashboard"===l){if(d){let t=(0,c.t$)(e.model,d);if(t){let r=(0,c.DY)(e.model,t);n=null==r?void 0:r.display}}else{var u,p,h;(null===(h=i[i.length-1])||void 0===h?void 0:null===(p=h.display)||void 0===p?void 0:null===(u=p.presentation)||void 0===u?void 0:u.hidden)&&(n={presentation:{hidden:!0}})}}return(0,s.Sf)(e,(0,o.v)(e,[{type:"move_node",node_id:r,new_next_node_id:d,new_node_display:n}]),r)},moveUp=(e,t)=>{let n,{id:r}=t,{nodes:i}=e.model,{type:l}=e,a=(0,c.$g)(e.model,r);if(0===a)return;let d=i[a-1].id;if("dashboard"===l){let t=(0,c.t$)(e.model,d);if(t){let r=(0,c.DY)(e.model,t);n=null==r?void 0:r.display}}return(0,s.Sf)(e,(0,o.v)(e,[{type:"move_node",node_id:r,new_next_node_id:d,new_node_display:n}]),r)},relicense=(e,t)=>{let{copyright:n,license:r}=t,{model:i}=e,l=[];if(i.copyright!==n&&l.push({type:"modify_copyright",new_node_value:n}),i.license!==r&&l.push({type:"modify_license",new_node_value:r}),l.length)return(0,o.v)(e,l)}},47716:function(e,t,n){"use strict";n.d(t,{$H:function(){return addNotificationRequest},D$:function(){return rejectNotificationRequest},NF:function(){return confirmNotificationRequest},Q1:function(){return confirmNotificationRequestListener},gY:function(){return ignoreNotificationRequests}});var r=n(5146),i=n(11252);let o="Notification not found in queue",addNotificationRequest=(e,t)=>{let{notificationRequests:n,notificationMode:r}=e,{requestId:i,notification:o}=t,{onReject:l}=o;if(void 0===r){l("ignoring notification requests until you manually run a cell");return}if("ignore"===r){l("ignoring notification requests for rest of session");return}return(n=new Map(n)).set(i,o),{notificationRequests:n}},confirmNotificationRequest=(e,t)=>{let{notificationRequests:n}=e,{requestId:r}=t;return(n=new Map(n)).delete(r),{notificationRequests:n}},confirmNotificationRequestListener=async(e,t)=>{let{notebook:n,currentUser:l}=e,s=l?l.name:"unknown user",{id:a,owner:d,model:{title:c},notificationRequests:u}=n,{requestId:p}=t,h=u.get(p);if(!h){console.error(o);return}let{provider:m,address:f,content:g,onConfirm:v,onReject:y}=h;switch(m){case"email":try{let e=await (0,r.Fv)("/notify/email",{id:a,to:f.split(","),content:g});e.error&&y(e.error),v({ok:!0})}catch(e){y(i.K.COULD_NOT_PREPARE_TO_SEND_EMAIL)}break;case"slack":{let e=await (0,r.a8)("/team/".concat(d.id,"/token?provider=slackNotifications")),t=await new i.r({address:f,token:e,userName:s,notebookTitle:c,scheduled:!1}).send(g);t.ok?v(t):y(t.error);break}default:y(i.K.UNRECOGNIZED_NOTIFICATION_PROVIDER)}},rejectNotificationRequest=(e,t)=>{let{notificationRequests:n}=e,{requestId:r}=t;n=new Map(n);let i=n.get(r);if(!i){console.error(o);return}return i.onReject("you chose not to send the notification"),n.delete(r),{notificationRequests:n}},ignoreNotificationRequests=()=>({notificationMode:"ignore"})},82244:function(e,t,n){"use strict";n.d(t,{Ez:function(){return togglePaneListener},GJ:function(){return toggleHelpPaneSection},Ge:function(){return setOpenCollection},Gr:function(){return closeHelpArticle},LZ:function(){return openHelpArticle},P4:function(){return toggleCollectionsSidebar},Yd:function(){return collectionsUpdated},_O:function(){return openCollectionsSidebar},_k:function(){return showPaneListener},lx:function(){return togglePane},rE:function(){return dismissPane},y3:function(){return i}});var r=n(5146);let i=new Set(["gettingStarted","loadingData","exploringData","reusingCode","collaborating","troubleshooting","links","keyboardShortcuts"]),showPaneListener=(e,t,n)=>{let{page:r}=e,{pane:i}=t;r.pane!==i&&n({type:"togglePane",pane:i})},togglePane=(e,t)=>{let{pane:n,focusKeyboardShortcuts:r}=t;return e.pane===n?e.guide&&"guide"!==n?{pane:"guide"}:{pane:null}:{pane:n,...r&&{helpArticlesOpen:[],helpPaneSectionsOpen:new Set(["keyboardShortcuts"])}}},togglePaneListener=(e,t,n)=>{let{page:r,decorations:{signpost:i}}=e,{pane:o}=t;r.pane!==o&&i&&i===function(e){switch(e){case"aiassist":return"assist";case"help":return"help";default:return null}}(o)&&n({type:"dismissSignpost",trigger:"Implicit"})},dismissPane=e=>e.guide&&"guide"!==e.pane?{pane:"guide"}:{pane:null},setOpenCollection=async(e,t,n)=>{let{notebook:i}=e,{collection:o}=t,{initialCollection:l}=i;(null==l?void 0:l.id)!==o.id&&(l=await (0,r.a8)("/collection/@".concat(o.owner.login,"/").concat(o.slug))),n({type:"openCollectionsSidebar",collection:l})},toggleCollectionsSidebar=e=>({collectionsSidebarOpen:!e.collectionsSidebarOpen}),collectionsUpdated=(e,t)=>({collectionsSidebarOpen:!t.orphaned&&e.collectionsSidebarOpen}),toggleHelpPaneSection=(e,t)=>{let{helpPaneSectionsOpen:n}=e,{section:r}=t;return(n=new Set(n)).has(r)?n.delete(r):n.add(r),{helpPaneSectionsOpen:n}},openCollectionsSidebar=()=>({collectionsSidebarOpen:!0}),openHelpArticle=(e,t)=>{let{helpArticlesOpen:n}=e,{article:r,reset:i}=t;return{helpArticlesOpen:i?[r]:n.concat(r)}},closeHelpArticle=e=>{let{helpArticlesOpen:t}=e;return{helpArticlesOpen:t.slice(0,-1)}}},90772:function(e,t,n){"use strict";n.d(t,{Dq:function(){return pauseLiveEdits},SK:function(){return resumeLiveEditsAnalytic},W8:function(){return pauseLiveEditsSuccess},Z6:function(){return pauseLiveEditsAnalytic},eD:function(){return resumeLiveEditsSuccess},gY:function(){return resumeLiveEdits}});var r=n(5146),i=n(4530);let pauseLiveEdits=async(e,t,n)=>{let{notebook:{pausedVersion:i,saveVersion:o,id:l}}=e;try{let e=await (0,r.Fv)("/document/".concat(l,"/pause"),{paused_version:o});if(null===e.paused_version)throw Error("Unexpected null paused_version");n({type:"pauseLiveEditsSuccess",pausedVersion:e.paused_version}),n({type:"showSuccessToast",message:"".concat(i?"Paused version updated to":"Paused live editing at"," v").concat(e.paused_version),key:"pauseResume"})}catch(e){n({type:"showErrorToast",message:"Oops, pausing this notebook failed. Try again?",key:"pauseResume"})}},resumeLiveEdits=async(e,t,n)=>{let{notebook:{id:i}}=e;try{let e=await (0,r.Fv)("/document/".concat(i,"/pause"),{paused_version:null});if(null!==e.paused_version)throw Error("Unexpected non-null paused_version");n({type:"resumeLiveEditsSuccess"}),n({type:"showSuccessToast",message:"Resumed live editing",key:"pauseResume"})}catch(e){n({type:"showErrorToast",message:"Oops, resuming live edits on this notebook failed. Try again?",key:"pauseResume"})}},pauseLiveEditsSuccess=(e,t)=>{let{pausedVersion:n}=t;return{pausedVersion:n}},resumeLiveEditsSuccess=()=>({pausedVersion:null}),pauseLiveEditsAnalytic=(e,t)=>{let{currentUser:n,notebook:r}=e,{pausedVersion:o}=t;(0,i.MR)((0,i.ym)({type:"notebook:manage:pauseUpdate",data:{previousPausedVersion:r.pausedVersion},currentUser:n,eventVersion:1,notebook:{...r,pausedVersion:o}}))},resumeLiveEditsAnalytic=e=>{let{currentUser:t,notebook:n}=e;(0,i.MR)((0,i.ym)({type:"notebook:manage:pauseUpdate",data:{previousPausedVersion:n.pausedVersion},currentUser:t,eventVersion:1,notebook:{...n,pausedVersion:null}}))}},30743:function(e,t,n){"use strict";n.d(t,{$R:function(){return revertSucceeded},_$:function(){return revertRequestedListener},oc:function(){return revertRequested},tR:function(){return revertFailed}});var r=n(89008),i=n(5146),o=n(79998);let revertRequested=()=>({isReverting:!0}),revertSucceeded=(e,t)=>({...(0,r.R)(e,t),isReverting:!1,saveTime:new Date,autosave:!0}),revertFailed=()=>({isReverting:!1}),revertRequestedListener=async(e,t,n)=>{let{notebook:{id:r,model:l,isReverting:s},currentUser:a,page:{pane:d}}=e;if(s)return;let{remote:c,version:u}=t;n({type:"showProcessingToast",key:"revert",message:c?"".concat((0,o.Ui)(l)," was reverted to version ").concat(u,"…"):"Reverting ".concat((0,o.Ui)(l)," to version ").concat(u,"…")});try{let{edit_unpublished:e,...s}=c?await (0,i.a8)("/document/".concat(r,"@").concat(t.saveVersion)):await (0,i.Fv)("/document/".concat(r,"/revert"),{version:u});n({type:"revertSucceeded",body:s,editUnpublished:e,currentUser:a}),n({type:"showSuccessToast",key:"revert",message:"".concat((0,o.Ui)(l)," was reverted to version ").concat(u,".")}),"history"===d&&n({type:"dismissPane"})}catch(e){n({type:"revertFailed"}),n({type:"showErrorToast",key:"revert",message:"".concat((0,o.Ui)(l)," ").concat(c?"was":"could not be"," reverted. Please reload").concat(c?"":" or try again",".")})}}},28826:function(e,t,n){"use strict";n.d(t,{$k:function(){return toggleReplaceInputExpandedReducer},Fz:function(){return setSearchTermReducer},IY:function(){return selectPreviousSearchResultReducer},J2:function(){return toggleRegexSearchReducer},Pp:function(){return togglePaneNotebookReducer},QB:function(){return showFindPaneNotebookReducer},Rt:function(){return replaceAllListener},YU:function(){return updateSearchResultsReducer},gL:function(){return toggleWholeWordSearchReducer},hf:function(){return selectNextSearchResultReducer},lc:function(){return toggleFindOptionsExpandedReducer},oG:function(){return selectSearchResultReducer},sA:function(){return setReplaceTermReducer},sk:function(){return replaceCurrentReducer},tT:function(){return toggleCaseSensitiveSearchReducer},wW:function(){return replaceAllReducer},zI:function(){return showFindPaneListener}});var r=n(78120),i=n(64063),o=n.n(i),l=n(42866),s=n(67064),a=n(93105),d=n(82244),c=n(7897),u=n(49817);function findLocations(e){let{searchTerm:t,content:n,caseInsensitive:r=!1,wholeWord:i=!1}=e;t instanceof RegExp||(i&&(t=t.trim()),r&&(n=n.toLocaleLowerCase(),t=t.toLocaleLowerCase()));let o=[],l=-1;if(t instanceof RegExp){let e;for(;null!==(e=t.exec(n));)o.push({location:e.index,matchedText:e[0],captureGroups:e.slice(1)})}else for(;l<n.length-1;){let e=n.indexOf(t,l+1);if(-1===e||(l=e,i&&(e>0&&/\b/.test(n[e-1])||e+t.length<n.length&&/\b/.test(n[e+t.length]))))break;o.push({location:e,matchedText:n.substr(e,t.length),captureGroups:[]})}return o}function replaceCaptureGroups(e,t){for(let n=0;n<t.length;n++)e=e.replaceAll("$".concat(n+1),t[n]);return e}function getSearchTerm(e){let{searchTerm:t,regexSearch:n}=e;return n?RegExp(t,"gu"):t}function searchNode(e){let{searchTerm:t,editorState:n,caseSensitiveSearch:r,wholeWordSearch:i}=e,o=n.doc.toString(),l=[],s=[{location:0,matchedText:"\n",captureGroups:[]},...findLocations({content:o,searchTerm:"\n"}),{location:o.length,matchedText:"\n",captureGroups:[]}];for(let e=0;e<s.length-1;e++){let n=s[e].location,a=s[e+1].location-1,d=o.substring(n,a+1);if(!d)continue;let c=findLocations({content:d,searchTerm:t,caseInsensitive:!r,wholeWord:i});for(let e of c){let t,r;let i=e.matchedText,o=e.location;if(i.length>=28){l.push({beforeText:"",termText:o>0?"…".concat(i.substr(0,26),"…"):"".concat(i.substr(0,27),"…"),afterText:"",matchLength:i.length,captureGroups:e.captureGroups,pos:n+o});continue}let s=d.substr(o,i.length);if(d.length<=28)t=d.substring(0,o),r=d.substring(o+i.length);else{let e=Math.floor(o+i.length/2);if(e-14<=0)t=d.substring(0,o),r="".concat(d.substring(o+i.length,27),"…");else if(e+14>d.length)t="…".concat(d.substring(d.length-28+1,o)),r=d.substring(o+i.length);else{let e=(28-i.length)/2-1,n=Math.floor(e),l=Math.ceil(e);t="…".concat(d.substr(o-n,n)),r="".concat(d.substr(o+i.length,l),"…")}}l.push({beforeText:t,termText:s,afterText:r,matchLength:i.length,captureGroups:e.captureGroups,pos:n+o})}}return l.length?l:void 0}function getSearchStateChange(e){let t;let{searchAnchor:n,searchResultsVisible:r,searchResults:i,selectedSearchResult:l,model:a}=e;if(i&&(0,u.n)(i)>0){if(n){let e=!1;e:for(let{id:r}of a.nodes){let o=i.get(r);if(r===n.nodeId){if(e=!0,o){for(let[e,{pos:i}]of o.entries())if(i>=n.position){t={nodeId:r,nodeResultIndex:e};break e}}}else if(e&&o){t={nodeId:r,nodeResultIndex:0};break}}}t||(t=getNodeIdAndIndex(i,0)),o()(t,l)&&(t=l)}let{editorStates:d,transactions:p}=e;for(let[e]of d)({editorStates:d,transactions:p}=(0,s.N)({editorStates:d,transactions:p},{effects:[c.YE.of((null==i?void 0:i.get(e))||null),c.j5.of(t||null),c.K5.of(r)]},e));return{...e,editorStates:d,transactions:p,selectedSearchResult:t}}function updateSearchResults(e,t){let n;if(!e.searchTerm)return e;let{editorStates:r,searchTerm:i,caseSensitiveSearch:o,wholeWordSearch:l,regexSearch:s,searchResults:a,model:{nodes:d}}=e;t||(t=Array.from(r.keys()));try{n=getSearchTerm({searchTerm:i,regexSearch:s})}catch(t){return getSearchStateChange(e)}let c=new Map;for(let{id:e}of d){let i=r.get(e);if(i){let r=t.includes(e)?searchNode({searchTerm:n,editorState:i,caseSensitiveSearch:o,wholeWordSearch:l}):a.get(e);r&&c.set(e,r)}}return getSearchStateChange({...e,searchResults:c})}let updateSearchResultsReducer=(e,t)=>{let{nodeIds:n}=t;return updateSearchResults(e,n)},setSearchTermReducer=(e,t)=>{let n,{searchTerm:r}=t,{editorStates:i,caseSensitiveSearch:o,wholeWordSearch:l,regexSearch:s,model:{nodes:a}}=e;if(!r)return getSearchStateChange({...e,searchTerm:"",searchResults:void 0,selectedSearchResult:void 0});try{n=getSearchTerm({searchTerm:r,regexSearch:s})}catch(e){return{searchTerm:r,searchResults:void 0,selectedSearchResult:void 0}}let d=new Map;for(let{id:e}of a){let t=i.get(e);if(t){let r=searchNode({searchTerm:n,editorState:t,caseSensitiveSearch:o,wholeWordSearch:l});r&&d.set(e,r)}}return getSearchStateChange({...e,searchTerm:r,searchResults:d})};function selectSearchResult(e,t){var n;if(!t)return;let{searchResults:r}=e,{nodeId:i,nodeResultIndex:o}=t,l=null==r?void 0:null===(n=r.get(i))||void 0===n?void 0:n[o];if(!l)return;let{editorStates:a,transactions:d}=e;for(let[e]of a)({editorStates:a,transactions:d}=(0,s.N)({editorStates:a,transactions:d},{effects:[c.j5.of(t)]},e));return{editorStates:a,transactions:d,selectedSearchResult:t,searchAnchor:{nodeId:i,position:l.pos}}}let selectSearchResultReducer=(e,t)=>{let{selectedSearchResult:n}=t;return selectSearchResult(e,n)};function getNodeIdAndIndex(e,t){let n,r;let i=0;for(let[o,l]of e){if(t<i+l.length){n=o,r=t-i;break}i+=l.length}return{nodeId:n,nodeResultIndex:r}}let selectNextSearchResultReducer=e=>{let{searchResults:t,selectedSearchResult:n}=e;if(!t||!n)return;let r=(0,u.n)(t),i=(0,u._)(t,n);return selectSearchResult(e,getNodeIdAndIndex(t,i<r-1?i+1:0))},selectPreviousSearchResultReducer=e=>{let{searchResults:t,selectedSearchResult:n}=e;if(!t||!n)return;let r=(0,u.n)(t),i=(0,u._)(t,n);return selectSearchResult(e,getNodeIdAndIndex(t,i>0?i-1:r-1))},showFindPaneListener=(e,t,n)=>(0,d._k)(e,{type:"showPane",pane:"find"},n),showFindPaneNotebookReducer=(e,t)=>{let{initialSearchTerm:n,anchorNodeId:r,anchorPosition:i=0}=t,o={};return void 0!==r&&(o.searchAnchor={nodeId:r,position:i},o.selectedSearchResult=void 0,e={...e,...o}),(void 0!==r||void 0!==n)&&(o={...o,...setSearchTermReducer(e,{type:"setSearchTerm",searchTerm:null!=n?n:e.searchTerm})}),o},togglePaneNotebookReducer=(e,t)=>{let{editorStates:n,transactions:i,searchResultsVisible:o,searchAnchor:l}=e,d="pane"in t&&"find"===t.pane&&!o,u={searchResultsVisible:d,searchAnchor:d?l:void 0};if(d!==o){for(let[e]of n)({editorStates:n,transactions:i}=(0,s.N)({editorStates:n,transactions:i},{effects:[c.K5.of(d)]},e));u={...u,editorStates:n,transactions:i}}if(("dismissPane"===t.type||"find"===t.pane)&&o){let{selectedSearchResult:t,searchResults:n}=e;if(n&&t){let{nodeId:i,nodeResultIndex:o}=t,{pos:l,matchLength:s}=n.get(i)[o];u={...u,...(0,a.$c)({...e,...u},i,r.jT.create([r.jT.range(l,l+s)]))}}else u={...u,...(0,a.VH)(e)}}return("dismissPane"===t.type||"aiassist"===t.pane)&&(u={...u,assistFocusId:null}),u},toggleFindOptionsExpandedReducer=e=>{let{findOptionsInputExpanded:t}=e;return{findOptionsInputExpanded:!t}},toggleCaseSensitiveSearchReducer=e=>updateSearchResults({...e,caseSensitiveSearch:!e.caseSensitiveSearch,regexSearch:!1}),toggleWholeWordSearchReducer=e=>updateSearchResults({...e,wholeWordSearch:!e.wholeWordSearch,regexSearch:!1}),toggleRegexSearchReducer=e=>updateSearchResults({...e,regexSearch:!e.regexSearch,caseSensitiveSearch:!1,wholeWordSearch:!1}),setReplaceTermReducer=(e,t)=>{let{replaceTerm:n}=t;return{replaceTerm:n}},replaceCurrentReducer=e=>{let{editorStates:t,transactions:n,selectedSearchResult:r,searchResults:i,replaceTerm:o}=e;if(!r||!i)return;t=new Map(t);let{nodeId:a,nodeResultIndex:d}=r,c=i.get(a),{pos:u,matchLength:p,captureGroups:h}=c[d];return e.regexSearch&&(o=replaceCaptureGroups(o,h)),{editorStates:t,transactions:n}=(0,s.N)({editorStates:t,transactions:n},{changes:[{from:u,to:u+p,insert:o}]},a),(0,l.v)({...e,editorStates:t,transactions:n},[{type:"modify_node",new_node_value:t.get(a).doc.toString(),node_id:a}])},replaceAllListener=(e,t,n)=>{let{notebook:{selectedSearchResult:r,searchResults:i}}=e;if(!r||!i)return;let o=(0,u.n)(i);n({type:"showSuccessToast",message:"Replaced ".concat(o," ").concat(1===o?"occurrence":"occurrences")})},replaceAllReducer=e=>{let{editorStates:t,transactions:n,selectedSearchResult:r,searchResults:i,replaceTerm:o}=e;if(!r||!i)return;for(let[r,l]of(t=new Map(t),i))({editorStates:t,transactions:n}=(0,s.N)({editorStates:t,transactions:n},{changes:l.map(t=>{let{pos:n,matchLength:r,captureGroups:i}=t,l=o;if(e.regexSearch)for(let e=0;e<i.length;e++)l=o=replaceCaptureGroups(l,i);return{from:n,to:n+r,insert:l}})},r));let a=[];for(let e of Array.from(i.keys())){let n=t.get(e).doc.toString();a.push({type:"modify_node",new_node_value:n,node_id:e})}return(0,l.v)({...e,editorStates:t,transactions:n},a)},toggleReplaceInputExpandedReducer=e=>{let{replaceInputExpanded:t}=e;return{replaceInputExpanded:!t}}},85478:function(e,t,n){"use strict";n.d(t,{AG:function(){return selectionDownstream},BP:function(){return selectionPin},Fq:function(){return selectionBlur},Kt:function(){return selectionFocusAfter},MP:function(){return selectionUpstream},PK:function(){return selectionHide},Qs:function(){return selectionPaste},S2:function(){return selectionCopyListener},SU:function(){return selectionInsert},Sx:function(){return selectionDelete},TW:function(){return selectionClear},Uo:function(){return selectionFocusBefore},WZ:function(){return selectionFocusToggle},bO:function(){return selectionRun},dZ:function(){return getSelectionUnion},fV:function(){return selectionMoveUp},q6:function(){return selectionDuplicate},qg:function(){return selectionAll},sc:function(){return selectionPromote},v2:function(){return selectionComment},vJ:function(){return selectionToggle},wP:function(){return selectionFocusEnter},zq:function(){return selectionMoveDown}});var r=n(63999),i=n(42866),o=n(67064),l=n(49122),s=n(43318),a=n(44526),d=n(72776),c=n(93105),u=n(42786),p=n(79941),h=n(40591);let selectionAll=e=>{let t;if(null===e.selectionFocusId){var n;let r=null===(n=e.model.nodes[0])||void 0===n?void 0:n.id;t={selectionFocusId:r,focusState:(0,c.mX)(e.focusStack,r)}}let r={selection:new Set(e.model.nodes.map(e=>e.id)),...t};return{...r,...(0,c.N5)({...e,...r})}},selectionFocusAfter=(e,t)=>{let{add:n}=t,r=e.selectionFocusId;if(null!==r){let t=(0,h.$g)(e.model,r);if(t>=e.model.nodes.length-1)return;r=e.model.nodes[t+1].id}else r=e.focusStack.length?e.focusStack[e.focusStack.length-1]:e.model.nodes[0].id;return updateSelectionFocus(e,r,n)},selectionFocusBefore=(e,t)=>{let{add:n}=t,r=e.selectionFocusId;if(null!==r){let t=(0,h.$g)(e.model,r);if(t<=0)return;r=e.model.nodes[t-1].id}else{var i;r=e.focusStack.length?e.focusStack[e.focusStack.length-1]:null===(i=e.model.nodes[e.model.nodes.length-1])||void 0===i?void 0:i.id}return updateSelectionFocus(e,r,n)},selectionUpstream=e=>selectDescendants(e,!0),selectionDownstream=e=>selectDescendants(e);function selectDescendants(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],{selection:n,selectionFocusId:r,model:{nodes:i}}=e;if(null===r)return;let o=(t?p.BY:p._n)(i),l=Array.from((0,p.mD)((0,h.DY)(e.model,r),o),e=>e.id);return{selection:new Set([r,...n,...l])}}let selectionBlur=e=>{let{focusId:t,selection:n,selectionFocusId:r}=e;return null!==t?updateSelectionFocus(e,t):n.size>0?{selection:new Set}:null!==r?{selectionFocusId:null}:void 0},selectionClear=()=>({selection:new Set,selectionFocusId:null}),selectionPromote=e=>{let{focusId:t}=e;if(null===t)return;let n={selectionFocusId:null,selection:new Set([t]),focusId:null};return{...n,...(0,c.N5)({...e,...n})}};function updateSelectionFocus(e,t,n){if(e.selectionFocusId===t)return;let r={...null!==e.assistFocusId?{assistFocusId:t}:void 0,selectionFocusId:t,selection:n&&null!==e.selectionFocusId?new Set(e.selection).add(e.selectionFocusId).add(t):e.selection,focusStack:(0,c.mX)(e.focusStack,t)};return{...r,...(0,c.N5)({...e,...r})}}let selectionFocusEnter=e=>{if(null!==e.selectionFocusId)return(0,c.Aq)(e,e.selectionFocusId)},selectionFocusToggle=e=>{let{selection:t,selectionFocusId:n}=e;if(null!==n)return(t=new Set(t)).has(n)?t.delete(n):t.add(n),{selection:t}},selectionToggle=(e,t)=>{let{model:n,selection:r}=e,{id:i}=t;if((0,h.DY)(n,i))return(r=new Set(r)).has(i)?r.delete(i):r.add(i),{selection:r}},selectionPin=e=>{let t=[...getSelectionUnion(e)],n=t.filter(t=>!(0,h.DY)(e.model,t).pinned);return(0,i.v)(e,n.length?n.map(e=>({type:"pin_node",node_id:e})):t.map(e=>({type:"unpin_node",node_id:e})))},selectionHide=e=>{let t=Array.from(getSelectionUnion(e),t=>(0,h.DY)(e.model,t));return(0,i.v)(e,(t.some(u.qU)?t.filter(u.qU):t.filter(e=>!(0,u.qU)(e))).map(u.fb))},selectionDelete=e=>{let t=Array.from(getSelectionUnion(e),e=>({type:"remove_node",node_id:e}));if(t.length<e.model.nodes.length)return(0,i.v)(e,t);let{node_id:n}=t.pop();return t.push({type:"modify_node",node_id:n,new_node_value:""}),{...(0,i.v)({...e,...(0,o.N)(e,{changes:{from:0,to:e.editorStates.get(n).doc.length,insert:""}},n)},t),focusId:n,focusStack:[n],selection:new Set,selectionFocusId:null}},selectionDuplicate=(e,t)=>{let{before:n}=t,r=getSelectionUnion(e),o=[],s=new Set,d=(0,l.e)(e.model.nodes),u=null;for(let t of r){let{editorState:r,insertEvent:i}=(0,a.N)(e,t,n,d);i.new_node_value=r.doc.toString();let l=e.model.events.length+o.length;o.push(i),t===e.selectionFocusId&&(u=l),e.selection.has(t)&&s.add(l)}return{...(0,i.v)(e,o),selection:s,selectionFocusId:u,focusStack:(0,c.mX)(e.focusStack,u)}},selectionRun=e=>{let t=new Set(getSelectionUnion(e)),n=(0,i.v)(e,Array.from(t,t=>({type:"modify_node",node_id:t,new_node_value:e.editorStates.get(t).doc.toString()})));for(let r=e.model.history.length,i=n.model.history.length;r<i;++r)t.delete(n.model.history[r].node_id);if(!t.size)return n;let o=new r.Z(n.model);for(let e of(o.history=n.model.history.slice(),t))o.history.push({type:"modify_node",node_id:e,new_node_value:(0,h.DY)(o,e).value});return{...n,model:o}},selectionComment=e=>{let t=e.selectionFocusId;if(null!==t&&!(t>e.saveVersion))return(0,s.hz)(e,{nodeId:t})},selectionInsert=(e,t)=>{let{before:n,inherit:r,mode:o="js"}=t,{model:l,focusStack:s,selectionFocusId:a,type:d}=e,u=null===a&&s.length?s[s.length-1]:a,p=n&&null===u?l.nodes[0].id:n||null===u?u:(0,h.o4)(l,u),m=r&&null!==u?(0,h.DY)(l,u):null,f=m?m.mode:o,g=null==m?void 0:m.display;if("dashboard"===d&&!p){var v,y,x;(null===(x=l.nodes[l.nodes.length-1])||void 0===x?void 0:null===(y=x.display)||void 0===y?void 0:null===(v=y.presentation)||void 0===v?void 0:v.hidden)&&(g={presentation:{hidden:!0}})}let b=(0,i.v)(e,[{type:"insert_node",new_next_node_id:p,new_node_value:"",new_node_pinned:!m||m.pinned,new_node_mode:f,new_node_data:m?m.data:null,new_node_name:"js"===f?null:"",new_node_display:g}]);return{...b,...(0,c.Aq)({...e,...b},l.events.length)}};function selectionMoveTo(e,t){let n=[],r=getSelectionUnion(e),o=e.model.nodes,{type:l}=e;for(let i=o.length-1;i>=0;--i){let d;let u=o[i].id;if("dashboard"===l){if(t){let n=(0,h.DY)(e.model,t);d=null==n?void 0:n.display}else{var s,a,c;(null===(c=o[o.length-1])||void 0===c?void 0:null===(a=c.display)||void 0===a?void 0:null===(s=a.presentation)||void 0===s?void 0:s.hidden)&&(d={presentation:{hidden:!0}})}}r.has(u)&&(n.push({type:"move_node",node_id:u,new_next_node_id:t,new_node_display:d}),t=u)}return(0,d.Sf)(e,(0,i.v)(e,n),e.selectionFocusId)}let selectionMoveDown=e=>{let t=getSelectionUnion(e),n=e.model.nodes,r=null;for(let e=n.length-1;e>=0;--e)if(t.has(n[e].id)){r=e<n.length-2?n[e+2].id:null;break}return selectionMoveTo(e,r)},selectionMoveUp=e=>{let t=getSelectionUnion(e),n=e.model.nodes,r=null;if(n.length&&t.has(n[0].id)){for(let e=1;e<n.length;++e)if(!t.has(n[e].id)){r=n[e].id;break}}else for(let e=1;e<n.length;++e)if(t.has(n[e].id)){r=n[e-1].id;break}return selectionMoveTo(e,r)},selectionCopyListener=(e,t)=>{let{notebook:n}=e,{clipboardData:r}=t,i=getSelectionUnion(n),o=[],l=[];for(let e of n.model.nodes)i.has(e.id)&&(o.push(e),l.push(n.editorStates.get(e.id).doc.toString()));r.setData("text/plain",l.join("\n\n")),r.setData("application/vnd.observablehq+json",JSON.stringify(o))},selectionPaste=(e,t)=>{var n,r;let{nodes:o}=t,l=null!==(r=e.selectionFocusId)&&void 0!==r?r:null===(n=e.model.nodes[0])||void 0===n?void 0:n.id,s=[],a=new Set,d=null;for(let t of o){let n=e.model.events.length+s.length;s.push({type:"insert_node",new_next_node_id:"dashboard"===e.type?null:l,new_node_display:"dashboard"===e.type?{presentation:{hidden:!0}}:void 0,new_node_value:t.value,new_node_pinned:t.pinned,new_node_mode:t.mode,new_node_data:t.data,new_node_name:t.name}),null===d&&(d=n),a.add(n)}return{...(0,i.v)(e,s),selection:a,selectionFocusId:d,focusStack:(0,c.mX)(e.focusStack,d)}};function getSelectionUnion(e){let{selection:t,selectionFocusId:n}=e;return t.size||null===n?t:new Set([n])}},77097:function(e,t,n){"use strict";n.d(t,{Z:function(){return getSourceTable},j:function(){return setDataSource}});var r=n(41269),i=n(42866),o=n(67064),l=n(93105),s=n(40591),a=n(44911);let setDataSource=(e,t)=>{let{id:n,source:r}=t,d=(0,s.DY)(e.model,n);if(!d)return;let c=[],u=e.editorStates.get(n).doc.toString();d.value!==u&&c.push({type:"modify_node",node_id:n,new_node_value:u}),c.push({type:"modify_data",node_id:n,new_node_data:{...d.data,source:r,..."table"===d.mode?{operations:{...a.Zu.defaultNode.data.operations,from:{table:getSourceTable(r)}}}:"chart"===d.mode?{config:d.data.config}:null}});let p=(0,i.v)(e,c);return e={...e,...p},p={...p,...(0,l.Aq)(e,n)},e={...e,...p},p={...p,...(0,o.N)(e,{scrollIntoView:!0},n)}};function getSourceTable(e){if(!(0,r.yD)(e.dialect))return null;switch(e.type){case"cell":return e.name;case"FileAttachment":return e.name.replace(/@\d+(?=\.|$)/,"").replace(/\.\w+$/,"");default:return null}}},42786:function(e,t,n){"use strict";n.d(t,{fb:function(){return toggleDisplayEvent},pk:function(){return setDisplay},qU:function(){return hasDisplay},r:function(){return toggleDisplay}});var r=n(64063),i=n.n(r),o=n(42866),l=n(78756),s=n(40591);function hasDisplay(e){var t,n;return!!e&&(null===(n=e.data)||void 0===n?void 0:null===(t=n.display)||void 0===t?void 0:t.mode)!=="none"}let toggleDisplay=(e,t)=>{let{id:n}=t,r=(0,s.DY)(e.model,n);if(r)return setDisplay(e,{type:"setDisplay",id:n,display:maybeToggleDisplay(r)})};function maybeToggleDisplay(e){var t,n;let r=null===(t=e.data)||void 0===t?void 0:t.display;return(null==r?void 0:r.mode)==="none"?null!==(n=r.previousDisplay)&&void 0!==n?n:null:{mode:"none",previousDisplay:r}}function toggleDisplayEvent(e){return maybeModifyDisplayEvent(e,maybeToggleDisplay(e))}function maybeModifyDisplayEvent(e,t){let{id:n,data:r}=e;return i()(null==r?void 0:r.display,t)?null:{type:"modify_data",node_id:n,new_node_data:t?{...r,display:t}:(0,l.w)(r)?{...r,display:void 0}:null}}let setDisplay=(e,t)=>{let n,{id:r,display:i}=t,l=(0,s.DY)(e.model,r);if(!l)return;let a=maybeModifyDisplayEvent(l,i);if(!a)return;let d=e.editorStates.get(r).doc.toString();return l.value!==d&&(n=(0,o.v)(e,[{type:"modify_node",node_id:r,new_node_value:d}])),{...n,...(0,o.v)({...e,...n},[a])}}},42612:function(e,t,n){"use strict";n.d(t,{q:function(){return setName}});var r=n(42866),i=n(67064),o=n(26271),l=n(40591),s=n(44911),a=n(41312);let setName=(e,t)=>{let{id:n,name:d,replaceReferences:c}=t,u=(0,l.DY)(e.model,n);if(!u)return;let p=(0,a.u2)(u);if(d===(p||""))return;let{editorStates:h,model:m,transactions:f}=e;return("js"===u.mode?{editorStates:h,model:m,transactions:f}=function(e,t,n){let l=function(e,t,n){let{editorStates:r,transactions:l}=n,s=r.get(e.id),a=(0,o.G)(s,!1);if(a){let n=t?null:(0,o.D)(s),d=null===n?a.to:n.from;return(0,i.N)({editorStates:r,transactions:l},{changes:{from:a.from,to:d,insert:t}},e.id)}return t?(0,i.N)({editorStates:r,transactions:l},{changes:{from:0,to:0,insert:"".concat(t," = ")}},e.id):{editorStates:r,transactions:l}}(e,t,n);return{...l,...(0,r.v)({...n,...l},[{type:"modify_node",node_id:e.id,new_node_value:l.editorStates.get(e.id).doc.toString()}])}}(u,d,e):{editorStates:h,model:m,transactions:f}=function(e,t,n){let i=n.editorStates.get(e.id).doc.toString();return(0,r.v)(n,[...e.value!==i?[{type:"modify_node",node_id:e.id,new_node_value:i}]:[],{type:"modify_name",node_id:e.id,new_node_name:t}])}(u,d,e),c&&p&&d)?function(e,t,n){let{editorStates:o,model:l,transactions:d}=e,c=[];for(let e of l.nodes){let r=o.get(e.id);if(e.value&&r){let l=!1,s=(0,a.Qc)({...e,value:r.doc.toString()});for(let r=s.references.length-1;r>=0;r--){let a=s.references[r];("MutableExpression"===a.type||"ViewExpression"===a.type)&&(a=a.id),a.name===t&&(l=!0,{editorStates:o,transactions:d}=(0,i.N)({editorStates:o,transactions:d},{changes:{from:a.start,to:a.end,insert:n}},e.id))}l&&c.push({type:"modify_node",node_id:e.id,new_node_value:o.get(e.id).doc.toString()})}(0,s.sO)(e)&&"cell"===e.data.source.type&&e.data.source.name===t&&c.push({type:"modify_data",node_id:e.id,new_node_data:{...e.data,source:{...e.data.source,name:n}}})}return{editorStates:o,model:l,transactions:d,...(0,r.v)({...e,editorStates:o,model:l,transactions:d},c)}}({...e,editorStates:h,model:m,transactions:f},p,d):{editorStates:h,model:m,transactions:f}}},90805:function(e,t,n){"use strict";n.d(t,{A:function(){return setScheduleListener},U:function(){return setSchedule}});var r=n(5146),i=n(4530);let setSchedule=(e,t)=>{let{schedule:n}=t;return{schedule:n}},setScheduleListener=async(e,t,n)=>{let{notebook:{id:o,schedule:l},currentUser:s}=e,{schedule:a}=t;try{await (0,r.Fv)("/document/".concat(o,"/schedule"),{schedule:a}),(0,i.MR)((0,i.a$)({type:"notebook:manage:setSchedule",data:{prevSchedule:l,schedule:a},eventVersion:1,currentUser:s}))}catch(e){n({type:"showErrorToast",message:"Could not set schedule. Refresh and try again?",key:"setSchedule"})}}},16755:function(e,t,n){"use strict";n.d(t,{Hr:function(){return maybeDismissSignatureHelp},M9:function(){return signatureHelpReducer},hg:function(){return signatureHelpDismissReducer}});var r=n(67064),i=n(25993),o=n(40591);let signatureHelpReducer=(e,t)=>{var n;let{model:l,signatureHelpDismissedSpan:s,editorStates:a,transactions:d}=e,{id:c,data:u}=t,p=(0,o.DY)(l,c),h=null==u?void 0:null===(n=u.applicableSpan)||void 0===n?void 0:n.start;if(p&&(!h||h!==s))return{signatureHelpData:u,signatureHelpNodeId:c,signatureHelpDismissedSpan:null,...(0,r.N)({editorStates:a,transactions:d},{effects:[i.LV.of(null),i.vo.of(void 0!==h)]},c)}},signatureHelpDismissReducer=(e,t)=>{let{id:n}=t,r=(0,o.DY)(e.model,n);if(r)return maybeDismissSignatureHelp(e,n)};function maybeDismissSignatureHelp(e,t){var n;let{editorStates:o,signatureHelpData:l,transactions:s}=e;if(null==t||!l)return;let a=(null===(n=l.applicableSpan)||void 0===n?void 0:n.start)||null;return{signatureHelpData:void 0,signatureHelpDismissedSpan:a,...(0,r.N)({editorStates:o,transactions:s},{effects:[i.LV.of(a),i.vo.of(!1)]},t)}}},59771:function(e,t,n){"use strict";n.d(t,{I8:function(){return insertSnippet},d1:function(){return requestSnippetsListener},eY:function(){return acceptSnippetListener},ns:function(){return insertSnippetListener}});var r,i=n(42866),o=n(67064),l=n(49122),s=n(22971),a=n(41888),d=n(22481),c=n(4530),u=n(40591),p=n(90271);let insertSnippet=(e,t)=>{let n,c,{apply:h,imports:m,mode:f,combine:g,display:v,label:y,afterId:x=null!==e.focusId?e.focusId:e.focusStack.length?e.focusStack[e.focusStack.length-1]:null===(r=e.model.nodes[e.model.nodes.length-1])||void 0===r?void 0:r.id}=t;if("dashboard"===e.type){let{layout:t,model:r}=e,i=x?(0,u.DY)(r,x):null;if(i){var b,w;if(null===(w=i.display)||void 0===w?void 0:null===(b=w.presentation)||void 0===b?void 0:b.hidden)n=(0,s.$T)(e,{id:x,before:!1,node:{mode:f,display:{presentation:{hidden:!0}},combine:null},type:"insert"});else{let r=x,i=null,o=t.find(e=>e.slots.find(e=>e.nodeId===x));o&&((0,d.G)(o.slots[0])||o.slots.length===p.j$)?r=o.slots[o.slots.length-1].nodeId:i=g||null===g?g:"previous",n=(0,s.$T)(e,{id:r,before:!1,node:{mode:f,combine:i,display:v},type:"insert"})}}else n=(0,s.$T)(e,{id:x,before:!1,node:{mode:f,combine:g,display:v},type:"insert"})}else n=(0,s.$T)(e,{id:x,before:!1,node:{mode:f},type:"insert"});e={...e,...n};let C=e.focusId,j={effects:[a.d.of(e.type)]},{editorStates:S}=(0,o.N)(e,j,C),k=S.get(C);if(h({dispatch:function(e){return c=e},state:k},{label:y},0,0),void 0!==m){let t=(0,l.e)(e.model.nodes),r="dashboard"===e.type?{presentation:{hidden:!0}}:void 0,o=(0,i.v)(e,m.filter(e=>{let[n]=e;return!t.has(n)}).map(e=>{let[t,n]=e;return{type:"insert_node",new_next_node_id:null,new_node_value:"import {".concat(t,'} from "').concat(n,'"'),new_node_pinned:!0,new_node_mode:"js",new_node_data:null,new_node_name:null,new_node_display:r}}));n={...n,...o},e={...e,...o}}return{...n,...(0,o.N)(e,c,C)}},insertSnippetListener=(e,t)=>{let{notebook:n,currentUser:r}=e,{label:i}=t;(0,c.MR)((0,c.ym)({type:"notebook:manage:insertSnippet",data:{label:i},eventVersion:1,notebook:n,currentUser:r}))},acceptSnippetListener=(e,t)=>{let{notebook:n,currentUser:r}=e,{id:i,source:o}=t;(0,c.MR)((0,c.ym)({type:"notebook:cells:manage:acceptSnippet",data:{cellIds:[i],source:o},eventVersion:1,notebook:n,currentUser:r}))},requestSnippetsListener=(e,t)=>{let{notebook:n,currentUser:r}=e,{id:i,trigger:o,source:l}=t;(0,c.MR)((0,c.ym)({type:"notebook:cells:manage:requestSnippets",data:{cellIds:[i],trigger:o,source:l},eventVersion:1,notebook:n,currentUser:r}))}},34513:function(e,t,n){"use strict";n.d(t,{M:function(){return updateSubscription},Q:function(){return updateSubscriptionSucceeded}});var r=n(5146),i=n(79998);let updateSubscription=async(e,t,n)=>{let{notebook:{id:o,model:l}}=e,{status:s,trigger:a,source:d}=t,c="comments"===s;try{let e=await (0,r.Fv)("/document/".concat(o,"/subscribe"),{status:s});a&&n({type:"showSuccessToast",message:c?'You will now receive emails for comments on "'.concat((0,i.Ui)(l),'".'):'You will no longer receive emails for comments on "'.concat((0,i.Ui)(l),'".')}),n({type:"updateSubscriptionSucceeded",status:e.status,trigger:a,source:d})}catch(e){a&&n({type:"showErrorToast",message:"Oops, subscribing to the notebook comments failed. Try again?",key:"updateSubscription"})}},updateSubscriptionSucceeded=(e,t)=>{let{status:n}=t;return{subscriptionState:n}}},10327:function(e,t,n){"use strict";n.d(t,{$b:function(){return closeSuggestion},BO:function(){return closeSuggestionSucceeded},G6:function(){return acknowledgeSuggestionClosedListener},Hh:function(){return sendSuggestionFailed},PZ:function(){return suggestionFromUpdated},gd:function(){return sendSuggestionListener},ky:function(){return closeSuggestionFailed},ls:function(){return sendSuggestion},nK:function(){return closeSuggestionListener}});var r=n(11163),i=n.n(r),o=n(5146),l=n(63302);let closeSuggestion=()=>({isClosingSuggestion:!0}),closeSuggestionFailed=()=>({isClosingSuggestion:!1}),closeSuggestionSucceeded=(e,t)=>{let{suggestion:n}=t;return{isClosingSuggestion:!1,suggestionFrom:n}},closeSuggestionListener=async(e,t,n)=>{let{notebook:r,currentUser:i}=e,{source:l,trigger:s}=t;n({type:"showProcessingToast",message:"Closing suggestion",key:"closeSuggestion"});try{await (0,o.Fv)("/suggestion/".concat(r.suggestionFrom.id,"/close")),n({type:"closeSuggestionSucceeded",suggestion:{...r.suggestionFrom,closer:i,close_time:new Date},source:l,trigger:s}),n({type:"showSuccessToast",message:"Suggestion closed",key:"closeSuggestion"})}catch(e){n({type:"closeSuggestionFailed"}),n({type:"showErrorToast",message:"Oops, closing the suggestion failed. Try again?",key:"closeSuggestion"})}},sendSuggestion=()=>({isSuggesting:!0}),sendSuggestionFailed=()=>({isSuggesting:!1}),sendSuggestionListener=async(e,t,n)=>{let{notebook:r}=e,{description:s,trigger:a,source:d}=t,c=r.id,u=r.forkOf.id,p={id:r.id,owner:r.owner},h={id:r.forkOf.id,owner:r.forkOf.owner};try{let e={to_id:u,from_title:r.model.title,version:r.model.version,description:s},t=await (0,o.Fv)("/document/".concat(c,"/suggest"),e);n({type:"sendSuggestionSucceeded",base:p,target:h,trigger:a,source:d});let m=(0,l.yY)(t);m!==location.pathname?i().push(m):i().reload()}catch(e){n({type:"sendSuggestionFailed",base:p,target:h,trigger:a,source:d}),n({type:"showErrorToast",message:"Oops, suggesting failed. Try again?"})}},acknowledgeSuggestionClosedListener=async(e,t,n)=>{let{notebook:r}=e;try{let e=await (0,o.Fv)("/suggestion/".concat(r.suggestionFrom.id,"/close-acknowledge"));n({type:"suggestionFromUpdated",updatedSuggestionFrom:e})}catch(e){n({type:"showErrorToast",message:"Oops, acknowledging the suggestion was closed failed. Try again?"})}},suggestionFromUpdated=(e,t)=>{let{updatedSuggestionFrom:n}=t;return{suggestionFrom:n}}},69948:function(e,t,n){"use strict";n.d(t,{Pn:function(){return deleteTag},_U:function(){return addTag},j7:function(){return deleteTagConfirm},v5:function(){return addTagConfirm}});var r=n(5146),i=n(4530);let addTag=async(e,t,n)=>{let{notebook:o,currentUser:l}=e,{tag:s,documentId:a}=t;try{n({type:"addTagConfirm",tag:s}),await (0,r.Fv)("/document/".concat(a,"/tag/add"),{tag:s}),(0,i.MR)((0,i.ym)({type:"notebook:manage:addTag",data:{tag:s},eventVersion:1,currentUser:l,notebook:o}))}catch(e){n({type:"showErrorToast",message:"Error adding tag: ".concat(s)})}},deleteTag=async(e,t,n)=>{let{notebook:o,currentUser:l}=e,{tag:s,documentId:a}=t;try{n({type:"deleteTagConfirm",tag:s}),await (0,r.Fv)("/document/".concat(a,"/tag/delete"),{tag:s}),(0,i.MR)((0,i.ym)({type:"notebook:manage:deleteTag",data:{tag:s},eventVersion:1,currentUser:l,notebook:o}))}catch(e){n({type:"showErrorToast",message:"Error deleting tag: ".concat(s)})}},addTagConfirm=(e,t)=>{let{tags:n}=e,{tag:r}=t;return n.push(r),{tags:n}},deleteTagConfirm=(e,t)=>{let{tags:n}=e,{tag:r}=t;return{tags:n.filter(e=>e!==r)}}},42866:function(e,t,n){"use strict";n.d(t,{v:function(){return applyModel}});var r=n(72776),i=n(67064),o=n(49092),l=n(49122),s=n(62029),a=n(93156),d=n(13961),c=n(40591),u=n(29020),p=n(15864);function applyModel(e,t){if(t.some(e=>"revert"===e.type))throw Error("Revert could not be processed.");let n=[],h=new Set,m=new Set,f=new Set,g=e.model.apply(t,e=>{(0,o.v)(e,n),(0,o.O)(e,{inserts:h,removes:m,modes:f})});if(!n.length)return{model:e.model,transactions:e.transactions,editorStates:e.editorStates};g.history=e.model.history.concat(n);let v=g.events.slice(e.model.version+1).filter(e=>"modify_node"===e.type||"mode_node"===e.type);if(!h.size&&!m.size&&!f.size&&!v.length)return{model:g,transactions:e.transactions,editorStates:e.editorStates};let{transactions:y}=e,x=new Map(e.editorStates),b=new Map,w=(0,p._6)();for(let t of h){let n=(0,c.DY)(g,t);n&&x.set(t,(0,r.l8)(n,w,e.files,e.owner,(0,u.os)(e)))}for(let e of m)x.delete(e),b.set(e,null);let C=new Set;for(let{node_id:e,new_node_value:t}of v)if(C.add(e),x.has(e)){let n=x.get(e);({transactions:y,editorStates:x}=(0,i.N)({transactions:y,editorStates:x},(0,a.rN)(n,t),e))}for(let t of(e.model.nodes!==g.nodes&&({editorStates:x,transactions:y}=(0,l.C)({editorStates:x,transactions:y},g.nodes)),f)){let e=(0,c.DY)(g,t);e&&({transactions:y,editorStates:x}=(0,i.N)({transactions:y,editorStates:x},{effects:d.g.of(e)},t))}return{model:g,editorStates:x,transactions:y,...(0,s.a)(e,b)}}},67064:function(e,t,n){"use strict";n.d(t,{N:function(){return applyUpdate}});var r=n(78120);function applyUpdate(e,t,n){let{editorStates:i,transactions:o}=e,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:n;(void 0===o||0===o.length)&&(o=[],i=new Map(i));let s=t instanceof r.YW?t:i.get(n).update(t);return i.set(l,s.state),o.push(s),{editorStates:i,transactions:o}}},49092:function(e,t,n){"use strict";function modelHistoryCallback(e,t){"noop"!==e.type&&t.push(e)}function modelNodeCallback(e,t){let{inserts:n,removes:r,modes:i}=t;switch(e.type){case"insert_node":n.add(e.node_id),r.delete(e.node_id);break;case"remove_node":n.delete(e.node_id),i.delete(e.node_id),r.add(e.node_id);break;case"mode_node":i.add(e.node_id)}}n.d(t,{O:function(){return modelNodeCallback},v:function(){return modelHistoryCallback}})},49122:function(e,t,n){"use strict";n.d(t,{C:function(){return updateNames},e:function(){return getNames}});var r=n(67064),i=n(85623),o=n(41312);function updateNames(e,t){let{editorStates:n,transactions:o}=e,l=getNames(t);for(let[e]of n)({transactions:o,editorStates:n}=(0,r.N)({transactions:o,editorStates:n},{effects:[i.Px.of(l)]},e));return{editorStates:n,transactions:o}}function getNames(e){return new Set(e.flatMap(o.WN))}},62029:function(e,t,n){"use strict";function remap(e,t){let{hoverId:n,focusStack:r,focusId:i,dragId:o,dropId:l,selectionFocusId:s,selection:a}=e,d={};for(let e of(r.some(e=>t.has(e))&&(d.focusStack=r.filter(e=>null!==t.get(e)).map(e=>{var n;return null!==(n=t.get(e))&&void 0!==n?n:e})),a))if(t.has(e)){let n=t.get(e);d.selection||(d.selection=new Set(a)),d.selection.delete(e),null!==n&&d.selection.add(n)}if(null!==n&&t.has(n)&&(d.hoverId=t.get(n)),null!==i&&t.has(i)&&(d.focusId=t.get(i)),null!==s&&t.has(s)&&(d.selectionFocusId=t.get(s)),null!==o&&t.has(o)&&(d.dragId=t.get(o)),null===d.dragId)d.dropId=void 0;else if(null!=l&&t.has(l)){let e=t.get(l);d.dropId=null===e?void 0:e}return d}n.d(t,{a:function(){return remap}})},89008:function(e,t,n){"use strict";n.d(t,{R:function(){return transitionModel}});var r=n(63999),i=n(72776);function transitionModel(e,t){let{body:n,editUnpublished:o,currentUser:l}=t,s=r.Z.of({...e.model,version:Math.max(e.model.version,n.version)}),a=r.Z.of(n),[d]=s.patch(a,s.nodes.concat(a.nodes).map(e=>{let{id:t}=e;return[t,t]}));return a.history=Array(e.model.history.length).concat(d),{model:a,editorStates:(0,i.AV)({...e,model:a},l),saveVersion:n.version,saveSubversion:0,editUnpublished:o,focusId:null,focusStack:[],dragId:null,dropId:void 0,hoverId:null}}},98270:function(e,t,n){"use strict";n.d(t,{D:function(){return initialNotebookState},$:function(){return eu}});var r=n(46047),i=n(36891),o=n(82730),l=n(18818),s=n(78120),a=n(67064),d=n(32341),c=n(79998),u=n(29020);function updatePresence(e,t){let n=new Map;for(let r=0;r<t.length;r++){let{node_ids:i,selections:o,avatar_url:l}=t[r];for(let a=0;a<i.length;a++){let p=i[a],h=o[a];if(null!==p&&h){if(n.has(p)||n.set(p,[]),(0,u.kG)(p,e))continue;let i=e.editorStates.get(p);if(i){let e=i.doc.length;for(let t of h.ranges)t.head>e&&(t.head=e),t.anchor>e&&(t.anchor=e)}n.get(p).push(d._O.of({selection:s.jT.fromJSON(h),avatar:l,name:(0,c.KY)(t[r]),order:r}))}}}for(let{node_ids:t}of e.participants)for(let e of t)null===e||n.has(e)||n.set(e,[d._O.of(null)]);let{editorStates:r,transactions:i}=e;for(let[e,t]of n)r.has(e)&&({transactions:i,editorStates:r}=(0,a.N)({transactions:i,editorStates:r},{effects:t},e));let o=e.spotlightParticipant&&!t.some(t=>t.id===e.spotlightParticipant);return{participants:t,transactions:i,editorStates:r,...o?{spotlightParticipant:null}:{}}}var p=n(82317),h=n(843),m=n(43318),f=n(32986),g=n(56564),v=n(39273),y=n(7595),x=n(32980),b=n(15864),w=n(78546),C=n(54588),j=n(45495),S=n(42866),k=n(44526),E=n(83687),_=n(72776),N=n(9039),L=n(93105);function updateHeight(e,t,n,r){let i={editor:0,worker:0,comments:0,display:0,total:0,...e.get(n)};return i.total+=r-i[t],0===i.total?e.delete(n):(i[t]=r,e.set(n,i)),e}var I=n(80833),T=n(66652),D=n(40591),M=n(44911);let merge=(e,t)=>{let n,r,i,o,l,{beforeId:d,afterId:c}=t,{focusId:u}=e,p=e.editorStates.get(d),h=e.editorStates.get(c),m=p.doc.toString(),f=h.doc.toString(),g=m.length,v=f.length;g<v||d===u&&!g?(n=d,r=c,i=o=0,l=m):(n=c,r=d,i=o=g,l=f);let y=(0,D.DY)(e.model,n),x=(0,D.DY)(e.model,r);if(!y||!x||y.mode!==x.mode&&(!M.qz[y.mode].convertible||!M.qz[x.mode].convertible)&&(u===d?g:u!==c||v))return;let{transactions:b,editorStates:w}=(0,a.N)(e,{changes:{from:i,to:o,insert:l}},r),C=(0,S.v)({...e,transactions:b,editorStates:w},[{type:"remove_node",node_id:n},{type:"modify_node",node_id:r,new_node_value:w.get(r).doc.toString()},..."js"!==y.mode&&"js"!==x.mode&&y.name&&!x.name?[{type:"modify_name",node_id:r,new_node_name:y.name}]:[]]),j=s.jT.single(g),k=(0,a.N)(C,{selection:j},r);return{...C,...k,...(0,L.Aq)({...e,...C,...k},r)}};var P=n(22971),R=n(47716),A=n(90772),O=n(30743),F=n(63999),B=n(49092),$=n(49122),V=n(62029),Z=n(93156),H=n(13961),U=n(23939);function mergeModel(e,t){if(t.some(e=>"revert"===e.type))throw Error("Revert could not be processed.");let n=[],r=new Set,i=new Set,o=new Set,[l,s]=e.model.merge(t,e=>{(0,B.v)(e,n),(0,B.O)(e,{inserts:r,removes:i,modes:o})});l===e.model&&(l=new F.Z(l)),l.history=e.model.history.concat(n);let c=t.filter(e=>"modify_node"===e.type||"mode_node"===e.type),p=(0,_.GD)(c);if(!s.size&&!r.size&&!i.size&&!o.size&&!p.size)return{model:l,editorStates:e.editorStates,transactions:e.transactions};let{transactions:h,files:m}=e,f=new Map(e.editorStates),g=new Map(s),v=(0,b._6)();for(let[e,t]of s){if(i.has(t))continue;r.delete(t);let n={effects:[d._O.of(null),U.y.of(t)]};({transactions:h,editorStates:f}=(0,a.N)({transactions:h,editorStates:f},n,e,t))}for(let t of r){let n=(0,D.DY)(l,t);n&&(f.set(t,(0,_.l8)(n,v,m,e.owner,(0,u.os)(e))),p.delete(t))}for(let e of i)f.delete(e),s.has(e)||g.set(e,null),p.delete(e);let y=l.events.slice(t[t.length-1].version+1).filter(e=>"modify_node"===e.type||"mode_node"===e.type),x=(0,_.GD)(y);for(let[e,t]of f){let n=(0,Z.VL)(t),r=x.get(e)||[],i=n.length-r.length;i>0&&({transactions:h,editorStates:f}=(0,a.N)({transactions:h,editorStates:f},(0,Z.r)(t,n.slice(0,i)),e))}for(let[e,t]of p){let n=f.get(e),r=t.map(e=>e.new_node_value);({transactions:h,editorStates:f}=(0,a.N)({transactions:h,editorStates:f},(0,Z.cK)(n,r),e))}for(let t of(e.model.nodes!==l.nodes&&({editorStates:f,transactions:h}=(0,$.C)({editorStates:f,transactions:h},l.nodes)),o)){let e=(0,D.DY)(l,t);e&&({transactions:h,editorStates:f}=(0,a.N)({transactions:h,editorStates:f},{effects:H.g.of(e)},t))}return{model:l,editorStates:f,transactions:h,...(0,V.a)(e,g)}}function getEditUnpublishedChange(e,t){return!(0,u.ws)(e)&&!1===e.editUnpublished&&t.some(e=>"noop"!==e.type)?{editUnpublished:!0}:void 0}var q=n(28826),Y=n(85478),z=n(77097),W=n(42786),G=n(26271),K=n(41312),J=n(42612),X=n(90805),Q=n(16755),ee=n(59771),et=n(22481),en=n(90271);function split(e,t){let{id:n,before:r}=t,{selection:{ranges:i},doc:o}=e.editorStates.get(n),l=[];for(let{from:e,to:t}of i)l.push([e,t]);let d=[],c=0;for(let{from:e,to:t}of i)d.push([c,e]),c=t;d.push([c,o.length]);for(let e=d.length-1-+!r;e>=+r;--e){let t=d[e];/^\s*$/.test(o.sliceString(...t))&&(l.push(t),d.splice(e,1))}let u=0,p=-1;for(let e=0;e<d.length;++e){let t=d[e][1]-d[e][0];t>p&&(p=t,u=e)}for(let e=0;e<d.length;++e)e!==u&&l.push(d[e]);let h=d.map(e=>o.sliceString(...e)),{pinned:m,mode:f,data:g,display:v}=(0,D.DY)(e.model,n),y=(0,D.o4)(e.model,n),x=[],b=n,w=null,C=null;if("dashboard"===e.type){let{layout:t}=e,i=t.findIndex(e=>e.slots.find(e=>e.nodeId===n)),o=t[i],l=t[i+1]?t[i+1]:null;(0,et.G)(o.slots[0])||1===o.slots.length||o.slots.length===en.j$?(C=!1,w=r?o.slots[0].nodeId:l?l.slots[0].nodeId:null):C=!0}for(let t=0;t<h.length;++t){if(t===u)continue;let i=e.model.version+x.push({type:"insert_node",new_next_node_id:!1===C?w:t<u?n:y,new_node_value:h[t],new_node_pinned:m,new_node_mode:f,new_node_data:0===h[t].length?function(e){if(null==e?void 0:e.display){let{display:t,...n}=e;return n}return e}(g):g,new_node_name:"js"===f?null:"",new_combine:C?"previous":null,new_node_display:v});(r&&0===t||!r&&t===h.length-1)&&(b=i)}let j={changes:l.map(e=>{let[t,n]=e;return{from:t,to:n}})},{transactions:k,editorStates:E}=(0,a.N)(e,j,n);x.push({type:"modify_node",node_id:n,new_node_value:h[u]});let _=(0,S.v)({...e,transactions:k,editorStates:E},x),N=(0,a.N)(_,{selection:s.jT.single(r?_.editorStates.get(b).doc.length:0)},b);return{..._,...N,...(0,L.Aq)({...e,..._,...N},b)}}var er=n(21390),ei=n(34513),eo=n(10327),el=n(69948),es=n(54687),ea=n(32219);function editorLocation(e,t){let{id:n,line:r,column:i}=t,{model:o}=e,l=(0,D.DY)(o,n),s=(0,ea.Z)(l);return"import"===s.type||"empty"===s.type?{id:n,line:1,column:0}:{id:n,...s.sourcemap.translate({line:r,column:i})}}function editorPosition(e,t){let{id:n,line:r,column:i}=t,{editorStates:o}=e,l=o.get(n);return Math.min(l.doc.line(Math.min(r,l.doc.lines)).from+i,l.doc.length-1)}function addValue(e,t,n){e.has(t)||e.set(t,new Set),e.get(t).add(n)}var ed=n(63302),ec=n(4870);function initialNotebookState(e){let{initialNotebook:t,initialCurrentUser:n,initialCollection:r,initialSafe:i=!1,initialAutosave:o=!0,initialPaused:l=!1,initialPresent:s=!1,initialSpecifier:a,initialTags:d=[]}=e,{isCompare:c=!1,saveVersion:u=t.version,baseNotebook:p}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},h=t.version<=ed.Lr&&(0,x.mG)(t)&&t.nodes.length?0:null,f=(0,N.uu)(t.files),g={assist:t.assist,type:t.type,assistFocusId:null,authors:t.authors,autosave:o,caseSensitiveSearch:!1,chatMessages:[],clientState:"closed",collections:t.collections,commentingLock:t.commenting_lock,comments:(0,m.Sh)(t.comments),composingComments:new Set,creator:t.creator,defaultThumbnail:t.default_thumbnail,description:t.description,documentKey:null,documentType:t.type,dragId:null,dropId:void 0,editorStates:new Map,editUnpublished:t.edit_unpublished,expandedResolvedComments:new Set,files:f,firstPublishedVersion:t.first_public_version,focusId:h,focusStack:null===h?[]:[h],spotlightParticipant:null,forkOf:t.fork_of,forks:t.forks,hasImporters:t.has_importers,heights:new Map,hoverId:null,id:t.id,initialAutosave:o,initialCollection:r,initialLatestVersion:t.latest_version,initialSpecifier:a?new ec.Z(a):null,insertingId:void 0,isClosingSuggestion:!1,isCompare:c,isForking:!1,isFullscreen:!1,isPausedLoad:l,present:s,isMerging:!1,isPublishing:!1,isReverting:!1,isSuggesting:!1,isUnpublishing:!1,isUpdatingTrash:!1,layout:[],like:t.like,likes:t.likes,model:(0,P.kT)(t),notificationRequests:new Map,notificationMode:void 0,openComments:new Set,owner:t.owner,participants:[],pausedVersion:t.paused_version,publishLevel:t.publish_level,publishTime:t.publish_time,publishVersion:t.publish_version,regexSearch:!1,replaceMessage:void 0,replaceTerm:"",roles:t.roles,safe:i,saveSubversion:0,saveTime:t.update_time||new Date,saveVersion:u,schedule:t.schedule,searchResults:void 0,searchResultsVisible:!1,searchTerm:"",selectedSearchResult:void 0,selection:new Set,selectionFocusId:null,sharing:t.sharing,slug:t.slug,subscriptionState:t.subscription||"default",suggestionFrom:t.suggestion_from,suggestionsTo:t.suggestions_to,tags:d,thumbnail:t.thumbnail,trashed:t.trashed,wholeWordSearch:!1,workerStatus:new Map,workerTasks:new Set},v=t.edits;return(0,b.OJ)(g,n),(0,_.Hp)(g,n,v),(0,m.UE)(g,n,p),g}let eu={addTagConfirm:el.v5,assistFocus:(e,t)=>{let{nodeId:n}=t;return{assistFocusId:n}},blur:L.yv,cellHeight:(e,t)=>{let{heights:n}=e,{heights:r}=t;for(let{id:e,height:t,type:i}of(n=new Map(n),r))updateHeight(n,i,e,t);return{heights:n}},chatCreateDraft:(e,t)=>{let{chatMessages:n}=e,{message:r}=t,i=[...n.filter(e=>!(e.id===r.id||e.node_id===r.node_id&&(0,o.t8)(e)))];return i.push(r),{chatMessages:i}},chatDelete:(e,t)=>{let{chatMessages:n}=e,{id:r}=t,i=[...n.filter(e=>e.id!==r)];return{chatMessages:i}},chatDeleteDraft:(e,t)=>{let{chatMessages:n}=e,{id:r}=t,i=[...n.filter(e=>e.id!==r)];return{chatMessages:i}},chatFeedback:(e,t)=>{let{chatMessages:n}=e,{id:r,feedback:i}=t;return{chatMessages:[...n.map(e=>r===e.id?{...e,feedback:i}:e)]}},chatSendDraft:(e,t)=>{let{chatMessages:n}=e,{id:r}=t,i=[...n.map(e=>e.id===r&&(0,o.t8)(e)?{...e,status:"unsent",complete:!0}:e)];return{chatMessages:i}},chatSend:(e,t)=>{let{chatMessages:n}=e,{type:r,...i}=t;return{chatMessages:n.concat({id:(0,l.Z)(8),...i,local:!0,complete:!0,status:"unsent"})}},chatSendConfirmed:(e,t)=>{let{chatMessages:n}=e,{id:r,sent_time:i}=t,o=[...n.map(e=>r===e.id?{...e,status:"sent",sent_time:i}:e)];return{chatMessages:o}},chatUsage:(e,t)=>{let{assist:n}=e,{enabled:r,quota_allocated:i,quota_used:o,quota_exhausted:l}=t;return n?{assist:{...n,enabled:r,quota_allocated:i,quota_exhausted:l,quota_used:o}}:{}},chatsReceived:(e,t)=>{let{chatMessages:n}=e,{chats:r}=t,i=[...n.filter(e=>!r.find(t=>t.id===e.id))];return i.push(...r),{chatMessages:function(e){let t=e.sort((e,t)=>"sent_time"in e&&"sent_time"in t?+e.sent_time-+t.sent_time:"sent_time"in e?-1:1);return t}(i)}},clientStateChanged:(e,t)=>{let{clientState:n}=t;if("aborted"===e.clientState&&"aborted"!==n)throw Error("Cannot recover an aborted client.");return{clientState:n,...("reopening"===n||"closed"===n||"aborted"===n)&&updatePresence({...e,clientState:n},[])}},closeInsertMenu:L.SS,closeSuggestion:eo.$b,closeSuggestionFailed:eo.ky,closeSuggestionSucceeded:eo.BO,cloudFileSnippet:w.AK,collectionsUpdated:p.Yd,commentComposeCancel:m.Mb,commentComposeOpen:m.hz,commentCreated:m.E,commentDeleted:m.dV,commentSaveConfirmed:m.V5,commentingLockSaved:h.q,commentsDeleteConfirmed:m.hx,commentsUpdated:m.A9,commit:P.th,createDocumentKeySucceeded:j.d,currentUserUpdated:(e,t)=>{let{updatedCurrentUser:n}=t,{owner:r}=e,{editorStates:i,transactions:o}=e,l=(0,b._6)(),d=(0,u.wW)(n,r),c=(0,u.CD)(n),p=(0,u.OA)(n),h=(0,x.Yb)(n)&&(0,y.j5)(n,e),m=!n,w=(0,u.Sx)(n),C=(0,u.S1)(n),j=(0,u.VO)(n);if(d!==l.prettierOn||c!==l.closeBracketsOn||h!==l.fileUploadsOn||p!==l.spellcheckOn||w!==l.defaultCellMode||m!==l.loginToUpload||C!==l.vimKeys||j!==l.defaultOpenAddCellMenu){(0,b.hS)({prettierOn:d,closeBracketsOn:c,fileUploadsOn:h,loginToUpload:m,spellcheckOn:p,defaultCellMode:w,vimKeys:C,defaultOpenAddCellMenu:j});let e=[g.C.of({prettierOn:d,closeBracketsOn:c,fileUploadsOn:h,loginToUpload:m,spellcheckOn:p,defaultCellMode:w,vimKeys:C,defaultOpenAddCellMenu:j})];for(let[t]of(c!==l.closeBracketsOn&&e.push(f.Hk.closeBrackets.reconfigure(c?f._g:[])),C!==l.vimKeys&&v.R.loaded&&e.push(f.Hk.vimKeys.reconfigure(l.vimKeys?s.Wl.highest(v.R.vim()):[])),i))({editorStates:i,transactions:o}=(0,a.N)({editorStates:i,transactions:o},{effects:e},t));return{editorStates:i,transactions:o}}},deleteTagConfirm:el.j7,descriptionUpdated:C.z,disableAutosave:i.C,dismissPane:q.Pp,dragEnded:(e,t)=>{let{dragCombine:n,dragDisplay:r}=t,{dragId:i,dropId:o,type:l,model:s}=e,a=r;if("dashboard"===l&&null===o){var d,c,u;(null===(u=s.nodes[s.nodes.length-1])||void 0===u?void 0:null===(c=u.display)||void 0===c?void 0:null===(d=c.presentation)||void 0===d?void 0:d.hidden)&&(a={presentation:{hidden:!0}})}return{...void 0!==o&&(0,S.v)(e,[{type:"move_node",node_id:i,new_next_node_id:o,new_combine:n,new_node_display:a}]),dragId:null,dropId:void 0}},dragStarted:(e,t)=>{let{id:n}=t;return{dragId:n}},dragged:(e,t)=>{let{dropId:n}=e,{id:r}=t;return n===r?void 0:{dropId:r}},duplicate:k.O,edit:(e,t)=>{let{editorStates:n}=e,{id:r,state:i}=t;if(n.get(r)===i)return;let o=new Map(n);o.set(r,i);let l=i.field(E.c);return null==l||l.updateFile(r,i.doc.toString()),{editorStates:o}},editCell:(e,t)=>{let{editorStates:n,transactions:r}=e,{selection:i,id:o,text:l}=t;n=new Map(n);let s=n.get(o);if(s){let e=i?s.selection.main:{from:0,to:s.doc.length},t=s.update({changes:{from:e.from,to:e.to,insert:l}});({editorStates:n,transactions:r}=(0,a.N)({editorStates:n,transactions:r},t,o))}return{editorStates:n,transactions:r}},enableVimKeys:e=>{if(!v.R.loaded)return;let t=[f.Hk.vimKeys.reconfigure(s.Wl.highest(v.R.vim()))],{editorStates:n,transactions:r}=e;for(let[e]of n)({editorStates:n,transactions:r}=(0,a.N)({editorStates:n,transactions:r},{effects:t},e));return{editorStates:n,transactions:r}},addNotificationRequest:R.$H,enterSafe:()=>({safe:!0}),exitSafe:()=>({safe:!1}),enterPresent:()=>({present:!0}),enterEdit:()=>({present:!1}),enterFullscreen:()=>({isFullscreen:!0}),exitFullscreen:()=>({isFullscreen:!1}),fileDeleteSucceeded:N.R$,fileMarkedForDeletion:N.GC,fileReplaced:N.YJ,focus:L.T_,focusAfter:L.ib,focusBefore:L.ug,focusDefinition:L.I$,focusError:L.z1,focusFirst:L.s0,focusLast:L.vG,focusUndo:L.zq,hideComments:m.u0,hover:(e,t)=>{let{id:n}=t,{hoverId:r}=e;if(r!==n)return{hoverId:n}},insertAfter:P.BE,insertBefore:P.Vt,insertCloudFile:w.GH,insertDatabase:w.q5,insertFile:N.pB,insertSuggestion:w.Qf,insertSnippet:ee.I8,layoutUpdated:(e,t)=>{let{layout:n}=t;return{layout:n}},liked:T.l,loadedVersion:I.X,localFileUploadSucceeded:N.b1,localFilesAttached:N.QT,merge:merge,mergeAfter:(e,t)=>{let{id:n}=t,{model:r}=e,i=(0,D.$g)(r,n)+1;if(!(i>=r.nodes.length))return merge(e,{type:"merge",beforeId:n,afterId:r.nodes[i].id})},mergeBefore:(e,t)=>{let{id:n}=t,{model:r}=e,i=(0,D.$g)(r,n)-1;if(!(i<0))return merge(e,{type:"merge",beforeId:r.nodes[i].id,afterId:n})},moveDown:P.vi,moveUp:P.A1,openInsertMenu:L.L4,pauseLiveEditsSuccess:A.W8,presence:(e,t)=>{let{participants:n}=t;return updatePresence(e,n)},relicense:P.XM,remoteFileUpdated:N.zJ,remove:P.Od,removeCloudFile:w.nD,replaceAll:q.wW,replaceCurrent:q.sk,resolveComments:m.Fq,resolveCommentsConfirmed:m.I5,resolveDependencies:(e,t)=>{let{resolutions:n}=t,r=n.map(e=>({type:"resolve_dependency",specifier_type:e.type,specifier:e.specifier,new_resolution:e.value}));return(0,S.v)(e,r)},confirmNotificationRequest:R.NF,rejectNotificationRequest:R.D$,resumeLiveEditsSuccess:A.eD,revertFailed:O.tR,revertRequested:O.oc,revertSucceeded:O.$R,saveConfirmed:(e,t)=>{let n,{saveVersion:r,saveSubversion:i,saveTime:o,edits:l,events:s}=t,{editorStates:d}=e,c=s.filter(e=>"modify_node"===e.type||"mode_node"===e.type),u=(0,_.GD)(c);for(let[e,t]of u)if(d.has(e)){let r=d.get(e),i=t.map(e=>e.new_node_value);({transactions:n,editorStates:d}=(0,a.N)({transactions:n,editorStates:d},(0,Z.r)(r,i),e))}let p=(0,_.GD)(l);for(let[e,t]of p)if(d.has(e)){let r=d.get(e);({transactions:n,editorStates:d}=(0,a.N)({transactions:n,editorStates:d},(0,Z.b4)(r,Array(t.length),t.length),e))}let h={saveVersion:r,saveSubversion:i,saveTime:o,editorStates:d,transactions:n};return{...h,...getEditUnpublishedChange({...e,...h},s)}},saveReceived:(e,t)=>{let{events:n,edits:r,saveVersion:i,saveTime:o,saveSubversion:l}=t,{editorStates:s,transactions:d,model:c,...u}=mergeModel(e,n),p=(0,_.GD)(r);for(let[e,t]of p)if(s.has(e)){let n=s.get(e),r=t.map(_.F2);({transactions:d,editorStates:s}=(0,a.N)({transactions:d,editorStates:s},(0,Z.b4)(n,r,0),e))}let h={editorStates:s,transactions:d,saveVersion:i,saveTime:o,saveSubversion:l,model:c,...u};return{...h,...getEditUnpublishedChange({...e,...h},n)}},selectionAll:Y.qg,selectionBlur:Y.Fq,selectionClear:Y.TW,selectionComment:Y.v2,selectionCut:Y.Sx,selectionDelete:Y.Sx,selectionDuplicate:Y.q6,selectionFocusAfter:Y.Kt,selectionFocusBefore:Y.Uo,selectionUpstream:Y.MP,selectionDownstream:Y.AG,selectionFocusEnter:Y.wP,selectionFocusToggle:Y.WZ,selectionHide:Y.PK,selectionInsert:Y.SU,selectionMoveDown:Y.zq,selectionMoveUp:Y.fV,selectionPaste:Y.Qs,selectionPin:Y.BP,selectionPromote:Y.sc,selectionRun:Y.bO,selectionToggle:Y.vJ,sendSuggestion:eo.ls,sendSuggestionFailed:eo.Hh,setAuthorAcceptance:r.KV,setAuthors:r.C2,setDataSource:z.j,setDataOperations:(e,t)=>{let{id:n,operations:r}=t,i=(0,D.DY)(e.model,n);if(!i||"table"!==i.mode)return;let o=i.data,l=function(e,t){var n,r,i;let o=new Map((null!==(i=null!==(r=t.names)&&void 0!==r?r:e.operations.names)&&void 0!==i?i:[]).map(e=>{let{name:t,column:n}=e;return[t,n]}));if(0===o.size)return t;let l={};if(null===(n=t.select)||void 0===n?void 0:n.columns){let e=t.select.columns.map(e=>{var t;return null!==(t=o.get(e))&&void 0!==t?t:e});l.select={columns:e}}return t.filter&&(l.filter=t.filter.map(e=>({...e,operands:e.operands.map(e=>{if("column"!==e.type)return e;let t=o.get(e.value);return{...e,value:null!=t?t:e.value}})}))),t.sort&&(l.sort=t.sort.map(e=>{var t;return{...e,column:null!==(t=o.get(e.column))&&void 0!==t?t:e.column}})),t.types&&(l.types=t.types.map(e=>{var t;return{...e,name:null!==(t=o.get(e.name))&&void 0!==t?t:e.name}})),{...t,...l}}(o,r),s=(0,S.v)(e,[{type:"modify_data",node_id:n,new_node_data:{...i.data,operations:{select:l.select||o.operations.select,from:l.from||o.operations.from,filter:l.filter||o.operations.filter,sort:l.sort||o.operations.sort,slice:l.slice||o.operations.slice,types:l.types||o.operations.types,names:l.names||o.operations.names,derive:"derive"in l?void 0===l.derive||0===l.derive.length?void 0:l.derive:o.operations.derive}}}]);return{...s,...(0,L.Aq)({...e,...s},n)}},setChartConfig:(e,t)=>{let{id:n,config:r,options:i}=t,o=(0,D.DY)(e.model,n);if(!o||"chart"!==o.mode)return;let l=(0,M.IS)(e.type).config,s=null===r?l:{...o.data.config,...r,options:null===i?l.options:{...o.data.config.options,...i}},a=(0,S.v)(e,[{type:"modify_data",node_id:n,new_node_data:{...o.data,config:function(e){var t;if((null===(t=e.options.color)||void 0===t?void 0:t.legend)===!1)return e;let n=JSON.parse(JSON.stringify(e)),r="field"===n.color.type||n.color.reduce;return r?n.options.color?n.options.color.legend=!0:n.options.color={legend:!0}:n.options.color&&(delete n.options.color.legend,Object.keys(n.options.color).length||delete n.options.color),n}(s)}}]);return{...a,...(0,L.Aq)({...e,...a},n)}},setDisplay:W.pk,openCollectionsSidebar:p._O,setMode:(e,t)=>{var n,r;let i,{id:o,mode:l,value:s}=t,d=e.editorStates.get(o);if(!d)return;let c=d.field(H.C);if(l===c)return;let u=(0,D.DY)(e.model,o),p=e.editorStates.get(o).doc.toString(),h=u.name;if(u.value!==p&&(i=(0,S.v)(e,[{type:"modify_node",node_id:o,new_node_value:p}])),"js"===c){let t=({...e,...i}).editorStates.get(o),n=(0,G.G)(t,!1);if(n){if((h=t.doc.sliceString(n.from,n.to))&&(0,K.r1)(h)){let n=(0,G.G)(t,!0),r=(0,G.D)(t);n&&r&&(i={...i,...(0,a.N)({...e,...i},{changes:{from:n.from,to:r.from,insert:""}},u.id)})}else h=""}else h=""}if("table"===c||"table"===l){let t=({...e,...i}).editorStates.get(o).doc.length;"table"===c?i={...i,...(0,a.N)({...e,...i},{changes:{from:0,to:t,insert:s||""}},o)}:t&&(i={...i,...(0,a.N)({...e,...i},{changes:{from:0,to:t,insert:""}},o)})}else"js"===l&&h&&({...e,...i}).editorStates.get(o).doc.length&&(i={...i,...(0,a.N)({...e,...i},{changes:{from:0,to:0,insert:"".concat(h," = ")}},o)});let m=(null===(r=u.data)||void 0===r?void 0:null===(n=r.display)||void 0===n?void 0:n.mode)==="none"?{display:{mode:"none"}}:null,f=({...e,...i}).editorStates.get(o).doc;return{...i={...i={...i,...(0,S.v)({...e,...i},[{type:"mode_node",node_id:o,new_node_value:f.toString(),new_node_pinned:f.length?u.pinned:M.qz[l].defaultNode.pinned,..."js"===l?{new_node_mode:l,new_node_name:M.xh.defaultNode.name,new_node_data:{...M.xh.defaultNode.data,...m}}:"sql"===l?{new_node_mode:l,new_node_name:null!=h?h:"",new_node_data:{...M.d0.defaultNode.data,..."table"===c&&{source:u.data.source},...m}}:"table"===l?{new_node_mode:l,new_node_name:null!=h?h:"",new_node_value:M.Zu.defaultNode.value,new_node_data:{...M.Zu.defaultNode.data,...m}}:"chart"===l?{new_node_mode:l,new_node_name:null!=h?h:"",new_node_value:M.mc.defaultNode.value,new_node_data:{...M.mc.defaultNode.data,...m}}:{new_node_mode:l,new_node_name:null!=h?h:"",new_node_data:{...M.qz[l].defaultNode.data,...m}}}])},...(0,a.N)({...e,...i},{effects:H.g.of((0,D.DY)({...e,...i}.model,o))},o)},...(0,L.Aq)({...e,...i},o)}},setName:J.q,selectNextSearchResult:q.hf,selectPreviousSearchResult:q.IY,selectSearchResult:q.oG,setReplaceTerm:q.sA,setSearchTerm:q.Fz,setSchedule:X.U,showComments:m.Q8,showFindPane:q.QB,signatureHelp:Q.M9,signatureHelpDismiss:Q.hg,splitAfter:(e,t)=>{let{id:n}=t;return split(e,{id:n,before:!1})},splitBefore:(e,t)=>{let{id:n}=t;return split(e,{id:n,before:!0})},spotlight:(e,t)=>{let{id:n}=t;if(!n)return{spotlightParticipant:null};let r=e.participants.find(e=>e.id===n);return r?{spotlightParticipant:n}:{spotlightParticipant:null}},sqlDialectUpdated:(e,t)=>{let{id:n,dialect:r}=t;return(0,a.N)(e,{effects:[f.Hk.sql.reconfigure((0,er.i6)({dialect:(0,M.D7)(r)}))]},n)},suggestionFromUpdated:eo.PZ,ignoreNotificationRequests:R.gY,synced:(e,t)=>{let{events:n,edits:r,saveVersion:i,saveSubversion:o,saveTime:l}=t,{editorStates:a,transactions:d,model:c,...p}=mergeModel(e,n);({editorStates:a,transactions:d}=(0,_.R9)({editorStates:a,transactions:d},r));let h={saveVersion:i,saveSubversion:o,...n.length||r.length?{saveTime:l}:null,editorStates:a,transactions:d,model:c,...p};if(h={...h,...updatePresence({...e,...h},e.participants)},null===e.focusId&&!(0,u.os)(e)&&(0,x.mG)(e)&&r.length>0){let t=r[0],n=e.participants.some(e=>e.self&&e.node_ids.includes(t.node_id))||!e.participants.some(e=>!e.self&&e.node_ids.includes(t.node_id));n&&a.has(t.node_id)&&(h={...h,...(0,L.$c)({...e,...h},t.node_id,s.jT.single(t.value.length))})}return{...h,...getEditUnpublishedChange({...e,...h},n)}},title:P.TN,toggleCaseSensitiveSearch:q.tT,toggleDisplay:W.r,togglePane:q.Pp,togglePin:P.aB,toggleRegexSearch:q.J2,toggleResolvedComments:m.m1,toggleWholeWordSearch:q.gL,tierUpdated:(e,t)=>{let{owner:n,roles:r}=e,{id:i,newTier:o}=t;if(n.id===i&&n.tier!==o&&"public"===n.tier)return{roles:r.filter(e=>"readonly"!==e)}},updateComment:m.uA,updateCommentStatus:m.Ty,updateSearchResults:q.YU,updateSubscriptionSucceeded:ei.Q,workerStatus:(e,t)=>{let{workerStatus:n}=e,{displayModes:r,statuses:i,suggestions:o,chartSpecs:l}=t;for(let[e,t]of(n=new Map(n),r)){let r=n.get(e),i=null==r?void 0:r.display;n.set(e,{...r,display:{mode:t,generation:i?i.generation+1:1}})}for(let[e,t]of i){let r=n.get(e);n.set(e,{...r,status:t})}for(let[e,t]of o){let r=n.get(e);n.set(e,{...r,suggestions:t})}for(let[e,t]of l){let r=n.get(e);n.set(e,{...r,chartSpec:t})}return{workerStatus:n}},workerErrors:(e,t)=>{let{errors:n}=t,{editorStates:r,transactions:i,model:o}=e,l=new Map,s=new Map;for(let e of o.nodes){let t=r.get(e.id).field(es.ei);for(let n of(t.length&&l.set(e.id,new Set),t)){if(n.isJumpToError)continue;let{jumpToError:t}=n;addValue(s,e.id,n),t&&addValue(s,e.id,t)}}for(let[t,r]of n){if(s.delete(t),!r)continue;let n="RuntimeError"===r.name?function(e,t,n){let{model:r}=e,i=(0,D.DY)(r,t),o=n.input;if(!o)return{id:t,message:n.message,position:0};let{references:l}=(0,K.Qc)(i),s=l.find(e=>o===(0,K.m8)(e));if(!s)return null;let a={id:t,message:n.message,position:s.start},d=r.nodes.find(e=>(0,K.WN)(e).includes(o));return d&&(a.jumpToError={isJumpToError:!0,id:d.id,position:0}),a}(e,t,r):"SyntaxError"===r.name?function(e,t,n){if(void 0===n.message)return null;let r=/^[\s\S]+\((\d+):(\d+)\)$/m.exec(n.message);if(!r)return null;let i=+r[1],o=+r[2];return{id:t,message:n.message,position:editorPosition(e,{id:t,line:i,column:o})}}(e,t,r):void 0!==r.stack?function(e,t,n){let r,i;let{editorStates:o}=e,l=null,s=n.stack.split("\n");for(let a=s.length-1;a>-1;a--){let d=s[a];if(r=/observablehq-(\d+):(\d+):(\d+)/.exec(d)){if(+r[1]===t){let i=+r[2]-1,o=+r[3]-1;l={id:t,message:n.message,position:editorPosition(e,editorLocation(e,{id:t,line:i,column:o}))}}else{if(!o.has(+r[1]))break;let t=+r[2]-1,n=+r[3]-1;i={isJumpToError:!0,id:+r[1],position:editorPosition(e,editorLocation(e,{id:+r[1],line:t,column:n}))}}}}return l&&{...l,jumpToError:i}}(e,t,r):null;if(!n)continue;addValue(s,t,n);let{jumpToError:i}=n;i&&addValue(s,t,i)}for(let[,e]of s)for(let t of e)addValue(l,t.id,t);for(let[e,t]of l){let n=(0,D.DY)(o,e);!n||(0,M.hN)(n)||({editorStates:r,transactions:i}=(0,a.N)({editorStates:r,transactions:i},{effects:[es.Cw.of([...t].map(t=>{var n;return{...t,doc:null===(n=r.get(e))||void 0===n?void 0:n.doc}}))]},e))}return{editorStates:r,transactions:i}},workerGoodbye:e=>{let{heights:t}=e;for(let[e,{worker:n}]of t=new Map(t))0!==n&&updateHeight(t,"worker",e,0);return{heights:t,workerStatus:new Map}},workerTask:(e,t)=>{let{safe:n,workerTasks:r}=e,{task:i}=t;return n?void i.reject(Error("no worker in safe mode")):(r.add(i),{workerTasks:r})}}},15864:function(e,t,n){"use strict";n.d(t,{OJ:function(){return setInitialUserEditorSettings},_6:function(){return userEditorSettings},hS:function(){return updateUserEditorSettings}});var r=n(7595),i=n(32980),o=n(29020);let l={prettierOn:!1,closeBracketsOn:!1,fileUploadsOn:!1,loginToUpload:!1,spellcheckOn:!1,defaultCellMode:"js",vimKeys:!1,defaultOpenAddCellMenu:!0};function setInitialUserEditorSettings(e,t){updateUserEditorSettings({prettierOn:(0,o.wW)(t,e.owner),closeBracketsOn:(0,o.CD)(t),fileUploadsOn:(0,i.Yb)(t)&&(0,r.j5)(t,e),loginToUpload:!t,spellcheckOn:(0,o.OA)(t),defaultCellMode:(0,o.Sx)(t),vimKeys:(0,o.S1)(t),defaultOpenAddCellMenu:(0,o.VO)(t)})}function updateUserEditorSettings(e){l={...l,...e}}function userEditorSettings(){return l}},85190:function(e,t,n){"use strict";n.d(t,{$j:function(){return o},v9:function(){return l},zt:function(){return r.zt}});var r=n(66338),i=n(95902);let o=(0,i.S3)(),l=(0,i.gR)()},35512:function(e,t,n){"use strict";var r,i,o,l,s,a;n.d(t,{$d:function(){return o},JY:function(){return r},UW:function(){return i}}),(l=r||(r={})).Data="data",l.Snippet="snippet",l.Reference="reference",l.Stdlib="stdlib",l.JavaScript="javascript",(s=i||(i={}))[s.JavaScriptLocal=99]="JavaScriptLocal",s[s.Reference=98]="Reference",s[s.Stdlib=97]="Stdlib",s[s.Data=96]="Data",s[s.Snippet=95]="Snippet",s[s.JavaScriptCell=94]="JavaScriptCell",s[s.JavaScript=93]="JavaScript",(a=o||(o={})).Global="global",a.Snippet="snippet",a.Cell="cell",a.Local="local",a.Stdlib="stdlib",a.File="file",a.Database="database",a.Secret="secret",a.Property="property",a.Dot="dot",a.Markdown="markdown",a.Mermaid="mermaid"}}]);